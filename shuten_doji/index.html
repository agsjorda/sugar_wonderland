<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<link rel="icon" type="image/png" href="/favicon.png" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="stylesheet" href="/style.css">
	<title>The Shuten Doji</title>
	<link rel="stylesheet" href="/main.scss">
	<style>
		body {
			margin: 0;
			padding: 0;
			overflow: hidden;
			background: #000000;
		}
		
		.background-container {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			z-index: -1;
			overflow: hidden;
		}
		
		.background-image {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			object-fit: cover;
			object-position: center bottom;
			border-radius: 0;
		}
		
		#root {
			position: relative;
			z-index: 1;
			width: 100vw;
			height: 100vh;
		}

		/* Add drop shadow under the game view (canvas inside #root) */
		#root canvas {
			filter: drop-shadow(0 16px 24px rgba(0, 0, 0, 0.7));
			border-radius: 8px;      /* or whatever radius you want */
			overflow: hidden;         /* helps ensure content respects rounding */
		}

		#game-container {
			position: relative;
			width: 100vw;
			height: 100vh;
		}

		#boot-loader {
			position: fixed;
			top: 0;
			left: 0;
			width: 100vw;
			height: 100vh;
			background: #000000;
			display: flex;
			align-items: center;
			justify-content: center;
			z-index: 2147483647;
			transition: opacity 150ms ease;
		}

		#boot-loader.hidden {
			opacity: 0;
			pointer-events: none;
		}

		#boot-loader .bl-stage {
			position: relative;
			width: min(100vw, calc(100vh * (428 / 926)));
			height: min(100vh, calc(100vw * (926 / 428)));
			aspect-ratio: 428 / 926;
			background: #10161D;
			overflow: hidden;
		}

		#boot-loader .bl-grid {
			position: absolute;
			inset: 0;
			pointer-events: none;
			background-image: radial-gradient(rgba(255,255,255,0.15) 1px, rgba(0,0,0,0) 1.5px);
			background-size: 20px 20px;
		}

		#boot-loader .bl-content {
			position: absolute;
			inset: 0;
			color: #FFFFFF;
			font-family: Poppins-Regular, Arial, sans-serif;
		}

		#boot-loader, #boot-loader * {
			box-sizing: border-box;
		}

		#boot-loader .bl-spine-slot {
			position: absolute;
			left: 50%;
			top: 48%;
			transform: translate(-50%, -50%);
			display: flex;
			align-items: center;
			justify-content: center;
			gap: 2.5%;
		}

		#boot-loader .bl-dijoker-left {
			display: block;
			width: 28%;
			max-width: none;
			height: auto;
			margin: 0;
		}

		#boot-loader .bl-dijoker-logo {
			display: block;
			width: 42%;
			max-width: none;
			height: auto;
			transform: none;
			margin: 0;
		}

		#boot-loader .bl-progress-slot {
			position: absolute;
			left: 50%;
			top: 60%;
			transform: translate(-50%, -50%);
		}

		#boot-loader .bl-motto {
			position: absolute;
			left: 50%;
			top: 89.4%;
			transform: translate(-50%, -50%);
			font-size: 14px;
			color: rgba(255,255,255,0.5);
			text-transform: uppercase;
			font-weight: 500;
			letter-spacing: 0.2px;
		}

		#boot-loader .bl-website {
			position: absolute;
			left: 50%;
			top: 92.7%;
			transform: translate(-50%, -50%);
			font-size: 14px;
			color: rgba(255,255,255,0.5);
			font-weight: 500;
		}

		#boot-loader .bl-spinner {
			width: 40px;
			height: 40px;
			border-radius: 50%;
			border: 4px solid rgba(255,255,255,0.2);
			border-top-color: #FFFFFF;
			animation: bl-spin 1s linear infinite;
			margin: 0 auto 12px;
			
		}

		@keyframes bl-spin { to { transform: rotate(360deg); } }
	</style>
</head>

<body>
	<div class="background-container">
		<img
			class="background-image"
			src="/fullscreen_bg.webp"
			alt="Fullscreen background"
		/>
	</div>
	<div id="boot-loader" aria-live="polite">
		<div class="bl-stage">
			<div class="bl-grid"></div>
			<div class="bl-content">
				<div class="bl-spine-slot">
					<img class="bl-dijoker-left" src="assets/portrait/high/loading/DiJoker.png" alt="DiJoker" onerror="this.style.display='none'"/>
					<img class="bl-dijoker-logo" src="assets/portrait/high/loading/DiJoker-logo.png" alt="DiJoker Logo" onerror="this.style.display='none'"/>
				</div>
				<div class="bl-progress-slot">
					<div class="bl-spinner"></div>
				</div>
			</div>
		</div>
	</div>
	<div id="root"></div>
	<script type="module" src="/src/main.tsx"></script>
	<script>
		(function(){
			window.setBootLoaderProgress = function(p){
				try{
					var v = Math.max(0, Math.min(100, Math.floor((p||0)*100)));
					var el = document.getElementById('boot-loader-fill');
					if (el) el.style.width = v + '%';
				}catch(e){}
			};
			window.hideBootLoader = function(){
				try{
					var el = document.getElementById('boot-loader');
					if (!el) return;
					el.classList.add('hidden');
					setTimeout(function(){ try{ el.remove(); }catch(e){} }, 200);
				}catch(e){}
			};
		})();
	</script>
</body>
</html>