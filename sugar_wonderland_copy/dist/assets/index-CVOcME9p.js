var t,e,i=Object.defineProperty,s=(t,e,s)=>((t,e,s)=>e in t?i(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);import{r as n}from"./phaser-C8r7ZkMC.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const i of t)if("childList"===i.type)for(const t of i.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();var a=n();class o{constructor(){s(this,"state"),this.state=void 0}setState(t,e){void 0!==this.state&&this.state.end(e),this.state=t,this.state.stateMachine=this,this.state.start(e)}update(t,e,i){void 0!==this.state&&this.state.update(t,e,i)}}class r{}s(r,"START","start"),s(r,"SPIN","spin"),s(r,"SPIN_END","spinEnd"),s(r,"SPIN_ANIMATION_START","spin_animation_start"),s(r,"SPIN_BEFORE_ANIMATION_END","spinBeforeAnimationEnd"),s(r,"SPIN_ANIMATION_END","spin_animation_end"),s(r,"MATCHES_DONE","matches_done"),s(r,"TUMBLE_SEQUENCE_DONE","tumble_sequence_done"),s(r,"WIN","win"),s(r,"RESET_WIN","resetWin"),s(r,"FINAL_WIN_SHOW","finalWinShow"),s(r,"FREE_SPIN_TOTAL_WIN","freeSpinTotalWin"),s(r,"CHANGE_LINE","changeLine"),s(r,"CHANGE_BET","change_bet"),s(r,"ENHANCE_BET_TOGGLE","enhance_bet_toggle"),s(r,"REMOVE_ENHANCE_BET","remove_enhance_bet"),s(r,"AUTOPLAY_START","autoplay_start"),s(r,"AUTOPLAY_STOP","autoplay_stop"),s(r,"AUTOPLAY_COMPLETE","autoplay_complete"),s(r,"BONUS_WIN_CLOSED","bonus_win_closed"),s(r,"HELP_SCREEN_TOGGLE","help_screen_toggle"),s(r,"WIN_OVERLAY_SHOW","winOverlayShow"),s(r,"WIN_OVERLAY_UPDATE_TOTAL_WIN","winOverlayUpdateTotalWin"),s(r,"WIN_OVERLAY_HIDE","winOverlayHide"),s(r,"FREE_SPIN_OVERLAY_SHOW","free_spin_overlay_show"),s(r,"UPDATE_TOTAL_WIN","updateTotalWin"),s(r,"UPDATE_CURRENCY","updateCurrency"),s(r,"UPDATE_BALANCE","updateBalance"),s(r,"GET_BALANCE","getBalance"),s(r,"UPDATE_FAKE_BALANCE","updateFakeBalance"),s(r,"CREATE_TURBO_BUTTON","createTurboButton"),s(r,"CREATE_AUTOPLAY","createAutoplay"),s(r,"CREATE_SPIN_BUTTON","createSpinButton"),s(r,"CREATE_DOUBLE_FEATURE","createDoubleFeature"),s(r,"CREATE_INFO","createInfo"),s(r,"emitter",new Phaser.Events.EventEmitter),s(r,"BOMB_FLOAT_TEXT","bomb_float_text"),s(r,"SESSION_TIMEOUT","session_timeout"),s(r,"SHOW_INSUFFICIENT_BALANCE","show_insufficient_balance"),s(r,"SHOW_BOMB_WIN","show_bomb_win"),s(r,"HIDE_BOMB_WIN","hide_bomb_win");const l=(t=0)=>e=>`[${e+t}m`,h=(t=0)=>e=>`[${38+t};5;${e}m`,c=(t=0)=>(e,i,s)=>`[${38+t};2;${e};${i};${s}m`,d={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};Object.keys(d.modifier),Object.keys(d.color),Object.keys(d.bgColor);const u=function(){const t=new Map;for(const[e,i]of Object.entries(d)){for(const[e,s]of Object.entries(i))d[e]={open:`[${s[0]}m`,close:`[${s[1]}m`},i[e]=d[e],t.set(s[0],s[1]);Object.defineProperty(d,e,{value:i,enumerable:!1})}return Object.defineProperty(d,"codes",{value:t,enumerable:!1}),d.color.close="[39m",d.bgColor.close="[49m",d.color.ansi=l(),d.color.ansi256=h(),d.color.ansi16m=c(),d.bgColor.ansi=l(10),d.bgColor.ansi256=h(10),d.bgColor.ansi16m=c(10),Object.defineProperties(d,{rgbToAnsi256:{value:(t,e,i)=>t===e&&e===i?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(e/255*5)+Math.round(i/255*5),enumerable:!1},hexToRgb:{value(t){const e=/[a-f\d]{6}|[a-f\d]{3}/i.exec(t.toString(16));if(!e)return[0,0,0];let[i]=e;3===i.length&&(i=[...i].map((t=>t+t)).join(""));const s=Number.parseInt(i,16);return[s>>16&255,s>>8&255,255&s]},enumerable:!1},hexToAnsi256:{value:t=>d.rgbToAnsi256(...d.hexToRgb(t)),enumerable:!1},ansi256ToAnsi:{value(t){if(t<8)return 30+t;if(t<16)return t-8+90;let e,i,s;if(t>=232)e=(10*(t-232)+8)/255,i=e,s=e;else{const n=(t-=16)%36;e=Math.floor(t/36)/5,i=Math.floor(n/6)/5,s=n%6/5}const n=2*Math.max(e,i,s);if(0===n)return 30;let a=30+(Math.round(s)<<2|Math.round(i)<<1|Math.round(e));return 2===n&&(a+=60),a},enumerable:!1},rgbToAnsi:{value:(t,e,i)=>d.ansi256ToAnsi(d.rgbToAnsi256(t,e,i)),enumerable:!1},hexToAnsi:{value:t=>d.ansi256ToAnsi(d.hexToAnsi256(t)),enumerable:!1}}),d}(),m=(()=>{if(!("navigator"in globalThis))return 0;if(globalThis.navigator.userAgentData){const t=navigator.userAgentData.brands.find((({brand:t})=>"Chromium"===t));if(t&&t.version>93)return 3}return/\b(Chrome|Chromium)\//.test(globalThis.navigator.userAgent)?1:0})(),g=0!==m&&{level:m},p={stdout:g,stderr:g};function b(t,e,i){let s=t.indexOf(e);if(-1===s)return t;const n=e.length;let a=0,o="";do{o+=t.slice(a,s)+e+i,a=s+n,s=t.indexOf(e,a)}while(-1!==s);return o+=t.slice(a),o}const{stdout:f,stderr:y}=p,w=Symbol("GENERATOR"),S=Symbol("STYLER"),x=Symbol("IS_EMPTY"),F=["ansi","ansi","ansi256","ansi16m"],v=Object.create(null);function T(t){return(t=>{const e=(...t)=>t.join(" ");return((t,e={})=>{if(e.level&&!(Number.isInteger(e.level)&&e.level>=0&&e.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");const i=f?f.level:0;t.level=void 0===e.level?i:e.level})(e,t),Object.setPrototypeOf(e,T.prototype),e})(t)}Object.setPrototypeOf(T.prototype,Function.prototype);for(const[ha,ca]of Object.entries(u))v[ha]={get(){const t=P(this,B(ca.open,ca.close,this[S]),this[x]);return Object.defineProperty(this,ha,{value:t}),t}};v.visible={get(){const t=P(this,this[S],!0);return Object.defineProperty(this,"visible",{value:t}),t}};const A=(t,e,i,...s)=>"rgb"===t?"ansi16m"===e?u[i].ansi16m(...s):"ansi256"===e?u[i].ansi256(u.rgbToAnsi256(...s)):u[i].ansi(u.rgbToAnsi(...s)):"hex"===t?A("rgb",e,i,...u.hexToRgb(...s)):u[i][t](...s),M=["rgb","hex","ansi256"];for(const ha of M)v[ha]={get(){const{level:t}=this;return function(...e){const i=B(A(ha,F[t],"color",...e),u.color.close,this[S]);return P(this,i,this[x])}}},v["bg"+ha[0].toUpperCase()+ha.slice(1)]={get(){const{level:t}=this;return function(...e){const i=B(A(ha,F[t],"bgColor",...e),u.bgColor.close,this[S]);return P(this,i,this[x])}}};const C=Object.defineProperties((()=>{}),{...v,level:{enumerable:!0,get(){return this[w].level},set(t){this[w].level=t}}}),B=(t,e,i)=>{let s,n;return void 0===i?(s=t,n=e):(s=i.openAll+t,n=e+i.closeAll),{open:t,close:e,openAll:s,closeAll:n,parent:i}},P=(t,e,i)=>{const s=(...t)=>I(s,1===t.length?""+t[0]:t.join(" "));return Object.setPrototypeOf(s,C),s[w]=t,s[S]=e,s[x]=i,s},I=(t,e)=>{if(t.level<=0||!e)return t[x]?"":e;let i=t[S];if(void 0===i)return e;const{openAll:s,closeAll:n}=i;if(e.includes(""))for(;void 0!==i;)e=b(e,i.close,i.open),i=i.parent;const a=e.indexOf("\n");return-1!==a&&(e=function(t,e,i,s){let n=0,a="";do{const o="\r"===t[s-1];a+=t.slice(n,o?s-1:s)+e+(o?"\r\n":"\n")+i,n=s+1,s=t.indexOf("\n",n)}while(-1!==s);return a+=t.slice(n),a}(e,n,s,a)),s+e+n};Object.defineProperties(T.prototype,v);const E=T();T({level:y?y.level:0});class D{constructor(){s(this,"initialLayerX",0),s(this,"initialLayerY",0),s(this,"isMobile",!1),s(this,"paused",!1),s(this,"main_background"),s(this,"bonus_background"),s(this,"main_cloud"),s(this,"bonus_cloud"),s(this,"main_foreground"),s(this,"bonus_foreground"),s(this,"main_lantern1"),s(this,"main_lantern2"),s(this,"main_lantern3"),s(this,"bonus_lantern1"),s(this,"bonus_lantern2"),s(this,"bonus_lantern3"),s(this,"lanternTweens",[]),s(this,"fsButton",null),s(this,"onEnterFs"),s(this,"onLeaveFs"),s(this,"onDomFsChange"),s(this,"onResize"),s(this,"floatingSpeedX",.001),s(this,"floatingSpeedY",.0012),s(this,"floatingAmplitudeX",200),s(this,"floatingAmplitudeY",250),s(this,"cloudParallaxSpeed",.1),s(this,"foregroundParallaxSpeed",0)}isMobileDevice(){const t=new URLSearchParams(window.location.search);return"mobile"==t.get("device")||"desktop"!=t.get("device")&&(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768)}preload(t){if(this.isMobile=this.isMobileDevice(),this.isMobile){const e="assets/Mobile";t.load.image("mobile_main_background",`${e}/Main_Background.png`),t.load.image("mobile_bonus_background",`${e}/Bonus_Background.png`),t.load.image("mobile_main_cover",`${e}/Main_Cover.png`),t.load.image("mobile_bonus_cover",`${e}/Bonus_Cover.png`)}else{const e="assets/background";t.load.image("bonus_background",`${e}/Bonus_Background.png`),t.load.image("bonus_cloud",`${e}/Bonus_Cloud.png`),t.load.image("bonus_foreground",`${e}/Bonus_Foreground.png`),t.load.image("bonus_lantern",`${e}/Bonus_Lantern.png`),t.load.image("main_background",`${e}/Main_Background.png`),t.load.image("main_cloud",`${e}/Main_Cloud.png`),t.load.image("main_foreground",`${e}/Main_Foreground.png`),t.load.image("main_lantern",`${e}/Main_Lantern.png`)}t.load.image("fs_max","assets/Controllers/Maximize.png"),t.load.image("fs_min","assets/Controllers/Minimize.png")}create(t){var e;this.createBackground(t),this.isMobile||this.createLanterns(t),t.gameData.isBonusRound=!1,console.log(E.green.bold(`[BG] create: isBonusRound=${t.gameData.isBonusRound}`)),this.toggleBackground(t),(null==(e=t.events)?void 0:e.on)&&t.events.on("shutdown",(()=>{this.lanternTweens=[]})),r.emitter.on(r.WIN_OVERLAY_SHOW,(()=>{this.paused=!0,this.pauseLanternTweens(t)})),r.emitter.on(r.WIN_OVERLAY_HIDE,(()=>{this.paused=!1,this.resumeLanternTweens(t)})),r.emitter.on(r.SESSION_TIMEOUT,(()=>{this.paused=!0,this.pauseLanternTweens(t)}));const i="undefined"!=typeof window&&window.APP_CONFIG?window.APP_CONFIG.version:void 0;let s=null!=i?i:"1.4.0";s&&!s.startsWith("v")&&(s=`v${s}`);const n=t.scale.width,a=t.scale.height,o=n<=500,l=t.add.text(n-10,a-10,s,{fontSize:o?"12px":"14px",color:"#ffffff",fontFamily:"'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif",stroke:"#000000",strokeThickness:2});l.setOrigin(1,1).setAlpha(.2),l.setDepth(3),this.createFullscreenToggle(t)}toggleBackground(t){let e=0,i=0;t.gameData.isBonusRound?(e=0,i=1):(e=1,i=0),this.main_background.alpha=e,this.bonus_background.alpha=i,this.main_foreground.alpha=e,this.bonus_foreground.alpha=i,this.isMobile||(this.main_cloud.alpha=e,this.main_foreground.alpha=e,this.main_lantern1.alpha=e,this.main_lantern2.alpha=e,this.main_lantern3.alpha=e,this.bonus_cloud.alpha=i,this.bonus_foreground.alpha=i,this.bonus_lantern1.alpha=i,this.bonus_lantern2.alpha=i,this.bonus_lantern3.alpha=i)}createFullscreenToggle(t){var e;const i=t.scale.width,s=this.isMobile?10:12,n=t.scale.isFullscreen?"fs_min":"fs_max",a=t.add.image(i-s,s,n);a.setOrigin(1,0);const o=this.isMobile?28:32;a.setDisplaySize(o,o),a.setInteractive({useHandCursor:!0}),a.setDepth(4),this.fsButton=a,a.on("pointerup",(()=>{var e,i,s,n;try{if(t.scale.isFullscreen){const s=null==(i=(e=t.scale).stopFullscreen)?void 0:i.call(e);s&&"function"==typeof s.catch&&s.catch((()=>{}))}else{const e=null==(n=(s=t.scale).startFullscreen)?void 0:n.call(s);e&&"function"==typeof e.catch&&e.catch((()=>{}))}}catch(a){}}));const r=()=>{this.fsButton&&this.fsButton.setTexture(t.scale.isFullscreen?"fs_min":"fs_max")};this.onEnterFs=r,this.onLeaveFs=r,t.scale.on("enterfullscreen",this.onEnterFs),t.scale.on("leavefullscreen",this.onLeaveFs),this.onDomFsChange=r,document.addEventListener("fullscreenchange",this.onDomFsChange),document.addEventListener("webkitfullscreenchange",this.onDomFsChange),this.onResize=()=>{const e=t.scale.width,i=s;this.fsButton&&this.fsButton.setPosition(e-i,i)},t.scale.on("resize",this.onResize),(null==(e=t.events)?void 0:e.once)&&t.events.once("shutdown",(()=>{this.onEnterFs&&t.scale.off("enterfullscreen",this.onEnterFs),this.onLeaveFs&&t.scale.off("leavefullscreen",this.onLeaveFs),this.onResize&&t.scale.off("resize",this.onResize),this.onDomFsChange&&(document.removeEventListener("fullscreenchange",this.onDomFsChange),document.removeEventListener("webkitfullscreenchange",this.onDomFsChange)),this.onEnterFs=void 0,this.onLeaveFs=void 0,this.onResize=void 0,this.onDomFsChange=void 0,this.fsButton&&(this.fsButton.destroy(),this.fsButton=null)}))}createBackground(t){const e=t.scale.width,i=t.scale.height,s=.5*e,n=.5*i;if(this.initialLayerX=s,this.initialLayerY=n,this.isMobile)this.main_background=t.add.image(s,n,"mobile_main_background"),this.main_background.setScale(1),this.main_background.setOrigin(.5,.5),this.bonus_background=t.add.image(s,n,"mobile_bonus_background"),this.bonus_background.setScale(1),this.bonus_background.setOrigin(.5,.5),this.main_foreground=t.add.image(s,t.scale.height,"mobile_main_cover"),this.main_foreground.setScale(1),this.main_foreground.setOrigin(.5,1.075),this.bonus_foreground=t.add.image(s,t.scale.height,"mobile_bonus_cover"),this.bonus_foreground.setScale(1),this.bonus_foreground.setOrigin(.5,1.075),this.main_background.setDepth(0),this.bonus_background.setDepth(0),this.main_foreground.setDepth(5),this.bonus_foreground.setDepth(5),this.main_cloud=null,this.bonus_cloud=null,this.main_lantern1=null,this.main_lantern2=null,this.main_lantern3=null,this.bonus_lantern1=null,this.bonus_lantern2=null,this.bonus_lantern3=null;else{this.main_background=t.add.image(this.initialLayerX,this.initialLayerY,"main_background"),this.main_cloud=t.add.image(this.initialLayerX,this.initialLayerY,"main_cloud"),this.main_foreground=t.add.image(this.initialLayerX,.4*i,"main_foreground"),this.bonus_background=t.add.image(this.initialLayerX,this.initialLayerY,"bonus_background"),this.bonus_cloud=t.add.image(this.initialLayerX,this.initialLayerY,"bonus_cloud"),this.bonus_foreground=t.add.image(this.initialLayerX,.4*i,"bonus_foreground");const e=.525;this.main_background.setScale(e),this.main_cloud.setScale(1.25*e),this.main_foreground.setScale(e),this.main_background.setDepth(0),this.main_cloud.setDepth(1),this.main_foreground.setDepth(2),this.bonus_background.setScale(e),this.bonus_cloud.setScale(1.25*e),this.bonus_foreground.setScale(e),this.bonus_background.setDepth(0),this.bonus_cloud.setDepth(1),this.bonus_foreground.setDepth(2)}}update(t,e,i){var s;if(this.isMobile)return;if(this.paused||(null==(s=t.slotMachine)?void 0:s.activeWinOverlay))return;const n=Math.sin(e*this.floatingSpeedX)*this.floatingAmplitudeX,a=Math.sin(e*this.floatingSpeedY)*this.floatingAmplitudeY;this.main_cloud&&(this.main_cloud.x=this.initialLayerX+n*this.cloudParallaxSpeed,this.main_cloud.y=this.initialLayerY+a*this.cloudParallaxSpeed),this.bonus_cloud&&(this.bonus_cloud.x=this.initialLayerX+n*this.cloudParallaxSpeed,this.bonus_cloud.y=this.initialLayerY+a*this.cloudParallaxSpeed),this.main_foreground&&(this.main_foreground.x=this.initialLayerX+n*this.foregroundParallaxSpeed,this.main_foreground.y=this.initialLayerY+a*this.foregroundParallaxSpeed),this.bonus_foreground&&(this.bonus_foreground.x=this.initialLayerX+n*this.foregroundParallaxSpeed,this.bonus_foreground.y=this.initialLayerY+a*this.foregroundParallaxSpeed)}createLanterns(t){if(this.isMobile)return;const e=t.scale.width,i=t.scale.height;this.main_lantern1=t.add.image(.1*e,.25*i,"main_lantern"),this.main_lantern1.setScale(.325),this.main_lantern1.setDepth(3),this.main_lantern1.setOrigin(.5,0),t.tweens.add({targets:this.main_lantern1,angle:{from:0,to:20},duration:1e3,ease:"Sine.easeInOut",yoyo:!0,repeat:-1}),this.captureTweensForTarget(t,this.main_lantern1),this.main_lantern2=t.add.image(.1825*e,.19*i,"main_lantern"),this.main_lantern2.setScale(.45),this.main_lantern2.setDepth(3),this.main_lantern2.setOrigin(.5,0),t.tweens.add({targets:this.main_lantern2,angle:{from:0,to:20},duration:1200,ease:"Sine.easeInOut",yoyo:!0,repeat:-1}),this.captureTweensForTarget(t,this.main_lantern2),this.main_lantern3=t.add.image(.94*e,.15*i,"main_lantern"),this.main_lantern3.setScale(.325),this.main_lantern3.setDepth(3),this.main_lantern3.setOrigin(.5,0),t.tweens.add({targets:this.main_lantern3,angle:{from:0,to:20},duration:1100,ease:"Sine.easeInOut",yoyo:!0,repeat:-1}),this.captureTweensForTarget(t,this.main_lantern3),this.bonus_lantern1=t.add.image(.1*e,.2*i,"bonus_lantern"),this.bonus_lantern1.setScale(.325),this.bonus_lantern1.setDepth(3),this.bonus_lantern1.setOrigin(.5,0),t.tweens.add({targets:this.bonus_lantern1,angle:{from:0,to:20},duration:1e3,ease:"Sine.easeInOut",yoyo:!0,repeat:-1}),this.captureTweensForTarget(t,this.bonus_lantern1),this.bonus_lantern2=t.add.image(.1825*e,.14*i,"bonus_lantern"),this.bonus_lantern2.setScale(.45),this.bonus_lantern2.setDepth(3),this.bonus_lantern2.setOrigin(.5,0),t.tweens.add({targets:this.bonus_lantern2,angle:{from:0,to:20},duration:1200,ease:"Sine.easeInOut",yoyo:!0,repeat:-1}),this.captureTweensForTarget(t,this.bonus_lantern2),this.bonus_lantern3=t.add.image(.94*e,.1*i,"bonus_lantern"),this.bonus_lantern3.setScale(.325),this.bonus_lantern3.setDepth(3),this.bonus_lantern3.setOrigin(.5,0),t.tweens.add({targets:this.bonus_lantern3,angle:{from:0,to:20},duration:1100,ease:"Sine.easeInOut",yoyo:!0,repeat:-1}),this.captureTweensForTarget(t,this.bonus_lantern3)}captureTweensForTarget(t,e){const i=t.tweens.getTweensOf?t.tweens.getTweensOf(e):[];Array.isArray(i)&&this.lanternTweens.push(...i)}pauseLanternTweens(t){t&&t.tweens&&this.lanternTweens.forEach((t=>t.pause()))}resumeLanternTweens(t){t&&t.tweens&&this.lanternTweens.forEach((t=>t.resume()))}}class R{constructor(t){s(this,"gameAPI"),s(this,"winamounts",[[100,50,25,15,12,10,8,5,4,2,100],[5,25,10,5,2,1.5,1.2,1,.9,.75,5],[3,10,2.5,2,1,1,.8,.5,.4,.25,3]]),s(this,"currency","$"),s(this,"slot",new _),s(this,"line",0),s(this,"currentRow",0),s(this,"bet",1),s(this,"maxBet",150),s(this,"minBet",.2),s(this,"balance",0),s(this,"totalBet",0),s(this,"totalWin",0),s(this,"totalWinFreeSpin",[]),s(this,"totalWinFreeSpinPerTumble",[]),s(this,"totalBonusWin",0),s(this,"doubleChanceEnabled",!1),s(this,"buyFeatureEnabled",!1),s(this,"isSpinning",!1),s(this,"turbo",!1),s(this,"isBonusRound",!1),s(this,"freeSpinLockUntilMs",0),s(this,"scatterCount",0),s(this,"scatterChance",.025),s(this,"maxScatter",6),s(this,"minScatter",0),s(this,"minBomb",0),s(this,"maxBomb",3),s(this,"bombMultiplier",[2,3,4,5,6,8,10,12,15,20,25,50,100]),s(this,"bombChance",10),s(this,"bombTypeChances",{low:.6,medium:.3,high:.1}),s(this,"isHelpScreenVisible",!1),s(this,"isMain",!0),s(this,"defaultMinScatter",0),s(this,"currentMatchingSymbols",[]),s(this,"doubleChanceMultiplier",2),s(this,"winRank",[1,20,30,45,60,21e3]),s(this,"gameUrl",""),s(this,"gameToken",""),s(this,"freeSpins",0),s(this,"totalFreeSpins",0),s(this,"apiBet",1),s(this,"apiFreeSpins",[]),s(this,"apiFreeSpinsIndex",0),s(this,"useApiFreeSpins",!1),s(this,"totalBombWin",0),s(this,"currentFreeSpinIndex",0),s(this,"autoplayRemainingSpins",0),s(this,"autoplayWasPaused",!1),s(this,"debugged",(()=>{const t=new URLSearchParams(window.location.search).get("debug");return console.log("debugParam",t,parseInt(t||"0")),t?parseInt(t):0})()),s(this,"demoMode",!1),this.gameAPI=t,function(){const t=new URLSearchParams(window.location.search);t.toString()&&console.log("ðŸ” URL Parameters:",Object.fromEntries(t.entries()))}(),this.debugged>0&&console.log("ðŸ”§ Debug mode enabled")}getDoubleFeaturePrice(){return Math.round(1.25*this.bet*100)/100}getBuyFeaturePrice(){return Math.round(100*this.bet)}isDebugMode(){return this.debugged>0}debugError(t,...e){this.debugged>0&&console.error(`%c[DEBUG ERROR] ${t}`,"color: #ff0000",...e)}debugLog(t,...e){this.debugged>0&&console.log(`[DEBUG] ${t}`,...e)}}let _=(t=class{constructor(){s(this,"values",[]),s(this,"scatterCount",0),s(this,"bombCount",0);for(let e=0;e<t.ROWS;e++){const e=[];for(let i=0;i<t.COLUMNS;i++){const i=Math.floor(Math.random()*t.SYMBOLS);e.push(i)}this.values.push(e)}}setRows(e,i){for(let s=0;s<t.COLUMNS;s++)this.values[i][s]=e[s]}placeBombs(e=0,i,s,n){if(this.bombCount=0,!n)return;const a=[];for(let o=0;o<t.ROWS;o++)for(let e=0;e<t.COLUMNS;e++)a.push({row:o,col:e});for(let t=a.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[a[t],a[e]]=[a[e],a[t]]}for(let t=0;t<a.length&&this.bombCount<i;t++)if(this.bombCount<e){const{row:e,col:i}=a[t],s=Math.random();let n;n=s<.6?Math.floor(7*Math.random())+10:s<.9?Math.floor(4*Math.random())+17:Math.floor(2*Math.random())+21,this.values[e][i]=n,this.bombCount++}else if(Math.random()<s){const{row:e,col:i}=a[t],s=Math.random();let n;n=s<.6?Math.floor(7*Math.random())+10:s<.9?Math.floor(4*Math.random())+17:Math.floor(2*Math.random())+21,this.values[e][i]=n,this.bombCount++}}placeScatters(e=0,i,s){this.scatterCount=0;const n=[];for(let a=0;a<t.ROWS;a++)for(let e=0;e<t.COLUMNS;e++)n.push({row:a,col:e});for(let t=n.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[n[t],n[e]]=[n[e],n[t]]}for(let a=0;a<n.length&&this.scatterCount<i;a++)if(this.scatterCount<e){const{row:e,col:i}=n[a];this.values[e][i]=t.SCATTER_SYMBOL,this.scatterCount++}else if(Math.random()<s){const{row:e,col:i}=n[a];this.values[e][i]=t.SCATTER_SYMBOL,this.scatterCount++}}},s(t,"TOGGLE_DIFFICULTY",!0),s(t,"TOGGLE_WIN_EFFECT",!1),s(t,"DIFFICULTY_SYMBOLS",1),s(t,"SYMBOLS",9),s(t,"ROWS",5),s(t,"COLUMNS",6),s(t,"SCATTER_SYMBOL",0),s(t,"SCATTER_SIZE",1.5),s(t,"SYMBOL_SIZE",1.5),s(t,"BOMB_SIZE_X",1),s(t,"BOMB_SIZE_Y",.9),s(t,"BOMBS_MAX_COUNT",3),s(t,"BOMB_SCALE",1.5),t),W=class{constructor(t){s(this,"scene"),this.scene=t}preload(){for(let t=0;t<=_.SYMBOLS;t++)this.scene.load.atlas(`Symbol${t}_SW`,`assets/Symbols/Animations/Symbol${t}_SW.png`,`assets/Symbols/Animations/Symbol${t}_SW.json`);this.scene.load.atlas("Explosion_SW","assets/Symbols/Animations/Explosion_SW.png","assets/Symbols/Animations/Explosion_SW.json")}create(){for(let e=0;e<=_.SYMBOLS;e++){const t=this.scene.anims.generateFrameNames(`Symbol${e}_SW`,{start:0,end:29,zeroPad:5,prefix:`Symbol${e}_SW-`,suffix:".png"});this.scene.anims.create({key:`symbol${e}_anim`,frames:t,frameRate:30,repeat:0})}const t=this.scene.anims.generateFrameNames("Explosion_SW",{start:0,end:11,zeroPad:5,prefix:"Explosion_SW-",suffix:".png"});this.scene.anims.create({key:"explosion_anim",frames:t,frameRate:30,repeat:0})}playSymbolAnimation(t,e){if(e>=0&&e<=_.SYMBOLS){this.scene.gameData.debugLog("playing animation for symbol: "+e);const i=t.depth;t.setDepth(i+10),t.play(`symbol${e}_anim`),t.once("animationcomplete",(()=>{t.active&&t.setDepth(i)}));const s=this.scene.add.sprite(0,0,"Explosion_SW");s.setScale(t.scaleX,t.scaleY),s.setDepth(t.depth+1),t.parentContainer&&(t.parentContainer.add(s),s.x=t.x,s.y=t.y),this.scene.time.delayedCall(420,(()=>{try{s.play("explosion_anim"),s.once("animationcomplete",(()=>{s.destroy()}))}catch(t){this.scene.gameData.debugError("error playing explosion animation: "+t)}}))}}stopSymbolAnimation(t){t.stop();const e=t.frame.texture.key.replace("Symbol","").replace("_SW","");t.setFrame(`Symbol${e}_SW-00000.png`)}};class L{constructor(t){s(this,"scene"),s(this,"spineWinAnim"),s(this,"bombImages",[]),s(this,"currentTrack",0),this.scene=t}preload(){this.scene.load.spineAtlas("myWinAnim2","assets/Win/Win.atlas"),this.scene.load.spineJson("myWinAnim2","assets/Win/Win.json"),this.scene.load.spineAtlas("Symbol10_SW","assets/Symbols/Bomb/Symbol_0002.atlas"),this.scene.load.spineJson("Symbol10_SW","assets/Symbols/Bomb/Symbol_0002.json")}create(){let t=this.scene.add.spine(0,0,"myWinAnim2","myWinAnim2");this.spineWinAnim=t,t.setPosition(0,0),t.setAlpha(0);let e=this.scene.add.spine(0,0,"Symbol10_SW","Symbol10_SW");e.setPosition(0,0),e.setAlpha(0)}update(){}playWinAnimation(t,e,i=""){t.alpha=1,this.spineWinAnim=t;let s="",n="";const a=e/500*100/100;let o=0,l=[];for(let h=0;h<500;h++)setTimeout((()=>{o>=e?o=e:o+=a,"FreeSpin"===i&&(o=e),r.emitter.emit(r.WIN_OVERLAY_UPDATE_TOTAL_WIN,o,i),l=[];const t=o.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});for(let e=0;e<t.length;e++)"."===t[e]?l.push("dot"):","===t[e]?l.push("coma"):l.push(t[e])}),3e3*h/500);switch(i){case"BigWin":s="BigWin-Intro",n="BigWin-Idle";break;case"EpicWin":s="EpicWin-Intro",n="EpicWin-Idle";break;case"MegaWin":s="MegaWin-Intro",n="MegaWin-Idle";break;case"SuperWin":s="SuperWin-Intro",n="SuperWin-Idle";break;case"FreeSpin":s="FreeSpin-Intro",n="FreeSpin-Idle";break;case"Congrats":s="Congrats-Intro",n="Congrats-Idle";break;default:return t.destroy(),void console.error("Win type not found: "+i)}""!=s&&""!=n&&(t.animationState.tracks.length>0?(t.animationState.addAnimation(this.currentTrack,s,!1),t.animationState.addAnimation(this.currentTrack+1,n,!0),this.currentTrack+=2):(t.animationState.setAnimation(this.currentTrack,s,!1),t.animationState.addAnimation(this.currentTrack+1,n,!0),this.currentTrack+=2))}exitAnimation(){this.scene.tweens.add({targets:this.spineWinAnim,alpha:0,duration:1e3,ease:"Sine.easeInOut"})}}const O="spine";let k=Phaser.GameObjects.Components;const N=k.ComputedSize,V=k.Depth,Y=k.Flip,X=k.ScrollFactor,G=k.Transform,H=k.Visible,U=k.Origin,$=k.Alpha;function z(...t){return e=>(Phaser.Class.mixin(e,t),e)}const q=z(N),j=z(V),Q=z(Y),Z=z(X),K=z(G),J=z(H),tt=z(U),et=z($);class it{constructor(){s(this,"entries",{}),s(this,"size",0)}add(t){let e=this.entries[t];return this.entries[t]=!0,!e&&(this.size++,!0)}addAll(t){let e=this.size;for(var i=0,s=t.length;i<s;i++)this.add(t[i]);return e!=this.size}contains(t){return this.entries[t]}clear(){this.entries={},this.size=0}}const st=class t{constructor(t=0,e=0,i=0,n=0){s(this,"r"),s(this,"g"),s(this,"b"),s(this,"a"),this.r=t,this.g=e,this.b=i,this.a=n}set(t,e,i,s){return this.r=t,this.g=e,this.b=i,this.a=s,this.clamp()}setFromColor(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}setFromString(t){return t="#"==t.charAt(0)?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=8!=t.length?1:parseInt(t.substr(6,2),16)/255,this}add(t,e,i,s){return this.r+=t,this.g+=e,this.b+=i,this.a+=s,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(t,e){t.r=((4278190080&e)>>>24)/255,t.g=((16711680&e)>>>16)/255,t.b=((65280&e)>>>8)/255,t.a=(255&e)/255}static rgb888ToColor(t,e){t.r=((16711680&e)>>>16)/255,t.g=((65280&e)>>>8)/255,t.b=(255&e)/255}toRgb888(){const t=t=>("0"+(255*t).toString(16)).slice(-2);return Number("0x"+t(this.r)+t(this.g)+t(this.b))}static fromString(e,i=new t){return i.setFromString(e)}};s(st,"WHITE",new st(1,1,1,1)),s(st,"RED",new st(1,0,0,1)),s(st,"GREEN",new st(0,1,0,1)),s(st,"BLUE",new st(0,0,1,1)),s(st,"MAGENTA",new st(1,0,1,1));let nt=st;const at=class t{static clamp(t,e,i){return t<e?e:t>i?i:t}static cosDeg(e){return Math.cos(e*t.degRad)}static sinDeg(e){return Math.sin(e*t.degRad)}static atan2Deg(e,i){return Math.atan2(e,i)*t.degRad}static signum(t){return t>0?1:t<0?-1:0}static toInt(t){return t>0?Math.floor(t):Math.ceil(t)}static cbrt(t){let e=Math.pow(Math.abs(t),1/3);return t<0?-e:e}static randomTriangular(e,i){return t.randomTriangularWith(e,i,.5*(e+i))}static randomTriangularWith(t,e,i){let s=Math.random(),n=e-t;return s<=(i-t)/n?t+Math.sqrt(s*n*(i-t)):e-Math.sqrt((1-s)*n*(e-i))}static isPowerOfTwo(t){return t&&!(t&t-1)}};s(at,"PI",3.1415927),s(at,"PI2",2*at.PI),s(at,"invPI2",1/at.PI2),s(at,"radiansToDegrees",180/at.PI),s(at,"radDeg",at.radiansToDegrees),s(at,"degreesToRadians",at.PI/180),s(at,"degRad",at.degreesToRadians);let ot=at;const rt=class t{static arrayCopy(t,e,i,s,n){for(let a=e,o=s;a<e+n;a++,o++)i[o]=t[a]}static arrayFill(t,e,i,s){for(let n=e;n<i;n++)t[n]=s}static setArraySize(t,e,i=0){let s=t.length;if(s==e)return t;if(t.length=e,s<e)for(let n=s;n<e;n++)t[n]=i;return t}static ensureArrayCapacity(e,i,s=0){return e.length>=i?e:t.setArraySize(e,i,s)}static newArray(t,e){let i=new Array(t);for(let s=0;s<t;s++)i[s]=e;return i}static newFloatArray(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Float32Array(e);{let t=new Array(e);for(let e=0;e<t.length;e++)t[e]=0;return t}}static newShortArray(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Int16Array(e);{let t=new Array(e);for(let e=0;e<t.length;e++)t[e]=0;return t}}static toFloatArray(e){return t.SUPPORTS_TYPED_ARRAYS?new Float32Array(e):e}static toSinglePrecision(e){return t.SUPPORTS_TYPED_ARRAYS?Math.fround(e):e}static webkit602BugfixHelper(t,e){}static contains(t,e,i=!0){for(var s=0;s<t.length;s++)if(t[s]==e)return!0;return!1}static enumValue(t,e){return t[e[0].toUpperCase()+e.slice(1)]}};s(rt,"SUPPORTS_TYPED_ARRAYS","undefined"!=typeof Float32Array);let lt=rt;class ht{constructor(t){s(this,"items",new Array),s(this,"instantiator"),this.instantiator=t}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(t){t.reset&&t.reset(),this.items.push(t)}freeAll(t){for(let e=0;e<t.length;e++)this.free(t[e])}clear(){this.items.length=0}}class ct{constructor(t=0,e=0){s(this,"x"),s(this,"y"),this.x=t,this.y=e}set(t,e){return this.x=t,this.y=e,this}length(){let t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}normalize(){let t=this.length();return 0!=t&&(this.x/=t,this.y/=t),this}}class dt{constructor(t){if(s(this,"name"),!t)throw new Error("name cannot be null.");this.name=t}}const ut=class t extends dt{constructor(e){super(e),s(this,"id",t.nextID++),s(this,"bones",null),s(this,"vertices",[]),s(this,"worldVerticesLength",0),s(this,"timelineAttachment",this)}computeWorldVertices(t,e,i,s,n,a){i=n+(i>>1)*a;let o=t.bone.skeleton,r=t.deform,l=this.vertices,h=this.bones;if(!h){r.length>0&&(l=r);let o=t.bone,h=o.worldX,c=o.worldY,d=o.a,u=o.b,m=o.c,g=o.d;for(let t=e,r=n;r<i;t+=2,r+=a){let e=l[t],i=l[t+1];s[r]=e*d+i*u+h,s[r+1]=e*m+i*g+c}return}let c=0,d=0;for(let m=0;m<e;m+=2){let t=h[c];c+=t+1,d+=t}let u=o.bones;if(0==r.length)for(let m=n,g=3*d;m<i;m+=a){let t=0,e=0,i=h[c++];for(i+=c;c<i;c++,g+=3){let i=u[h[c]],s=l[g],n=l[g+1],a=l[g+2];t+=(s*i.a+n*i.b+i.worldX)*a,e+=(s*i.c+n*i.d+i.worldY)*a}s[m]=t,s[m+1]=e}else{let t=r;for(let e=n,o=3*d,r=d<<1;e<i;e+=a){let i=0,n=0,a=h[c++];for(a+=c;c<a;c++,o+=3,r+=2){let e=u[h[c]],s=l[o]+t[r],a=l[o+1]+t[r+1],d=l[o+2];i+=(s*e.a+a*e.b+e.worldX)*d,n+=(s*e.c+a*e.d+e.worldY)*d}s[e]=i,s[e+1]=n}}}copyTo(t){this.bones?(t.bones=new Array(this.bones.length),lt.arrayCopy(this.bones,0,t.bones,0,this.bones.length)):t.bones=null,this.vertices&&(t.vertices=lt.newFloatArray(this.vertices.length),lt.arrayCopy(this.vertices,0,t.vertices,0,this.vertices.length)),t.worldVerticesLength=this.worldVerticesLength,t.timelineAttachment=this.timelineAttachment}};s(ut,"nextID",0);let mt=ut;const gt=class t{constructor(e){s(this,"id",t.nextID()),s(this,"regions"),s(this,"start",0),s(this,"digits",0),s(this,"setupIndex",0),this.regions=new Array(e)}copy(){let e=new t(this.regions.length);return lt.arrayCopy(this.regions,0,e.regions,0,this.regions.length),e.start=this.start,e.digits=this.digits,e.setupIndex=this.setupIndex,e}apply(t,e){let i=t.sequenceIndex;-1==i&&(i=this.setupIndex),i>=this.regions.length&&(i=this.regions.length-1);let s=this.regions[i];e.region!=s&&(e.region=s,e.updateRegion())}getPath(t,e){let i=t,s=(this.start+e).toString();for(let n=this.digits-s.length;n>0;n--)i+="0";return i+=s,i}static nextID(){return t._nextID++}};s(gt,"_nextID",0);let pt=gt;var bt,ft;(ft=bt||(bt={}))[ft.hold=0]="hold",ft[ft.once=1]="once",ft[ft.loop=2]="loop",ft[ft.pingpong=3]="pingpong",ft[ft.onceReverse=4]="onceReverse",ft[ft.loopReverse=5]="loopReverse",ft[ft.pingpongReverse=6]="pingpongReverse";const yt=[bt.hold,bt.once,bt.loop,bt.pingpong,bt.onceReverse,bt.loopReverse,bt.pingpongReverse];class wt{constructor(t,e,i){if(s(this,"name"),s(this,"timelines",[]),s(this,"timelineIds",new it),s(this,"duration"),!t)throw new Error("name cannot be null.");this.name=t,this.setTimelines(e),this.duration=i}setTimelines(t){if(!t)throw new Error("timelines cannot be null.");this.timelines=t,this.timelineIds.clear();for(var e=0;e<t.length;e++)this.timelineIds.addAll(t[e].getPropertyIds())}hasTimeline(t){for(let e=0;e<t.length;e++)if(this.timelineIds.contains(t[e]))return!0;return!1}apply(t,e,i,s,n,a,o,r){if(!t)throw new Error("skeleton cannot be null.");s&&0!=this.duration&&(i%=this.duration,e>0&&(e%=this.duration));let l=this.timelines;for(let h=0,c=l.length;h<c;h++)l[h].apply(t,e,i,n,a,o,r)}}var St,xt,Ft,vt;(xt=St||(St={}))[xt.setup=0]="setup",xt[xt.first=1]="first",xt[xt.replace=2]="replace",xt[xt.add=3]="add",(vt=Ft||(Ft={}))[vt.mixIn=0]="mixIn",vt[vt.mixOut=1]="mixOut";const Tt={rotate:0,x:1,y:2,scaleX:3,scaleY:4,shearX:5,shearY:6,inherit:7,rgb:8,alpha:9,rgb2:10,attachment:11,deform:12,event:13,drawOrder:14,ikConstraint:15,transformConstraint:16,pathConstraintPosition:17,pathConstraintSpacing:18,pathConstraintMix:19,physicsConstraintInertia:20,physicsConstraintStrength:21,physicsConstraintDamping:22,physicsConstraintMass:23,physicsConstraintWind:24,physicsConstraintGravity:25,physicsConstraintMix:26,physicsConstraintReset:27,sequence:28};class At{constructor(t,e){s(this,"propertyIds"),s(this,"frames"),this.propertyIds=e,this.frames=lt.newFloatArray(t*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(t,e){let i=t.length;for(let s=1;s<i;s++)if(t[s]>e)return s-1;return i-1}static search(t,e,i){let s=t.length;for(let n=i;n<s;n+=i)if(t[n]>e)return n-i;return s-i}}class Mt extends At{constructor(t,e,i){super(t,i),s(this,"curves"),this.curves=lt.newFloatArray(t+18*e),this.curves[t-1]=1}setLinear(t){this.curves[t]=0}setStepped(t){this.curves[t]=1}shrink(t){let e=this.getFrameCount()+18*t;if(this.curves.length>e){let t=lt.newFloatArray(e);lt.arrayCopy(this.curves,0,t,0,e),this.curves=t}}setBezier(t,e,i,s,n,a,o,r,l,h,c){let d=this.curves,u=this.getFrameCount()+18*t;0==i&&(d[e]=2+u);let m=.03*(s-2*a+r),g=.03*(n-2*o+l),p=.006*(3*(a-r)-s+h),b=.006*(3*(o-l)-n+c),f=2*m+p,y=2*g+b,w=.3*(a-s)+m+.16666667*p,S=.3*(o-n)+g+.16666667*b,x=s+w,F=n+S;for(let v=u+18;u<v;u+=2)d[u]=x,d[u+1]=F,w+=f,S+=y,f+=p,y+=b,x+=w,F+=S}getBezierValue(t,e,i,s){let n=this.curves;if(n[s]>t){let a=this.frames[e],o=this.frames[e+i];return o+(t-a)/(n[s]-a)*(n[s+1]-o)}let a=s+18;for(s+=2;s<a;s+=2)if(n[s]>=t){let e=n[s-2],i=n[s-1];return i+(t-e)/(n[s]-e)*(n[s+1]-i)}e+=this.getFrameEntries();let o=n[a-2],r=n[a-1];return r+(t-o)/(this.frames[e]-o)*(this.frames[e+i]-r)}}class Ct extends Mt{constructor(t,e,i){super(t,e,[i])}getFrameEntries(){return 2}setFrame(t,e,i){t<<=1,this.frames[t]=e,this.frames[t+1]=i}getCurveValue(t){let e=this.frames,i=e.length-2;for(let n=2;n<=i;n+=2)if(e[n]>t){i=n-2;break}let s=this.curves[i>>1];switch(s){case 0:let s=e[i],n=e[i+1];return n+(t-s)/(e[i+2]-s)*(e[i+2+1]-n);case 1:return e[i+1]}return this.getBezierValue(t,i,1,s-2)}getRelativeValue(t,e,i,s,n){if(t<this.frames[0]){switch(i){case St.setup:return n;case St.first:return s+(n-s)*e}return s}let a=this.getCurveValue(t);switch(i){case St.setup:return n+a*e;case St.first:case St.replace:a+=n-s}return s+a*e}getAbsoluteValue(t,e,i,s,n){if(t<this.frames[0]){switch(i){case St.setup:return n;case St.first:return s+(n-s)*e}return s}let a=this.getCurveValue(t);return i==St.setup?n+(a-n)*e:s+(a-s)*e}getAbsoluteValue2(t,e,i,s,n,a){if(t<this.frames[0]){switch(i){case St.setup:return n;case St.first:return s+(n-s)*e}return s}return i==St.setup?n+(a-n)*e:s+(a-s)*e}getScaleValue(t,e,i,s,n,a){if(t<this.frames[0]){switch(i){case St.setup:return a;case St.first:return n+(a-n)*e}return n}let o=this.getCurveValue(t)*a;if(1==e)return i==St.add?n+o-a:o;if(s==Ft.mixOut)switch(i){case St.setup:return a+(Math.abs(o)*ot.signum(a)-a)*e;case St.first:case St.replace:return n+(Math.abs(o)*ot.signum(n)-n)*e}else{let t=0;switch(i){case St.setup:return t=Math.abs(a)*ot.signum(o),t+(o-t)*e;case St.first:case St.replace:return t=Math.abs(n)*ot.signum(o),t+(o-t)*e}}return n+(o-a)*e}}class Bt extends Mt{constructor(t,e,i,s){super(t,e,[i,s])}getFrameEntries(){return 3}setFrame(t,e,i,s){t*=3,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=s}}class Pt extends Ct{constructor(t,e,i){super(t,e,Tt.rotate+"|"+i),s(this,"boneIndex",0),this.boneIndex=i}apply(t,e,i,s,n,a,o){let r=t.bones[this.boneIndex];r.active&&(r.rotation=this.getRelativeValue(i,n,a,r.rotation,r.data.rotation))}}class It extends Bt{constructor(t,e,i){super(t,e,Tt.x+"|"+i,Tt.y+"|"+i),s(this,"boneIndex",0),this.boneIndex=i}apply(t,e,i,s,n,a,o){let r=t.bones[this.boneIndex];if(!r.active)return;let l=this.frames;if(i<l[0]){switch(a){case St.setup:return r.x=r.data.x,void(r.y=r.data.y);case St.first:r.x+=(r.data.x-r.x)*n,r.y+=(r.data.y-r.y)*n}return}let h=0,c=0,d=At.search(l,i,3),u=this.curves[d/3];switch(u){case 0:let t=l[d];h=l[d+1],c=l[d+2];let e=(i-t)/(l[d+3]-t);h+=(l[d+3+1]-h)*e,c+=(l[d+3+2]-c)*e;break;case 1:h=l[d+1],c=l[d+2];break;default:h=this.getBezierValue(i,d,1,u-2),c=this.getBezierValue(i,d,2,u+18-2)}switch(a){case St.setup:r.x=r.data.x+h*n,r.y=r.data.y+c*n;break;case St.first:case St.replace:r.x+=(r.data.x+h-r.x)*n,r.y+=(r.data.y+c-r.y)*n;break;case St.add:r.x+=h*n,r.y+=c*n}}}class Et extends Ct{constructor(t,e,i){super(t,e,Tt.x+"|"+i),s(this,"boneIndex",0),this.boneIndex=i}apply(t,e,i,s,n,a,o){let r=t.bones[this.boneIndex];r.active&&(r.x=this.getRelativeValue(i,n,a,r.x,r.data.x))}}class Dt extends Ct{constructor(t,e,i){super(t,e,Tt.y+"|"+i),s(this,"boneIndex",0),this.boneIndex=i}apply(t,e,i,s,n,a,o){let r=t.bones[this.boneIndex];r.active&&(r.y=this.getRelativeValue(i,n,a,r.y,r.data.y))}}class Rt extends Bt{constructor(t,e,i){super(t,e,Tt.scaleX+"|"+i,Tt.scaleY+"|"+i),s(this,"boneIndex",0),this.boneIndex=i}apply(t,e,i,s,n,a,o){let r=t.bones[this.boneIndex];if(!r.active)return;let l,h,c=this.frames;if(i<c[0]){switch(a){case St.setup:return r.scaleX=r.data.scaleX,void(r.scaleY=r.data.scaleY);case St.first:r.scaleX+=(r.data.scaleX-r.scaleX)*n,r.scaleY+=(r.data.scaleY-r.scaleY)*n}return}let d=At.search(c,i,3),u=this.curves[d/3];switch(u){case 0:let t=c[d];l=c[d+1],h=c[d+2];let e=(i-t)/(c[d+3]-t);l+=(c[d+3+1]-l)*e,h+=(c[d+3+2]-h)*e;break;case 1:l=c[d+1],h=c[d+2];break;default:l=this.getBezierValue(i,d,1,u-2),h=this.getBezierValue(i,d,2,u+18-2)}if(l*=r.data.scaleX,h*=r.data.scaleY,1==n)a==St.add?(r.scaleX+=l-r.data.scaleX,r.scaleY+=h-r.data.scaleY):(r.scaleX=l,r.scaleY=h);else{let t=0,e=0;if(o==Ft.mixOut)switch(a){case St.setup:t=r.data.scaleX,e=r.data.scaleY,r.scaleX=t+(Math.abs(l)*ot.signum(t)-t)*n,r.scaleY=e+(Math.abs(h)*ot.signum(e)-e)*n;break;case St.first:case St.replace:t=r.scaleX,e=r.scaleY,r.scaleX=t+(Math.abs(l)*ot.signum(t)-t)*n,r.scaleY=e+(Math.abs(h)*ot.signum(e)-e)*n;break;case St.add:r.scaleX+=(l-r.data.scaleX)*n,r.scaleY+=(h-r.data.scaleY)*n}else switch(a){case St.setup:t=Math.abs(r.data.scaleX)*ot.signum(l),e=Math.abs(r.data.scaleY)*ot.signum(h),r.scaleX=t+(l-t)*n,r.scaleY=e+(h-e)*n;break;case St.first:case St.replace:t=Math.abs(r.scaleX)*ot.signum(l),e=Math.abs(r.scaleY)*ot.signum(h),r.scaleX=t+(l-t)*n,r.scaleY=e+(h-e)*n;break;case St.add:r.scaleX+=(l-r.data.scaleX)*n,r.scaleY+=(h-r.data.scaleY)*n}}}}class _t extends Ct{constructor(t,e,i){super(t,e,Tt.scaleX+"|"+i),s(this,"boneIndex",0),this.boneIndex=i}apply(t,e,i,s,n,a,o){let r=t.bones[this.boneIndex];r.active&&(r.scaleX=this.getScaleValue(i,n,a,o,r.scaleX,r.data.scaleX))}}class Wt extends Ct{constructor(t,e,i){super(t,e,Tt.scaleY+"|"+i),s(this,"boneIndex",0),this.boneIndex=i}apply(t,e,i,s,n,a,o){let r=t.bones[this.boneIndex];r.active&&(r.scaleY=this.getScaleValue(i,n,a,o,r.scaleY,r.data.scaleY))}}class Lt extends Bt{constructor(t,e,i){super(t,e,Tt.shearX+"|"+i,Tt.shearY+"|"+i),s(this,"boneIndex",0),this.boneIndex=i}apply(t,e,i,s,n,a,o){let r=t.bones[this.boneIndex];if(!r.active)return;let l=this.frames;if(i<l[0]){switch(a){case St.setup:return r.shearX=r.data.shearX,void(r.shearY=r.data.shearY);case St.first:r.shearX+=(r.data.shearX-r.shearX)*n,r.shearY+=(r.data.shearY-r.shearY)*n}return}let h=0,c=0,d=At.search(l,i,3),u=this.curves[d/3];switch(u){case 0:let t=l[d];h=l[d+1],c=l[d+2];let e=(i-t)/(l[d+3]-t);h+=(l[d+3+1]-h)*e,c+=(l[d+3+2]-c)*e;break;case 1:h=l[d+1],c=l[d+2];break;default:h=this.getBezierValue(i,d,1,u-2),c=this.getBezierValue(i,d,2,u+18-2)}switch(a){case St.setup:r.shearX=r.data.shearX+h*n,r.shearY=r.data.shearY+c*n;break;case St.first:case St.replace:r.shearX+=(r.data.shearX+h-r.shearX)*n,r.shearY+=(r.data.shearY+c-r.shearY)*n;break;case St.add:r.shearX+=h*n,r.shearY+=c*n}}}class Ot extends Ct{constructor(t,e,i){super(t,e,Tt.shearX+"|"+i),s(this,"boneIndex",0),this.boneIndex=i}apply(t,e,i,s,n,a,o){let r=t.bones[this.boneIndex];r.active&&(r.shearX=this.getRelativeValue(i,n,a,r.shearX,r.data.shearX))}}class kt extends Ct{constructor(t,e,i){super(t,e,Tt.shearY+"|"+i),s(this,"boneIndex",0),this.boneIndex=i}apply(t,e,i,s,n,a,o){let r=t.bones[this.boneIndex];r.active&&(r.shearY=this.getRelativeValue(i,n,a,r.shearY,r.data.shearY))}}class Nt extends At{constructor(t,e){super(t,[Tt.inherit+"|"+e]),s(this,"boneIndex",0),this.boneIndex=e}getFrameEntries(){return 2}setFrame(t,e,i){t*=2,this.frames[t]=e,this.frames[t+1]=i}apply(t,e,i,s,n,a,o){let r=t.bones[this.boneIndex];if(!r.active)return;if(o==Ft.mixOut)return void(a==St.setup&&(r.inherit=r.data.inherit));let l=this.frames;i<l[0]?a!=St.setup&&a!=St.first||(r.inherit=r.data.inherit):r.inherit=this.frames[At.search(l,i,2)+1]}}class Vt extends Mt{constructor(t,e,i){super(t,e,[Tt.rgb+"|"+i,Tt.alpha+"|"+i]),s(this,"slotIndex",0),this.slotIndex=i}getFrameEntries(){return 5}setFrame(t,e,i,s,n,a){t*=5,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=s,this.frames[t+3]=n,this.frames[t+4]=a}apply(t,e,i,s,n,a,o){let r=t.slots[this.slotIndex];if(!r.bone.active)return;let l=this.frames,h=r.color;if(i<l[0]){let t=r.data.color;switch(a){case St.setup:return void h.setFromColor(t);case St.first:h.add((t.r-h.r)*n,(t.g-h.g)*n,(t.b-h.b)*n,(t.a-h.a)*n)}return}let c=0,d=0,u=0,m=0,g=At.search(l,i,5),p=this.curves[g/5];switch(p){case 0:let t=l[g];c=l[g+1],d=l[g+2],u=l[g+3],m=l[g+4];let e=(i-t)/(l[g+5]-t);c+=(l[g+5+1]-c)*e,d+=(l[g+5+2]-d)*e,u+=(l[g+5+3]-u)*e,m+=(l[g+5+4]-m)*e;break;case 1:c=l[g+1],d=l[g+2],u=l[g+3],m=l[g+4];break;default:c=this.getBezierValue(i,g,1,p-2),d=this.getBezierValue(i,g,2,p+18-2),u=this.getBezierValue(i,g,3,p+36-2),m=this.getBezierValue(i,g,4,p+54-2)}1==n?h.set(c,d,u,m):(a==St.setup&&h.setFromColor(r.data.color),h.add((c-h.r)*n,(d-h.g)*n,(u-h.b)*n,(m-h.a)*n))}}class Yt extends Mt{constructor(t,e,i){super(t,e,[Tt.rgb+"|"+i]),s(this,"slotIndex",0),this.slotIndex=i}getFrameEntries(){return 4}setFrame(t,e,i,s,n){t<<=2,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=s,this.frames[t+3]=n}apply(t,e,i,s,n,a,o){let r=t.slots[this.slotIndex];if(!r.bone.active)return;let l=this.frames,h=r.color;if(i<l[0]){let t=r.data.color;switch(a){case St.setup:return h.r=t.r,h.g=t.g,void(h.b=t.b);case St.first:h.r+=(t.r-h.r)*n,h.g+=(t.g-h.g)*n,h.b+=(t.b-h.b)*n}return}let c=0,d=0,u=0,m=At.search(l,i,4),g=this.curves[m>>2];switch(g){case 0:let t=l[m];c=l[m+1],d=l[m+2],u=l[m+3];let e=(i-t)/(l[m+4]-t);c+=(l[m+4+1]-c)*e,d+=(l[m+4+2]-d)*e,u+=(l[m+4+3]-u)*e;break;case 1:c=l[m+1],d=l[m+2],u=l[m+3];break;default:c=this.getBezierValue(i,m,1,g-2),d=this.getBezierValue(i,m,2,g+18-2),u=this.getBezierValue(i,m,3,g+36-2)}if(1==n)h.r=c,h.g=d,h.b=u;else{if(a==St.setup){let t=r.data.color;h.r=t.r,h.g=t.g,h.b=t.b}h.r+=(c-h.r)*n,h.g+=(d-h.g)*n,h.b+=(u-h.b)*n}}}class Xt extends Ct{constructor(t,e,i){super(t,e,Tt.alpha+"|"+i),s(this,"slotIndex",0),this.slotIndex=i}apply(t,e,i,s,n,a,o){let r=t.slots[this.slotIndex];if(!r.bone.active)return;let l=r.color;if(i<this.frames[0]){let t=r.data.color;switch(a){case St.setup:return void(l.a=t.a);case St.first:l.a+=(t.a-l.a)*n}return}let h=this.getCurveValue(i);1==n?l.a=h:(a==St.setup&&(l.a=r.data.color.a),l.a+=(h-l.a)*n)}}class Gt extends Mt{constructor(t,e,i){super(t,e,[Tt.rgb+"|"+i,Tt.alpha+"|"+i,Tt.rgb2+"|"+i]),s(this,"slotIndex",0),this.slotIndex=i}getFrameEntries(){return 8}setFrame(t,e,i,s,n,a,o,r,l){t<<=3,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=s,this.frames[t+3]=n,this.frames[t+4]=a,this.frames[t+5]=o,this.frames[t+6]=r,this.frames[t+7]=l}apply(t,e,i,s,n,a,o){let r=t.slots[this.slotIndex];if(!r.bone.active)return;let l=this.frames,h=r.color,c=r.darkColor;if(i<l[0]){let t=r.data.color,e=r.data.darkColor;switch(a){case St.setup:return h.setFromColor(t),c.r=e.r,c.g=e.g,void(c.b=e.b);case St.first:h.add((t.r-h.r)*n,(t.g-h.g)*n,(t.b-h.b)*n,(t.a-h.a)*n),c.r+=(e.r-c.r)*n,c.g+=(e.g-c.g)*n,c.b+=(e.b-c.b)*n}return}let d=0,u=0,m=0,g=0,p=0,b=0,f=0,y=At.search(l,i,8),w=this.curves[y>>3];switch(w){case 0:let t=l[y];d=l[y+1],u=l[y+2],m=l[y+3],g=l[y+4],p=l[y+5],b=l[y+6],f=l[y+7];let e=(i-t)/(l[y+8]-t);d+=(l[y+8+1]-d)*e,u+=(l[y+8+2]-u)*e,m+=(l[y+8+3]-m)*e,g+=(l[y+8+4]-g)*e,p+=(l[y+8+5]-p)*e,b+=(l[y+8+6]-b)*e,f+=(l[y+8+7]-f)*e;break;case 1:d=l[y+1],u=l[y+2],m=l[y+3],g=l[y+4],p=l[y+5],b=l[y+6],f=l[y+7];break;default:d=this.getBezierValue(i,y,1,w-2),u=this.getBezierValue(i,y,2,w+18-2),m=this.getBezierValue(i,y,3,w+36-2),g=this.getBezierValue(i,y,4,w+54-2),p=this.getBezierValue(i,y,5,w+72-2),b=this.getBezierValue(i,y,6,w+90-2),f=this.getBezierValue(i,y,7,w+108-2)}if(1==n)h.set(d,u,m,g),c.r=p,c.g=b,c.b=f;else{if(a==St.setup){h.setFromColor(r.data.color);let t=r.data.darkColor;c.r=t.r,c.g=t.g,c.b=t.b}h.add((d-h.r)*n,(u-h.g)*n,(m-h.b)*n,(g-h.a)*n),c.r+=(p-c.r)*n,c.g+=(b-c.g)*n,c.b+=(f-c.b)*n}}}class Ht extends Mt{constructor(t,e,i){super(t,e,[Tt.rgb+"|"+i,Tt.rgb2+"|"+i]),s(this,"slotIndex",0),this.slotIndex=i}getFrameEntries(){return 7}setFrame(t,e,i,s,n,a,o,r){t*=7,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=s,this.frames[t+3]=n,this.frames[t+4]=a,this.frames[t+5]=o,this.frames[t+6]=r}apply(t,e,i,s,n,a,o){let r=t.slots[this.slotIndex];if(!r.bone.active)return;let l=this.frames,h=r.color,c=r.darkColor;if(i<l[0]){let t=r.data.color,e=r.data.darkColor;switch(a){case St.setup:return h.r=t.r,h.g=t.g,h.b=t.b,c.r=e.r,c.g=e.g,void(c.b=e.b);case St.first:h.r+=(t.r-h.r)*n,h.g+=(t.g-h.g)*n,h.b+=(t.b-h.b)*n,c.r+=(e.r-c.r)*n,c.g+=(e.g-c.g)*n,c.b+=(e.b-c.b)*n}return}let d=0,u=0,m=0,g=0,p=0,b=0,f=At.search(l,i,7),y=this.curves[f/7];switch(y){case 0:let t=l[f];d=l[f+1],u=l[f+2],m=l[f+3],g=l[f+4],p=l[f+5],b=l[f+6];let e=(i-t)/(l[f+7]-t);d+=(l[f+7+1]-d)*e,u+=(l[f+7+2]-u)*e,m+=(l[f+7+3]-m)*e,g+=(l[f+7+4]-g)*e,p+=(l[f+7+5]-p)*e,b+=(l[f+7+6]-b)*e;break;case 1:d=l[f+1],u=l[f+2],m=l[f+3],g=l[f+4],p=l[f+5],b=l[f+6];break;default:d=this.getBezierValue(i,f,1,y-2),u=this.getBezierValue(i,f,2,y+18-2),m=this.getBezierValue(i,f,3,y+36-2),g=this.getBezierValue(i,f,4,y+54-2),p=this.getBezierValue(i,f,5,y+72-2),b=this.getBezierValue(i,f,6,y+90-2)}if(1==n)h.r=d,h.g=u,h.b=m,c.r=g,c.g=p,c.b=b;else{if(a==St.setup){let t=r.data.color,e=r.data.darkColor;h.r=t.r,h.g=t.g,h.b=t.b,c.r=e.r,c.g=e.g,c.b=e.b}h.r+=(d-h.r)*n,h.g+=(u-h.g)*n,h.b+=(m-h.b)*n,c.r+=(g-c.r)*n,c.g+=(p-c.g)*n,c.b+=(b-c.b)*n}}}class Ut extends At{constructor(t,e){super(t,[Tt.attachment+"|"+e]),s(this,"slotIndex",0),s(this,"attachmentNames"),this.slotIndex=e,this.attachmentNames=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,i){this.frames[t]=e,this.attachmentNames[t]=i}apply(t,e,i,s,n,a,o){let r=t.slots[this.slotIndex];r.bone.active&&(o!=Ft.mixOut?i<this.frames[0]?a!=St.setup&&a!=St.first||this.setAttachment(t,r,r.data.attachmentName):this.setAttachment(t,r,this.attachmentNames[At.search1(this.frames,i)]):a==St.setup&&this.setAttachment(t,r,r.data.attachmentName))}setAttachment(t,e,i){e.setAttachment(i?t.getAttachment(this.slotIndex,i):null)}}class $t extends Mt{constructor(t,e,i,n){super(t,e,[Tt.deform+"|"+i+"|"+n.id]),s(this,"slotIndex",0),s(this,"attachment"),s(this,"vertices"),this.slotIndex=i,this.attachment=n,this.vertices=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,i){this.frames[t]=e,this.vertices[t]=i}setBezier(t,e,i,s,n,a,o,r,l,h,c){let d=this.curves,u=this.getFrameCount()+18*t;0==i&&(d[e]=2+u);let m=.03*(s-2*a+r),g=.03*l-.06*o,p=.006*(3*(a-r)-s+h),b=.018*(o-l+.33333333),f=2*m+p,y=2*g+b,w=.3*(a-s)+m+.16666667*p,S=.3*o+g+.16666667*b,x=s+w,F=S;for(let v=u+18;u<v;u+=2)d[u]=x,d[u+1]=F,w+=f,S+=y,f+=p,y+=b,x+=w,F+=S}getCurvePercent(t,e){let i=this.curves,s=i[e];switch(s){case 0:let i=this.frames[e];return(t-i)/(this.frames[e+this.getFrameEntries()]-i);case 1:return 0}if(s-=2,i[s]>t){let n=this.frames[e];return i[s+1]*(t-n)/(i[s]-n)}let n=s+18;for(s+=2;s<n;s+=2)if(i[s]>=t){let e=i[s-2],n=i[s-1];return n+(t-e)/(i[s]-e)*(i[s+1]-n)}let a=i[n-2],o=i[n-1];return o+(1-o)*(t-a)/(this.frames[e+this.getFrameEntries()]-a)}apply(t,e,i,s,n,a,o){let r=t.slots[this.slotIndex];if(!r.bone.active)return;let l=r.getAttachment();if(!l)return;if(!(l instanceof mt)||l.timelineAttachment!=this.attachment)return;let h=r.deform;0==h.length&&(a=St.setup);let c=this.vertices,d=c[0].length,u=this.frames;if(i<u[0]){switch(a){case St.setup:return void(h.length=0);case St.first:if(1==n)return void(h.length=0);h.length=d;let t=l;if(t.bones)for(n=1-n,m=0;m<d;m++)h[m]*=n;else{let e=t.vertices;for(var m=0;m<d;m++)h[m]+=(e[m]-h[m])*n}}return}if(h.length=d,i>=u[u.length-1]){let t=c[u.length-1];if(1==n)if(a==St.add){let e=l;if(e.bones)for(let i=0;i<d;i++)h[i]+=t[i];else{let i=e.vertices;for(let e=0;e<d;e++)h[e]+=t[e]-i[e]}}else lt.arrayCopy(t,0,h,0,d);else switch(a){case St.setup:{let e=l;if(e.bones)for(let i=0;i<d;i++)h[i]=t[i]*n;else{let i=e.vertices;for(let e=0;e<d;e++){let s=i[e];h[e]=s+(t[e]-s)*n}}break}case St.first:case St.replace:for(let i=0;i<d;i++)h[i]+=(t[i]-h[i])*n;break;case St.add:let e=l;if(e.bones)for(let i=0;i<d;i++)h[i]+=t[i]*n;else{let i=e.vertices;for(let e=0;e<d;e++)h[e]+=(t[e]-i[e])*n}}return}let g=At.search1(u,i),p=this.getCurvePercent(i,g),b=c[g],f=c[g+1];if(1==n)if(a==St.add){let t=l;if(t.bones)for(let e=0;e<d;e++){let t=b[e];h[e]+=t+(f[e]-t)*p}else{let e=t.vertices;for(let t=0;t<d;t++){let i=b[t];h[t]+=i+(f[t]-i)*p-e[t]}}}else for(let y=0;y<d;y++){let t=b[y];h[y]=t+(f[y]-t)*p}else switch(a){case St.setup:{let t=l;if(t.bones)for(let e=0;e<d;e++){let t=b[e];h[e]=(t+(f[e]-t)*p)*n}else{let e=t.vertices;for(let t=0;t<d;t++){let i=b[t],s=e[t];h[t]=s+(i+(f[t]-i)*p-s)*n}}break}case St.first:case St.replace:for(let e=0;e<d;e++){let t=b[e];h[e]+=(t+(f[e]-t)*p-h[e])*n}break;case St.add:let t=l;if(t.bones)for(let e=0;e<d;e++){let t=b[e];h[e]+=(t+(f[e]-t)*p)*n}else{let e=t.vertices;for(let t=0;t<d;t++){let i=b[t];h[t]+=(i+(f[t]-i)*p-e[t])*n}}}}}const zt=class t extends At{constructor(e){super(e,t.propertyIds),s(this,"events"),this.events=new Array(e)}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,i,s,n,a,o){if(!s)return;let r=this.frames,l=this.frames.length;if(e>i)this.apply(t,e,Number.MAX_VALUE,s,n,a,o),e=-1;else if(e>=r[l-1])return;if(i<r[0])return;let h=0;if(e<r[0])h=0;else{h=At.search1(r,e)+1;let t=r[h];for(;h>0&&r[h-1]==t;)h--}for(;h<l&&i>=r[h];h++)s.push(this.events[h])}};s(zt,"propertyIds",[""+Tt.event]);let qt=zt;const jt=class t extends At{constructor(e){super(e,t.propertyIds),s(this,"drawOrders"),this.drawOrders=new Array(e)}getFrameCount(){return this.frames.length}setFrame(t,e,i){this.frames[t]=e,this.drawOrders[t]=i}apply(t,e,i,s,n,a,o){if(o==Ft.mixOut)return void(a==St.setup&&lt.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length));if(i<this.frames[0])return void(a!=St.setup&&a!=St.first||lt.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length));let r=At.search1(this.frames,i),l=this.drawOrders[r];if(l){let e=t.drawOrder,i=t.slots;for(let t=0,s=l.length;t<s;t++)e[t]=i[l[t]]}else lt.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length)}};s(jt,"propertyIds",[""+Tt.drawOrder]);let Qt=jt;class Zt extends Mt{constructor(t,e,i){super(t,e,[Tt.ikConstraint+"|"+i]),s(this,"constraintIndex",0),this.constraintIndex=i}getFrameEntries(){return 6}setFrame(t,e,i,s,n,a,o){t*=6,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=s,this.frames[t+3]=n,this.frames[t+4]=a?1:0,this.frames[t+5]=o?1:0}apply(t,e,i,s,n,a,o){let r=t.ikConstraints[this.constraintIndex];if(!r.active)return;let l=this.frames;if(i<l[0]){switch(a){case St.setup:return r.mix=r.data.mix,r.softness=r.data.softness,r.bendDirection=r.data.bendDirection,r.compress=r.data.compress,void(r.stretch=r.data.stretch);case St.first:r.mix+=(r.data.mix-r.mix)*n,r.softness+=(r.data.softness-r.softness)*n,r.bendDirection=r.data.bendDirection,r.compress=r.data.compress,r.stretch=r.data.stretch}return}let h=0,c=0,d=At.search(l,i,6),u=this.curves[d/6];switch(u){case 0:let t=l[d];h=l[d+1],c=l[d+2];let e=(i-t)/(l[d+6]-t);h+=(l[d+6+1]-h)*e,c+=(l[d+6+2]-c)*e;break;case 1:h=l[d+1],c=l[d+2];break;default:h=this.getBezierValue(i,d,1,u-2),c=this.getBezierValue(i,d,2,u+18-2)}a==St.setup?(r.mix=r.data.mix+(h-r.data.mix)*n,r.softness=r.data.softness+(c-r.data.softness)*n,o==Ft.mixOut?(r.bendDirection=r.data.bendDirection,r.compress=r.data.compress,r.stretch=r.data.stretch):(r.bendDirection=l[d+3],r.compress=0!=l[d+4],r.stretch=0!=l[d+5])):(r.mix+=(h-r.mix)*n,r.softness+=(c-r.softness)*n,o==Ft.mixIn&&(r.bendDirection=l[d+3],r.compress=0!=l[d+4],r.stretch=0!=l[d+5]))}}class Kt extends Mt{constructor(t,e,i){super(t,e,[Tt.transformConstraint+"|"+i]),s(this,"constraintIndex",0),this.constraintIndex=i}getFrameEntries(){return 7}setFrame(t,e,i,s,n,a,o,r){let l=this.frames;l[t*=7]=e,l[t+1]=i,l[t+2]=s,l[t+3]=n,l[t+4]=a,l[t+5]=o,l[t+6]=r}apply(t,e,i,s,n,a,o){let r=t.transformConstraints[this.constraintIndex];if(!r.active)return;let l,h,c,d,u,m,g=this.frames;if(i<g[0]){let t=r.data;switch(a){case St.setup:return r.mixRotate=t.mixRotate,r.mixX=t.mixX,r.mixY=t.mixY,r.mixScaleX=t.mixScaleX,r.mixScaleY=t.mixScaleY,void(r.mixShearY=t.mixShearY);case St.first:r.mixRotate+=(t.mixRotate-r.mixRotate)*n,r.mixX+=(t.mixX-r.mixX)*n,r.mixY+=(t.mixY-r.mixY)*n,r.mixScaleX+=(t.mixScaleX-r.mixScaleX)*n,r.mixScaleY+=(t.mixScaleY-r.mixScaleY)*n,r.mixShearY+=(t.mixShearY-r.mixShearY)*n}return}let p=At.search(g,i,7),b=this.curves[p/7];switch(b){case 0:let t=g[p];l=g[p+1],h=g[p+2],c=g[p+3],d=g[p+4],u=g[p+5],m=g[p+6];let e=(i-t)/(g[p+7]-t);l+=(g[p+7+1]-l)*e,h+=(g[p+7+2]-h)*e,c+=(g[p+7+3]-c)*e,d+=(g[p+7+4]-d)*e,u+=(g[p+7+5]-u)*e,m+=(g[p+7+6]-m)*e;break;case 1:l=g[p+1],h=g[p+2],c=g[p+3],d=g[p+4],u=g[p+5],m=g[p+6];break;default:l=this.getBezierValue(i,p,1,b-2),h=this.getBezierValue(i,p,2,b+18-2),c=this.getBezierValue(i,p,3,b+36-2),d=this.getBezierValue(i,p,4,b+54-2),u=this.getBezierValue(i,p,5,b+72-2),m=this.getBezierValue(i,p,6,b+90-2)}if(a==St.setup){let t=r.data;r.mixRotate=t.mixRotate+(l-t.mixRotate)*n,r.mixX=t.mixX+(h-t.mixX)*n,r.mixY=t.mixY+(c-t.mixY)*n,r.mixScaleX=t.mixScaleX+(d-t.mixScaleX)*n,r.mixScaleY=t.mixScaleY+(u-t.mixScaleY)*n,r.mixShearY=t.mixShearY+(m-t.mixShearY)*n}else r.mixRotate+=(l-r.mixRotate)*n,r.mixX+=(h-r.mixX)*n,r.mixY+=(c-r.mixY)*n,r.mixScaleX+=(d-r.mixScaleX)*n,r.mixScaleY+=(u-r.mixScaleY)*n,r.mixShearY+=(m-r.mixShearY)*n}}class Jt extends Ct{constructor(t,e,i){super(t,e,Tt.pathConstraintPosition+"|"+i),s(this,"constraintIndex",0),this.constraintIndex=i}apply(t,e,i,s,n,a,o){let r=t.pathConstraints[this.constraintIndex];r.active&&(r.position=this.getAbsoluteValue(i,n,a,r.position,r.data.position))}}class te extends Ct{constructor(t,e,i){super(t,e,Tt.pathConstraintSpacing+"|"+i),s(this,"constraintIndex",0),this.constraintIndex=i}apply(t,e,i,s,n,a,o){let r=t.pathConstraints[this.constraintIndex];r.active&&(r.spacing=this.getAbsoluteValue(i,n,a,r.spacing,r.data.spacing))}}class ee extends Mt{constructor(t,e,i){super(t,e,[Tt.pathConstraintMix+"|"+i]),s(this,"constraintIndex",0),this.constraintIndex=i}getFrameEntries(){return 4}setFrame(t,e,i,s,n){let a=this.frames;a[t<<=2]=e,a[t+1]=i,a[t+2]=s,a[t+3]=n}apply(t,e,i,s,n,a,o){let r=t.pathConstraints[this.constraintIndex];if(!r.active)return;let l,h,c,d=this.frames;if(i<d[0]){switch(a){case St.setup:return r.mixRotate=r.data.mixRotate,r.mixX=r.data.mixX,void(r.mixY=r.data.mixY);case St.first:r.mixRotate+=(r.data.mixRotate-r.mixRotate)*n,r.mixX+=(r.data.mixX-r.mixX)*n,r.mixY+=(r.data.mixY-r.mixY)*n}return}let u=At.search(d,i,4),m=this.curves[u>>2];switch(m){case 0:let t=d[u];l=d[u+1],h=d[u+2],c=d[u+3];let e=(i-t)/(d[u+4]-t);l+=(d[u+4+1]-l)*e,h+=(d[u+4+2]-h)*e,c+=(d[u+4+3]-c)*e;break;case 1:l=d[u+1],h=d[u+2],c=d[u+3];break;default:l=this.getBezierValue(i,u,1,m-2),h=this.getBezierValue(i,u,2,m+18-2),c=this.getBezierValue(i,u,3,m+36-2)}if(a==St.setup){let t=r.data;r.mixRotate=t.mixRotate+(l-t.mixRotate)*n,r.mixX=t.mixX+(h-t.mixX)*n,r.mixY=t.mixY+(c-t.mixY)*n}else r.mixRotate+=(l-r.mixRotate)*n,r.mixX+=(h-r.mixX)*n,r.mixY+=(c-r.mixY)*n}}class ie extends Ct{constructor(t,e,i,n){super(t,e,n+"|"+i),s(this,"constraintIndex",0),this.constraintIndex=i}apply(t,e,i,s,n,a,o){let r;if(-1==this.constraintIndex){const e=i>=this.frames[0]?this.getCurveValue(i):0;for(const s of t.physicsConstraints)s.active&&this.global(s.data)&&this.set(s,this.getAbsoluteValue2(i,n,a,this.get(s),this.setup(s),e))}else r=t.physicsConstraints[this.constraintIndex],r.active&&this.set(r,this.getAbsoluteValue(i,n,a,this.get(r),this.setup(r)))}}class se extends ie{constructor(t,e,i){super(t,e,i,Tt.physicsConstraintInertia)}setup(t){return t.data.inertia}get(t){return t.inertia}set(t,e){t.inertia=e}global(t){return t.inertiaGlobal}}class ne extends ie{constructor(t,e,i){super(t,e,i,Tt.physicsConstraintStrength)}setup(t){return t.data.strength}get(t){return t.strength}set(t,e){t.strength=e}global(t){return t.strengthGlobal}}class ae extends ie{constructor(t,e,i){super(t,e,i,Tt.physicsConstraintDamping)}setup(t){return t.data.damping}get(t){return t.damping}set(t,e){t.damping=e}global(t){return t.dampingGlobal}}class oe extends ie{constructor(t,e,i){super(t,e,i,Tt.physicsConstraintMass)}setup(t){return 1/t.data.massInverse}get(t){return 1/t.massInverse}set(t,e){t.massInverse=1/e}global(t){return t.massGlobal}}class re extends ie{constructor(t,e,i){super(t,e,i,Tt.physicsConstraintWind)}setup(t){return t.data.wind}get(t){return t.wind}set(t,e){t.wind=e}global(t){return t.windGlobal}}class le extends ie{constructor(t,e,i){super(t,e,i,Tt.physicsConstraintGravity)}setup(t){return t.data.gravity}get(t){return t.gravity}set(t,e){t.gravity=e}global(t){return t.gravityGlobal}}class he extends ie{constructor(t,e,i){super(t,e,i,Tt.physicsConstraintMix)}setup(t){return t.data.mix}get(t){return t.mix}set(t,e){t.mix=e}global(t){return t.mixGlobal}}const ce=class t extends At{constructor(e,i){super(e,t.propertyIds),s(this,"constraintIndex"),this.constraintIndex=i}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e}apply(t,e,i,s,n,a,o){let r;if(-1!=this.constraintIndex&&(r=t.physicsConstraints[this.constraintIndex],!r.active))return;const l=this.frames;if(e>i)this.apply(t,e,Number.MAX_VALUE,[],n,a,o),e=-1;else if(e>=l[l.length-1])return;if(!(i<l[0])&&(e<l[0]||i>=l[At.search1(l,e)+1]))if(null!=r)r.reset();else for(const h of t.physicsConstraints)h.active&&h.reset()}};s(ce,"propertyIds",[Tt.physicsConstraintReset.toString()]);let de=ce;const ue=class t extends At{constructor(t,e,i){super(t,[Tt.sequence+"|"+e+"|"+i.sequence.id]),s(this,"slotIndex"),s(this,"attachment"),this.slotIndex=e,this.attachment=i}getFrameEntries(){return t.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(e,i,s,n,a){let o=this.frames;o[e*=t.ENTRIES]=i,o[e+t.MODE]=s|n<<4,o[e+t.DELAY]=a}apply(e,i,s,n,a,o,r){let l=e.slots[this.slotIndex];if(!l.bone.active)return;let h=l.attachment,c=this.attachment;if(!(h==c||h instanceof mt&&h.timelineAttachment==c))return;if(r==Ft.mixOut)return void(o==St.setup&&(l.sequenceIndex=-1));let d=this.frames;if(s<d[0])return void(o!=St.setup&&o!=St.first||(l.sequenceIndex=-1));let u=At.search(d,s,t.ENTRIES),m=d[u],g=d[u+t.MODE],p=d[u+t.DELAY];if(!this.attachment.sequence)return;let b=g>>4,f=this.attachment.sequence.regions.length,y=yt[15&g];if(y!=bt.hold)switch(b+=(s-m)/p+1e-5|0,y){case bt.once:b=Math.min(f-1,b);break;case bt.loop:b%=f;break;case bt.pingpong:{let t=(f<<1)-2;b=0==t?0:b%t,b>=f&&(b=t-b);break}case bt.onceReverse:b=Math.max(f-1-b,0);break;case bt.loopReverse:b=f-1-b%f;break;case bt.pingpongReverse:{let t=(f<<1)-2;b=0==t?0:(b+f-1)%t,b>=f&&(b=t-b)}}l.sequenceIndex=b}};s(ue,"ENTRIES",3),s(ue,"MODE",1),s(ue,"DELAY",2);let me=ue;const ge=class t{constructor(t){s(this,"data"),s(this,"tracks",new Array),s(this,"timeScale",1),s(this,"unkeyedState",0),s(this,"events",new Array),s(this,"listeners",new Array),s(this,"queue",new fe(this)),s(this,"propertyIDs",new it),s(this,"animationsChanged",!1),s(this,"trackEntryPool",new ht((()=>new be))),this.data=t}static emptyAnimation(){return t._emptyAnimation}update(t){t*=this.timeScale;let e=this.tracks;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(!s)continue;s.animationLast=s.nextAnimationLast,s.trackLast=s.nextTrackLast;let n=t*s.timeScale;if(s.delay>0){if(s.delay-=n,s.delay>0)continue;n=-s.delay,s.delay=0}let a=s.next;if(a){let e=s.trackLast-a.delay;if(e>=0){for(a.delay=0,a.trackTime+=0==s.timeScale?0:(e/s.timeScale+t)*a.timeScale,s.trackTime+=n,this.setCurrent(i,a,!0);a.mixingFrom;)a.mixTime+=t,a=a.mixingFrom;continue}}else if(s.trackLast>=s.trackEnd&&!s.mixingFrom){e[i]=null,this.queue.end(s),this.clearNext(s);continue}if(s.mixingFrom&&this.updateMixingFrom(s,t)){let t=s.mixingFrom;for(s.mixingFrom=null,t&&(t.mixingTo=null);t;)this.queue.end(t),t=t.mixingFrom}s.trackTime+=n}this.queue.drain()}updateMixingFrom(t,e){let i=t.mixingFrom;if(!i)return!0;let s=this.updateMixingFrom(i,e);return i.animationLast=i.nextAnimationLast,i.trackLast=i.nextTrackLast,-1!=t.nextTrackLast&&t.mixTime>=t.mixDuration?(0!=i.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=i.mixingFrom,null!=i.mixingFrom&&(i.mixingFrom.mixingTo=t),t.interruptAlpha=i.interruptAlpha,this.queue.end(i)),s):(i.trackTime+=e*i.timeScale,t.mixTime+=e,!1)}apply(t){if(!t)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let e=this.events,i=this.tracks,s=!1;for(let d=0,u=i.length;d<u;d++){let a=i[d];if(!a||a.delay>0)continue;s=!0;let o=0==d?St.first:a.mixBlend,r=a.alpha;a.mixingFrom?r*=this.applyMixingFrom(a,t,o):a.trackTime>=a.trackEnd&&!a.next&&(r=0);let l=r>=a.alphaAttachmentThreshold,h=a.animationLast,c=a.getAnimationTime(),u=c,m=e;a.reverse&&(u=a.animation.duration-u,m=null);let g=a.animation.timelines,p=g.length;if(0==d&&1==r||o==St.add){0==d&&(l=!0);for(let e=0;e<p;e++){var n=g[e];n instanceof Ut?this.applyAttachmentTimeline(n,t,u,o,l):n.apply(t,h,u,m,r,o,Ft.mixIn)}}else{let e=a.timelineMode,i=a.shortestRotation,s=!i&&a.timelinesRotation.length!=p<<1;s&&(a.timelinesRotation.length=p<<1);for(let n=0;n<p;n++){let c=g[n],d=e[n]==Se?o:St.setup;!i&&c instanceof Pt?this.applyRotateTimeline(c,t,u,r,d,a.timelinesRotation,n<<1,s):c instanceof Ut?this.applyAttachmentTimeline(c,t,u,o,l):c.apply(t,h,u,m,r,d,Ft.mixIn)}}this.queueEvents(a,c),e.length=0,a.nextAnimationLast=c,a.nextTrackLast=a.trackTime}for(var a=this.unkeyedState+Ae,o=t.slots,r=0,l=t.slots.length;r<l;r++){var h=o[r];if(h.attachmentState==a){var c=h.data.attachmentName;h.setAttachment(c?t.getAttachment(h.data.index,c):null)}}return this.unkeyedState+=2,this.queue.drain(),s}applyMixingFrom(t,e,i){let s=t.mixingFrom;s.mixingFrom&&this.applyMixingFrom(s,e,i);let n=0;0==t.mixDuration?(n=1,i==St.first&&(i=St.setup)):(n=t.mixTime/t.mixDuration,n>1&&(n=1),i!=St.first&&(i=s.mixBlend));let a=n<s.mixAttachmentThreshold,o=n<s.mixDrawOrderThreshold,r=s.animation.timelines,l=r.length,h=s.alpha*t.interruptAlpha,c=h*(1-n),d=s.animationLast,u=s.getAnimationTime(),m=u,g=null;if(s.reverse?m=s.animation.duration-m:n<s.eventThreshold&&(g=this.events),i==St.add)for(let p=0;p<l;p++)r[p].apply(e,d,m,g,c,i,Ft.mixOut);else{let t=s.timelineMode,n=s.timelineHoldMix,u=s.shortestRotation,p=!u&&s.timelinesRotation.length!=l<<1;p&&(s.timelinesRotation.length=l<<1),s.totalAlpha=0;for(let b=0;b<l;b++){let l,f=r[b],y=Ft.mixOut,w=0;switch(t[b]){case Se:if(!o&&f instanceof Qt)continue;l=i,w=c;break;case xe:l=St.setup,w=c;break;case Fe:l=i,w=h;break;case ve:l=St.setup,w=h;break;default:l=St.setup;let t=n[b];w=h*Math.max(0,1-t.mixTime/t.mixDuration)}s.totalAlpha+=w,!u&&f instanceof Pt?this.applyRotateTimeline(f,e,m,w,l,s.timelinesRotation,b<<1,p):f instanceof Ut?this.applyAttachmentTimeline(f,e,m,l,a&&w>=s.alphaAttachmentThreshold):(o&&f instanceof Qt&&l==St.setup&&(y=Ft.mixIn),f.apply(e,d,m,g,w,l,y))}}return t.mixDuration>0&&this.queueEvents(s,u),this.events.length=0,s.nextAnimationLast=u,s.nextTrackLast=s.trackTime,n}applyAttachmentTimeline(t,e,i,s,n){var a=e.slots[t.slotIndex];a.bone.active&&(i<t.frames[0]?s!=St.setup&&s!=St.first||this.setAttachment(e,a,a.data.attachmentName,n):this.setAttachment(e,a,t.attachmentNames[At.search1(t.frames,i)],n),a.attachmentState<=this.unkeyedState&&(a.attachmentState=this.unkeyedState+Ae))}setAttachment(t,e,i,s){e.setAttachment(i?t.getAttachment(e.data.index,i):null),s&&(e.attachmentState=this.unkeyedState+Me)}applyRotateTimeline(t,e,i,s,n,a,o,r){if(r&&(a[o]=0),1==s)return void t.apply(e,0,i,null,1,n,Ft.mixIn);let l=e.bones[t.boneIndex];if(!l.active)return;let h=0,c=0;if(i<t.frames[0])switch(n){case St.setup:l.rotation=l.data.rotation;default:return;case St.first:h=l.rotation,c=l.data.rotation}else h=n==St.setup?l.data.rotation:l.rotation,c=l.data.rotation+t.getCurveValue(i);let d=0,u=c-h;if(u-=360*Math.ceil(u/360-.5),0==u)d=a[o];else{let t=0,e=0;r?(t=0,e=u):(t=a[o],e=a[o+1]);let i=t-t%360;d=u+i;let s=u>=0,n=t>=0;Math.abs(e)<=90&&ot.signum(e)!=ot.signum(u)&&(Math.abs(t-i)>180?(d+=360*ot.signum(t),n=s):0!=i?d-=360*ot.signum(t):n=s),n!=s&&(d+=360*ot.signum(t)),a[o]=d}a[o+1]=u,l.rotation=h+d*s}queueEvents(t,e){let i=t.animationStart,s=t.animationEnd,n=s-i,a=t.trackLast%n,o=this.events,r=0,l=o.length;for(;r<l;r++){let e=o[r];if(e.time<a)break;e.time>s||this.queue.event(t,e)}let h=!1;if(t.loop)if(0==n)h=!0;else{const e=Math.floor(t.trackTime/n);h=e>0&&e>Math.floor(t.trackLast/n)}else h=e>=s&&t.animationLast<s;for(h&&this.queue.complete(t);r<l;r++){let e=o[r];e.time<i||this.queue.event(t,e)}}clearTracks(){let t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,i=this.tracks.length;e<i;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;let e=this.tracks[t];if(!e)return;this.queue.end(e),this.clearNext(e);let i=e;for(;;){let t=i.mixingFrom;if(!t)break;this.queue.end(t),i.mixingFrom=null,i.mixingTo=null,i=t}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,i){let s=this.expandToIndex(t);this.tracks[t]=e,e.previous=null,s&&(i&&this.queue.interrupt(s),e.mixingFrom=s,s.mixingTo=e,e.mixTime=0,s.mixingFrom&&s.mixDuration>0&&(e.interruptAlpha*=Math.min(1,s.mixTime/s.mixDuration)),s.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,i=!1){let s=this.data.skeletonData.findAnimation(e);if(!s)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,s,i)}setAnimationWith(t,e,i=!1){if(!e)throw new Error("animation cannot be null.");let s=!0,n=this.expandToIndex(t);n&&(-1==n.nextTrackLast?(this.tracks[t]=n.mixingFrom,this.queue.interrupt(n),this.queue.end(n),this.clearNext(n),n=n.mixingFrom,s=!1):this.clearNext(n));let a=this.trackEntry(t,e,i,n);return this.setCurrent(t,a,s),this.queue.drain(),a}addAnimation(t,e,i=!1,s=0){let n=this.data.skeletonData.findAnimation(e);if(!n)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,n,i,s)}addAnimationWith(t,e,i=!1,s=0){if(!e)throw new Error("animation cannot be null.");let n=this.expandToIndex(t);if(n)for(;n.next;)n=n.next;let a=this.trackEntry(t,e,i,n);return n?(n.next=a,a.previous=n,s<=0&&(s=Math.max(s+n.getTrackComplete()-a.mixDuration,0))):(this.setCurrent(t,a,!0),this.queue.drain(),s<0&&(s=0)),a.delay=s,a}setEmptyAnimation(e,i=0){let s=this.setAnimationWith(e,t.emptyAnimation(),!1);return s.mixDuration=i,s.trackEnd=i,s}addEmptyAnimation(e,i=0,s=0){let n=this.addAnimationWith(e,t.emptyAnimation(),!1,s);return s<=0&&(n.delay=Math.max(n.delay+n.mixDuration-i,0)),n.mixDuration=i,n.trackEnd=i,n}setEmptyAnimations(t=0){let e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let i=0,s=this.tracks.length;i<s;i++){let e=this.tracks[i];e&&this.setEmptyAnimation(e.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:(lt.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,i,s){let n=this.trackEntryPool.obtain();return n.reset(),n.trackIndex=t,n.animation=e,n.loop=i,n.holdPrevious=!1,n.reverse=!1,n.shortestRotation=!1,n.eventThreshold=0,n.alphaAttachmentThreshold=0,n.mixAttachmentThreshold=0,n.mixDrawOrderThreshold=0,n.animationStart=0,n.animationEnd=e.duration,n.animationLast=-1,n.nextAnimationLast=-1,n.delay=0,n.trackTime=0,n.trackLast=-1,n.nextTrackLast=-1,n.trackEnd=Number.MAX_VALUE,n.timeScale=1,n.alpha=1,n.mixTime=0,n.mixDuration=s?this.data.getMix(s.animation,e):0,n.interruptAlpha=1,n.totalAlpha=0,n.mixBlend=St.replace,n}clearNext(t){let e=t.next;for(;e;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();let t=this.tracks;for(let e=0,i=t.length;e<i;e++){let i=t[e];if(i){for(;i.mixingFrom;)i=i.mixingFrom;do{i.mixingTo&&i.mixBlend==St.add||this.computeHold(i),i=i.mixingTo}while(i)}}}computeHold(t){let e=t.mixingTo,i=t.animation.timelines,s=t.animation.timelines.length,n=t.timelineMode;n.length=s;let a=t.timelineHoldMix;a.length=0;let o=this.propertyIDs;if(e&&e.holdPrevious)for(let r=0;r<s;r++)n[r]=o.addAll(i[r].getPropertyIds())?ve:Fe;else t:for(let r=0;r<s;r++){let s=i[r],l=s.getPropertyIds();if(o.addAll(l))if(!e||s instanceof Ut||s instanceof Qt||s instanceof qt||!e.animation.hasTimeline(l))n[r]=xe;else{for(let i=e.mixingTo;i;i=i.mixingTo)if(!i.animation.hasTimeline(l)){if(t.mixDuration>0){n[r]=Te,a[r]=i;continue t}break}n[r]=ve}else n[r]=Se}}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(!t)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){let e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}};s(ge,"_emptyAnimation",new wt("<empty>",[],0));let pe=ge;class be{constructor(){s(this,"animation",null),s(this,"previous",null),s(this,"next",null),s(this,"mixingFrom",null),s(this,"mixingTo",null),s(this,"listener",null),s(this,"trackIndex",0),s(this,"loop",!1),s(this,"holdPrevious",!1),s(this,"reverse",!1),s(this,"shortestRotation",!1),s(this,"eventThreshold",0),s(this,"mixAttachmentThreshold",0),s(this,"alphaAttachmentThreshold",0),s(this,"mixDrawOrderThreshold",0),s(this,"animationStart",0),s(this,"animationEnd",0),s(this,"animationLast",0),s(this,"nextAnimationLast",0),s(this,"delay",0),s(this,"trackTime",0),s(this,"trackLast",0),s(this,"nextTrackLast",0),s(this,"trackEnd",0),s(this,"timeScale",0),s(this,"alpha",0),s(this,"mixTime",0),s(this,"_mixDuration",0),s(this,"interruptAlpha",0),s(this,"totalAlpha",0),s(this,"mixBlend",St.replace),s(this,"timelineMode",new Array),s(this,"timelineHoldMix",new Array),s(this,"timelinesRotation",new Array)}get mixDuration(){return this._mixDuration}set mixDuration(t){this._mixDuration=t}setMixDurationWithDelay(t,e){this._mixDuration=t,e<=0&&(e=null!=this.previous?Math.max(e+this.previous.getTrackComplete()-t,0):0),this.delay=e}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){let t=this.animationEnd-this.animationStart;if(0!=t){if(this.loop)return t*(1+(this.trackTime/t|0));if(this.trackTime<t)return t}return this.trackTime}wasApplied(){return-1!=this.nextTrackLast}isNextReady(){return null!=this.next&&this.nextTrackLast-this.next.delay>=0}}class fe{constructor(t){s(this,"objects",[]),s(this,"drainDisabled",!1),s(this,"animState"),this.animState=t}start(t){this.objects.push(ye.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(ye.interrupt),this.objects.push(t)}end(t){this.objects.push(ye.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(ye.dispose),this.objects.push(t)}complete(t){this.objects.push(ye.complete),this.objects.push(t)}event(t,e){this.objects.push(ye.event),this.objects.push(t),this.objects.push(e)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let t=this.objects,e=this.animState.listeners;for(let i=0;i<t.length;i+=2){let s=t[i],n=t[i+1];switch(s){case ye.start:n.listener&&n.listener.start&&n.listener.start(n);for(let t=0;t<e.length;t++){let i=e[t];i.start&&i.start(n)}break;case ye.interrupt:n.listener&&n.listener.interrupt&&n.listener.interrupt(n);for(let t=0;t<e.length;t++){let i=e[t];i.interrupt&&i.interrupt(n)}break;case ye.end:n.listener&&n.listener.end&&n.listener.end(n);for(let t=0;t<e.length;t++){let i=e[t];i.end&&i.end(n)}case ye.dispose:n.listener&&n.listener.dispose&&n.listener.dispose(n);for(let t=0;t<e.length;t++){let i=e[t];i.dispose&&i.dispose(n)}this.animState.trackEntryPool.free(n);break;case ye.complete:n.listener&&n.listener.complete&&n.listener.complete(n);for(let t=0;t<e.length;t++){let i=e[t];i.complete&&i.complete(n)}break;case ye.event:let s=t[2+i++];n.listener&&n.listener.event&&n.listener.event(n,s);for(let t=0;t<e.length;t++){let i=e[t];i.event&&i.event(n,s)}}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}var ye,we;(we=ye||(ye={}))[we.start=0]="start",we[we.interrupt=1]="interrupt",we[we.end=2]="end",we[we.dispose=3]="dispose",we[we.complete=4]="complete",we[we.event=5]="event";const Se=0,xe=1,Fe=2,ve=3,Te=4,Ae=1,Me=2;class Ce{constructor(t){if(s(this,"skeletonData"),s(this,"animationToMixTime",{}),s(this,"defaultMix",0),!t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,i){let s=this.skeletonData.findAnimation(t);if(!s)throw new Error("Animation not found: "+t);let n=this.skeletonData.findAnimation(e);if(!n)throw new Error("Animation not found: "+e);this.setMixWith(s,n,i)}setMixWith(t,e,i){if(!t)throw new Error("from cannot be null.");if(!e)throw new Error("to cannot be null.");let s=t.name+"."+e.name;this.animationToMixTime[s]=i}getMix(t,e){let i=t.name+"."+e.name,s=this.animationToMixTime[i];return void 0===s?this.defaultMix:s}}class Be extends mt{constructor(t){super(t),s(this,"color",new nt(1,1,1,1))}copy(){let t=new Be(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}}class Pe extends mt{constructor(t){super(t),s(this,"endSlot",null),s(this,"color",new nt(.2275,.2275,.8078,1))}copy(){let t=new Pe(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}}class Ie{constructor(t){s(this,"_image"),this._image=t}getImage(){return this._image}}var Ee,De,Re,_e;(De=Ee||(Ee={}))[De.Nearest=9728]="Nearest",De[De.Linear=9729]="Linear",De[De.MipMap=9987]="MipMap",De[De.MipMapNearestNearest=9984]="MipMapNearestNearest",De[De.MipMapLinearNearest=9985]="MipMapLinearNearest",De[De.MipMapNearestLinear=9986]="MipMapNearestLinear",De[De.MipMapLinearLinear=9987]="MipMapLinearLinear",(_e=Re||(Re={}))[_e.MirroredRepeat=33648]="MirroredRepeat",_e[_e.ClampToEdge=33071]="ClampToEdge",_e[_e.Repeat=10497]="Repeat";class We{constructor(){s(this,"texture"),s(this,"u",0),s(this,"v",0),s(this,"u2",0),s(this,"v2",0),s(this,"width",0),s(this,"height",0),s(this,"degrees",0),s(this,"offsetX",0),s(this,"offsetY",0),s(this,"originalWidth",0),s(this,"originalHeight",0)}}class Le{constructor(t){s(this,"pages",new Array),s(this,"regions",new Array);let e=new Oe(t),i=new Array(4),n={size:t=>{t.width=parseInt(i[1]),t.height=parseInt(i[2])},format:()=>{},filter:t=>{t.minFilter=lt.enumValue(Ee,i[1]),t.magFilter=lt.enumValue(Ee,i[2])},repeat:t=>{-1!=i[1].indexOf("x")&&(t.uWrap=Re.Repeat),-1!=i[1].indexOf("y")&&(t.vWrap=Re.Repeat)},pma:t=>{t.pma="true"==i[1]}};var a={xy:t=>{t.x=parseInt(i[1]),t.y=parseInt(i[2])},size:t=>{t.width=parseInt(i[1]),t.height=parseInt(i[2])},bounds:t=>{t.x=parseInt(i[1]),t.y=parseInt(i[2]),t.width=parseInt(i[3]),t.height=parseInt(i[4])},offset:t=>{t.offsetX=parseInt(i[1]),t.offsetY=parseInt(i[2])},orig:t=>{t.originalWidth=parseInt(i[1]),t.originalHeight=parseInt(i[2])},offsets:t=>{t.offsetX=parseInt(i[1]),t.offsetY=parseInt(i[2]),t.originalWidth=parseInt(i[3]),t.originalHeight=parseInt(i[4])},rotate:t=>{let e=i[1];"true"==e?t.degrees=90:"false"!=e&&(t.degrees=parseInt(e))},index:t=>{t.index=parseInt(i[1])}};let o=e.readLine();for(;o&&0==o.trim().length;)o=e.readLine();for(;o&&0!=o.trim().length&&0!=e.readEntry(i,o);)o=e.readLine();let r=null,l=null,h=null;for(;null!==o;)if(0==o.trim().length)r=null,o=e.readLine();else if(r){let t=new Ne(r,o);for(;;){let s=e.readEntry(i,o=e.readLine());if(0==s)break;let n=a[i[0]];if(n)n(t);else{l||(l=[]),h||(h=[]),l.push(i[0]);let t=[];for(let e=0;e<s;e++)t.push(parseInt(i[e+1]));h.push(t)}}0==t.originalWidth&&0==t.originalHeight&&(t.originalWidth=t.width,t.originalHeight=t.height),l&&l.length>0&&h&&h.length>0&&(t.names=l,t.values=h,l=null,h=null),t.u=t.x/r.width,t.v=t.y/r.height,90==t.degrees?(t.u2=(t.x+t.height)/r.width,t.v2=(t.y+t.width)/r.height):(t.u2=(t.x+t.width)/r.width,t.v2=(t.y+t.height)/r.height),this.regions.push(t)}else{for(r=new ke(o.trim());0!=e.readEntry(i,o=e.readLine());){let t=n[i[0]];t&&t(r)}this.pages.push(r)}}findRegion(t){for(let e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null}setTextures(t,e=""){for(let i of this.pages)i.setTexture(t.get(e+i.name))}dispose(){var t;for(let e=0;e<this.pages.length;e++)null==(t=this.pages[e].texture)||t.dispose()}}class Oe{constructor(t){s(this,"lines"),s(this,"index",0),this.lines=t.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(t,e){if(!e)return 0;if(0==(e=e.trim()).length)return 0;let i=e.indexOf(":");if(-1==i)return 0;t[0]=e.substr(0,i).trim();for(let s=1,n=i+1;;s++){let i=e.indexOf(",",n);if(-1==i)return t[s]=e.substr(n).trim(),s;if(t[s]=e.substr(n,i-n).trim(),n=i+1,4==s)return 4}}}class ke{constructor(t){s(this,"name"),s(this,"minFilter",Ee.Nearest),s(this,"magFilter",Ee.Nearest),s(this,"uWrap",Re.ClampToEdge),s(this,"vWrap",Re.ClampToEdge),s(this,"texture",null),s(this,"width",0),s(this,"height",0),s(this,"pma",!1),s(this,"regions",new Array),this.name=t}setTexture(t){this.texture=t,t.setFilters(this.minFilter,this.magFilter),t.setWraps(this.uWrap,this.vWrap);for(let e of this.regions)e.texture=t}}class Ne extends We{constructor(t,e){super(),s(this,"page"),s(this,"name"),s(this,"x",0),s(this,"y",0),s(this,"offsetX",0),s(this,"offsetY",0),s(this,"originalWidth",0),s(this,"originalHeight",0),s(this,"index",0),s(this,"degrees",0),s(this,"names",null),s(this,"values",null),this.page=t,this.name=e,t.regions.push(this)}}class Ve extends mt{constructor(t,e){super(t),s(this,"region",null),s(this,"path"),s(this,"regionUVs",[]),s(this,"uvs",[]),s(this,"triangles",[]),s(this,"color",new nt(1,1,1,1)),s(this,"width",0),s(this,"height",0),s(this,"hullLength",0),s(this,"edges",[]),s(this,"parentMesh",null),s(this,"sequence",null),s(this,"tempColor",new nt(0,0,0,0)),this.path=e}updateRegion(){if(!this.region)throw new Error("Region not set.");let t=this.regionUVs;this.uvs&&this.uvs.length==t.length||(this.uvs=lt.newFloatArray(t.length));let e=this.uvs,i=this.uvs.length,s=this.region.u,n=this.region.v,a=0,o=0;if(this.region instanceof Ne){let r=this.region,l=r.page,h=l.width,c=l.height;switch(r.degrees){case 90:s-=(r.originalHeight-r.offsetY-r.height)/h,n-=(r.originalWidth-r.offsetX-r.width)/c,a=r.originalHeight/h,o=r.originalWidth/c;for(let r=0;r<i;r+=2)e[r]=s+t[r+1]*a,e[r+1]=n+(1-t[r])*o;return;case 180:s-=(r.originalWidth-r.offsetX-r.width)/h,n-=r.offsetY/c,a=r.originalWidth/h,o=r.originalHeight/c;for(let r=0;r<i;r+=2)e[r]=s+(1-t[r])*a,e[r+1]=n+(1-t[r+1])*o;return;case 270:s-=r.offsetY/h,n-=r.offsetX/c,a=r.originalHeight/h,o=r.originalWidth/c;for(let r=0;r<i;r+=2)e[r]=s+(1-t[r+1])*a,e[r+1]=n+t[r]*o;return}s-=r.offsetX/h,n-=(r.originalHeight-r.offsetY-r.height)/c,a=r.originalWidth/h,o=r.originalHeight/c}else this.region?(a=this.region.u2-s,o=this.region.v2-n):(s=n=0,a=o=1);for(let r=0;r<i;r+=2)e[r]=s+t[r]*a,e[r+1]=n+t[r+1]*o}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();let t=new Ve(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Array(this.regionUVs.length),lt.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.uvs=new Array(this.uvs.length),lt.arrayCopy(this.uvs,0,t.uvs,0,this.uvs.length),t.triangles=new Array(this.triangles.length),lt.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,t.sequence=null!=this.sequence?this.sequence.copy():null,this.edges&&(t.edges=new Array(this.edges.length),lt.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}computeWorldVertices(t,e,i,s,n,a){null!=this.sequence&&this.sequence.apply(t,this),super.computeWorldVertices(t,e,i,s,n,a)}newLinkedMesh(){let t=new Ve(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),t.timelineAttachment=this.timelineAttachment,t.setParentMesh(this.parentMesh?this.parentMesh:this),null!=t.region&&t.updateRegion(),t}}class Ye extends mt{constructor(t){super(t),s(this,"lengths",[]),s(this,"closed",!1),s(this,"constantSpeed",!1),s(this,"color",new nt(1,1,1,1))}copy(){let t=new Ye(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),lt.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}}class Xe extends mt{constructor(t){super(t),s(this,"x",0),s(this,"y",0),s(this,"rotation",0),s(this,"color",new nt(.38,.94,0,1))}computeWorldPosition(t,e){return e.x=this.x*t.a+this.y*t.b+t.worldX,e.y=this.x*t.c+this.y*t.d+t.worldY,e}computeWorldRotation(t){const e=this.rotation*ot.degRad,i=Math.cos(e),s=Math.sin(e),n=i*t.a+s*t.b,a=i*t.c+s*t.d;return ot.atan2Deg(a,n)}copy(){let t=new Xe(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}}const Ge=class t extends dt{constructor(t,e){super(t),s(this,"x",0),s(this,"y",0),s(this,"scaleX",1),s(this,"scaleY",1),s(this,"rotation",0),s(this,"width",0),s(this,"height",0),s(this,"color",new nt(1,1,1,1)),s(this,"path"),s(this,"region",null),s(this,"sequence",null),s(this,"offset",lt.newFloatArray(8)),s(this,"uvs",lt.newFloatArray(8)),s(this,"tempColor",new nt(1,1,1,1)),this.path=e}updateRegion(){if(!this.region)throw new Error("Region not set.");let t=this.region,e=this.uvs;if(null==t)return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=1,e[5]=1,e[6]=1,void(e[7]=0);let i=this.width/this.region.originalWidth*this.scaleX,s=this.height/this.region.originalHeight*this.scaleY,n=-this.width/2*this.scaleX+this.region.offsetX*i,a=-this.height/2*this.scaleY+this.region.offsetY*s,o=n+this.region.width*i,r=a+this.region.height*s,l=this.rotation*ot.degRad,h=Math.cos(l),c=Math.sin(l),d=this.x,u=this.y,m=n*h+d,g=n*c,p=a*h+u,b=a*c,f=o*h+d,y=o*c,w=r*h+u,S=r*c,x=this.offset;x[0]=m-b,x[1]=p+g,x[2]=m-S,x[3]=w+g,x[4]=f-S,x[5]=w+y,x[6]=f-b,x[7]=p+y,90==t.degrees?(e[0]=t.u2,e[1]=t.v2,e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)}computeWorldVertices(t,e,i,s){null!=this.sequence&&this.sequence.apply(t,this);let n=t.bone,a=this.offset,o=n.worldX,r=n.worldY,l=n.a,h=n.b,c=n.c,d=n.d,u=0,m=0;u=a[0],m=a[1],e[i]=u*l+m*h+o,e[i+1]=u*c+m*d+r,i+=s,u=a[2],m=a[3],e[i]=u*l+m*h+o,e[i+1]=u*c+m*d+r,i+=s,u=a[4],m=a[5],e[i]=u*l+m*h+o,e[i+1]=u*c+m*d+r,i+=s,u=a[6],m=a[7],e[i]=u*l+m*h+o,e[i+1]=u*c+m*d+r}copy(){let e=new t(this.name,this.path);return e.region=this.region,e.x=this.x,e.y=this.y,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e.rotation=this.rotation,e.width=this.width,e.height=this.height,lt.arrayCopy(this.uvs,0,e.uvs,0,8),lt.arrayCopy(this.offset,0,e.offset,0,8),e.color.setFromColor(this.color),e.sequence=null!=this.sequence?this.sequence.copy():null,e}};s(Ge,"X1",0),s(Ge,"Y1",1),s(Ge,"C1R",2),s(Ge,"C1G",3),s(Ge,"C1B",4),s(Ge,"C1A",5),s(Ge,"U1",6),s(Ge,"V1",7),s(Ge,"X2",8),s(Ge,"Y2",9),s(Ge,"C2R",10),s(Ge,"C2G",11),s(Ge,"C2B",12),s(Ge,"C2A",13),s(Ge,"U2",14),s(Ge,"V2",15),s(Ge,"X3",16),s(Ge,"Y3",17),s(Ge,"C3R",18),s(Ge,"C3G",19),s(Ge,"C3B",20),s(Ge,"C3A",21),s(Ge,"U3",22),s(Ge,"V3",23),s(Ge,"X4",24),s(Ge,"Y4",25),s(Ge,"C4R",26),s(Ge,"C4G",27),s(Ge,"C4B",28),s(Ge,"C4A",29),s(Ge,"U4",30),s(Ge,"V4",31);let He=Ge;class Ue{constructor(t){s(this,"atlas"),this.atlas=t}loadSequence(t,e,i){let s=i.regions;for(let n=0,a=s.length;n<a;n++){let a=i.getPath(e,n),o=this.atlas.findRegion(a);if(null==o)throw new Error("Region not found in atlas: "+a+" (sequence: "+t+")");s[n]=o}}newRegionAttachment(t,e,i,s){let n=new He(e,i);if(null!=s)this.loadSequence(e,i,s);else{let t=this.atlas.findRegion(i);if(!t)throw new Error("Region not found in atlas: "+i+" (region attachment: "+e+")");n.region=t}return n}newMeshAttachment(t,e,i,s){let n=new Ve(e,i);if(null!=s)this.loadSequence(e,i,s);else{let t=this.atlas.findRegion(i);if(!t)throw new Error("Region not found in atlas: "+i+" (mesh attachment: "+e+")");n.region=t}return n}newBoundingBoxAttachment(t,e){return new Be(e)}newPathAttachment(t,e){return new Ye(e)}newPointAttachment(t,e){return new Xe(e)}newClippingAttachment(t,e){return new Pe(e)}}class $e{constructor(t,e,i){if(s(this,"index",0),s(this,"name"),s(this,"parent",null),s(this,"length",0),s(this,"x",0),s(this,"y",0),s(this,"rotation",0),s(this,"scaleX",1),s(this,"scaleY",1),s(this,"shearX",0),s(this,"shearY",0),s(this,"inherit",ze.Normal),s(this,"skinRequired",!1),s(this,"color",new nt),s(this,"icon"),s(this,"visible",!1),t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=i}}var ze,qe,je,Qe,Ze,Ke,Je,ti;(qe=ze||(ze={}))[qe.Normal=0]="Normal",qe[qe.OnlyTranslation=1]="OnlyTranslation",qe[qe.NoRotationOrReflection=2]="NoRotationOrReflection",qe[qe.NoScale=3]="NoScale",qe[qe.NoScaleOrReflection=4]="NoScaleOrReflection";class ei{constructor(t,e,i){if(s(this,"data"),s(this,"skeleton"),s(this,"parent",null),s(this,"children",new Array),s(this,"x",0),s(this,"y",0),s(this,"rotation",0),s(this,"scaleX",0),s(this,"scaleY",0),s(this,"shearX",0),s(this,"shearY",0),s(this,"ax",0),s(this,"ay",0),s(this,"arotation",0),s(this,"ascaleX",0),s(this,"ascaleY",0),s(this,"ashearX",0),s(this,"ashearY",0),s(this,"a",0),s(this,"b",0),s(this,"c",0),s(this,"d",0),s(this,"worldY",0),s(this,"worldX",0),s(this,"inherit",ze.Normal),s(this,"sorted",!1),s(this,"active",!1),!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=i,this.setToSetupPose()}isActive(){return this.active}update(t){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,i,s,n,a,o){this.ax=t,this.ay=e,this.arotation=i,this.ascaleX=s,this.ascaleY=n,this.ashearX=a,this.ashearY=o;let r=this.parent;if(!r){let r=this.skeleton;const l=r.scaleX,h=r.scaleY,c=(i+a)*ot.degRad,d=(i+90+o)*ot.degRad;return this.a=Math.cos(c)*s*l,this.b=Math.cos(d)*n*l,this.c=Math.sin(c)*s*h,this.d=Math.sin(d)*n*h,this.worldX=t*l+r.x,void(this.worldY=e*h+r.y)}let l=r.a,h=r.b,c=r.c,d=r.d;switch(this.worldX=l*t+h*e+r.worldX,this.worldY=c*t+d*e+r.worldY,this.inherit){case ze.Normal:{const t=(i+a)*ot.degRad,e=(i+90+o)*ot.degRad,r=Math.cos(t)*s,u=Math.cos(e)*n,m=Math.sin(t)*s,g=Math.sin(e)*n;return this.a=l*r+h*m,this.b=l*u+h*g,this.c=c*r+d*m,void(this.d=c*u+d*g)}case ze.OnlyTranslation:{const t=(i+a)*ot.degRad,e=(i+90+o)*ot.degRad;this.a=Math.cos(t)*s,this.b=Math.cos(e)*n,this.c=Math.sin(t)*s,this.d=Math.sin(e)*n;break}case ze.NoRotationOrReflection:{let t=1/this.skeleton.scaleX,e=1/this.skeleton.scaleY;l*=t,c*=e;let r=l*l+c*c,u=0;r>1e-4?(r=Math.abs(l*d*e-h*t*c)/r,h=c*r,d=l*r,u=Math.atan2(c,l)*ot.radDeg):(l=0,c=0,u=90-Math.atan2(d,h)*ot.radDeg);const m=(i+a-u)*ot.degRad,g=(i+o-u+90)*ot.degRad,p=Math.cos(m)*s,b=Math.cos(g)*n,f=Math.sin(m)*s,y=Math.sin(g)*n;this.a=l*p-h*f,this.b=l*b-h*y,this.c=c*p+d*f,this.d=c*b+d*y;break}case ze.NoScale:case ze.NoScaleOrReflection:{i*=ot.degRad;const t=Math.cos(i),e=Math.sin(i);let r=(l*t+h*e)/this.skeleton.scaleX,u=(c*t+d*e)/this.skeleton.scaleY,m=Math.sqrt(r*r+u*u);m>1e-5&&(m=1/m),r*=m,u*=m,m=Math.sqrt(r*r+u*u),this.inherit==ze.NoScale&&l*d-h*c<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(m=-m),i=Math.PI/2+Math.atan2(u,r);const g=Math.cos(i)*m,p=Math.sin(i)*m;a*=ot.degRad,o=(90+o)*ot.degRad;const b=Math.cos(a)*s,f=Math.cos(o)*n,y=Math.sin(a)*s,w=Math.sin(o)*n;this.a=r*b+g*y,this.b=r*f+g*w,this.c=u*b+p*y,this.d=u*f+p*w;break}}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY}setToSetupPose(){let t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY,this.inherit=t.inherit}updateAppliedTransform(){let t=this.parent;if(!t)return this.ax=this.worldX-this.skeleton.x,this.ay=this.worldY-this.skeleton.y,this.arotation=Math.atan2(this.c,this.a)*ot.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*ot.radDeg);let e,i,s,n,a=t.a,o=t.b,r=t.c,l=t.d,h=1/(a*l-o*r),c=l*h,d=o*h,u=r*h,m=a*h,g=this.worldX-t.worldX,p=this.worldY-t.worldY;if(this.ax=g*c-p*d,this.ay=p*m-g*u,this.inherit==ze.OnlyTranslation)e=this.a,i=this.b,s=this.c,n=this.d;else{switch(this.inherit){case ze.NoRotationOrReflection:{let t=Math.abs(a*l-o*r)/(a*a+r*r);o=-r*this.skeleton.scaleX*t/this.skeleton.scaleY,l=a*this.skeleton.scaleY*t/this.skeleton.scaleX,h=1/(a*l-o*r),c=l*h,d=o*h;break}case ze.NoScale:case ze.NoScaleOrReflection:let t=ot.cosDeg(this.rotation),e=ot.sinDeg(this.rotation);a=(a*t+o*e)/this.skeleton.scaleX,r=(r*t+l*e)/this.skeleton.scaleY;let i=Math.sqrt(a*a+r*r);i>1e-5&&(i=1/i),a*=i,r*=i,i=Math.sqrt(a*a+r*r),this.inherit==ze.NoScale&&h<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(i=-i);let s=ot.PI/2+Math.atan2(r,a);o=Math.cos(s)*i,l=Math.sin(s)*i,h=1/(a*l-o*r),c=l*h,d=o*h,u=r*h,m=a*h}e=c*this.a-d*this.c,i=c*this.b-d*this.d,s=m*this.c-u*this.a,n=m*this.d-u*this.b}if(this.ashearX=0,this.ascaleX=Math.sqrt(e*e+s*s),this.ascaleX>1e-4){let t=e*n-i*s;this.ascaleY=t/this.ascaleX,this.ashearY=-Math.atan2(e*i+s*n,t)*ot.radDeg,this.arotation=Math.atan2(s,e)*ot.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(i*i+n*n),this.ashearY=0,this.arotation=90-Math.atan2(n,i)*ot.radDeg}getWorldRotationX(){return Math.atan2(this.c,this.a)*ot.radDeg}getWorldRotationY(){return Math.atan2(this.d,this.b)*ot.radDeg}getWorldScaleX(){return Math.sqrt(this.a*this.a+this.c*this.c)}getWorldScaleY(){return Math.sqrt(this.b*this.b+this.d*this.d)}worldToLocal(t){let e=1/(this.a*this.d-this.b*this.c),i=t.x-this.worldX,s=t.y-this.worldY;return t.x=i*this.d*e-s*this.b*e,t.y=s*this.a*e-i*this.c*e,t}localToWorld(t){let e=t.x,i=t.y;return t.x=e*this.a+i*this.b+this.worldX,t.y=e*this.c+i*this.d+this.worldY,t}worldToParent(t){if(null==t)throw new Error("world cannot be null.");return null==this.parent?t:this.parent.worldToLocal(t)}parentToWorld(t){if(null==t)throw new Error("world cannot be null.");return null==this.parent?t:this.parent.localToWorld(t)}worldToLocalRotation(t){let e=ot.sinDeg(t),i=ot.cosDeg(t);return Math.atan2(this.a*e-this.c*i,this.d*i-this.b*e)*ot.radDeg+this.rotation-this.shearX}localToWorldRotation(t){t-=this.rotation-this.shearX;let e=ot.sinDeg(t),i=ot.cosDeg(t);return Math.atan2(i*this.c+e*this.d,i*this.a+e*this.b)*ot.radDeg}rotateWorld(t){t*=ot.degRad;const e=Math.sin(t),i=Math.cos(t),s=this.a,n=this.b;this.a=i*s-e*this.c,this.b=i*n-e*this.d,this.c=e*s+i*this.c,this.d=e*n+i*this.d}}class ii{constructor(t,e,i){s(this,"name"),s(this,"order"),s(this,"skinRequired"),this.name=t,this.order=e,this.skinRequired=i}}class si{constructor(t,e){if(s(this,"data"),s(this,"intValue",0),s(this,"floatValue",0),s(this,"stringValue",null),s(this,"time",0),s(this,"volume",0),s(this,"balance",0),!e)throw new Error("data cannot be null.");this.time=t,this.data=e}}class ni{constructor(t){s(this,"name"),s(this,"intValue",0),s(this,"floatValue",0),s(this,"stringValue",null),s(this,"audioPath",null),s(this,"volume",0),s(this,"balance",0),this.name=t}}class ai{constructor(t,e){if(s(this,"data"),s(this,"bones"),s(this,"target"),s(this,"bendDirection",0),s(this,"compress",!1),s(this,"stretch",!1),s(this,"mix",1),s(this,"softness",0),s(this,"active",!1),!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let s=0;s<t.bones.length;s++){let i=e.findBone(t.bones[s].name);if(!i)throw new Error(`Couldn't find bone ${t.bones[s].name}`);this.bones.push(i)}let i=e.findBone(t.target.name);if(!i)throw new Error(`Couldn't find bone ${t.target.name}`);this.target=i,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch}isActive(){return this.active}setToSetupPose(){const t=this.data;this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch}update(t){if(0==this.mix)return;let e=this.target,i=this.bones;switch(i.length){case 1:this.apply1(i[0],e.worldX,e.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(i[0],i[1],e.worldX,e.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix)}}apply1(t,e,i,s,n,a,o){let r=t.parent;if(!r)throw new Error("IK bone must have parent.");let l=r.a,h=r.b,c=r.c,d=r.d,u=-t.ashearX-t.arotation,m=0,g=0;switch(t.inherit){case ze.OnlyTranslation:m=(e-t.worldX)*ot.signum(t.skeleton.scaleX),g=(i-t.worldY)*ot.signum(t.skeleton.scaleY);break;case ze.NoRotationOrReflection:let s=Math.abs(l*d-h*c)/Math.max(1e-4,l*l+c*c),n=l/t.skeleton.scaleX,a=c/t.skeleton.scaleY;h=-a*s*t.skeleton.scaleX,d=n*s*t.skeleton.scaleY,u+=Math.atan2(a,n)*ot.radDeg;default:let o=e-r.worldX,p=i-r.worldY,b=l*d-h*c;Math.abs(b)<=1e-4?(m=0,g=0):(m=(o*d-p*h)/b-t.ax,g=(p*l-o*c)/b-t.ay)}u+=Math.atan2(g,m)*ot.radDeg,t.ascaleX<0&&(u+=180),u>180?u-=360:u<-180&&(u+=360);let p=t.ascaleX,b=t.ascaleY;if(s||n){switch(t.inherit){case ze.NoScale:case ze.NoScaleOrReflection:m=e-t.worldX,g=i-t.worldY}const r=t.data.length*p;if(r>1e-4){const t=m*m+g*g;if(s&&t<r*r||n&&t>r*r){const e=(Math.sqrt(t)/r-1)*o+1;p*=e,a&&(b*=e)}}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+u*o,p,b,t.ashearX,t.ashearY)}apply2(t,e,i,s,n,a,o,r,l){if(t.inherit!=ze.Normal||e.inherit!=ze.Normal)return;let h=t.ax,c=t.ay,d=t.ascaleX,u=t.ascaleY,m=d,g=u,p=e.ascaleX,b=0,f=0,y=0;d<0?(d=-d,b=180,y=-1):(b=0,y=1),u<0&&(u=-u,y=-y),p<0?(p=-p,f=180):f=0;let w=e.ax,S=0,x=0,F=0,v=t.a,T=t.b,A=t.c,M=t.d,C=Math.abs(d-u)<=1e-4;!C||a?(S=0,x=v*w+t.worldX,F=A*w+t.worldY):(S=e.ay,x=v*w+T*S+t.worldX,F=A*w+M*S+t.worldY);let B=t.parent;if(!B)throw new Error("IK parent must itself have a parent.");v=B.a,T=B.b,A=B.c,M=B.d;let P=v*M-T*A,I=x-B.worldX,E=F-B.worldY;P=Math.abs(P)<=1e-4?0:1/P;let D,R,_=(I*M-E*T)*P-h,W=(E*v-I*A)*P-c,L=Math.sqrt(_*_+W*W),O=e.data.length*p;if(L<1e-4)return this.apply1(t,i,s,!1,a,!1,l),void e.updateWorldTransformWith(w,S,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);I=i-B.worldX,E=s-B.worldY;let k=(I*M-E*T)*P-h,N=(E*v-I*A)*P-c,V=k*k+N*N;if(0!=r){r*=d*(p+1)*.5;let t=Math.sqrt(V),e=t-L-O*d+r;if(e>0){let i=Math.min(1,e/(2*r))-1;i=(e-r*(1-i*i))/t,k-=i*k,N-=i*N,V=k*k+N*N}}t:if(C){O*=d;let t=(V-L*L-O*O)/(2*L*O);t<-1?(t=-1,R=Math.PI*n):t>1?(t=1,R=0,a&&(v=(Math.sqrt(V)/(L+O)-1)*l+1,m*=v,o&&(g*=v))):R=Math.acos(t)*n,v=L+O*t,T=O*Math.sin(R),D=Math.atan2(N*v-k*T,k*v+N*T)}else{v=d*O,T=u*O;let t=v*v,e=T*T,i=Math.atan2(N,k);A=e*L*L+t*V-t*e;let s=-2*e*L,a=e-t;if(M=s*s-4*a*A,M>=0){let t=Math.sqrt(M);s<0&&(t=-t),t=.5*-(s+t);let e=t/a,o=A/t,r=Math.abs(e)<Math.abs(o)?e:o;if(e=V-r*r,e>=0){E=Math.sqrt(e)*n,D=i-Math.atan2(E,r),R=Math.atan2(E/u,(r-L)/d);break t}}let o=ot.PI,r=L-v,l=r*r,h=0,c=0,m=L+v,g=m*m,p=0;A=-v*L/(t-e),A>=-1&&A<=1&&(A=Math.acos(A),I=v*Math.cos(A)+L,E=T*Math.sin(A),M=I*I+E*E,M<l&&(o=A,l=M,r=I,h=E),M>g&&(c=A,g=M,m=I,p=E)),V<=.5*(l+g)?(D=i-Math.atan2(h*n,r),R=o*n):(D=i-Math.atan2(p*n,m),R=c*n)}let Y=Math.atan2(S,w)*y,X=t.arotation;D=(D-Y)*ot.radDeg+b-X,D>180?D-=360:D<-180&&(D+=360),t.updateWorldTransformWith(h,c,X+D*l,m,g,0,0),X=e.arotation,R=((R+Y)*ot.radDeg-e.ashearX)*y+f-X,R>180?R-=360:R<-180&&(R+=360),e.updateWorldTransformWith(w,S,X+R*l,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}}class oi extends ii{constructor(t){super(t,0,!1),s(this,"bones",new Array),s(this,"_target",null),s(this,"bendDirection",0),s(this,"compress",!1),s(this,"stretch",!1),s(this,"uniform",!1),s(this,"mix",0),s(this,"softness",0)}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class ri extends ii{constructor(t){super(t,0,!1),s(this,"bones",new Array),s(this,"_target",null),s(this,"positionMode",je.Fixed),s(this,"spacingMode",Ze.Fixed),s(this,"rotateMode",Je.Chain),s(this,"offsetRotation",0),s(this,"position",0),s(this,"spacing",0),s(this,"mixRotate",0),s(this,"mixX",0),s(this,"mixY",0)}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("SlotData not set.")}}(Qe=je||(je={}))[Qe.Fixed=0]="Fixed",Qe[Qe.Percent=1]="Percent",(Ke=Ze||(Ze={}))[Ke.Length=0]="Length",Ke[Ke.Fixed=1]="Fixed",Ke[Ke.Percent=2]="Percent",Ke[Ke.Proportional=3]="Proportional",(ti=Je||(Je={}))[ti.Tangent=0]="Tangent",ti[ti.Chain=1]="Chain",ti[ti.ChainScale=2]="ChainScale";const li=class t{constructor(t,e){if(s(this,"data"),s(this,"bones"),s(this,"target"),s(this,"position",0),s(this,"spacing",0),s(this,"mixRotate",0),s(this,"mixX",0),s(this,"mixY",0),s(this,"spaces",new Array),s(this,"positions",new Array),s(this,"world",new Array),s(this,"curves",new Array),s(this,"lengths",new Array),s(this,"segments",new Array),s(this,"active",!1),!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let s=0,n=t.bones.length;s<n;s++){let i=e.findBone(t.bones[s].name);if(!i)throw new Error(`Couldn't find bone ${t.bones[s].name}.`);this.bones.push(i)}let i=e.findSlot(t.target.name);if(!i)throw new Error(`Couldn't find target bone ${t.target.name}`);this.target=i,this.position=t.position,this.spacing=t.spacing,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY}isActive(){return this.active}setToSetupPose(){const t=this.data;this.position=t.position,this.spacing=t.spacing,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY}update(e){let i=this.target.getAttachment();if(!(i instanceof Ye))return;let s=this.mixRotate,n=this.mixX,a=this.mixY;if(0==s&&0==n&&0==a)return;let o=this.data,r=o.rotateMode==Je.Tangent,l=o.rotateMode==Je.ChainScale,h=this.bones,c=h.length,d=r?c:c+1,u=lt.setArraySize(this.spaces,d),m=l?this.lengths=lt.setArraySize(this.lengths,c):[],g=this.spacing;switch(o.spacingMode){case Ze.Percent:if(l)for(let t=0,s=d-1;t<s;t++){let e=h[t],i=e.data.length,s=i*e.a,n=i*e.c;m[t]=Math.sqrt(s*s+n*n)}lt.arrayFill(u,1,d,g);break;case Ze.Proportional:let e=0;for(let s=0,n=d-1;s<n;){let i=h[s],n=i.data.length;if(n<t.epsilon)l&&(m[s]=0),u[++s]=g;else{let t=n*i.a,a=n*i.c,o=Math.sqrt(t*t+a*a);l&&(m[s]=o),u[++s]=o,e+=o}}if(e>0){e=d/e*g;for(let t=1;t<d;t++)u[t]*=e}break;default:let i=o.spacingMode==Ze.Length;for(let s=0,n=d-1;s<n;){let e=h[s],n=e.data.length;if(n<t.epsilon)l&&(m[s]=0),u[++s]=g;else{let t=n*e.a,a=n*e.c,o=Math.sqrt(t*t+a*a);l&&(m[s]=o),u[++s]=(i?n+g:g)*o/n}}}let p=this.computeWorldPositions(i,d,r),b=p[0],f=p[1],y=o.offsetRotation,w=!1;if(0==y)w=o.rotateMode==Je.Chain;else{w=!1;let t=this.target.bone;y*=t.a*t.d-t.b*t.c>0?ot.degRad:-.01745329277777778}for(let t=0,S=3;t<c;t++,S+=3){let e=h[t];e.worldX+=(b-e.worldX)*n,e.worldY+=(f-e.worldY)*a;let i=p[S],o=p[S+1],c=i-b,d=o-f;if(l){let i=m[t];if(0!=i){let t=(Math.sqrt(c*c+d*d)/i-1)*s+1;e.a*=t,e.c*=t}}if(b=i,f=o,s>0){let i=e.a,n=e.b,a=e.c,o=e.d,l=0,h=0,m=0;if(l=r?p[S-1]:0==u[t+1]?p[S+2]:Math.atan2(d,c),l-=Math.atan2(a,i),w){h=Math.cos(l),m=Math.sin(l);let t=e.data.length;b+=(t*(h*i-m*a)-c)*s,f+=(t*(m*i+h*a)-d)*s}else l+=y;l>ot.PI?l-=ot.PI2:l<-3.1415927&&(l+=ot.PI2),l*=s,h=Math.cos(l),m=Math.sin(l),e.a=h*i-m*a,e.b=h*n-m*o,e.c=m*i+h*a,e.d=m*n+h*o}e.updateAppliedTransform()}}computeWorldPositions(e,i,s){let n=this.target,a=this.position,o=this.spaces,r=lt.setArraySize(this.positions,3*i+2),l=this.world,h=e.closed,c=e.worldVerticesLength,d=c/6,u=t.NONE;if(!e.constantSpeed){let m=e.lengths;d-=h?1:2;let g,p=m[d];switch(this.data.positionMode==je.Percent&&(a*=p),this.data.spacingMode){case Ze.Percent:g=p;break;case Ze.Proportional:g=p/i;break;default:g=1}l=lt.setArraySize(this.world,8);for(let b=0,f=0,y=0;b<i;b++,f+=3){let i=o[b]*g;a+=i;let w=a;if(h)w%=p,w<0&&(w+=p),y=0;else{if(w<0){u!=t.BEFORE&&(u=t.BEFORE,e.computeWorldVertices(n,2,4,l,0,2)),this.addBeforePosition(w,l,0,r,f);continue}if(w>p){u!=t.AFTER&&(u=t.AFTER,e.computeWorldVertices(n,c-6,4,l,0,2)),this.addAfterPosition(w-p,l,0,r,f);continue}}for(;;y++){let t=m[y];if(!(w>t)){if(0==y)w/=t;else{let e=m[y-1];w=(w-e)/(t-e)}break}}y!=u&&(u=y,h&&y==d?(e.computeWorldVertices(n,c-4,4,l,0,2),e.computeWorldVertices(n,0,4,l,4,2)):e.computeWorldVertices(n,6*y+2,8,l,0,2)),this.addCurvePosition(w,l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],r,f,s||b>0&&0==i)}return r}h?(c+=2,l=lt.setArraySize(this.world,c),e.computeWorldVertices(n,2,c-4,l,0,2),e.computeWorldVertices(n,0,2,l,c-4,2),l[c-2]=l[0],l[c-1]=l[1]):(d--,c-=4,l=lt.setArraySize(this.world,c),e.computeWorldVertices(n,2,c,l,0,2));let m,g=lt.setArraySize(this.curves,d),p=0,b=l[0],f=l[1],y=0,w=0,S=0,x=0,F=0,v=0,T=0,A=0,M=0,C=0,B=0,P=0,I=0,E=0;for(let t=0,_=2;t<d;t++,_+=6)y=l[_],w=l[_+1],S=l[_+2],x=l[_+3],F=l[_+4],v=l[_+5],T=.1875*(b-2*y+S),A=.1875*(f-2*w+x),M=.09375*(3*(y-S)-b+F),C=.09375*(3*(w-x)-f+v),B=2*T+M,P=2*A+C,I=.75*(y-b)+T+.16666667*M,E=.75*(w-f)+A+.16666667*C,p+=Math.sqrt(I*I+E*E),I+=B,E+=P,B+=M,P+=C,p+=Math.sqrt(I*I+E*E),I+=B,E+=P,p+=Math.sqrt(I*I+E*E),I+=B+M,E+=P+C,p+=Math.sqrt(I*I+E*E),g[t]=p,b=F,f=v;switch(this.data.positionMode==je.Percent&&(a*=p),this.data.spacingMode){case Ze.Percent:m=p;break;case Ze.Proportional:m=p/i;break;default:m=1}let D=this.segments,R=0;for(let t=0,_=0,W=0,L=0;t<i;t++,_+=3){let e=o[t]*m;a+=e;let i=a;if(h)i%=p,i<0&&(i+=p),W=0;else{if(i<0){this.addBeforePosition(i,l,0,r,_);continue}if(i>p){this.addAfterPosition(i-p,l,c-4,r,_);continue}}for(;;W++){let t=g[W];if(!(i>t)){if(0==W)i/=t;else{let e=g[W-1];i=(i-e)/(t-e)}break}}if(W!=u){u=W;let t=6*W;for(b=l[t],f=l[t+1],y=l[t+2],w=l[t+3],S=l[t+4],x=l[t+5],F=l[t+6],v=l[t+7],T=.03*(b-2*y+S),A=.03*(f-2*w+x),M=.006*(3*(y-S)-b+F),C=.006*(3*(w-x)-f+v),B=2*T+M,P=2*A+C,I=.3*(y-b)+T+.16666667*M,E=.3*(w-f)+A+.16666667*C,R=Math.sqrt(I*I+E*E),D[0]=R,t=1;t<8;t++)I+=B,E+=P,B+=M,P+=C,R+=Math.sqrt(I*I+E*E),D[t]=R;I+=B,E+=P,R+=Math.sqrt(I*I+E*E),D[8]=R,I+=B+M,E+=P+C,R+=Math.sqrt(I*I+E*E),D[9]=R,L=0}for(i*=R;;L++){let t=D[L];if(!(i>t)){if(0==L)i/=t;else{let e=D[L-1];i=L+(i-e)/(t-e)}break}}this.addCurvePosition(.1*i,b,f,y,w,S,x,F,v,r,_,s||t>0&&0==e)}return r}addBeforePosition(t,e,i,s,n){let a=e[i],o=e[i+1],r=e[i+2]-a,l=e[i+3]-o,h=Math.atan2(l,r);s[n]=a+t*Math.cos(h),s[n+1]=o+t*Math.sin(h),s[n+2]=h}addAfterPosition(t,e,i,s,n){let a=e[i+2],o=e[i+3],r=a-e[i],l=o-e[i+1],h=Math.atan2(l,r);s[n]=a+t*Math.cos(h),s[n+1]=o+t*Math.sin(h),s[n+2]=h}addCurvePosition(t,e,i,s,n,a,o,r,l,h,c,d){if(0==t||isNaN(t))return h[c]=e,h[c+1]=i,void(h[c+2]=Math.atan2(n-i,s-e));let u=t*t,m=u*t,g=1-t,p=g*g,b=p*g,f=g*t,y=3*f,w=g*y,S=y*t,x=e*b+s*w+a*S+r*m,F=i*b+n*w+o*S+l*m;h[c]=x,h[c+1]=F,d&&(h[c+2]=t<.001?Math.atan2(n-i,s-e):Math.atan2(F-(i*p+n*f*2+o*u),x-(e*p+s*f*2+a*u)))}};s(li,"NONE",-1),s(li,"BEFORE",-2),s(li,"AFTER",-3),s(li,"epsilon",1e-5);let hi=li;class ci{constructor(t,e){s(this,"data"),s(this,"_bone",null),s(this,"inertia",0),s(this,"strength",0),s(this,"damping",0),s(this,"massInverse",0),s(this,"wind",0),s(this,"gravity",0),s(this,"mix",0),s(this,"_reset",!0),s(this,"ux",0),s(this,"uy",0),s(this,"cx",0),s(this,"cy",0),s(this,"tx",0),s(this,"ty",0),s(this,"xOffset",0),s(this,"xVelocity",0),s(this,"yOffset",0),s(this,"yVelocity",0),s(this,"rotateOffset",0),s(this,"rotateVelocity",0),s(this,"scaleOffset",0),s(this,"scaleVelocity",0),s(this,"active",!1),s(this,"skeleton"),s(this,"remaining",0),s(this,"lastTime",0),this.data=t,this.skeleton=e,this.bone=e.bones[t.bone.index],this.inertia=t.inertia,this.strength=t.strength,this.damping=t.damping,this.massInverse=t.massInverse,this.wind=t.wind,this.gravity=t.gravity,this.mix=t.mix}set bone(t){this._bone=t}get bone(){if(this._bone)return this._bone;throw new Error("Bone not set.")}reset(){this.remaining=0,this.lastTime=this.skeleton.time,this._reset=!0,this.xOffset=0,this.xVelocity=0,this.yOffset=0,this.yVelocity=0,this.rotateOffset=0,this.rotateVelocity=0,this.scaleOffset=0,this.scaleVelocity=0}setToSetupPose(){const t=this.data;this.inertia=t.inertia,this.strength=t.strength,this.damping=t.damping,this.massInverse=t.massInverse,this.wind=t.wind,this.gravity=t.gravity,this.mix=t.mix}isActive(){return this.active}update(t){const e=this.mix;if(0==e)return;const i=this.data.x>0,s=this.data.y>0,n=this.data.rotate>0||this.data.shearX>0,a=this.data.scaleX>0,o=this.bone,r=o.data.length;switch(t){case pi.none:return;case pi.reset:this.reset();case pi.update:const t=this.skeleton,l=Math.max(this.skeleton.time-this.lastTime,0);this.remaining+=l,this.lastTime=t.time;const h=o.worldX,c=o.worldY;if(this._reset)this._reset=!1,this.ux=h,this.uy=c;else{let d=this.remaining,u=this.inertia,m=this.data.step,g=this.skeleton.data.referenceScale,p=-1,b=this.data.limit*l,f=b*Math.abs(t.scaleY);if(b*=Math.abs(t.scaleX),i||s){if(i){const t=(this.ux-h)*u;this.xOffset+=t>b?b:t<-b?-b:t,this.ux=h}if(s){const t=(this.uy-c)*u;this.yOffset+=t>f?f:t<-f?-f:t,this.uy=c}if(d>=m){p=Math.pow(this.damping,60*m);const e=this.massInverse*m,n=this.strength,a=this.wind*g*t.scaleX,o=this.gravity*g*t.scaleY;do{i&&(this.xVelocity+=(a-this.xOffset*n)*e,this.xOffset+=this.xVelocity*m,this.xVelocity*=p),s&&(this.yVelocity-=(o+this.yOffset*n)*e,this.yOffset+=this.yVelocity*m,this.yVelocity*=p),d-=m}while(d>=m)}i&&(o.worldX+=this.xOffset*e*this.data.x),s&&(o.worldY+=this.yOffset*e*this.data.y)}if(n||a){let t=Math.atan2(o.c,o.a),i=0,s=0,l=0,h=this.cx-o.worldX,c=this.cy-o.worldY;if(h>b?h=b:h<-b&&(h=-b),c>f?c=f:c<-f&&(c=-f),n){l=(this.data.rotate+this.data.shearX)*e;let n=Math.atan2(c+this.ty,h+this.tx)-t-this.rotateOffset*l;this.rotateOffset+=(n-Math.ceil(n*ot.invPI2-.5)*ot.PI2)*u,n=this.rotateOffset*l+t,i=Math.cos(n),s=Math.sin(n),a&&(n=r*o.getWorldScaleX(),n>0&&(this.scaleOffset+=(h*i+c*s)*u/n))}else{i=Math.cos(t),s=Math.sin(t);const e=r*o.getWorldScaleX();e>0&&(this.scaleOffset+=(h*i+c*s)*u/e)}if(d=this.remaining,d>=m){-1==p&&(p=Math.pow(this.damping,60*m));const e=this.massInverse*m,o=this.strength,h=this.wind,c=gi.yDown?-this.gravity:this.gravity,u=r/g;for(;;)if(d-=m,a&&(this.scaleVelocity+=(h*i-c*s-this.scaleOffset*o)*e,this.scaleOffset+=this.scaleVelocity*m,this.scaleVelocity*=p),n){if(this.rotateVelocity-=((h*s+c*i)*u+this.rotateOffset*o)*e,this.rotateOffset+=this.rotateVelocity*m,this.rotateVelocity*=p,d<m)break;const n=this.rotateOffset*l+t;i=Math.cos(n),s=Math.sin(n)}else if(d<m)break}}this.remaining=d}this.cx=o.worldX,this.cy=o.worldY;break;case pi.pose:i&&(o.worldX+=this.xOffset*e*this.data.x),s&&(o.worldY+=this.yOffset*e*this.data.y)}if(n){let t=this.rotateOffset*e,i=0,s=0,n=0;if(this.data.shearX>0){let e=0;this.data.rotate>0&&(e=t*this.data.rotate,i=Math.sin(e),s=Math.cos(e),n=o.b,o.b=s*n-i*o.d,o.d=i*n+s*o.d),e+=t*this.data.shearX,i=Math.sin(e),s=Math.cos(e),n=o.a,o.a=s*n-i*o.c,o.c=i*n+s*o.c}else t*=this.data.rotate,i=Math.sin(t),s=Math.cos(t),n=o.a,o.a=s*n-i*o.c,o.c=i*n+s*o.c,n=o.b,o.b=s*n-i*o.d,o.d=i*n+s*o.d}if(a){const t=1+this.scaleOffset*e*this.data.scaleX;o.a*=t,o.c*=t}t!=pi.pose&&(this.tx=r*o.a,this.ty=r*o.c),o.updateAppliedTransform()}translate(t,e){this.ux-=t,this.uy-=e,this.cx-=t,this.cy-=e}rotate(t,e,i){const s=i*ot.degRad,n=Math.cos(s),a=Math.sin(s),o=this.cx-t,r=this.cy-e;this.translate(o*n-r*a-o,o*a+r*n-r)}}class di{constructor(t,e){if(s(this,"data"),s(this,"bone"),s(this,"color"),s(this,"darkColor",null),s(this,"attachment",null),s(this,"attachmentState",0),s(this,"sequenceIndex",-1),s(this,"deform",new Array),!t)throw new Error("data cannot be null.");if(!e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new nt,this.darkColor=t.darkColor?new nt:null,this.setToSetupPose()}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(t instanceof mt&&this.attachment instanceof mt&&t.timelineAttachment==this.attachment.timelineAttachment||(this.deform.length=0),this.attachment=t,this.sequenceIndex=-1)}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class ui{constructor(t,e){if(s(this,"data"),s(this,"bones"),s(this,"target"),s(this,"mixRotate",0),s(this,"mixX",0),s(this,"mixY",0),s(this,"mixScaleX",0),s(this,"mixScaleY",0),s(this,"mixShearY",0),s(this,"temp",new ct),s(this,"active",!1),!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let s=0;s<t.bones.length;s++){let i=e.findBone(t.bones[s].name);if(!i)throw new Error(`Couldn't find bone ${t.bones[s].name}.`);this.bones.push(i)}let i=e.findBone(t.target.name);if(!i)throw new Error(`Couldn't find target bone ${t.target.name}.`);this.target=i,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY}isActive(){return this.active}setToSetupPose(){const t=this.data;this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY}update(t){0==this.mixRotate&&0==this.mixX&&0==this.mixY&&0==this.mixScaleX&&0==this.mixScaleY&&0==this.mixShearY||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){let t=this.mixRotate,e=this.mixX,i=this.mixY,s=this.mixScaleX,n=this.mixScaleY,a=this.mixShearY,o=0!=e||0!=i,r=this.target,l=r.a,h=r.b,c=r.c,d=r.d,u=l*d-h*c>0?ot.degRad:-.01745329277777778,m=this.data.offsetRotation*u,g=this.data.offsetShearY*u,p=this.bones;for(let b=0,f=p.length;b<f;b++){let u=p[b];if(0!=t){let e=u.a,i=u.b,s=u.c,n=u.d,a=Math.atan2(c,l)-Math.atan2(s,e)+m;a>ot.PI?a-=ot.PI2:a<-3.1415927&&(a+=ot.PI2),a*=t;let o=Math.cos(a),r=Math.sin(a);u.a=o*e-r*s,u.b=o*i-r*n,u.c=r*e+o*s,u.d=r*i+o*n}if(o){let t=this.temp;r.localToWorld(t.set(this.data.offsetX,this.data.offsetY)),u.worldX+=(t.x-u.worldX)*e,u.worldY+=(t.y-u.worldY)*i}if(0!=s){let t=Math.sqrt(u.a*u.a+u.c*u.c);0!=t&&(t=(t+(Math.sqrt(l*l+c*c)-t+this.data.offsetScaleX)*s)/t),u.a*=t,u.c*=t}if(0!=n){let t=Math.sqrt(u.b*u.b+u.d*u.d);0!=t&&(t=(t+(Math.sqrt(h*h+d*d)-t+this.data.offsetScaleY)*n)/t),u.b*=t,u.d*=t}if(a>0){let t=u.b,e=u.d,i=Math.atan2(e,t),s=Math.atan2(d,h)-Math.atan2(c,l)-(i-Math.atan2(u.c,u.a));s>ot.PI?s-=ot.PI2:s<-3.1415927&&(s+=ot.PI2),s=i+(s+g)*a;let n=Math.sqrt(t*t+e*e);u.b=Math.cos(s)*n,u.d=Math.sin(s)*n}u.updateAppliedTransform()}}applyRelativeWorld(){let t=this.mixRotate,e=this.mixX,i=this.mixY,s=this.mixScaleX,n=this.mixScaleY,a=this.mixShearY,o=0!=e||0!=i,r=this.target,l=r.a,h=r.b,c=r.c,d=r.d,u=l*d-h*c>0?ot.degRad:-.01745329277777778,m=this.data.offsetRotation*u,g=this.data.offsetShearY*u,p=this.bones;for(let b=0,f=p.length;b<f;b++){let u=p[b];if(0!=t){let e=u.a,i=u.b,s=u.c,n=u.d,a=Math.atan2(c,l)+m;a>ot.PI?a-=ot.PI2:a<-3.1415927&&(a+=ot.PI2),a*=t;let o=Math.cos(a),r=Math.sin(a);u.a=o*e-r*s,u.b=o*i-r*n,u.c=r*e+o*s,u.d=r*i+o*n}if(o){let t=this.temp;r.localToWorld(t.set(this.data.offsetX,this.data.offsetY)),u.worldX+=t.x*e,u.worldY+=t.y*i}if(0!=s){let t=(Math.sqrt(l*l+c*c)-1+this.data.offsetScaleX)*s+1;u.a*=t,u.c*=t}if(0!=n){let t=(Math.sqrt(h*h+d*d)-1+this.data.offsetScaleY)*n+1;u.b*=t,u.d*=t}if(a>0){let t=Math.atan2(d,h)-Math.atan2(c,l);t>ot.PI?t-=ot.PI2:t<-3.1415927&&(t+=ot.PI2);let e=u.b,i=u.d;t=Math.atan2(i,e)+(t-ot.PI/2+g)*a;let s=Math.sqrt(e*e+i*i);u.b=Math.cos(t)*s,u.d=Math.sin(t)*s}u.updateAppliedTransform()}}applyAbsoluteLocal(){let t=this.mixRotate,e=this.mixX,i=this.mixY,s=this.mixScaleX,n=this.mixScaleY,a=this.mixShearY,o=this.target,r=this.bones;for(let l=0,h=r.length;l<h;l++){let h=r[l],c=h.arotation;0!=t&&(c+=(o.arotation-c+this.data.offsetRotation)*t);let d=h.ax,u=h.ay;d+=(o.ax-d+this.data.offsetX)*e,u+=(o.ay-u+this.data.offsetY)*i;let m=h.ascaleX,g=h.ascaleY;0!=s&&0!=m&&(m=(m+(o.ascaleX-m+this.data.offsetScaleX)*s)/m),0!=n&&0!=g&&(g=(g+(o.ascaleY-g+this.data.offsetScaleY)*n)/g);let p=h.ashearY;0!=a&&(p+=(o.ashearY-p+this.data.offsetShearY)*a),h.updateWorldTransformWith(d,u,c,m,g,h.ashearX,p)}}applyRelativeLocal(){let t=this.mixRotate,e=this.mixX,i=this.mixY,s=this.mixScaleX,n=this.mixScaleY,a=this.mixShearY,o=this.target,r=this.bones;for(let l=0,h=r.length;l<h;l++){let h=r[l],c=h.arotation+(o.arotation+this.data.offsetRotation)*t,d=h.ax+(o.ax+this.data.offsetX)*e,u=h.ay+(o.ay+this.data.offsetY)*i,m=h.ascaleX*((o.ascaleX-1+this.data.offsetScaleX)*s+1),g=h.ascaleY*((o.ascaleY-1+this.data.offsetScaleY)*n+1),p=h.ashearY+(o.ashearY+this.data.offsetShearY)*a;h.updateWorldTransformWith(d,u,c,m,g,h.ashearX,p)}}}const mi=class t{constructor(t){if(s(this,"data"),s(this,"bones"),s(this,"slots"),s(this,"drawOrder"),s(this,"ikConstraints"),s(this,"transformConstraints"),s(this,"pathConstraints"),s(this,"physicsConstraints"),s(this,"_updateCache",new Array),s(this,"skin",null),s(this,"color"),s(this,"scaleX",1),s(this,"_scaleY",1),s(this,"x",0),s(this,"y",0),s(this,"time",0),!t)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){let i,s=t.bones[e];if(s.parent){let t=this.bones[s.parent.index];i=new ei(s,this,t),t.children.push(i)}else i=new ei(s,this,null);this.bones.push(i)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){let i=t.slots[e],s=this.bones[i.boneData.index],n=new di(i,s);this.slots.push(n),this.drawOrder.push(n)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){let i=t.ikConstraints[e];this.ikConstraints.push(new ai(i,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){let i=t.transformConstraints[e];this.transformConstraints.push(new ui(i,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){let i=t.pathConstraints[e];this.pathConstraints.push(new hi(i,this))}this.physicsConstraints=new Array;for(let e=0;e<t.physicsConstraints.length;e++){let i=t.physicsConstraints[e];this.physicsConstraints.push(new ci(i,this))}this.color=new nt(1,1,1,1),this.updateCache()}get scaleY(){return t.yDown?-this._scaleY:this._scaleY}set scaleY(t){this._scaleY=t}updateCache(){this._updateCache.length=0;let t=this.bones;for(let c=0,d=t.length;c<d;c++){let e=t[c];e.sorted=e.data.skinRequired,e.active=!e.sorted}if(this.skin){let t=this.skin.bones;for(let e=0,i=this.skin.bones.length;e<i;e++){let i=this.bones[t[e].index];do{i.sorted=!1,i.active=!0,i=i.parent}while(i)}}let e=this.ikConstraints,i=this.transformConstraints,s=this.pathConstraints,n=this.physicsConstraints,a=e.length,o=i.length,r=s.length,l=this.physicsConstraints.length,h=a+o+r+l;t:for(let c=0;c<h;c++){for(let t=0;t<a;t++){let i=e[t];if(i.data.order==c){this.sortIkConstraint(i);continue t}}for(let t=0;t<o;t++){let e=i[t];if(e.data.order==c){this.sortTransformConstraint(e);continue t}}for(let t=0;t<r;t++){let e=s[t];if(e.data.order==c){this.sortPathConstraint(e);continue t}}for(let t=0;t<l;t++){const e=n[t];if(e.data.order==c){this.sortPhysicsConstraint(e);continue t}}}for(let c=0,d=t.length;c<d;c++)this.sortBone(t[c])}sortIkConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&lt.contains(this.skin.constraints,t.data,!0)),!t.active)return;let e=t.target;this.sortBone(e);let i=t.bones,s=i[0];if(this.sortBone(s),1==i.length)this._updateCache.push(t),this.sortReset(s.children);else{let e=i[i.length-1];this.sortBone(e),this._updateCache.push(t),this.sortReset(s.children),e.sorted=!0}}sortPathConstraint(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||this.skin&&lt.contains(this.skin.constraints,t.data,!0)),!t.active)return;let e=t.target,i=e.data.index,s=e.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,i,s),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,i,s);for(let r=0,l=this.data.skins.length;r<l;r++)this.sortPathConstraintAttachment(this.data.skins[r],i,s);let n=e.getAttachment();n instanceof Ye&&this.sortPathConstraintAttachmentWith(n,s);let a=t.bones,o=a.length;for(let r=0;r<o;r++)this.sortBone(a[r]);this._updateCache.push(t);for(let r=0;r<o;r++)this.sortReset(a[r].children);for(let r=0;r<o;r++)a[r].sorted=!0}sortTransformConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&lt.contains(this.skin.constraints,t.data,!0)),!t.active)return;this.sortBone(t.target);let e=t.bones,i=e.length;if(t.data.local)for(let s=0;s<i;s++){let t=e[s];this.sortBone(t.parent),this.sortBone(t)}else for(let s=0;s<i;s++)this.sortBone(e[s]);this._updateCache.push(t);for(let s=0;s<i;s++)this.sortReset(e[s].children);for(let s=0;s<i;s++)e[s].sorted=!0}sortPathConstraintAttachment(t,e,i){let s=t.attachments[e];if(s)for(let n in s)this.sortPathConstraintAttachmentWith(s[n],i)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof Ye))return;let i=t.bones;if(i){let t=this.bones;for(let e=0,s=i.length;e<s;){let s=i[e++];for(s+=e;e<s;)this.sortBone(t[i[e++]])}}else this.sortBone(e)}sortPhysicsConstraint(t){const e=t.bone;t.active=e.active&&(!t.data.skinRequired||null!=this.skin&&lt.contains(this.skin.constraints,t.data,!0)),t.active&&(this.sortBone(e),this._updateCache.push(t),this.sortReset(e.children),e.sorted=!0)}sortBone(t){if(!t)return;if(t.sorted)return;let e=t.parent;e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,i=t.length;e<i;e++){let i=t[e];i.active&&(i.sorted&&this.sortReset(i.children),i.sorted=!1)}}updateWorldTransform(t){if(null==t)throw new Error("physics is undefined");let e=this.bones;for(let s=0,n=e.length;s<n;s++){let t=e[s];t.ax=t.x,t.ay=t.y,t.arotation=t.rotation,t.ascaleX=t.scaleX,t.ascaleY=t.scaleY,t.ashearX=t.shearX,t.ashearY=t.shearY}let i=this._updateCache;for(let s=0,n=i.length;s<n;s++)i[s].update(t)}updateWorldTransformWith(t,e){if(!e)throw new Error("parent cannot be null.");let i=this.bones;for(let p=1,b=i.length;p<b;p++){let t=i[p];t.ax=t.x,t.ay=t.y,t.arotation=t.rotation,t.ascaleX=t.scaleX,t.ascaleY=t.scaleY,t.ashearX=t.shearX,t.ashearY=t.shearY}let s=this.getRootBone();if(!s)throw new Error("Root bone must not be null.");let n=e.a,a=e.b,o=e.c,r=e.d;s.worldX=n*this.x+a*this.y+e.worldX,s.worldY=o*this.x+r*this.y+e.worldY;const l=(s.rotation+s.shearX)*ot.degRad,h=(s.rotation+90+s.shearY)*ot.degRad,c=Math.cos(l)*s.scaleX,d=Math.cos(h)*s.scaleY,u=Math.sin(l)*s.scaleX,m=Math.sin(h)*s.scaleY;s.a=(n*c+a*u)*this.scaleX,s.b=(n*d+a*m)*this.scaleX,s.c=(o*c+r*u)*this.scaleY,s.d=(o*d+r*m)*this.scaleY;let g=this._updateCache;for(let p=0,b=g.length;p<b;p++){let e=g[p];e!=s&&e.update(t)}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){for(const t of this.bones)t.setToSetupPose();for(const t of this.ikConstraints)t.setToSetupPose();for(const t of this.transformConstraints)t.setToSetupPose();for(const t of this.pathConstraints)t.setToSetupPose();for(const t of this.physicsConstraints)t.setToSetupPose()}setSlotsToSetupPose(){let t=this.slots;lt.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,i=t.length;e<i;e++)t[e].setToSetupPose()}getRootBone(){return 0==this.bones.length?null:this.bones[0]}findBone(t){if(!t)throw new Error("boneName cannot be null.");let e=this.bones;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.data.name==t)return s}return null}findSlot(t){if(!t)throw new Error("slotName cannot be null.");let e=this.slots;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.data.name==t)return s}return null}setSkinByName(t){let e=this.data.findSkin(t);if(!e)throw new Error("Skin not found: "+t);this.setSkin(e)}setSkin(t){if(t!=this.skin){if(t)if(this.skin)t.attachAll(this,this.skin);else{let e=this.slots;for(let i=0,s=e.length;i<s;i++){let s=e[i],n=s.data.attachmentName;if(n){let e=t.getAttachment(i,n);e&&s.setAttachment(e)}}}this.skin=t,this.updateCache()}}getAttachmentByName(t,e){let i=this.data.findSlot(t);if(!i)throw new Error(`Can't find slot with name ${t}`);return this.getAttachment(i.index,e)}getAttachment(t,e){if(!e)throw new Error("attachmentName cannot be null.");if(this.skin){let i=this.skin.getAttachment(t,e);if(i)return i}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(!t)throw new Error("slotName cannot be null.");let i=this.slots;for(let s=0,n=i.length;s<n;s++){let n=i[s];if(n.data.name==t){let i=null;if(e&&(i=this.getAttachment(s,e),!i))throw new Error("Attachment not found: "+e+", for slot: "+t);return void n.setAttachment(i)}}throw new Error("Slot not found: "+t)}findIkConstraint(t){var e;if(!t)throw new Error("constraintName cannot be null.");return null!=(e=this.ikConstraints.find((e=>e.data.name==t)))?e:null}findTransformConstraint(t){var e;if(!t)throw new Error("constraintName cannot be null.");return null!=(e=this.transformConstraints.find((e=>e.data.name==t)))?e:null}findPathConstraint(t){var e;if(!t)throw new Error("constraintName cannot be null.");return null!=(e=this.pathConstraints.find((e=>e.data.name==t)))?e:null}findPhysicsConstraint(t){var e;if(null==t)throw new Error("constraintName cannot be null.");return null!=(e=this.physicsConstraints.find((e=>e.data.name==t)))?e:null}getBoundsRect(t){let e=new ct,i=new ct;return this.getBounds(e,i,void 0,t),{x:e.x,y:e.y,width:i.x,height:i.y}}getBounds(e,i,s=new Array(2),n=null){if(!e)throw new Error("offset cannot be null.");if(!i)throw new Error("size cannot be null.");let a=this.drawOrder,o=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY;for(let c=0,d=a.length;c<d;c++){let e=a[c];if(!e.bone.active)continue;let i=0,d=null,u=null,m=e.getAttachment();if(m instanceof He)i=8,d=lt.setArraySize(s,i,0),m.computeWorldVertices(e,d,0,2),u=t.quadTriangles;else if(m instanceof Ve){let t=m;i=t.worldVerticesLength,d=lt.setArraySize(s,i,0),t.computeWorldVertices(e,0,i,d,0,2),u=t.triangles}else if(m instanceof Pe&&null!=n){n.clipStart(e,m);continue}if(d&&u){null!=n&&n.isClipping()&&(n.clipTriangles(d,u,u.length),d=n.clippedVertices,i=n.clippedVertices.length);for(let t=0,e=d.length;t<e;t+=2){let e=d[t],i=d[t+1];o=Math.min(o,e),r=Math.min(r,i),l=Math.max(l,e),h=Math.max(h,i)}}null!=n&&n.clipEndWithSlot(e)}null!=n&&n.clipEnd(),e.set(o,r),i.set(l-o,h-r)}update(t){this.time+=t}physicsTranslate(t,e){const i=this.physicsConstraints;for(let s=0,n=i.length;s<n;s++)i[s].translate(t,e)}physicsRotate(t,e,i){const s=this.physicsConstraints;for(let n=0,a=s.length;n<a;n++)s[n].rotate(t,e,i)}};s(mi,"quadTriangles",[0,1,2,2,3,0]),s(mi,"yDown",!1);let gi=mi;var pi,bi,fi,yi;(bi=pi||(pi={}))[bi.none=0]="none",bi[bi.reset=1]="reset",bi[bi.update=2]="update",bi[bi.pose=3]="pose";class wi extends ii{constructor(t){super(t,0,!1),s(this,"_bone",null),s(this,"x",0),s(this,"y",0),s(this,"rotate",0),s(this,"scaleX",0),s(this,"shearX",0),s(this,"limit",0),s(this,"step",0),s(this,"inertia",0),s(this,"strength",0),s(this,"damping",0),s(this,"massInverse",0),s(this,"wind",0),s(this,"gravity",0),s(this,"mix",0),s(this,"inertiaGlobal",!1),s(this,"strengthGlobal",!1),s(this,"dampingGlobal",!1),s(this,"massGlobal",!1),s(this,"windGlobal",!1),s(this,"gravityGlobal",!1),s(this,"mixGlobal",!1)}set bone(t){this._bone=t}get bone(){if(this._bone)return this._bone;throw new Error("BoneData not set.")}}class Si{constructor(){s(this,"name",null),s(this,"bones",new Array),s(this,"slots",new Array),s(this,"skins",new Array),s(this,"defaultSkin",null),s(this,"events",new Array),s(this,"animations",new Array),s(this,"ikConstraints",new Array),s(this,"transformConstraints",new Array),s(this,"pathConstraints",new Array),s(this,"physicsConstraints",new Array),s(this,"x",0),s(this,"y",0),s(this,"width",0),s(this,"height",0),s(this,"referenceScale",100),s(this,"version",null),s(this,"hash",null),s(this,"fps",0),s(this,"imagesPath",null),s(this,"audioPath",null)}findBone(t){if(!t)throw new Error("boneName cannot be null.");let e=this.bones;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.name==t)return s}return null}findSlot(t){if(!t)throw new Error("slotName cannot be null.");let e=this.slots;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.name==t)return s}return null}findSkin(t){if(!t)throw new Error("skinName cannot be null.");let e=this.skins;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.name==t)return s}return null}findEvent(t){if(!t)throw new Error("eventDataName cannot be null.");let e=this.events;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.name==t)return s}return null}findAnimation(t){if(!t)throw new Error("animationName cannot be null.");let e=this.animations;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s.name==t)return s}return null}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let i=0,s=e.length;i<s;i++){const s=e[i];if(s.name==t)return s}return null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let i=0,s=e.length;i<s;i++){const s=e[i];if(s.name==t)return s}return null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let i=0,s=e.length;i<s;i++){const s=e[i];if(s.name==t)return s}return null}findPhysicsConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.physicsConstraints;for(let i=0,s=e.length;i<s;i++){const s=e[i];if(s.name==t)return s}return null}}class xi{constructor(t=0,e,i){s(this,"slotIndex"),s(this,"name"),s(this,"attachment"),this.slotIndex=t,this.name=e,this.attachment=i}}class Fi{constructor(t){if(s(this,"name"),s(this,"attachments",new Array),s(this,"bones",Array()),s(this,"constraints",new Array),s(this,"color",new nt(.99607843,.61960787,.30980393,1)),!t)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,i){if(!i)throw new Error("attachment cannot be null.");let s=this.attachments;t>=s.length&&(s.length=t+1),s[t]||(s[t]={}),s[t][e]=i}addSkin(t){for(let s=0;s<t.bones.length;s++){let e=t.bones[s],i=!1;for(let t=0;t<this.bones.length;t++)if(this.bones[t]==e){i=!0;break}i||this.bones.push(e)}for(let s=0;s<t.constraints.length;s++){let e=t.constraints[s],i=!1;for(let t=0;t<this.constraints.length;t++)if(this.constraints[t]==e){i=!0;break}i||this.constraints.push(e)}let e=t.getAttachments();for(let s=0;s<e.length;s++){var i=e[s];this.setAttachment(i.slotIndex,i.name,i.attachment)}}copySkin(t){for(let s=0;s<t.bones.length;s++){let e=t.bones[s],i=!1;for(let t=0;t<this.bones.length;t++)if(this.bones[t]==e){i=!0;break}i||this.bones.push(e)}for(let s=0;s<t.constraints.length;s++){let e=t.constraints[s],i=!1;for(let t=0;t<this.constraints.length;t++)if(this.constraints[t]==e){i=!0;break}i||this.constraints.push(e)}let e=t.getAttachments();for(let s=0;s<e.length;s++){var i=e[s];i.attachment&&(i.attachment instanceof Ve?(i.attachment=i.attachment.newLinkedMesh(),this.setAttachment(i.slotIndex,i.name,i.attachment)):(i.attachment=i.attachment.copy(),this.setAttachment(i.slotIndex,i.name,i.attachment)))}}getAttachment(t,e){let i=this.attachments[t];return i?i[e]:null}removeAttachment(t,e){let i=this.attachments[t];i&&delete i[e]}getAttachments(){let t=new Array;for(var e=0;e<this.attachments.length;e++){let i=this.attachments[e];if(i)for(let s in i){let n=i[s];n&&t.push(new xi(e,s,n))}}return t}getAttachmentsForSlot(t,e){let i=this.attachments[t];if(i)for(let s in i){let n=i[s];n&&e.push(new xi(t,s,n))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let i=0;for(let s=0;s<t.slots.length;s++){let n=t.slots[s],a=n.getAttachment();if(a&&i<e.attachments.length){let t=e.attachments[i];for(let e in t)if(a==t[e]){let t=this.getAttachment(i,e);t&&n.setAttachment(t);break}}i++}}}class vi{constructor(t,e,i){if(s(this,"index",0),s(this,"name"),s(this,"boneData"),s(this,"color",new nt(1,1,1,1)),s(this,"darkColor",null),s(this,"attachmentName",null),s(this,"blendMode",fi.Normal),s(this,"visible",!0),t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");if(!i)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=i}}(yi=fi||(fi={}))[yi.Normal=0]="Normal",yi[yi.Additive=1]="Additive",yi[yi.Multiply=2]="Multiply",yi[yi.Screen=3]="Screen";class Ti extends ii{constructor(t){super(t,0,!1),s(this,"bones",new Array),s(this,"_target",null),s(this,"mixRotate",0),s(this,"mixX",0),s(this,"mixY",0),s(this,"mixScaleX",0),s(this,"mixScaleY",0),s(this,"mixShearY",0),s(this,"offsetRotation",0),s(this,"offsetX",0),s(this,"offsetY",0),s(this,"offsetScaleX",0),s(this,"offsetScaleY",0),s(this,"offsetShearY",0),s(this,"relative",!1),s(this,"local",!1)}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class Ai{constructor(t){s(this,"scale",1),s(this,"attachmentLoader"),s(this,"linkedMeshes",new Array),this.attachmentLoader=t}readSkeletonData(t){var e;let i=this.scale,s=new Si;s.name="";let n=new Mi(t),a=n.readInt32(),o=n.readInt32();s.hash=0==o&&0==a?null:o.toString(16)+a.toString(16),s.version=n.readString(),s.x=n.readFloat(),s.y=n.readFloat(),s.width=n.readFloat(),s.height=n.readFloat(),s.referenceScale=n.readFloat()*i;let r=n.readBoolean();r&&(s.fps=n.readFloat(),s.imagesPath=n.readString(),s.audioPath=n.readString());let l=0;l=n.readInt(!0);for(let c=0;c<l;c++){let t=n.readString();if(!t)throw new Error("String in string table must not be null.");n.strings.push(t)}l=n.readInt(!0);for(let c=0;c<l;c++){let t=n.readString();if(!t)throw new Error("Bone name must not be null.");let a=0==c?null:s.bones[n.readInt(!0)],o=new $e(c,t,a);o.rotation=n.readFloat(),o.x=n.readFloat()*i,o.y=n.readFloat()*i,o.scaleX=n.readFloat(),o.scaleY=n.readFloat(),o.shearX=n.readFloat(),o.shearY=n.readFloat(),o.length=n.readFloat()*i,o.inherit=n.readByte(),o.skinRequired=n.readBoolean(),r&&(nt.rgba8888ToColor(o.color,n.readInt32()),o.icon=null!=(e=n.readString())?e:void 0,o.visible=n.readBoolean()),s.bones.push(o)}l=n.readInt(!0);for(let c=0;c<l;c++){let t=n.readString();if(!t)throw new Error("Slot name must not be null.");let e=s.bones[n.readInt(!0)],i=new vi(c,t,e);nt.rgba8888ToColor(i.color,n.readInt32());let a=n.readInt32();-1!=a&&nt.rgb888ToColor(i.darkColor=new nt,a),i.attachmentName=n.readStringRef(),i.blendMode=n.readInt(!0),r&&(i.visible=n.readBoolean()),s.slots.push(i)}l=n.readInt(!0);for(let c,d=0;d<l;d++){let t=n.readString();if(!t)throw new Error("IK constraint data name must not be null.");let e=new oi(t);e.order=n.readInt(!0),c=n.readInt(!0);for(let i=0;i<c;i++)e.bones.push(s.bones[n.readInt(!0)]);e.target=s.bones[n.readInt(!0)];let a=n.readByte();e.skinRequired=!!(1&a),e.bendDirection=2&a?1:-1,e.compress=!!(4&a),e.stretch=!!(8&a),e.uniform=!!(16&a),32&a&&(e.mix=64&a?n.readFloat():1),128&a&&(e.softness=n.readFloat()*i),s.ikConstraints.push(e)}l=n.readInt(!0);for(let c,d=0;d<l;d++){let t=n.readString();if(!t)throw new Error("Transform constraint data name must not be null.");let e=new Ti(t);e.order=n.readInt(!0),c=n.readInt(!0);for(let i=0;i<c;i++)e.bones.push(s.bones[n.readInt(!0)]);e.target=s.bones[n.readInt(!0)];let a=n.readByte();e.skinRequired=!!(1&a),e.local=!!(2&a),e.relative=!!(4&a),8&a&&(e.offsetRotation=n.readFloat()),16&a&&(e.offsetX=n.readFloat()*i),32&a&&(e.offsetY=n.readFloat()*i),64&a&&(e.offsetScaleX=n.readFloat()),128&a&&(e.offsetScaleY=n.readFloat()),a=n.readByte(),1&a&&(e.offsetShearY=n.readFloat()),2&a&&(e.mixRotate=n.readFloat()),4&a&&(e.mixX=n.readFloat()),8&a&&(e.mixY=n.readFloat()),16&a&&(e.mixScaleX=n.readFloat()),32&a&&(e.mixScaleY=n.readFloat()),64&a&&(e.mixShearY=n.readFloat()),s.transformConstraints.push(e)}l=n.readInt(!0);for(let c,d=0;d<l;d++){let t=n.readString();if(!t)throw new Error("Path constraint data name must not be null.");let e=new ri(t);e.order=n.readInt(!0),e.skinRequired=n.readBoolean(),c=n.readInt(!0);for(let i=0;i<c;i++)e.bones.push(s.bones[n.readInt(!0)]);e.target=s.slots[n.readInt(!0)];const a=n.readByte();e.positionMode=1&a,e.spacingMode=a>>1&3,e.rotateMode=a>>3&3,128&a&&(e.offsetRotation=n.readFloat()),e.position=n.readFloat(),e.positionMode==je.Fixed&&(e.position*=i),e.spacing=n.readFloat(),e.spacingMode!=Ze.Length&&e.spacingMode!=Ze.Fixed||(e.spacing*=i),e.mixRotate=n.readFloat(),e.mixX=n.readFloat(),e.mixY=n.readFloat(),s.pathConstraints.push(e)}l=n.readInt(!0);for(let c=0;c<l;c++){const t=n.readString();if(!t)throw new Error("Physics constraint data name must not be null.");const e=new wi(t);e.order=n.readInt(!0),e.bone=s.bones[n.readInt(!0)];let a=n.readByte();e.skinRequired=!!(1&a),2&a&&(e.x=n.readFloat()),4&a&&(e.y=n.readFloat()),8&a&&(e.rotate=n.readFloat()),16&a&&(e.scaleX=n.readFloat()),32&a&&(e.shearX=n.readFloat()),e.limit=(64&a?n.readFloat():5e3)*i,e.step=1/n.readUnsignedByte(),e.inertia=n.readFloat(),e.strength=n.readFloat(),e.damping=n.readFloat(),e.massInverse=128&a?n.readFloat():1,e.wind=n.readFloat(),e.gravity=n.readFloat(),a=n.readByte(),1&a&&(e.inertiaGlobal=!0),2&a&&(e.strengthGlobal=!0),4&a&&(e.dampingGlobal=!0),8&a&&(e.massGlobal=!0),16&a&&(e.windGlobal=!0),32&a&&(e.gravityGlobal=!0),64&a&&(e.mixGlobal=!0),e.mix=128&a?n.readFloat():1,s.physicsConstraints.push(e)}let h=this.readSkin(n,s,!0,r);h&&(s.defaultSkin=h,s.skins.push(h));{let t=s.skins.length;for(lt.setArraySize(s.skins,l=t+n.readInt(!0));t<l;t++){let e=this.readSkin(n,s,!1,r);if(!e)throw new Error("readSkin() should not have returned null.");s.skins[t]=e}}l=this.linkedMeshes.length;for(let c=0;c<l;c++){let t=this.linkedMeshes[c];const e=s.skins[t.skinIndex];if(!t.parent)throw new Error("Linked mesh parent must not be null");let i=e.getAttachment(t.slotIndex,t.parent);if(!i)throw new Error(`Parent mesh not found: ${t.parent}`);t.mesh.timelineAttachment=t.inheritTimeline?i:t.mesh,t.mesh.setParentMesh(i),null!=t.mesh.region&&t.mesh.updateRegion()}this.linkedMeshes.length=0,l=n.readInt(!0);for(let c=0;c<l;c++){let t=n.readString();if(!t)throw new Error("Event data name must not be null");let e=new ni(t);e.intValue=n.readInt(!1),e.floatValue=n.readFloat(),e.stringValue=n.readString(),e.audioPath=n.readString(),e.audioPath&&(e.volume=n.readFloat(),e.balance=n.readFloat()),s.events.push(e)}l=n.readInt(!0);for(let c=0;c<l;c++){let t=n.readString();if(!t)throw new Error("Animatio name must not be null.");s.animations.push(this.readAnimation(n,t,s))}return s}readSkin(t,e,i,s){let n=null,a=0;if(i){if(a=t.readInt(!0),0==a)return null;n=new Fi("default")}else{let i=t.readString();if(!i)throw new Error("Skin name must not be null.");n=new Fi(i),s&&nt.rgba8888ToColor(n.color,t.readInt32()),n.bones.length=t.readInt(!0);for(let s=0,a=n.bones.length;s<a;s++)n.bones[s]=e.bones[t.readInt(!0)];for(let s=0,a=t.readInt(!0);s<a;s++)n.constraints.push(e.ikConstraints[t.readInt(!0)]);for(let s=0,a=t.readInt(!0);s<a;s++)n.constraints.push(e.transformConstraints[t.readInt(!0)]);for(let s=0,a=t.readInt(!0);s<a;s++)n.constraints.push(e.pathConstraints[t.readInt(!0)]);for(let s=0,a=t.readInt(!0);s<a;s++)n.constraints.push(e.physicsConstraints[t.readInt(!0)]);a=t.readInt(!0)}for(let o=0;o<a;o++){let i=t.readInt(!0);for(let a=0,o=t.readInt(!0);a<o;a++){let a=t.readStringRef();if(!a)throw new Error("Attachment name must not be null");let o=this.readAttachment(t,e,n,i,a,s);o&&n.setAttachment(i,a,o)}}return n}readAttachment(t,e,i,s,n,a){let o=this.scale,r=t.readByte();const l=8&r?t.readStringRef():n;if(!l)throw new Error("Attachment name must not be null");switch(7&r){case Pi.Region:{let e=16&r?t.readStringRef():null;const s=32&r?t.readInt32():4294967295,n=64&r?this.readSequence(t):null;let a=128&r?t.readFloat():0,h=t.readFloat(),c=t.readFloat(),d=t.readFloat(),u=t.readFloat(),m=t.readFloat(),g=t.readFloat();e||(e=l);let p=this.attachmentLoader.newRegionAttachment(i,l,e,n);return p?(p.path=e,p.x=h*o,p.y=c*o,p.scaleX=d,p.scaleY=u,p.rotation=a,p.width=m*o,p.height=g*o,nt.rgba8888ToColor(p.color,s),p.sequence=n,null==n&&p.updateRegion(),p):null}case Pi.BoundingBox:{let e=this.readVertices(t,!!(16&r)),s=a?t.readInt32():0,n=this.attachmentLoader.newBoundingBoxAttachment(i,l);return n?(n.worldVerticesLength=e.length,n.vertices=e.vertices,n.bones=e.bones,a&&nt.rgba8888ToColor(n.color,s),n):null}case Pi.Mesh:{let e=16&r?t.readStringRef():l;const s=32&r?t.readInt32():4294967295,n=64&r?this.readSequence(t):null,h=t.readInt(!0),c=this.readVertices(t,!!(128&r)),d=this.readFloatArray(t,c.length,1),u=this.readShortArray(t,3*(c.length-h-2));let m=[],g=0,p=0;a&&(m=this.readShortArray(t,t.readInt(!0)),g=t.readFloat(),p=t.readFloat()),e||(e=l);let b=this.attachmentLoader.newMeshAttachment(i,l,e,n);return b?(b.path=e,nt.rgba8888ToColor(b.color,s),b.bones=c.bones,b.vertices=c.vertices,b.worldVerticesLength=c.length,b.triangles=u,b.regionUVs=d,null==n&&b.updateRegion(),b.hullLength=h<<1,b.sequence=n,a&&(b.edges=m,b.width=g*o,b.height=p*o),b):null}case Pi.LinkedMesh:{const e=16&r?t.readStringRef():l;if(null==e)throw new Error("Path of linked mesh must not be null");const n=32&r?t.readInt32():4294967295,h=64&r?this.readSequence(t):null,c=!!(128&r),d=t.readInt(!0),u=t.readStringRef();let m=0,g=0;a&&(m=t.readFloat(),g=t.readFloat());let p=this.attachmentLoader.newMeshAttachment(i,l,e,h);return p?(p.path=e,nt.rgba8888ToColor(p.color,n),p.sequence=h,a&&(p.width=m*o,p.height=g*o),this.linkedMeshes.push(new Ci(p,d,s,u,c)),p):null}case Pi.Path:{const e=!!(16&r),s=!!(32&r),n=this.readVertices(t,!!(64&r)),h=lt.newArray(n.length/6,0);for(let i=0,a=h.length;i<a;i++)h[i]=t.readFloat()*o;const c=a?t.readInt32():0,d=this.attachmentLoader.newPathAttachment(i,l);return d?(d.closed=e,d.constantSpeed=s,d.worldVerticesLength=n.length,d.vertices=n.vertices,d.bones=n.bones,d.lengths=h,a&&nt.rgba8888ToColor(d.color,c),d):null}case Pi.Point:{const e=t.readFloat(),s=t.readFloat(),n=t.readFloat(),r=a?t.readInt32():0,h=this.attachmentLoader.newPointAttachment(i,l);return h?(h.x=s*o,h.y=n*o,h.rotation=e,a&&nt.rgba8888ToColor(h.color,r),h):null}case Pi.Clipping:{const s=t.readInt(!0),n=this.readVertices(t,!!(16&r));let o=a?t.readInt32():0,h=this.attachmentLoader.newClippingAttachment(i,l);return h?(h.endSlot=e.slots[s],h.worldVerticesLength=n.length,h.vertices=n.vertices,h.bones=n.bones,a&&nt.rgba8888ToColor(h.color,o),h):null}}return null}readSequence(t){let e=new pt(t.readInt(!0));return e.start=t.readInt(!0),e.digits=t.readInt(!0),e.setupIndex=t.readInt(!0),e}readVertices(t,e){const i=this.scale,s=t.readInt(!0),n=new Bi;if(n.length=s<<1,!e)return n.vertices=this.readFloatArray(t,n.length,i),n;let a=new Array,o=new Array;for(let r=0;r<s;r++){let e=t.readInt(!0);o.push(e);for(let s=0;s<e;s++)o.push(t.readInt(!0)),a.push(t.readFloat()*i),a.push(t.readFloat()*i),a.push(t.readFloat())}return n.vertices=lt.toFloatArray(a),n.bones=o,n}readFloatArray(t,e,i){let s=new Array(e);if(1==i)for(let n=0;n<e;n++)s[n]=t.readFloat();else for(let n=0;n<e;n++)s[n]=t.readFloat()*i;return s}readShortArray(t,e){let i=new Array(e);for(let s=0;s<e;s++)i[s]=t.readInt(!0);return i}readAnimation(t,e,i){t.readInt(!0);let s=new Array,n=this.scale;for(let l=0,h=t.readInt(!0);l<h;l++){let e=t.readInt(!0);for(let i=0,n=t.readInt(!0);i<n;i++){let i=t.readByte(),n=t.readInt(!0),a=n-1;switch(i){case Ui:{let i=new Ut(n,e);for(let e=0;e<n;e++)i.setFrame(e,t.readFloat(),t.readStringRef());s.push(i);break}case $i:{let i=t.readInt(!0),o=new Vt(n,i,e),r=t.readFloat(),l=t.readUnsignedByte()/255,h=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255,d=t.readUnsignedByte()/255;for(let e=0,s=0;o.setFrame(e,r,l,h,c,d),e!=a;e++){let i=t.readFloat(),n=t.readUnsignedByte()/255,a=t.readUnsignedByte()/255,u=t.readUnsignedByte()/255,m=t.readUnsignedByte()/255;switch(t.readByte()){case cs:o.setStepped(e);break;case ds:Ri(t,o,s++,e,0,r,i,l,n,1),Ri(t,o,s++,e,1,r,i,h,a,1),Ri(t,o,s++,e,2,r,i,c,u,1),Ri(t,o,s++,e,3,r,i,d,m,1)}r=i,l=n,h=a,c=u,d=m}s.push(o);break}case zi:{let i=t.readInt(!0),o=new Yt(n,i,e),r=t.readFloat(),l=t.readUnsignedByte()/255,h=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255;for(let e=0,s=0;o.setFrame(e,r,l,h,c),e!=a;e++){let i=t.readFloat(),n=t.readUnsignedByte()/255,a=t.readUnsignedByte()/255,d=t.readUnsignedByte()/255;switch(t.readByte()){case cs:o.setStepped(e);break;case ds:Ri(t,o,s++,e,0,r,i,l,n,1),Ri(t,o,s++,e,1,r,i,h,a,1),Ri(t,o,s++,e,2,r,i,c,d,1)}r=i,l=n,h=a,c=d}s.push(o);break}case qi:{let i=t.readInt(!0),o=new Gt(n,i,e),r=t.readFloat(),l=t.readUnsignedByte()/255,h=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255,d=t.readUnsignedByte()/255,u=t.readUnsignedByte()/255,m=t.readUnsignedByte()/255,g=t.readUnsignedByte()/255;for(let e=0,s=0;o.setFrame(e,r,l,h,c,d,u,m,g),e!=a;e++){let i=t.readFloat(),n=t.readUnsignedByte()/255,a=t.readUnsignedByte()/255,p=t.readUnsignedByte()/255,b=t.readUnsignedByte()/255,f=t.readUnsignedByte()/255,y=t.readUnsignedByte()/255,w=t.readUnsignedByte()/255;switch(t.readByte()){case cs:o.setStepped(e);break;case ds:Ri(t,o,s++,e,0,r,i,l,n,1),Ri(t,o,s++,e,1,r,i,h,a,1),Ri(t,o,s++,e,2,r,i,c,p,1),Ri(t,o,s++,e,3,r,i,d,b,1),Ri(t,o,s++,e,4,r,i,u,f,1),Ri(t,o,s++,e,5,r,i,m,y,1),Ri(t,o,s++,e,6,r,i,g,w,1)}r=i,l=n,h=a,c=p,d=b,u=f,m=y,g=w}s.push(o);break}case ji:{let i=t.readInt(!0),o=new Ht(n,i,e),r=t.readFloat(),l=t.readUnsignedByte()/255,h=t.readUnsignedByte()/255,c=t.readUnsignedByte()/255,d=t.readUnsignedByte()/255,u=t.readUnsignedByte()/255,m=t.readUnsignedByte()/255;for(let e=0,s=0;o.setFrame(e,r,l,h,c,d,u,m),e!=a;e++){let i=t.readFloat(),n=t.readUnsignedByte()/255,a=t.readUnsignedByte()/255,g=t.readUnsignedByte()/255,p=t.readUnsignedByte()/255,b=t.readUnsignedByte()/255,f=t.readUnsignedByte()/255;switch(t.readByte()){case cs:o.setStepped(e);break;case ds:Ri(t,o,s++,e,0,r,i,l,n,1),Ri(t,o,s++,e,1,r,i,h,a,1),Ri(t,o,s++,e,2,r,i,c,g,1),Ri(t,o,s++,e,3,r,i,d,p,1),Ri(t,o,s++,e,4,r,i,u,b,1),Ri(t,o,s++,e,5,r,i,m,f,1)}r=i,l=n,h=a,c=g,d=p,u=b,m=f}s.push(o);break}case Qi:{let i=new Xt(n,t.readInt(!0),e),o=t.readFloat(),r=t.readUnsignedByte()/255;for(let e=0,s=0;i.setFrame(e,o,r),e!=a;e++){let n=t.readFloat(),a=t.readUnsignedByte()/255;switch(t.readByte()){case cs:i.setStepped(e);break;case ds:Ri(t,i,s++,e,0,o,n,r,a,1)}o=n,r=a}s.push(i)}}}}for(let l=0,h=t.readInt(!0);l<h;l++){let e=t.readInt(!0);for(let i=0,a=t.readInt(!0);i<a;i++){let i=t.readByte(),a=t.readInt(!0);if(i==Hi){let i=new Nt(a,e);for(let e=0;e<a;e++)i.setFrame(e,t.readFloat(),t.readByte());s.push(i);continue}let o=t.readInt(!0);switch(i){case _i:s.push(Ei(t,new Pt(a,o,e),1));break;case Wi:s.push(Di(t,new It(a,o,e),n));break;case Li:s.push(Ei(t,new Et(a,o,e),n));break;case Oi:s.push(Ei(t,new Dt(a,o,e),n));break;case ki:s.push(Di(t,new Rt(a,o,e),1));break;case Ni:s.push(Ei(t,new _t(a,o,e),1));break;case Vi:s.push(Ei(t,new Wt(a,o,e),1));break;case Yi:s.push(Di(t,new Lt(a,o,e),1));break;case Xi:s.push(Ei(t,new Ot(a,o,e),1));break;case Gi:s.push(Ei(t,new kt(a,o,e),1))}}}for(let l=0,h=t.readInt(!0);l<h;l++){let e=t.readInt(!0),i=t.readInt(!0),a=i-1,o=new Zt(i,t.readInt(!0),e),r=t.readByte(),l=t.readFloat(),h=1&r?2&r?t.readFloat():1:0,c=4&r?t.readFloat()*n:0;for(let s=0,d=0;o.setFrame(s,l,h,c,8&r?1:-1,!!(16&r),!!(32&r)),s!=a;s++){r=t.readByte();const e=t.readFloat(),i=1&r?2&r?t.readFloat():1:0,a=4&r?t.readFloat()*n:0;64&r?o.setStepped(s):128&r&&(Ri(t,o,d++,s,0,l,e,h,i,1),Ri(t,o,d++,s,1,l,e,c,a,n)),l=e,h=i,c=a}s.push(o)}for(let l=0,h=t.readInt(!0);l<h;l++){let e=t.readInt(!0),i=t.readInt(!0),n=i-1,a=new Kt(i,t.readInt(!0),e),o=t.readFloat(),r=t.readFloat(),l=t.readFloat(),h=t.readFloat(),c=t.readFloat(),d=t.readFloat(),u=t.readFloat();for(let s=0,m=0;a.setFrame(s,o,r,l,h,c,d,u),s!=n;s++){let e=t.readFloat(),i=t.readFloat(),n=t.readFloat(),g=t.readFloat(),p=t.readFloat(),b=t.readFloat(),f=t.readFloat();switch(t.readByte()){case cs:a.setStepped(s);break;case ds:Ri(t,a,m++,s,0,o,e,r,i,1),Ri(t,a,m++,s,1,o,e,l,n,1),Ri(t,a,m++,s,2,o,e,h,g,1),Ri(t,a,m++,s,3,o,e,c,p,1),Ri(t,a,m++,s,4,o,e,d,b,1),Ri(t,a,m++,s,5,o,e,u,f,1)}o=e,r=i,l=n,h=g,c=p,d=b,u=f}s.push(a)}for(let l=0,h=t.readInt(!0);l<h;l++){let e=t.readInt(!0),a=i.pathConstraints[e];for(let i=0,o=t.readInt(!0);i<o;i++){const i=t.readByte(),o=t.readInt(!0),r=t.readInt(!0);switch(i){case Ji:s.push(Ei(t,new Jt(o,r,e),a.positionMode==je.Fixed?n:1));break;case ts:s.push(Ei(t,new te(o,r,e),a.spacingMode==Ze.Length||a.spacingMode==Ze.Fixed?n:1));break;case es:let i=new ee(o,r,e),l=t.readFloat(),h=t.readFloat(),c=t.readFloat(),d=t.readFloat();for(let e=0,s=0,n=i.getFrameCount()-1;i.setFrame(e,l,h,c,d),e!=n;e++){let n=t.readFloat(),a=t.readFloat(),o=t.readFloat(),r=t.readFloat();switch(t.readByte()){case cs:i.setStepped(e);break;case ds:Ri(t,i,s++,e,0,l,n,h,a,1),Ri(t,i,s++,e,1,l,n,c,o,1),Ri(t,i,s++,e,2,l,n,d,r,1)}l=n,h=a,c=o,d=r}s.push(i)}}}for(let l=0,h=t.readInt(!0);l<h;l++){const e=t.readInt(!0)-1;for(let i=0,n=t.readInt(!0);i<n;i++){const i=t.readByte(),n=t.readInt(!0);if(i==hs){const i=new de(n,e);for(let e=0;e<n;e++)i.setFrame(e,t.readFloat());s.push(i);continue}const a=t.readInt(!0);switch(i){case is:s.push(Ei(t,new se(n,a,e),1));break;case ss:s.push(Ei(t,new ne(n,a,e),1));break;case ns:s.push(Ei(t,new ae(n,a,e),1));break;case as:s.push(Ei(t,new oe(n,a,e),1));break;case os:s.push(Ei(t,new re(n,a,e),1));break;case rs:s.push(Ei(t,new le(n,a,e),1));break;case ls:s.push(Ei(t,new he(n,a,e),1))}}}for(let l=0,h=t.readInt(!0);l<h;l++){let e=i.skins[t.readInt(!0)];for(let i=0,a=t.readInt(!0);i<a;i++){let i=t.readInt(!0);for(let a=0,o=t.readInt(!0);a<o;a++){let a=t.readStringRef();if(!a)throw new Error("attachmentName must not be null.");let o=e.getAttachment(i,a),r=t.readByte(),l=t.readInt(!0),h=l-1;switch(r){case Zi:{let e=o,a=e.bones,r=e.vertices,c=a?r.length/3*2:r.length,d=t.readInt(!0),u=new $t(l,d,i,e),m=t.readFloat();for(let i=0,s=0;;i++){let e,o=t.readInt(!0);if(0==o)e=a?lt.newFloatArray(c):r;else{e=lt.newFloatArray(c);let i=t.readInt(!0);if(o+=i,1==n)for(let s=i;s<o;s++)e[s]=t.readFloat();else for(let s=i;s<o;s++)e[s]=t.readFloat()*n;if(!a)for(let t=0,s=e.length;t<s;t++)e[t]+=r[t]}if(u.setFrame(i,m,e),i==h)break;let l=t.readFloat();switch(t.readByte()){case cs:u.setStepped(i);break;case ds:Ri(t,u,s++,i,0,m,l,0,1,1)}m=l}s.push(u);break}case Ki:{let e=new me(l,i,o);for(let i=0;i<l;i++){let s=t.readFloat(),n=t.readInt32();e.setFrame(i,s,yt[15&n],n>>4,t.readFloat())}s.push(e);break}}}}}let a=t.readInt(!0);if(a>0){let e=new Qt(a),n=i.slots.length;for(let i=0;i<a;i++){let s=t.readFloat(),a=t.readInt(!0),o=lt.newArray(n,0);for(let t=n-1;t>=0;t--)o[t]=-1;let r=lt.newArray(n-a,0),l=0,h=0;for(let e=0;e<a;e++){let e=t.readInt(!0);for(;l!=e;)r[h++]=l++;o[l+t.readInt(!0)]=l++}for(;l<n;)r[h++]=l++;for(let t=n-1;t>=0;t--)-1==o[t]&&(o[t]=r[--h]);e.setFrame(i,s,o)}s.push(e)}let o=t.readInt(!0);if(o>0){let e=new qt(o);for(let s=0;s<o;s++){let n=t.readFloat(),a=i.events[t.readInt(!0)],o=new si(n,a);o.intValue=t.readInt(!1),o.floatValue=t.readFloat(),o.stringValue=t.readString(),null==o.stringValue&&(o.stringValue=a.stringValue),o.data.audioPath&&(o.volume=t.readFloat(),o.balance=t.readFloat()),e.setFrame(s,o)}s.push(e)}let r=0;for(let l=0,h=s.length;l<h;l++)r=Math.max(r,s[l].getDuration());return new wt(e,s,r)}}class Mi{constructor(t,e=new Array,i=0,n=new DataView(t instanceof ArrayBuffer?t:t.buffer)){s(this,"strings"),s(this,"index"),s(this,"buffer"),this.strings=e,this.index=i,this.buffer=n}readByte(){return this.buffer.getInt8(this.index++)}readUnsignedByte(){return this.buffer.getUint8(this.index++)}readShort(){let t=this.buffer.getInt16(this.index);return this.index+=2,t}readInt32(){let t=this.buffer.getInt32(this.index);return this.index+=4,t}readInt(t){let e=this.readByte(),i=127&e;return 128&e&&(e=this.readByte(),i|=(127&e)<<7,128&e&&(e=this.readByte(),i|=(127&e)<<14,128&e&&(e=this.readByte(),i|=(127&e)<<21,128&e&&(e=this.readByte(),i|=(127&e)<<28)))),t?i:i>>>1^-(1&i)}readStringRef(){let t=this.readInt(!0);return 0==t?null:this.strings[t-1]}readString(){let t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;let e="";for(let i=0;i<t;){let t=this.readUnsignedByte();switch(t>>4){case 12:case 13:e+=String.fromCharCode((31&t)<<6|63&this.readByte()),i+=2;break;case 14:e+=String.fromCharCode((15&t)<<12|(63&this.readByte())<<6|63&this.readByte()),i+=3;break;default:e+=String.fromCharCode(t),i++}}return e}readFloat(){let t=this.buffer.getFloat32(this.index);return this.index+=4,t}readBoolean(){return 0!=this.readByte()}}let Ci=class{constructor(t,e,i,n,a){s(this,"parent"),s(this,"skinIndex"),s(this,"slotIndex"),s(this,"mesh"),s(this,"inheritTimeline"),this.mesh=t,this.skinIndex=e,this.slotIndex=i,this.parent=n,this.inheritTimeline=a}};class Bi{constructor(t=null,e=null,i=0){s(this,"bones"),s(this,"vertices"),s(this,"length"),this.bones=t,this.vertices=e,this.length=i}}var Pi,Ii;function Ei(t,e,i){let s=t.readFloat(),n=t.readFloat()*i;for(let a=0,o=0,r=e.getFrameCount()-1;e.setFrame(a,s,n),a!=r;a++){let r=t.readFloat(),l=t.readFloat()*i;switch(t.readByte()){case cs:e.setStepped(a);break;case ds:Ri(t,e,o++,a,0,s,r,n,l,i)}s=r,n=l}return e}function Di(t,e,i){let s=t.readFloat(),n=t.readFloat()*i,a=t.readFloat()*i;for(let o=0,r=0,l=e.getFrameCount()-1;e.setFrame(o,s,n,a),o!=l;o++){let l=t.readFloat(),h=t.readFloat()*i,c=t.readFloat()*i;switch(t.readByte()){case cs:e.setStepped(o);break;case ds:Ri(t,e,r++,o,0,s,l,n,h,i),Ri(t,e,r++,o,1,s,l,a,c,i)}s=l,n=h,a=c}return e}function Ri(t,e,i,s,n,a,o,r,l,h){e.setBezier(i,s,n,a,r,t.readFloat(),t.readFloat()*h,t.readFloat(),t.readFloat()*h,o,l)}(Ii=Pi||(Pi={}))[Ii.Region=0]="Region",Ii[Ii.BoundingBox=1]="BoundingBox",Ii[Ii.Mesh=2]="Mesh",Ii[Ii.LinkedMesh=3]="LinkedMesh",Ii[Ii.Path=4]="Path",Ii[Ii.Point=5]="Point",Ii[Ii.Clipping=6]="Clipping";const _i=0,Wi=1,Li=2,Oi=3,ki=4,Ni=5,Vi=6,Yi=7,Xi=8,Gi=9,Hi=10,Ui=0,$i=1,zi=2,qi=3,ji=4,Qi=5,Zi=0,Ki=1,Ji=0,ts=1,es=2,is=0,ss=1,ns=2,as=4,os=5,rs=6,ls=7,hs=8,cs=1,ds=2;class us{constructor(){s(this,"minX",0),s(this,"minY",0),s(this,"maxX",0),s(this,"maxY",0),s(this,"boundingBoxes",new Array),s(this,"polygons",new Array),s(this,"polygonPool",new ht((()=>lt.newFloatArray(16))))}update(t,e){if(!t)throw new Error("skeleton cannot be null.");let i=this.boundingBoxes,s=this.polygons,n=this.polygonPool,a=t.slots,o=a.length;i.length=0,n.freeAll(s),s.length=0;for(let r=0;r<o;r++){let t=a[r];if(!t.bone.active)continue;let e=t.getAttachment();if(e instanceof Be){let a=e;i.push(a);let o=n.obtain();o.length!=a.worldVerticesLength&&(o=lt.newFloatArray(a.worldVerticesLength)),s.push(o),a.computeWorldVertices(t,0,a.worldVerticesLength,o,0,2)}}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)}aabbCompute(){let t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY,n=this.polygons;for(let a=0,o=n.length;a<o;a++){let o=n[a],r=o;for(let n=0,a=o.length;n<a;n+=2){let a=r[n],o=r[n+1];t=Math.min(t,a),e=Math.min(e,o),i=Math.max(i,a),s=Math.max(s,o)}}this.minX=t,this.minY=e,this.maxX=i,this.maxY=s}aabbContainsPoint(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY}aabbIntersectsSegment(t,e,i,s){let n=this.minX,a=this.minY,o=this.maxX,r=this.maxY;if(t<=n&&i<=n||e<=a&&s<=a||t>=o&&i>=o||e>=r&&s>=r)return!1;let l=(s-e)/(i-t),h=l*(n-t)+e;if(h>a&&h<r)return!0;if(h=l*(o-t)+e,h>a&&h<r)return!0;let c=(a-e)/l+t;return c>n&&c<o||(c=(r-e)/l+t,c>n&&c<o)}aabbIntersectsSkeleton(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY}containsPoint(t,e){let i=this.polygons;for(let s=0,n=i.length;s<n;s++)if(this.containsPointPolygon(i[s],t,e))return this.boundingBoxes[s];return null}containsPointPolygon(t,e,i){let s=t,n=t.length,a=n-2,o=!1;for(let r=0;r<n;r+=2){let t=s[r+1],n=s[a+1];if(t<i&&n>=i||n<i&&t>=i){let l=s[r];l+(i-t)/(n-t)*(s[a]-l)<e&&(o=!o)}a=r}return o}intersectsSegment(t,e,i,s){let n=this.polygons;for(let a=0,o=n.length;a<o;a++)if(this.intersectsSegmentPolygon(n[a],t,e,i,s))return this.boundingBoxes[a];return null}intersectsSegmentPolygon(t,e,i,s,n){let a=t,o=t.length,r=e-s,l=i-n,h=e*n-i*s,c=a[o-2],d=a[o-1];for(let u=0;u<o;u+=2){let t=a[u],o=a[u+1],m=c*o-d*t,g=c-t,p=d-o,b=r*p-l*g,f=(h*g-r*m)/b;if((f>=c&&f<=t||f>=t&&f<=c)&&(f>=e&&f<=s||f>=s&&f<=e)){let t=(h*p-l*m)/b;if((t>=d&&t<=o||t>=o&&t<=d)&&(t>=i&&t<=n||t>=n&&t<=i))return!0}c=t,d=o}return!1}getPolygon(t){if(!t)throw new Error("boundingBox cannot be null.");let e=this.boundingBoxes.indexOf(t);return-1==e?null:this.polygons[e]}getWidth(){return this.maxX-this.minX}getHeight(){return this.maxY-this.minY}}class ms{constructor(){s(this,"convexPolygons",new Array),s(this,"convexPolygonsIndices",new Array),s(this,"indicesArray",new Array),s(this,"isConcaveArray",new Array),s(this,"triangles",new Array),s(this,"polygonPool",new ht((()=>new Array))),s(this,"polygonIndicesPool",new ht((()=>new Array)))}triangulate(t){let e=t,i=t.length>>1,s=this.indicesArray;s.length=0;for(let o=0;o<i;o++)s[o]=o;let n=this.isConcaveArray;n.length=0;for(let o=0,r=i;o<r;++o)n[o]=ms.isConcave(o,i,e,s);let a=this.triangles;for(a.length=0;i>3;){let t=i-1,o=0,r=1;for(;;){t:if(!n[o]){let a=s[t]<<1,l=s[o]<<1,h=s[r]<<1,c=e[a],d=e[a+1],u=e[l],m=e[l+1],g=e[h],p=e[h+1];for(let o=(r+1)%i;o!=t;o=(o+1)%i){if(!n[o])continue;let t=s[o]<<1,i=e[t],a=e[t+1];if(ms.positiveArea(g,p,c,d,i,a)&&ms.positiveArea(c,d,u,m,i,a)&&ms.positiveArea(u,m,g,p,i,a))break t}break}if(0==r){do{if(!n[o])break;o--}while(o>0);break}t=o,o=r,r=(r+1)%i}a.push(s[(i+o-1)%i]),a.push(s[o]),a.push(s[(o+1)%i]),s.splice(o,1),n.splice(o,1),i--;let l=(i+o-1)%i,h=o==i?0:o;n[l]=ms.isConcave(l,i,e,s),n[h]=ms.isConcave(h,i,e,s)}return 3==i&&(a.push(s[2]),a.push(s[0]),a.push(s[1])),a}decompose(t,e){let i=t,s=this.convexPolygons;this.polygonPool.freeAll(s),s.length=0;let n=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(n),n.length=0;let a=this.polygonIndicesPool.obtain();a.length=0;let o=this.polygonPool.obtain();o.length=0;let r=-1,l=0;for(let h=0,c=e.length;h<c;h+=3){let t=e[h]<<1,c=e[h+1]<<1,d=e[h+2]<<1,u=i[t],m=i[t+1],g=i[c],p=i[c+1],b=i[d],f=i[d+1],y=!1;if(r==t){let t=o.length-4,e=ms.winding(o[t],o[t+1],o[t+2],o[t+3],b,f),i=ms.winding(b,f,o[0],o[1],o[2],o[3]);e==l&&i==l&&(o.push(b),o.push(f),a.push(d),y=!0)}y||(o.length>0?(s.push(o),n.push(a)):(this.polygonPool.free(o),this.polygonIndicesPool.free(a)),o=this.polygonPool.obtain(),o.length=0,o.push(u),o.push(m),o.push(g),o.push(p),o.push(b),o.push(f),a=this.polygonIndicesPool.obtain(),a.length=0,a.push(t),a.push(c),a.push(d),l=ms.winding(u,m,g,p,b,f),r=t)}o.length>0&&(s.push(o),n.push(a));for(let h=0,c=s.length;h<c;h++){if(a=n[h],0==a.length)continue;let t=a[0],e=a[a.length-1];o=s[h];let i=o.length-4,r=o[i],l=o[i+1],d=o[i+2],u=o[i+3],m=o[0],g=o[1],p=o[2],b=o[3],f=ms.winding(r,l,d,u,m,g);for(let y=0;y<c;y++){if(y==h)continue;let i=n[y];if(3!=i.length)continue;let c=i[0],w=i[1],S=i[2],x=s[y],F=x[x.length-2],v=x[x.length-1];if(c!=t||w!=e)continue;let T=ms.winding(r,l,d,u,F,v),A=ms.winding(F,v,m,g,p,b);T==f&&A==f&&(x.length=0,i.length=0,o.push(F),o.push(v),a.push(S),r=d,l=u,d=F,u=v,y=0)}}for(let h=s.length-1;h>=0;h--)o=s[h],0==o.length&&(s.splice(h,1),this.polygonPool.free(o),a=n[h],n.splice(h,1),this.polygonIndicesPool.free(a));return s}static isConcave(t,e,i,s){let n=s[(e+t-1)%e]<<1,a=s[t]<<1,o=s[(t+1)%e]<<1;return!this.positiveArea(i[n],i[n+1],i[a],i[a+1],i[o],i[o+1])}static positiveArea(t,e,i,s,n,a){return t*(a-s)+i*(e-a)+n*(s-e)>=0}static winding(t,e,i,s,n,a){let o=i-t,r=s-e;return n*r-a*o+o*e-t*r>=0?1:-1}}class gs{constructor(){s(this,"triangulator",new ms),s(this,"clippingPolygon",new Array),s(this,"clipOutput",new Array),s(this,"clippedVertices",new Array),s(this,"clippedUVs",new Array),s(this,"clippedTriangles",new Array),s(this,"scratch",new Array),s(this,"clipAttachment",null),s(this,"clippingPolygons",null)}clipStart(t,e){if(this.clipAttachment)return 0;this.clipAttachment=e;let i=e.worldVerticesLength,s=lt.setArraySize(this.clippingPolygon,i);e.computeWorldVertices(t,0,i,s,0,2);let n=this.clippingPolygon;gs.makeClockwise(n);let a=this.clippingPolygons=this.triangulator.decompose(n,this.triangulator.triangulate(n));for(let o=0,r=a.length;o<r;o++){let t=a[o];gs.makeClockwise(t),t.push(t[0]),t.push(t[1])}return a.length}clipEndWithSlot(t){this.clipAttachment&&this.clipAttachment.endSlot==t.data&&this.clipEnd()}clipEnd(){this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)}isClipping(){return null!=this.clipAttachment}clipTriangles(t,e,i,s,n,a,o,r){let l,h,c,d,u,m;"number"==typeof e?(l=i,h=s,c=n,d=a,u=o,m=r):(l=e,h=i,c=s,d=n,u=a,m=o),c&&d&&u&&"boolean"==typeof m?this.clipTrianglesRender(t,l,h,c,d,u,m):this.clipTrianglesNoRender(t,l,h)}clipTrianglesNoRender(t,e,i){let s=this.clipOutput,n=this.clippedVertices,a=this.clippedTriangles,o=this.clippingPolygons,r=o.length,l=0;n.length=0,a.length=0;for(let h=0;h<i;h+=3){let i=e[h]<<1,c=t[i],d=t[i+1];i=e[h+1]<<1;let u=t[i],m=t[i+1];i=e[h+2]<<1;let g=t[i],p=t[i+1];for(let t=0;t<r;t++){let e=n.length;if(!this.clip(c,d,u,m,g,p,o[t],s)){let t=lt.setArraySize(n,e+6);t[e]=c,t[e+1]=d,t[e+2]=u,t[e+3]=m,t[e+4]=g,t[e+5]=p,e=a.length;let i=lt.setArraySize(a,e+3);i[e]=l,i[e+1]=l+1,i[e+2]=l+2,l+=3;break}{let t=s.length;if(0==t)continue;let i=t>>1,o=this.clipOutput,r=lt.setArraySize(n,e+2*i);for(let s=0;s<t;s+=2,e+=2){let t=o[s],i=o[s+1];r[e]=t,r[e+1]=i}e=a.length;let h=lt.setArraySize(a,e+3*(i-2));i--;for(let s=1;s<i;s++,e+=3)h[e]=l,h[e+1]=l+s,h[e+2]=l+s+1;l+=i+1}}}}clipTrianglesRender(t,e,i,s,n,a,o){let r=this.clipOutput,l=this.clippedVertices,h=this.clippedTriangles,c=this.clippingPolygons,d=c.length,u=o?12:8,m=0;l.length=0,h.length=0;for(let g=0;g<i;g+=3){let i=e[g]<<1,p=t[i],b=t[i+1],f=s[i],y=s[i+1];i=e[g+1]<<1;let w=t[i],S=t[i+1],x=s[i],F=s[i+1];i=e[g+2]<<1;let v=t[i],T=t[i+1],A=s[i],M=s[i+1];for(let t=0;t<d;t++){let e=l.length;if(!this.clip(p,b,w,S,v,T,c[t],r)){let t=lt.setArraySize(l,e+3*u);t[e]=p,t[e+1]=b,t[e+2]=n.r,t[e+3]=n.g,t[e+4]=n.b,t[e+5]=n.a,o?(t[e+6]=f,t[e+7]=y,t[e+8]=a.r,t[e+9]=a.g,t[e+10]=a.b,t[e+11]=a.a,t[e+12]=w,t[e+13]=S,t[e+14]=n.r,t[e+15]=n.g,t[e+16]=n.b,t[e+17]=n.a,t[e+18]=x,t[e+19]=F,t[e+20]=a.r,t[e+21]=a.g,t[e+22]=a.b,t[e+23]=a.a,t[e+24]=v,t[e+25]=T,t[e+26]=n.r,t[e+27]=n.g,t[e+28]=n.b,t[e+29]=n.a,t[e+30]=A,t[e+31]=M,t[e+32]=a.r,t[e+33]=a.g,t[e+34]=a.b,t[e+35]=a.a):(t[e+6]=f,t[e+7]=y,t[e+8]=w,t[e+9]=S,t[e+10]=n.r,t[e+11]=n.g,t[e+12]=n.b,t[e+13]=n.a,t[e+14]=x,t[e+15]=F,t[e+16]=v,t[e+17]=T,t[e+18]=n.r,t[e+19]=n.g,t[e+20]=n.b,t[e+21]=n.a,t[e+22]=A,t[e+23]=M),e=h.length;let i=lt.setArraySize(h,e+3);i[e]=m,i[e+1]=m+1,i[e+2]=m+2,m+=3;break}{let t=r.length;if(0==t)continue;let i=S-T,s=v-w,c=p-v,d=T-b,g=1/(i*c+s*(b-T)),C=t>>1,B=this.clipOutput,P=lt.setArraySize(l,e+C*u);for(let r=0;r<t;r+=2,e+=u){let t=B[r],l=B[r+1];P[e]=t,P[e+1]=l,P[e+2]=n.r,P[e+3]=n.g,P[e+4]=n.b,P[e+5]=n.a;let h=t-v,u=l-T,m=(i*h+s*u)*g,p=(d*h+c*u)*g,b=1-m-p;P[e+6]=f*m+x*p+A*b,P[e+7]=y*m+F*p+M*b,o&&(P[e+8]=a.r,P[e+9]=a.g,P[e+10]=a.b,P[e+11]=a.a)}e=h.length;let I=lt.setArraySize(h,e+3*(C-2));C--;for(let n=1;n<C;n++,e+=3)I[e]=m,I[e+1]=m+n,I[e+2]=m+n+1;m+=C+1}}}}clipTrianglesUnpacked(t,e,i,s){let n=this.clipOutput,a=this.clippedVertices,o=this.clippedUVs,r=this.clippedTriangles,l=this.clippingPolygons,h=l.length,c=0;a.length=0,o.length=0,r.length=0;for(let d=0;d<i;d+=3){let i=e[d]<<1,u=t[i],m=t[i+1],g=s[i],p=s[i+1];i=e[d+1]<<1;let b=t[i],f=t[i+1],y=s[i],w=s[i+1];i=e[d+2]<<1;let S=t[i],x=t[i+1],F=s[i],v=s[i+1];for(let t=0;t<h;t++){let e=a.length;if(!this.clip(u,m,b,f,S,x,l[t],n)){let t=lt.setArraySize(a,e+6);t[e]=u,t[e+1]=m,t[e+2]=b,t[e+3]=f,t[e+4]=S,t[e+5]=x;let i=lt.setArraySize(o,e+6);i[e]=g,i[e+1]=p,i[e+2]=y,i[e+3]=w,i[e+4]=F,i[e+5]=v,e=r.length;let s=lt.setArraySize(r,e+3);s[e]=c,s[e+1]=c+1,s[e+2]=c+2,c+=3;break}{let t=n.length;if(0==t)continue;let i=f-x,s=S-b,l=u-S,h=x-m,d=1/(i*l+s*(m-x)),T=t>>1,A=this.clipOutput,M=lt.setArraySize(a,e+2*T),C=lt.setArraySize(o,e+2*T);for(let n=0;n<t;n+=2,e+=2){let t=A[n],a=A[n+1];M[e]=t,M[e+1]=a;let o=t-S,r=a-x,c=(i*o+s*r)*d,u=(h*o+l*r)*d,m=1-c-u;C[e]=g*c+y*u+F*m,C[e+1]=p*c+w*u+v*m}e=r.length;let B=lt.setArraySize(r,e+3*(T-2));T--;for(let n=1;n<T;n++,e+=3)B[e]=c,B[e+1]=c+n,B[e+2]=c+n+1;c+=T+1}}}}clip(t,e,i,s,n,a,o,r){let l,h=r,c=!1;o.length%4>=2?(l=r,r=this.scratch):l=this.scratch,l.length=0,l.push(t),l.push(e),l.push(i),l.push(s),l.push(n),l.push(a),l.push(t),l.push(e),r.length=0;let d=o.length-4,u=o;for(let m=0;;m+=2){let t=u[m],e=u[m+1],i=t-u[m+2],s=e-u[m+3],n=r.length,a=l;for(let h=0,d=l.length-2;h<d;){let n=a[h],o=a[h+1];h+=2;let l=a[h],d=a[h+1],u=s*(t-l)>i*(e-d),m=s*(t-n)-i*(e-o);if(m>0){if(u){r.push(l),r.push(d);continue}let t=l-n,e=d-o,a=m/(t*s-e*i);if(!(a>=0&&a<=1)){r.push(l),r.push(d);continue}r.push(n+t*a),r.push(o+e*a)}else if(u){let t=l-n,e=d-o,a=m/(t*s-e*i);if(!(a>=0&&a<=1)){r.push(l),r.push(d);continue}r.push(n+t*a),r.push(o+e*a),r.push(l),r.push(d)}c=!0}if(n==r.length)return h.length=0,!0;if(r.push(r[0]),r.push(r[1]),m==d)break;let o=r;(r=l).length=0,l=o}if(h!=r){h.length=0;for(let t=0,e=r.length-2;t<e;t++)h[t]=r[t]}else h.length=h.length-2;return c}static makeClockwise(t){let e=t,i=t.length,s=e[i-2]*e[1]-e[0]*e[i-1],n=0,a=0,o=0,r=0;for(let l=0,h=i-3;l<h;l+=2)n=e[l],a=e[l+1],o=e[l+2],r=e[l+3],s+=n*r-o*a;if(!(s<0))for(let l=0,h=i-2,c=i>>1;l<c;l+=2){let t=e[l],i=e[l+1],s=h-l;e[l]=e[s],e[l+1]=e[s+1],e[s]=t,e[s+1]=i}}}class ps{constructor(t){s(this,"attachmentLoader"),s(this,"scale",1),s(this,"linkedMeshes",new Array),this.attachmentLoader=t}readSkeletonData(t){var e,i;let s=this.scale,n=new Si,a="string"==typeof t?JSON.parse(t):t,o=a.skeleton;if(o&&(n.hash=o.hash,n.version=o.spine,n.x=o.x,n.y=o.y,n.width=o.width,n.height=o.height,n.referenceScale=Ss(o,"referenceScale",100)*s,n.fps=o.fps,n.imagesPath=null!=(e=o.images)?e:null,n.audioPath=null!=(i=o.audio)?i:null),a.bones)for(let r=0;r<a.bones.length;r++){let t=a.bones[r],e=null,i=Ss(t,"parent",null);i&&(e=n.findBone(i));let o=new $e(n.bones.length,t.name,e);o.length=Ss(t,"length",0)*s,o.x=Ss(t,"x",0)*s,o.y=Ss(t,"y",0)*s,o.rotation=Ss(t,"rotation",0),o.scaleX=Ss(t,"scaleX",1),o.scaleY=Ss(t,"scaleY",1),o.shearX=Ss(t,"shearX",0),o.shearY=Ss(t,"shearY",0),o.inherit=lt.enumValue(ze,Ss(t,"inherit","Normal")),o.skinRequired=Ss(t,"skin",!1);let l=Ss(t,"color",null);l&&o.color.setFromString(l),n.bones.push(o)}if(a.slots)for(let r=0;r<a.slots.length;r++){let t=a.slots[r],e=t.name,i=n.findBone(t.bone);if(!i)throw new Error(`Couldn't find bone ${t.bone} for slot ${e}`);let s=new vi(n.slots.length,e,i),o=Ss(t,"color",null);o&&s.color.setFromString(o);let l=Ss(t,"dark",null);l&&(s.darkColor=nt.fromString(l)),s.attachmentName=Ss(t,"attachment",null),s.blendMode=lt.enumValue(fi,Ss(t,"blend","normal")),s.visible=Ss(t,"visible",!0),n.slots.push(s)}if(a.ik)for(let r=0;r<a.ik.length;r++){let t=a.ik[r],e=new oi(t.name);e.order=Ss(t,"order",0),e.skinRequired=Ss(t,"skin",!1);for(let s=0;s<t.bones.length;s++){let i=n.findBone(t.bones[s]);if(!i)throw new Error(`Couldn't find bone ${t.bones[s]} for IK constraint ${t.name}.`);e.bones.push(i)}let i=n.findBone(t.target);if(!i)throw new Error(`Couldn't find target bone ${t.target} for IK constraint ${t.name}.`);e.target=i,e.mix=Ss(t,"mix",1),e.softness=Ss(t,"softness",0)*s,e.bendDirection=Ss(t,"bendPositive",!0)?1:-1,e.compress=Ss(t,"compress",!1),e.stretch=Ss(t,"stretch",!1),e.uniform=Ss(t,"uniform",!1),n.ikConstraints.push(e)}if(a.transform)for(let r=0;r<a.transform.length;r++){let t=a.transform[r],e=new Ti(t.name);e.order=Ss(t,"order",0),e.skinRequired=Ss(t,"skin",!1);for(let s=0;s<t.bones.length;s++){let i=t.bones[s],a=n.findBone(i);if(!a)throw new Error(`Couldn't find bone ${i} for transform constraint ${t.name}.`);e.bones.push(a)}let i=t.target,o=n.findBone(i);if(!o)throw new Error(`Couldn't find target bone ${i} for transform constraint ${t.name}.`);e.target=o,e.local=Ss(t,"local",!1),e.relative=Ss(t,"relative",!1),e.offsetRotation=Ss(t,"rotation",0),e.offsetX=Ss(t,"x",0)*s,e.offsetY=Ss(t,"y",0)*s,e.offsetScaleX=Ss(t,"scaleX",0),e.offsetScaleY=Ss(t,"scaleY",0),e.offsetShearY=Ss(t,"shearY",0),e.mixRotate=Ss(t,"mixRotate",1),e.mixX=Ss(t,"mixX",1),e.mixY=Ss(t,"mixY",e.mixX),e.mixScaleX=Ss(t,"mixScaleX",1),e.mixScaleY=Ss(t,"mixScaleY",e.mixScaleX),e.mixShearY=Ss(t,"mixShearY",1),n.transformConstraints.push(e)}if(a.path)for(let r=0;r<a.path.length;r++){let t=a.path[r],e=new ri(t.name);e.order=Ss(t,"order",0),e.skinRequired=Ss(t,"skin",!1);for(let s=0;s<t.bones.length;s++){let i=t.bones[s],a=n.findBone(i);if(!a)throw new Error(`Couldn't find bone ${i} for path constraint ${t.name}.`);e.bones.push(a)}let i=t.target,o=n.findSlot(i);if(!o)throw new Error(`Couldn't find target slot ${i} for path constraint ${t.name}.`);e.target=o,e.positionMode=lt.enumValue(je,Ss(t,"positionMode","Percent")),e.spacingMode=lt.enumValue(Ze,Ss(t,"spacingMode","Length")),e.rotateMode=lt.enumValue(Je,Ss(t,"rotateMode","Tangent")),e.offsetRotation=Ss(t,"rotation",0),e.position=Ss(t,"position",0),e.positionMode==je.Fixed&&(e.position*=s),e.spacing=Ss(t,"spacing",0),e.spacingMode!=Ze.Length&&e.spacingMode!=Ze.Fixed||(e.spacing*=s),e.mixRotate=Ss(t,"mixRotate",1),e.mixX=Ss(t,"mixX",1),e.mixY=Ss(t,"mixY",e.mixX),n.pathConstraints.push(e)}if(a.physics)for(let r=0;r<a.physics.length;r++){const t=a.physics[r],e=new wi(t.name);e.order=Ss(t,"order",0),e.skinRequired=Ss(t,"skin",!1);const i=t.bone,o=n.findBone(i);if(null==o)throw new Error("Physics bone not found: "+i);e.bone=o,e.x=Ss(t,"x",0),e.y=Ss(t,"y",0),e.rotate=Ss(t,"rotate",0),e.scaleX=Ss(t,"scaleX",0),e.shearX=Ss(t,"shearX",0),e.limit=Ss(t,"limit",5e3)*s,e.step=1/Ss(t,"fps",60),e.inertia=Ss(t,"inertia",1),e.strength=Ss(t,"strength",100),e.damping=Ss(t,"damping",1),e.massInverse=1/Ss(t,"mass",1),e.wind=Ss(t,"wind",0),e.gravity=Ss(t,"gravity",0),e.mix=Ss(t,"mix",1),e.inertiaGlobal=Ss(t,"inertiaGlobal",!1),e.strengthGlobal=Ss(t,"strengthGlobal",!1),e.dampingGlobal=Ss(t,"dampingGlobal",!1),e.massGlobal=Ss(t,"massGlobal",!1),e.windGlobal=Ss(t,"windGlobal",!1),e.gravityGlobal=Ss(t,"gravityGlobal",!1),e.mixGlobal=Ss(t,"mixGlobal",!1),n.physicsConstraints.push(e)}if(a.skins)for(let r=0;r<a.skins.length;r++){let t=a.skins[r],e=new Fi(t.name);if(t.bones)for(let i=0;i<t.bones.length;i++){let s=t.bones[i],a=n.findBone(s);if(!a)throw new Error(`Couldn't find bone ${s} for skin ${t.name}.`);e.bones.push(a)}if(t.ik)for(let i=0;i<t.ik.length;i++){let s=t.ik[i],a=n.findIkConstraint(s);if(!a)throw new Error(`Couldn't find IK constraint ${s} for skin ${t.name}.`);e.constraints.push(a)}if(t.transform)for(let i=0;i<t.transform.length;i++){let s=t.transform[i],a=n.findTransformConstraint(s);if(!a)throw new Error(`Couldn't find transform constraint ${s} for skin ${t.name}.`);e.constraints.push(a)}if(t.path)for(let i=0;i<t.path.length;i++){let s=t.path[i],a=n.findPathConstraint(s);if(!a)throw new Error(`Couldn't find path constraint ${s} for skin ${t.name}.`);e.constraints.push(a)}if(t.physics)for(let i=0;i<t.physics.length;i++){let s=t.physics[i],a=n.findPhysicsConstraint(s);if(!a)throw new Error(`Couldn't find physics constraint ${s} for skin ${t.name}.`);e.constraints.push(a)}for(let i in t.attachments){let s=n.findSlot(i);if(!s)throw new Error(`Couldn't find slot ${i} for skin ${t.name}.`);let a=t.attachments[i];for(let t in a){let i=this.readAttachment(a[t],e,s.index,t,n);i&&e.setAttachment(s.index,t,i)}}n.skins.push(e),"default"==e.name&&(n.defaultSkin=e)}for(let r=0,l=this.linkedMeshes.length;r<l;r++){let t=this.linkedMeshes[r],e=t.skin?n.findSkin(t.skin):n.defaultSkin;if(!e)throw new Error(`Skin not found: ${t.skin}`);let i=e.getAttachment(t.slotIndex,t.parent);if(!i)throw new Error(`Parent mesh not found: ${t.parent}`);t.mesh.timelineAttachment=t.inheritTimeline?i:t.mesh,t.mesh.setParentMesh(i),null!=t.mesh.region&&t.mesh.updateRegion()}if(this.linkedMeshes.length=0,a.events)for(let r in a.events){let t=a.events[r],e=new ni(r);e.intValue=Ss(t,"int",0),e.floatValue=Ss(t,"float",0),e.stringValue=Ss(t,"string",""),e.audioPath=Ss(t,"audio",null),e.audioPath&&(e.volume=Ss(t,"volume",1),e.balance=Ss(t,"balance",0)),n.events.push(e)}if(a.animations)for(let r in a.animations){let t=a.animations[r];this.readAnimation(t,r,n)}return n}readAttachment(t,e,i,s,n){let a=this.scale;switch(s=Ss(t,"name",s),Ss(t,"type","region")){case"region":{let i=Ss(t,"path",s),n=this.readSequence(Ss(t,"sequence",null)),o=this.attachmentLoader.newRegionAttachment(e,s,i,n);if(!o)return null;o.path=i,o.x=Ss(t,"x",0)*a,o.y=Ss(t,"y",0)*a,o.scaleX=Ss(t,"scaleX",1),o.scaleY=Ss(t,"scaleY",1),o.rotation=Ss(t,"rotation",0),o.width=t.width*a,o.height=t.height*a,o.sequence=n;let r=Ss(t,"color",null);return r&&o.color.setFromString(r),null!=o.region&&o.updateRegion(),o}case"boundingbox":{let i=this.attachmentLoader.newBoundingBoxAttachment(e,s);if(!i)return null;this.readVertices(t,i,t.vertexCount<<1);let n=Ss(t,"color",null);return n&&i.color.setFromString(n),i}case"mesh":case"linkedmesh":{let n=Ss(t,"path",s),o=this.readSequence(Ss(t,"sequence",null)),r=this.attachmentLoader.newMeshAttachment(e,s,n,o);if(!r)return null;r.path=n;let l=Ss(t,"color",null);l&&r.color.setFromString(l),r.width=Ss(t,"width",0)*a,r.height=Ss(t,"height",0)*a,r.sequence=o;let h=Ss(t,"parent",null);if(h)return this.linkedMeshes.push(new bs(r,Ss(t,"skin",null),i,h,Ss(t,"timelines",!0))),r;let c=t.uvs;return this.readVertices(t,r,c.length),r.triangles=t.triangles,r.regionUVs=c,null!=r.region&&r.updateRegion(),r.edges=Ss(t,"edges",null),r.hullLength=2*Ss(t,"hull",0),r}case"path":{let i=this.attachmentLoader.newPathAttachment(e,s);if(!i)return null;i.closed=Ss(t,"closed",!1),i.constantSpeed=Ss(t,"constantSpeed",!0);let n=t.vertexCount;this.readVertices(t,i,n<<1);let o=lt.newArray(n/3,0);for(let e=0;e<t.lengths.length;e++)o[e]=t.lengths[e]*a;i.lengths=o;let r=Ss(t,"color",null);return r&&i.color.setFromString(r),i}case"point":{let i=this.attachmentLoader.newPointAttachment(e,s);if(!i)return null;i.x=Ss(t,"x",0)*a,i.y=Ss(t,"y",0)*a,i.rotation=Ss(t,"rotation",0);let n=Ss(t,"color",null);return n&&i.color.setFromString(n),i}case"clipping":{let i=this.attachmentLoader.newClippingAttachment(e,s);if(!i)return null;let a=Ss(t,"end",null);a&&(i.endSlot=n.findSlot(a));let o=t.vertexCount;this.readVertices(t,i,o<<1);let r=Ss(t,"color",null);return r&&i.color.setFromString(r),i}}return null}readSequence(t){if(null==t)return null;let e=new pt(Ss(t,"count",0));return e.start=Ss(t,"start",1),e.digits=Ss(t,"digits",0),e.setupIndex=Ss(t,"setup",0),e}readVertices(t,e,i){let s=this.scale;e.worldVerticesLength=i;let n=t.vertices;if(i==n.length){let t=lt.toFloatArray(n);if(1!=s)for(let e=0,i=n.length;e<i;e++)t[e]*=s;return void(e.vertices=t)}let a=new Array,o=new Array;for(let r=0,l=n.length;r<l;){let t=n[r++];o.push(t);for(let e=r+4*t;r<e;r+=4)o.push(n[r]),a.push(n[r+1]*s),a.push(n[r+2]*s),a.push(n[r+3])}e.bones=o,e.vertices=lt.toFloatArray(a)}readAnimation(t,e,i){let s=this.scale,n=new Array;if(t.slots)for(let o in t.slots){let e=t.slots[o],s=i.findSlot(o);if(!s)throw new Error("Slot not found: "+o);let a=s.index;for(let t in e){let i=e[t];if(!i)continue;let s=i.length;if("attachment"==t){let t=new Ut(s,a);for(let e=0;e<s;e++){let s=i[e];t.setFrame(e,Ss(s,"time",0),Ss(s,"name",null))}n.push(t)}else if("rgba"==t){let t=new Vt(s,s<<2,a),e=i[0],o=Ss(e,"time",0),r=nt.fromString(e.color);for(let s=0,n=0;;s++){t.setFrame(s,o,r.r,r.g,r.b,r.a);let a=i[s+1];if(!a){t.shrink(n);break}let l=Ss(a,"time",0),h=nt.fromString(a.color),c=e.curve;c&&(n=ws(c,t,n,s,0,o,l,r.r,h.r,1),n=ws(c,t,n,s,1,o,l,r.g,h.g,1),n=ws(c,t,n,s,2,o,l,r.b,h.b,1),n=ws(c,t,n,s,3,o,l,r.a,h.a,1)),o=l,r=h,e=a}n.push(t)}else if("rgb"==t){let t=new Yt(s,3*s,a),e=i[0],o=Ss(e,"time",0),r=nt.fromString(e.color);for(let s=0,n=0;;s++){t.setFrame(s,o,r.r,r.g,r.b);let a=i[s+1];if(!a){t.shrink(n);break}let l=Ss(a,"time",0),h=nt.fromString(a.color),c=e.curve;c&&(n=ws(c,t,n,s,0,o,l,r.r,h.r,1),n=ws(c,t,n,s,1,o,l,r.g,h.g,1),n=ws(c,t,n,s,2,o,l,r.b,h.b,1)),o=l,r=h,e=a}n.push(t)}else if("alpha"==t)n.push(fs(i,new Xt(s,s,a),0,1));else if("rgba2"==t){let t=new Gt(s,7*s,a),e=i[0],o=Ss(e,"time",0),r=nt.fromString(e.light),l=nt.fromString(e.dark);for(let s=0,n=0;;s++){t.setFrame(s,o,r.r,r.g,r.b,r.a,l.r,l.g,l.b);let a=i[s+1];if(!a){t.shrink(n);break}let h=Ss(a,"time",0),c=nt.fromString(a.light),d=nt.fromString(a.dark),u=e.curve;u&&(n=ws(u,t,n,s,0,o,h,r.r,c.r,1),n=ws(u,t,n,s,1,o,h,r.g,c.g,1),n=ws(u,t,n,s,2,o,h,r.b,c.b,1),n=ws(u,t,n,s,3,o,h,r.a,c.a,1),n=ws(u,t,n,s,4,o,h,l.r,d.r,1),n=ws(u,t,n,s,5,o,h,l.g,d.g,1),n=ws(u,t,n,s,6,o,h,l.b,d.b,1)),o=h,r=c,l=d,e=a}n.push(t)}else if("rgb2"==t){let t=new Ht(s,6*s,a),e=i[0],o=Ss(e,"time",0),r=nt.fromString(e.light),l=nt.fromString(e.dark);for(let s=0,n=0;;s++){t.setFrame(s,o,r.r,r.g,r.b,l.r,l.g,l.b);let a=i[s+1];if(!a){t.shrink(n);break}let h=Ss(a,"time",0),c=nt.fromString(a.light),d=nt.fromString(a.dark),u=e.curve;u&&(n=ws(u,t,n,s,0,o,h,r.r,c.r,1),n=ws(u,t,n,s,1,o,h,r.g,c.g,1),n=ws(u,t,n,s,2,o,h,r.b,c.b,1),n=ws(u,t,n,s,3,o,h,l.r,d.r,1),n=ws(u,t,n,s,4,o,h,l.g,d.g,1),n=ws(u,t,n,s,5,o,h,l.b,d.b,1)),o=h,r=c,l=d,e=a}n.push(t)}}}if(t.bones)for(let o in t.bones){let e=t.bones[o],a=i.findBone(o);if(!a)throw new Error("Bone not found: "+o);let r=a.index;for(let t in e){let i=e[t],o=i.length;if(0!=o)if("rotate"===t)n.push(fs(i,new Pt(o,o,r),0,1));else if("translate"===t){let t=new It(o,o<<1,r);n.push(ys(i,t,"x","y",0,s))}else if("translatex"===t){let t=new Et(o,o,r);n.push(fs(i,t,0,s))}else if("translatey"===t){let t=new Dt(o,o,r);n.push(fs(i,t,0,s))}else if("scale"===t){let t=new Rt(o,o<<1,r);n.push(ys(i,t,"x","y",1,1))}else if("scalex"===t){let t=new _t(o,o,r);n.push(fs(i,t,1,1))}else if("scaley"===t){let t=new Wt(o,o,r);n.push(fs(i,t,1,1))}else if("shear"===t){let t=new Lt(o,o<<1,r);n.push(ys(i,t,"x","y",0,1))}else if("shearx"===t){let t=new Ot(o,o,r);n.push(fs(i,t,0,1))}else if("sheary"===t){let t=new kt(o,o,r);n.push(fs(i,t,0,1))}else if("inherit"===t){let t=new Nt(o,a.index);for(let e=0;e<i.length;e++){let s=i[e];t.setFrame(e,Ss(s,"time",0),lt.enumValue(ze,Ss(s,"inherit","Normal")))}n.push(t)}}}if(t.ik)for(let o in t.ik){let e=t.ik[o],a=e[0];if(!a)continue;let r=i.findIkConstraint(o);if(!r)throw new Error("IK Constraint not found: "+o);let l=i.ikConstraints.indexOf(r),h=new Zt(e.length,e.length<<1,l),c=Ss(a,"time",0),d=Ss(a,"mix",1),u=Ss(a,"softness",0)*s;for(let t=0,i=0;;t++){h.setFrame(t,c,d,u,Ss(a,"bendPositive",!0)?1:-1,Ss(a,"compress",!1),Ss(a,"stretch",!1));let n=e[t+1];if(!n){h.shrink(i);break}let o=Ss(n,"time",0),r=Ss(n,"mix",1),l=Ss(n,"softness",0)*s,m=a.curve;m&&(i=ws(m,h,i,t,0,c,o,d,r,1),i=ws(m,h,i,t,1,c,o,u,l,s)),c=o,d=r,u=l,a=n}n.push(h)}if(t.transform)for(let o in t.transform){let e=t.transform[o],s=e[0];if(!s)continue;let a=i.findTransformConstraint(o);if(!a)throw new Error("Transform constraint not found: "+o);let r=i.transformConstraints.indexOf(a),l=new Kt(e.length,6*e.length,r),h=Ss(s,"time",0),c=Ss(s,"mixRotate",1),d=Ss(s,"mixX",1),u=Ss(s,"mixY",d),m=Ss(s,"mixScaleX",1),g=Ss(s,"mixScaleY",m),p=Ss(s,"mixShearY",1);for(let t=0,i=0;;t++){l.setFrame(t,h,c,d,u,m,g,p);let n=e[t+1];if(!n){l.shrink(i);break}let a=Ss(n,"time",0),o=Ss(n,"mixRotate",1),r=Ss(n,"mixX",1),b=Ss(n,"mixY",r),f=Ss(n,"mixScaleX",1),y=Ss(n,"mixScaleY",f),w=Ss(n,"mixShearY",1),S=s.curve;S&&(i=ws(S,l,i,t,0,h,a,c,o,1),i=ws(S,l,i,t,1,h,a,d,r,1),i=ws(S,l,i,t,2,h,a,u,b,1),i=ws(S,l,i,t,3,h,a,m,f,1),i=ws(S,l,i,t,4,h,a,g,y,1),i=ws(S,l,i,t,5,h,a,p,w,1)),h=a,c=o,d=r,u=b,m=f,g=y,m=f,s=n}n.push(l)}if(t.path)for(let o in t.path){let e=t.path[o],a=i.findPathConstraint(o);if(!a)throw new Error("Path constraint not found: "+o);let r=i.pathConstraints.indexOf(a);for(let t in e){let i=e[t],o=i[0];if(!o)continue;let l=i.length;if("position"===t){let t=new Jt(l,l,r);n.push(fs(i,t,0,a.positionMode==je.Fixed?s:1))}else if("spacing"===t){let t=new te(l,l,r);n.push(fs(i,t,0,a.spacingMode==Ze.Length||a.spacingMode==Ze.Fixed?s:1))}else if("mix"===t){let t=new ee(l,3*l,r),e=Ss(o,"time",0),s=Ss(o,"mixRotate",1),a=Ss(o,"mixX",1),h=Ss(o,"mixY",a);for(let n=0,r=0;;n++){t.setFrame(n,e,s,a,h);let l=i[n+1];if(!l){t.shrink(r);break}let c=Ss(l,"time",0),d=Ss(l,"mixRotate",1),u=Ss(l,"mixX",1),m=Ss(l,"mixY",u),g=o.curve;g&&(r=ws(g,t,r,n,0,e,c,s,d,1),r=ws(g,t,r,n,1,e,c,a,u,1),r=ws(g,t,r,n,2,e,c,h,m,1)),e=c,s=d,a=u,h=m,o=l}n.push(t)}}}if(t.physics)for(let o in t.physics){let e=t.physics[o],s=-1;if(o.length>0){let t=i.findPhysicsConstraint(o);if(!t)throw new Error("Physics constraint not found: "+o);s=i.physicsConstraints.indexOf(t)}for(let t in e){let i=e[t],a=i[0];if(!a)continue;let o,r=i.length;if("reset"!=t){if("inertia"==t)o=new se(r,r,s);else if("strength"==t)o=new ne(r,r,s);else if("damping"==t)o=new ae(r,r,s);else if("mass"==t)o=new oe(r,r,s);else if("wind"==t)o=new re(r,r,s);else if("gravity"==t)o=new le(r,r,s);else{if("mix"!=t)continue;o=new he(r,r,s)}n.push(fs(i,o,0,1))}else{const t=new de(r,s);for(let e=0;null!=a;a=i[e+1],e++)t.setFrame(e,Ss(a,"time",0));n.push(t)}}}if(t.attachments)for(let o in t.attachments){let e=t.attachments[o],a=i.findSkin(o);if(!a)throw new Error("Skin not found: "+o);for(let t in e){let o=e[t],r=i.findSlot(t);if(!r)throw new Error("Slot not found: "+t);let l=r.index;for(let t in o){let e=o[t],i=a.getAttachment(l,t);for(let t in e){let a=e[t],o=a[0];if(o)if("deform"==t){let t=i.bones,e=i.vertices,r=t?e.length/3*2:e.length,h=new $t(a.length,a.length,l,i),c=Ss(o,"time",0);for(let i=0,n=0;;i++){let l,d=Ss(o,"vertices",null);if(d){l=lt.newFloatArray(r);let i=Ss(o,"offset",0);if(lt.arrayCopy(d,0,l,i,d.length),1!=s)for(let t=i,e=t+d.length;t<e;t++)l[t]*=s;if(!t)for(let t=0;t<r;t++)l[t]+=e[t]}else l=t?lt.newFloatArray(r):e;h.setFrame(i,c,l);let u=a[i+1];if(!u){h.shrink(n);break}let m=Ss(u,"time",0),g=o.curve;g&&(n=ws(g,h,n,i,0,c,m,0,1,1)),c=m,o=u}n.push(h)}else if("sequence"==t){let t=new me(a.length,l,i),e=0;for(let i=0;i<a.length;i++){let s=Ss(o,"delay",e),n=Ss(o,"time",0),r=bt[Ss(o,"mode","hold")],l=Ss(o,"index",0);t.setFrame(i,n,r,l,s),e=s,o=a[i+1]}n.push(t)}}}}}if(t.drawOrder){let e=new Qt(t.drawOrder.length),s=i.slots.length,a=0;for(let n=0;n<t.drawOrder.length;n++,a++){let o=t.drawOrder[n],r=null,l=Ss(o,"offsets",null);if(l){r=lt.newArray(s,-1);let t=lt.newArray(s-l.length,0),e=0,n=0;for(let s=0;s<l.length;s++){let a=l[s],o=i.findSlot(a.slot);if(!o)throw new Error("Slot not found: "+o);let h=o.index;for(;e!=h;)t[n++]=e++;r[e+a.offset]=e++}for(;e<s;)t[n++]=e++;for(let i=s-1;i>=0;i--)-1==r[i]&&(r[i]=t[--n])}e.setFrame(a,Ss(o,"time",0),r)}n.push(e)}if(t.events){let e=new qt(t.events.length),s=0;for(let n=0;n<t.events.length;n++,s++){let a=t.events[n],o=i.findEvent(a.name);if(!o)throw new Error("Event not found: "+a.name);let r=new si(lt.toSinglePrecision(Ss(a,"time",0)),o);r.intValue=Ss(a,"int",o.intValue),r.floatValue=Ss(a,"float",o.floatValue),r.stringValue=Ss(a,"string",o.stringValue),r.data.audioPath&&(r.volume=Ss(a,"volume",1),r.balance=Ss(a,"balance",0)),e.setFrame(s,r)}n.push(e)}let a=0;for(let o=0,r=n.length;o<r;o++)a=Math.max(a,n[o].getDuration());i.animations.push(new wt(e,n,a))}}class bs{constructor(t,e,i,n,a){s(this,"parent"),s(this,"skin"),s(this,"slotIndex"),s(this,"mesh"),s(this,"inheritTimeline"),this.mesh=t,this.skin=e,this.slotIndex=i,this.parent=n,this.inheritTimeline=a}}function fs(t,e,i,s){let n=t[0],a=Ss(n,"time",0),o=Ss(n,"value",i)*s,r=0;for(let l=0;;l++){e.setFrame(l,a,o);let h=t[l+1];if(!h)return e.shrink(r),e;let c=Ss(h,"time",0),d=Ss(h,"value",i)*s;n.curve&&(r=ws(n.curve,e,r,l,0,a,c,o,d,s)),a=c,o=d,n=h}}function ys(t,e,i,s,n,a){let o=t[0],r=Ss(o,"time",0),l=Ss(o,i,n)*a,h=Ss(o,s,n)*a,c=0;for(let d=0;;d++){e.setFrame(d,r,l,h);let u=t[d+1];if(!u)return e.shrink(c),e;let m=Ss(u,"time",0),g=Ss(u,i,n)*a,p=Ss(u,s,n)*a,b=o.curve;b&&(c=ws(b,e,c,d,0,r,m,l,g,a),c=ws(b,e,c,d,1,r,m,h,p,a)),r=m,l=g,h=p,o=u}}function ws(t,e,i,s,n,a,o,r,l,h){if("stepped"==t)return e.setStepped(s),i;let c=n<<2,d=t[c],u=t[c+1]*h,m=t[c+2],g=t[c+3]*h;return e.setBezier(i,s,n,a,r,d,u,m,g,o,l),i+1}function Ss(t,e,i){return void 0!==t[e]?t[e]:i}void 0===Math.fround&&(Math.fround=function(t){return function(e){return t[0]=e,t[0]}}(new Float32Array(1)));class xs extends Phaser.GameObjects.GameObject{constructor(t,e){super(t,e)}}class Fs{constructor(t=!1){s(this,"clipping"),this.clipping=t}calculateBounds(t){if(!t.skeleton)return{x:0,y:0,width:0,height:0};const e=new gi(t.skeleton.data);e.setToSetupPose(),e.updateWorldTransform(pi.update);const i=e.getBoundsRect(this.clipping?new gs:void 0);return i.width==Number.NEGATIVE_INFINITY?{x:0,y:0,width:0,height:0}:i}}class vs extends(j(tt(q(Q(Z(K(J(et(xs))))))))){constructor(t,e,i,n,a,o,r=new Fs){super(t,window.SPINE_GAME_OBJECT_TYPE?window.SPINE_GAME_OBJECT_TYPE:O),s(this,"plugin"),s(this,"boundsProvider"),s(this,"blendMode",-1),s(this,"skeleton"),s(this,"animationStateData"),s(this,"animationState"),s(this,"beforeUpdateWorldTransforms",(()=>{})),s(this,"afterUpdateWorldTransforms",(()=>{})),s(this,"premultipliedAlpha",!1),s(this,"offsetX",0),s(this,"offsetY",0),this.plugin=e,this.boundsProvider=r,this.setPosition(i,n),this.premultipliedAlpha=this.plugin.isAtlasPremultiplied(o),this.skeleton=this.plugin.createSkeleton(a,o),this.animationStateData=new Ce(this.skeleton.data),this.animationState=new pe(this.animationStateData),this.skeleton.updateWorldTransform(pi.update),this.updateSize()}updateSize(){if(!this.skeleton)return;let t=this.boundsProvider.calculateBounds(this);this.width=t.width,this.height=t.height,this.setDisplayOrigin(-t.x,-t.y),this.offsetX=-t.x,this.offsetY=-t.y}skeletonToPhaserWorldCoordinates(t){let e=this.getWorldTransformMatrix(),i=e.a,s=e.b,n=e.c,a=e.d,o=e.tx,r=e.ty,l=t.x,h=t.y;t.x=l*i+h*n+o,t.y=l*s+h*a+r}phaserWorldCoordinatesToSkeleton(t){let e=this.getWorldTransformMatrix();e=e.invert();let i=e.a,s=e.b,n=e.c,a=e.d,o=e.tx,r=e.ty,l=t.x,h=t.y;t.x=l*i+h*n+o,t.y=l*s+h*a+r}phaserWorldCoordinatesToBone(t,e){this.phaserWorldCoordinatesToSkeleton(t),e.parent?e.parent.worldToLocal(t):e.worldToLocal(t)}updatePose(t){this.animationState.update(t/1e3),this.animationState.apply(this.skeleton),this.beforeUpdateWorldTransforms(this),this.skeleton.update(t/1e3),this.skeleton.updateWorldTransform(pi.update),this.afterUpdateWorldTransforms(this)}preUpdate(t,e){this.skeleton&&this.animationState&&this.updatePose(e)}preDestroy(){}willRender(t){var e=!this.skeleton||!(15!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id);if(this.visible||(e=!1),!e&&this.parentContainer&&this.plugin.webGLRenderer){var i=this.plugin.webGLRenderer;this.plugin.gl&&this.plugin.phaserRenderer instanceof Phaser.Renderer.WebGL.WebGLRenderer&&i.batcher.isDrawing&&(i.end(),this.plugin.phaserRenderer.pipelines.rebind())}return e}renderWebGL(t,e,i,s){if(!this.skeleton||!this.animationState||!this.plugin.webGLRenderer)return;let n=this.plugin.webGLRenderer;t.newType&&(t.pipelines.clear(),n.begin()),i.addToRenderList(e);let a=Phaser.GameObjects.GetCalcMatrix(e,i,s).calc,o=a.a,r=a.b,l=a.c,h=a.d,c=a.tx,d=a.ty,u=e.offsetX-e.displayOriginX,m=e.offsetY-e.displayOriginY;n.drawSkeleton(e.skeleton,e.premultipliedAlpha,-1,-1,((t,e,i)=>{for(let s=0;s<e;s+=i){let e=t[s]+u,i=t[s+1]+m;t[s]=e*o+i*l+c,t[s+1]=e*r+i*h+d}})),t.nextTypeMatch||(n.end(),t.pipelines.rebind())}renderCanvas(t,e,i,s){if(!this.skeleton||!this.animationState||!this.plugin.canvasRenderer)return;let n=t.currentContext,a=this.plugin.canvasRenderer;a.ctx=n,i.addToRenderList(e);let o=Phaser.GameObjects.GetCalcMatrix(e,i,s).calc,r=this.skeleton;r.x=o.tx,r.y=o.ty,r.scaleX=o.scaleX,r.scaleY=o.scaleY,r.getRootBone().rotation=-57.29577866666166*o.rotationNormalized,this.skeleton.updateWorldTransform(pi.update),n.save(),a.draw(r),n.restore()}}class Ts{constructor(t,e){s(this,"scene"),s(this,"container"),s(this,"winAnimation"),s(this,"winText"),s(this,"winText_x",0),s(this,"winText_y",20),s(this,"freeSpinsText"),s(this,"buttonText"),s(this,"winAnim"),s(this,"isActive",!1),s(this,"isAnimating",!1),s(this,"multiplier",0),s(this,"isMobile",!1),s(this,"buttonZone"),s(this,"skipOnce",[!1,!1,!1,!1,!1]),s(this,"onSpaceDown"),s(this,"inputLocked",!1),s(this,"currentWinType"),s(this,"delaySkipMS",100),s(this,"currentCount",0),s(this,"targetCount",0),s(this,"countInterval"),s(this,"isCounting",!1),s(this,"finalBetTotal",0),s(this,"currentAnimationPhase","bigwin"),s(this,"skipIdleAnimation",!1),s(this,"isIntroPlaying",!1),this.scene=t,this.isMobile=this.isMobileDevice(),this.winAnimation=e,this.container=t.add.container(0,0),this.container.setDepth(1e4),this.container.setScale(this.isMobile?.5:1),this.createOverlay()}isMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768}resetSkipOnce(){this.skipOnce=[!1,!1,!1,!1,!1]}createOverlay(){const t=this.scene.add.graphics();t.fillStyle(0,.7),t.fillRect(0,0,2*this.scene.scale.width,2*this.scene.scale.height),this.container.add(t);const e=this.scene.add.container(this.isMobile?this.scene.scale.width:.55*this.scene.scale.width,this.isMobile?this.scene.scale.height:.55*this.scene.scale.height);this.container.add(e),this.winAnim=this.scene.add.spine(0,0,"myWinAnim2","myWinAnim2"),this.winAnim.setScale((this.isMobile,1)),this.winAnim.setOrigin(this.isMobile?.475:.5,(this.isMobile,.5)),this.winAnim.name="winAnim",e.add(this.winAnim),this.winText=this.scene.add.text(0,0,"0.00",{fontSize:"128px",color:"#FFD700",fontFamily:"Poppins",fontStyle:"bold",align:"center",stroke:"#FF0000",strokeThickness:10,shadow:{offsetX:0,offsetY:0,color:"#FFFFFF",blur:20,stroke:!0,fill:!1}}),this.winText.setOrigin(.5),this.winText.alpha=1,this.winText.setScale(.5),e.add(this.winText),this.freeSpinsText=this.scene.add.text(0,0,"0.00",{fontSize:"84px",color:"#FFD700",fontFamily:"Poppins",fontStyle:"bold",align:"center",stroke:"#FF0000",strokeThickness:6,shadow:{offsetX:0,offsetY:0,color:"#FFFFFF",blur:10,stroke:!0,fill:!1}}),this.freeSpinsText.setOrigin(.5),this.freeSpinsText.visible=!1,this.freeSpinsText.setPosition(this.isMobile?-110:-150,95),e.add(this.freeSpinsText),this.buttonText=this.scene.add.text(this.isMobile?0:-50,this.winText_y+150,"Press anywhere to continue",{fontSize:"40px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold",align:"center",stroke:"#379557",strokeThickness:6,shadow:{offsetX:0,offsetY:0,color:"#000000",blur:10,stroke:!0,fill:!1}}),this.buttonText.setOrigin(.5,1),e.add(this.buttonText);const i=this.scene.add.zone(0,0,this.scene.scale.width,this.scene.scale.height);this.buttonZone=i,i.setInteractive(new Phaser.Geom.Rectangle(0,0,2*this.scene.scale.width,2*this.scene.scale.height),Phaser.Geom.Rectangle.Contains),e.add(i),this.setupEventListeners()}setupEventListeners(){r.emitter.on(r.WIN_OVERLAY_UPDATE_TOTAL_WIN,((t,e)=>{if("FreeSpin"===this.currentWinType)return this.winText.setPosition(this.isMobile?0:-60,-60),this.winText.setText(`${t.toFixed(0)}`),void(this.freeSpinsText.visible=!1);"Congrats"===e?(this.winText.setPosition(this.isMobile?0:-60,-60),this.winText.setText(`${t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),this.winText.setScale(this.isMobile?.75:1),this.freeSpinsText.visible=!0,this.freeSpinsText.setText(`${this.scene.gameData.totalFreeSpins.toFixed(0)}`)):"FreeSpin"===e?(this.winText.setPosition(this.isMobile?0:-60,-60),this.winText.setText(`${t.toFixed(0)}`),this.freeSpinsText.visible=!1):(this.startCounting(this.winAnim,t),this.freeSpinsText.visible=!1)})),this.buttonZone.on("pointerdown",(()=>{this.handleSkipInput()})),!this.isMobile&&this.scene.input.keyboard&&(this.onSpaceDown=()=>{this.handleSkipInput()},this.scene.input.keyboard.on("keydown-SPACE",this.onSpaceDown))}async show(t,e){var i,s,n;if(this.isAnimating)return;this.isActive=!0,this.isAnimating=!0,this.currentWinType=e,this.inputLocked=!0,this.scene.time.delayedCall(333,(()=>{this.inputLocked=!1}));let a=["#FFF15A","#FFD000","#FFB400"];const o=this.winText.context.createLinearGradient(0,0,0,this.winText.height);if(o.addColorStop(0,a[0]),o.addColorStop(.5,a[1]),o.addColorStop(1,a[2]),this.winText.setFill(o),"FreeSpin"===e){this.winText.setPosition(0,-100),this.winText.setText(`${t.toFixed(0)}`),this.winText.setScale(2*this.winText.scale),this.freeSpinsText.visible=!1,this.multiplier=-1,this.playWinSound(t);try{null==(n=null==(s=null==(i=this.scene)?void 0:i.autoplay)?void 0:s.hideRemainingSpinsDisplay)||n.call(s)}catch(l){}this.winAnim&&(this.winAnimation.playWinAnimation(this.winAnim,t,"FreeSpin"),this.winAnim.setPosition(this.winAnim.x,this.winAnim.y+150),this.buttonText.setPosition(this.buttonText.x,this.buttonText.y+75));try{r.emitter.emit(r.FREE_SPIN_OVERLAY_SHOW,t)}catch(l){}}else"Congrats"===e?(this.winText.setPosition(0,-60),this.winText.setText(`${t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),this.freeSpinsText.visible=!0,this.freeSpinsText.setText(`${this.scene.gameData.totalFreeSpins.toFixed(0)}`),this.multiplier=-2,this.playWinSound(-2),this.winAnim&&(this.winAnimation.playWinAnimation(this.winAnim,t,"Congrats"),this.winAnim.setPosition(this.winAnim.x,this.winAnim.y+150),this.buttonText.setPosition(this.buttonText.x,this.buttonText.y+75))):(this.freeSpinsText.visible=!1,this.multiplier=0,this.startCounting(this.winAnim,t));r.emitter.emit(r.WIN_OVERLAY_SHOW),this.isAnimating=!1}playWinSound(t){let e;e=-1===this.multiplier?this.scene.audioManager.FreeSpinW:-2===this.multiplier?this.scene.audioManager.CongratsW:t>=this.scene.gameData.bet*this.scene.gameData.winRank[4]?this.scene.audioManager.SuperW:t>=this.scene.gameData.bet*this.scene.gameData.winRank[3]?this.scene.audioManager.EpicW:t>=this.scene.gameData.bet*this.scene.gameData.winRank[2]?this.scene.audioManager.MegaW:t>=this.scene.gameData.bet*this.scene.gameData.winRank[1]?this.scene.audioManager.BigW:this.scene.audioManager.FreeSpinW,e&&e.play()}destroy(){this.isActive&&(this.scene.slotMachine.activeWinOverlay=!1,this.winAnimation.exitAnimation(),r.emitter.off(r.WIN_OVERLAY_UPDATE_TOTAL_WIN),this.countInterval&&(this.scene.time.removeEvent(this.countInterval),this.countInterval=void 0),this.container.destroy(),this.buttonZone=null,this.isActive=!1,this.isAnimating=!1,this.isIntroPlaying=!1,this.currentWinType=void 0,this.scene.audioManager.stopWinSFX(this.scene),r.emitter.emit(r.WIN_OVERLAY_HIDE),this.onSpaceDown&&this.scene.input.keyboard&&(this.scene.input.keyboard.off("keydown-SPACE",this.onSpaceDown),this.onSpaceDown=void 0))}startCounting(t,e){"FreeSpin"!==this.currentWinType&&-1!==this.multiplier&&(this.winAnim=t,this.finalBetTotal=e,this.multiplier,this.winText.setVisible(!1),this.isMobile||this.winAnim.setPosition(this.winAnim.x,.1*this.scene.scale.height),this.playBigwinIntro())}winTextFadeIn(){var t;null==(t=this.winText)||t.setScale(2),this.scene.tweens.add({targets:this.winText,scale:1,duration:777,ease:"Expo.InOut",onComplete:()=>{var t;null==(t=this.winText)||t.setScale(1)}})}playBigwinIntro(){this.winAnimation&&this.winText&&(this.isIntroPlaying||(this.isIntroPlaying=!0,this.currentAnimationPhase="bigwin_intro",this.winAnim.animationState.setAnimation(0,"BigWin-Intro",!1),this.winText.setPosition(this.winText_x,this.winText_y),this.winTextFadeIn(),this.skipIdleAnimation||setTimeout((()=>{this.scene.audioManager.queueWinSFX(["BigWin"])}),100),setTimeout((()=>{this.isIntroPlaying=!1,this.skipIdleAnimation?(this.skipIdleAnimation=!1,this.handleIntroSkip()):this.playBigwinIdle()}),this.delaySkipMS)))}playBigwinIdle(){if(!this.winAnimation||!this.winText)return;this.currentAnimationPhase="bigwin_idle",this.winAnim.animationState.setAnimation(0,"BigWin-Idle",!0);let t=this.finalBetTotal;this.finalBetTotal-.01>this.scene.gameData.bet*this.scene.gameData.winRank[1]&&(t=this.scene.gameData.bet*this.scene.gameData.winRank[1]),this.startCountUp(t,6e3)}playMegawinIntro(){this.winAnimation&&this.winText&&(this.isIntroPlaying||(this.isIntroPlaying=!0,this.currentAnimationPhase="megawin_intro",this.winAnim.animationState.setAnimation(0,"MegaWin-Intro",!1),this.winText.setPosition(this.winText_x,this.winText_y),this.winTextFadeIn(),this.skipIdleAnimation||(this.scene.audioManager.clearWinSFXQueue(),this.scene.audioManager.queueWinSFX(["MegaWin"])),setTimeout((()=>{this.isIntroPlaying=!1,this.skipIdleAnimation?(this.skipIdleAnimation=!1,this.handleIntroSkip()):this.playMegawinIdle()}),this.delaySkipMS)))}playMegawinIdle(){if(!this.winAnimation||!this.winText)return;this.currentAnimationPhase="megawin_idle",this.winAnim.animationState.setAnimation(0,"MegaWin-Idle",!0);let t=this.finalBetTotal;this.finalBetTotal-.01>this.scene.gameData.bet*this.scene.gameData.winRank[2]&&(t=this.scene.gameData.bet*this.scene.gameData.winRank[2]),this.startCountUp(t,6e3)}playEpicwinIntro(){this.winAnimation&&this.winText&&(this.isIntroPlaying||(this.isIntroPlaying=!0,this.currentAnimationPhase="epicwin_intro",this.winAnim.animationState.setAnimation(0,"EpicWin-Intro",!1),this.winText.setPosition(this.winText_x,this.winText_y),this.winTextFadeIn(),this.skipIdleAnimation||(this.scene.audioManager.clearWinSFXQueue(),this.scene.audioManager.queueWinSFX(["EpicWin"])),setTimeout((()=>{this.isIntroPlaying=!1,this.skipIdleAnimation?(this.skipIdleAnimation=!1,this.handleIntroSkip()):this.playEpicwinIdle()}),this.delaySkipMS)))}playEpicwinIdle(){if(!this.winAnimation||!this.winText)return;this.currentAnimationPhase="epicwin_idle",this.winAnim.animationState.setAnimation(0,"EpicWin-Idle",!0);let t=this.finalBetTotal;this.finalBetTotal-.01>this.scene.gameData.bet*this.scene.gameData.winRank[3]&&(t=this.scene.gameData.bet*this.scene.gameData.winRank[3]),this.startCountUp(t,6e3)}playSuperwinIntro(){this.winAnimation&&this.winText&&(this.isIntroPlaying||(this.isIntroPlaying=!0,this.currentAnimationPhase="superwin_intro",this.winAnim.animationState.setAnimation(0,"SuperWin-Intro",!1),this.winText.setPosition(this.winText_x,this.winText_y),this.winTextFadeIn(),this.skipIdleAnimation||(this.scene.audioManager.clearWinSFXQueue(),this.scene.audioManager.queueWinSFX(["SuperWin"])),setTimeout((()=>{this.isIntroPlaying=!1,this.skipIdleAnimation?(this.skipIdleAnimation=!1,this.handleIntroSkip()):this.playSuperwinIdle()}),this.delaySkipMS)))}playSuperwinIdle(){this.winAnimation&&this.winText&&(this.currentAnimationPhase="superwin_idle",this.winAnim.animationState.setAnimation(0,"SuperWin-Idle",!0),this.startCountUp(this.finalBetTotal,6e3))}startCountUp(t,e){this.targetCount=t;const i=this.currentCount;let s=0;this.isCounting=!0,this.countInterval=this.scene.time.addEvent({delay:8,callback:()=>{if(!this.isCounting)return;s+=8;const t=Math.min(s/e,this.scene.gameData.bet<1?2:2*this.scene.gameData.bet);if(this.currentCount=i+(this.targetCount-i)*t,this.updateWinText(),this.currentCount>=this.targetCount){if(this.currentCount=this.targetCount,this.updateWinText(),this.isCounting=!1,this.countInterval&&this.scene.time.removeEvent(this.countInterval),this.currentCount>=this.finalBetTotal)return void this.handleFinalWin();const t=this.currentCount;t>=this.scene.gameData.bet*this.scene.gameData.winRank[1]&&t<this.scene.gameData.bet*this.scene.gameData.winRank[2]?this.playMegawinIntro():t>=this.scene.gameData.bet*this.scene.gameData.winRank[2]&&t<this.scene.gameData.bet*this.scene.gameData.winRank[3]?this.playEpicwinIntro():t>=this.scene.gameData.bet*this.scene.gameData.winRank[3]&&t<this.finalBetTotal&&this.playSuperwinIntro()}},loop:!0})}updateWinText(){var t;this.winText&&("0.00"==this.winText.text?this.winText.setVisible(!1):this.winText.setVisible(!0),null==(t=this.winText)||t.setText(this.currentCount.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})))}handleSkipInput(){this.inputLocked||(-1===this.multiplier?(this.buttonZone&&this.buttonZone.disableInteractive(!0),this.endWinAnimation((()=>{this.scene.time.delayedCall(200,(()=>{var t,e,i;try{null==(e=null==(t=this.scene.autoplay)?void 0:t.hideRemainingSpinsDisplay)||e.call(t)}catch(s){}this.scene.gameData.useApiFreeSpins&&(null==(i=this.scene.slotMachine)?void 0:i.startApiFreeSpins)?this.scene.slotMachine.startApiFreeSpins(this.scene):this.scene.autoplay.isAutoPlaying||r.emitter.emit(r.AUTOPLAY_START,this.scene.gameData.freeSpins),this.destroy()}))}))):-2===this.multiplier?(this.buttonZone&&this.buttonZone.disableInteractive(!0),this.endWinAnimation((()=>{this.scene.time.delayedCall(200,(()=>{var t;this.scene.background.toggleBackground(this.scene),this.scene.audioManager.changeBackgroundMusic(this.scene);const e=this.scene.gameData.autoplayWasPaused,i=this.scene.gameData.autoplayRemainingSpins||0;e&&i>0?(this.scene.gameData.autoplayWasPaused=!1,this.scene.gameData.autoplayRemainingSpins=0,r.emitter.emit(r.AUTOPLAY_START,i)):this.scene.gameData.useApiFreeSpins&&(null==(t=this.scene.slotMachine)?void 0:t.startApiFreeSpins)?this.scene.slotMachine.startApiFreeSpins(this.scene):this.scene.autoplay.isAutoPlaying||r.emitter.emit(r.AUTOPLAY_START,this.scene.gameData.freeSpins),this.scene.background.toggleBackground(this.scene),this.scene.audioManager.changeBackgroundMusic(this.scene),this.destroy()}))}))):this.handleButtonPressDuringCounting())}handleButtonPressDuringCounting(){this.countInterval&&(this.scene.time.removeEvent(this.countInterval),this.isCounting=!1,this.scene.audioManager.stopWinSFX(this.scene)),this.currentCount<this.targetCount&&(this.currentCount=this.targetCount,this.updateWinText()),this.skipIdleAnimation=this.currentCount===this.targetCount;const t=this.currentCount,e=this.determineNextAnimationPhase(t);e?this.transitionToNextAnimation(e):(this.buttonZone&&this.buttonZone.disableInteractive(!0),this.endWinAnimation((()=>{this.destroy()})))}determineNextAnimationPhase(t){return t>=this.scene.gameData.bet*this.scene.gameData.winRank[4]?"superwin":t>=this.scene.gameData.bet*this.scene.gameData.winRank[3]?"epicwin":t>=this.scene.gameData.bet*this.scene.gameData.winRank[2]?"megawin":t>=this.scene.gameData.bet*this.scene.gameData.winRank[1]?"bigwin":null}determineNextTransitionPhase(t){return t>=this.scene.gameData.bet*this.scene.gameData.winRank[4]?null:t>=this.scene.gameData.bet*this.scene.gameData.winRank[3]?"superwin":t>=this.scene.gameData.bet*this.scene.gameData.winRank[2]?"epicwin":t>=this.scene.gameData.bet*this.scene.gameData.winRank[1]?"megawin":"bigwin"}transitionToNextAnimation(t){switch(t){case"bigwin":this.playMegawinIntro();break;case"megawin":this.playEpicwinIntro();break;case"epicwin":this.playSuperwinIntro();break;case"superwin":this.playSuperwinIdle()}}continueCountingToNextPhase(){const t=this.shouldTransitionToNextAnimation();if(t)this.transitionToNextAnimation(t);else{const t=this.currentCount,e=this.calculateNextTarget(t);this.startCountUp(e,6e3)}}handleIntroSkip(){const t=this.currentAnimationPhase;if("bigwin_intro"===t)this.targetCount>this.scene.gameData.bet*this.scene.gameData.winRank[1]?(setTimeout((()=>{this.scene.audioManager.clearWinSFXQueue(),this.scene.audioManager.queueWinSFX(["MegaWin"])}),1e3),this.transitionToNextAnimation("megawin")):(this.scene.audioManager.queueWinSFX(["BigWin"]),this.playBigwinIdle());else if("megawin_intro"===t)this.targetCount>this.scene.gameData.bet*this.scene.gameData.winRank[2]?(setTimeout((()=>{this.scene.audioManager.clearWinSFXQueue(),this.scene.audioManager.queueWinSFX(["EpicWin"])}),1e3),this.transitionToNextAnimation("epicwin")):(this.scene.audioManager.queueWinSFX(["MegaWin"]),this.playMegawinIdle());else if("epicwin_intro"===t)this.targetCount>this.scene.gameData.bet*this.scene.gameData.winRank[3]?(setTimeout((()=>{this.scene.audioManager.clearWinSFXQueue(),this.scene.audioManager.queueWinSFX(["SuperWin"])}),1e3),this.transitionToNextAnimation("superwin")):(this.scene.audioManager.queueWinSFX(["EpicWin"]),this.playEpicwinIdle());else if("superwin_intro"===t)if(this.targetCount>this.scene.gameData.bet*this.scene.gameData.winRank[4]){this.scene.audioManager.queueWinSFX(["SuperWin"]);const t=this.calculateNextTarget(this.currentCount);this.startCountUp(t,6e3)}else this.scene.audioManager.queueWinSFX(["SuperWin"]),this.playSuperwinIdle()}shouldTransitionToNextAnimation(){const t=this.currentAnimationPhase;return"bigwin_idle"===t&&this.targetCount>this.scene.gameData.bet*this.scene.gameData.winRank[1]?"megawin":"megawin_idle"===t&&this.targetCount>this.scene.gameData.bet*this.scene.gameData.winRank[2]?"epicwin":"epicwin_idle"===t&&this.targetCount>this.scene.gameData.bet*this.scene.gameData.winRank[3]?"superwin":"superwin_idle"===t?(this.handleSuperwinSkip(),null):null}handleSuperwinSkip(){this.buttonZone&&this.buttonZone.disableInteractive(!0),this.isActive&&this.endWinAnimation((()=>{this.destroy()}))}calculateNextTarget(t){return t>=this.scene.gameData.bet*this.scene.gameData.winRank[4]||t>=this.scene.gameData.bet*this.scene.gameData.winRank[3]?this.finalBetTotal:t>=this.scene.gameData.bet*this.scene.gameData.winRank[2]?Math.min(this.finalBetTotal,this.scene.gameData.bet*this.scene.gameData.winRank[3]):t>=this.scene.gameData.bet*this.scene.gameData.winRank[1]?Math.min(this.finalBetTotal,this.scene.gameData.bet*this.scene.gameData.winRank[2]):this.finalBetTotal}handleFinalWin(){this.buttonZone&&this.buttonZone.setInteractive(!1),setTimeout((()=>{this.isActive&&this.endWinAnimation((()=>{this.destroy()}))}),100)}endWinAnimation(t){this.buttonZone&&this.buttonZone.disableInteractive(!0),this.scene.tweens.add({targets:this.container,alpha:.5,duration:333,ease:"Power2",onComplete:()=>{t()}})}}class As{constructor(t){s(this,"scene"),s(this,"container"),s(this,"contentContainer"),s(this,"buttonZone"),s(this,"isMobile",!1),s(this,"inputLocked",!1),s(this,"onSpaceDown"),this.scene=t,this.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768,this.container=this.scene.add.container(0,0),this.container.setDepth(1e4),this.container.setScale(this.isMobile?.5:1);const e=this.scene.add.graphics();e.fillStyle(0,.7),e.fillRect(0,0,2*this.scene.scale.width,2*this.scene.scale.height),this.container.add(e),this.contentContainer=this.scene.add.container(this.isMobile?this.scene.scale.width:.5*this.scene.scale.width,this.isMobile?this.scene.scale.height:.5*this.scene.scale.height),this.container.add(this.contentContainer),this.buttonZone=this.scene.add.zone(0,0,this.scene.scale.width,this.scene.scale.height),this.buttonZone.setInteractive(new Phaser.Geom.Rectangle(0,0,2*this.scene.scale.width,2*this.scene.scale.height),Phaser.Geom.Rectangle.Contains),this.container.add(this.buttonZone)}show(t,e){var i,s,n;const a=this.scene.add.image(0,0,"buyFeatBG");a.setOrigin(.5,.5),this.scene.sys.game.renderer.pipelines&&a.setPipeline("BlurPostFX");const o=this.scene.add.text(0,0,"You won\n\n\nmore free spins",{fontSize:"48px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold",align:"center"});o.setOrigin(.5,.5);const l=this.scene.add.text(0,0,`${t}`,{fontSize:"88px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold",align:"center"});l.setOrigin(.5,.5);const h=l.context.createLinearGradient(0,0,0,l.height);h.addColorStop(0,"#FFF15A"),h.addColorStop(.5,"#FFD000"),h.addColorStop(1,"#FFB400"),l.setFill(h),this.contentContainer.add(a),this.contentContainer.add(o),this.contentContainer.add(l),this.inputLocked=!0,this.scene.time.delayedCall(400,(()=>{this.inputLocked=!1})),!this.isMobile&&this.scene.input.keyboard&&(this.onSpaceDown=()=>this.tryClose(e),this.scene.input.keyboard.on("keydown-SPACE",this.onSpaceDown)),this.buttonZone.on("pointerdown",(()=>this.tryClose(e))),((null==(s=null==(i=this.scene.buttons)?void 0:i.autoplay)?void 0:s.isAutoPlaying)||(null==(n=this.scene.gameData)?void 0:n.useApiFreeSpins))&&this.scene.time.delayedCall(400,(()=>this.tryClose(e))),this.scene.slotMachine&&(this.scene.slotMachine.activeWinOverlay=!0),r.emitter.emit(r.WIN_OVERLAY_SHOW)}tryClose(t){this.inputLocked||this.end((()=>{t&&t()}))}end(t){this.scene.tweens.add({targets:this.container,alpha:0,duration:333,ease:"Power2",onComplete:()=>{t(),this.destroy()}})}destroy(){this.onSpaceDown&&this.scene.input.keyboard&&(this.scene.input.keyboard.off("keydown-SPACE",this.onSpaceDown),this.onSpaceDown=void 0),this.scene.slotMachine&&(this.scene.slotMachine.activeWinOverlay=!1),this.container.destroy(),r.emitter.emit(r.WIN_OVERLAY_HIDE)}}class Ms extends a.GameObjects.Container{constructor(t,e,i,n,a){super(t,e,i),s(this,"bombSprite"),s(this,"textOverlay"),s(this,"floatingText"),s(this,"orbitTimer"),s(this,"multiplier"),s(this,"bombType"),s(this,"scene"),s(this,"gameData"),s(this,"isMobile",!1),this.isMobile=this.isMobileDevice(),this.scene=t,this.gameData=a,this.multiplier=this.getMultiplierFromBombValue(n),this.bombType=this.getBombTypeFromMultiplier(this.multiplier);let o="Symbols10_SW";"medium"==this.bombType?o="Symbols11_SW":"high"==this.bombType&&(o="Symbols12_SW"),this.bombSprite=t.add.spine(0,0,"Symbol10_SW","Symbol10_SW"),this.bombSprite.setVisible(!0),this.bombSprite.setDepth(1),this.bombSprite.animationState.setAnimation(0,o,!1),this.bombSprite.animationState.timeScale=1;const r=this.bombSprite.animationState.getCurrent(0);if(r){const t=1/30*1e3;this.scene.time.delayedCall(t,(()=>{try{this.bombSprite.animationState.timeScale=0,r.trackTime=t/1e3,this.bombSprite.animationState.update(0)}catch(e){}}))}t.gameData.totalBombWin=0,this.bombSprite.animationState.timeScale=0;const l=this.multiplier>=50?0:this.multiplier>=12?1:2,h=["#4B0082","#8B004B","#8B3A00"],c=[.7,.6,.6];let d=[["#A64DFF","#DAB6FF"],["#FF4D94","#FFB6C1"],["#FF8C42","#FFD700"]][l];this.textOverlay=t.add.text(0,0,`${this.multiplier}X`,{fontSize:"36px",color:d[0],fontFamily:"Poppins",fontStyle:"bold",align:"center",stroke:h[l],strokeThickness:4,shadow:{offsetX:0,offsetY:0,color:"rgba(0, 0, 0, "+c[l]+")",blur:10,stroke:!0,fill:!1}}),this.textOverlay.setOrigin(.5,.5),this.textOverlay.setDepth(2),this.add([this.bombSprite,this.textOverlay]),this.setDepth(10),this.floatingText=t.add.text(0,0,`X ${this.multiplier}`,{fontSize:"32px",color:d[0],fontFamily:"Poppins",fontStyle:"bold",stroke:h[l],strokeThickness:4,shadow:{offsetX:0,offsetY:0,color:"rgba(0, 0, 0, "+c[l]+")",blur:10,stroke:!0,fill:!1}}),this.floatingText.setOrigin(.5,.5),this.floatingText.setDepth(1e6);try{this.scene.children.bringToTop(this.floatingText)}catch(u){}this.updateFloatingTextPosition(),this.textOverlay.setAlpha(1),this.textOverlay.setScale(1.25*this.textOverlay.scale),this.setScale(.8)}isMobileDevice(){const t=new URLSearchParams(window.location.search);return"mobile"==t.get("device")||"desktop"!=t.get("device")&&(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768)}getMultiplierFromBombValue(t){if(t<10||t>22)return this.gameData.debugError("Invalid bomb value:",t),1;const e=t-10,i=this.gameData.bombMultiplier;return e>=0&&e<i.length?i[e]:(this.gameData.debugError("Multiplier index out of range:",e),1)}getBombTypeFromMultiplier(t){return t>25?"high":t>10?"medium":"low"}setBombDisplaySize(t,e){var i,s;try{const n=this.bombSprite,a=n.getBounds?n.getBounds():void 0,o=(null==(i=null==a?void 0:a.size)?void 0:i.x)||(null==a?void 0:a.width)||n.width||100,r=(null==(s=null==a?void 0:a.size)?void 0:s.y)||(null==a?void 0:a.height)||n.height||100,l=t/o,h=e/r,c=Math.min(l,h);this.bombSprite.setScale(c),this.bombSprite.setPosition(0,-10)}catch(a){const i=Math.min(t,e)/120;this.bombSprite.setScale(i),this.bombSprite.setPosition(0,0)}this.textOverlay.setPosition(15,-7.5);const n=Math.floor(.28*Math.min(t/2,e/2));this.textOverlay.setFontSize(n),this.setSize(t,e)}playBombAnimation(){this.gameData.debugLog("Playing bomb animation",{bombType:this.bombType}),setTimeout((()=>{try{this.scene.audioManager.TExplosion.play({volume:this.scene.audioManager.getSFXVolume()}),this.scene.audioManager.BonusBG.resume()}catch(t){}this.spawnOverlayBombAnimation("animation",1500,31,30),this.setOtherSymbolsDepth(0),this.startFloatingTextRise()}),1e3),this.scene.tweens.add({targets:this.textOverlay,alpha:1,scale:1.2,duration:300,ease:"Back.easeOut",yoyo:!0,yoyoDelay:200})}isPlayingAnimation(){if(this.bombSprite&&this.bombSprite.animationState.tracks.length>0){const t=this.bombSprite.animationState.getCurrent(0);if(t&&t.animation)return t.animation.name.includes("Symbols")}return!1}getBombSprite(){return this.bombSprite}getTextOverlay(){return this.textOverlay}getMultiplier(){return this.multiplier}getBombType(){return this.bombType}updateText(t){this.textOverlay.setText(t),this.gameData.debugLog("Bomb text updated",{text:t})}showExplosion(){this.gameData.debugLog("Showing bomb explosion");try{this.scene.audioManager.TExplosion.play(),this.scene.audioManager.BonusBG.resume()}catch(t){}switch(this.bombType){case"low":this.spawnOverlayBombAnimation("Symbols10_SW",1500,31,30);break;case"medium":this.spawnOverlayBombAnimation("Symbols11_SW",1500,31,30);break;case"high":this.spawnOverlayBombAnimation("Symbols12_SW",1500,31,30)}this.setOtherSymbolsDepth(0),this.scene.tweens.add({targets:this.textOverlay,alpha:1,duration:500,ease:"Power2"}),this.startFloatingTextRise()}spawnOverlayBombAnimation(t="",e=650,i,s=30){try{const a=this.parentContainer,o=this.x+this.bombSprite.x,l=this.y+this.bombSprite.y;let h=null;h=this.scene.add.spine(o,l,t,t),h.setScale(this.bombSprite.scaleX,this.bombSprite.scaleY),h.setAlpha(1);try{this.scene.tweens.add({targets:h,scaleX:.5*h.scaleX,scaleY:.5*h.scaleY,duration:800,ease:"Power2"})}catch(n){}a&&"function"==typeof a.add?(a.add(h),"function"==typeof a.bringToTop&&a.bringToTop(h)):h.setDepth(1e4),h.animationState.timeScale=1;const c=h.animationState.setAnimation(0,t,!1);if("number"==typeof i&&i>=0&&s>0){const t=i/s*1e3;this.scene.time.delayedCall(t,(()=>{var e,i;try{h.animationState.timeScale=0;const s=h.animationState.getCurrent(0)||c;s&&(s.trackTime=t/1e3),h.animationState.update(0),null==(i=null==(e=h.skeleton)?void 0:e.updateWorldTransform)||i.call(e),h.setAlpha(1),h.setVisible(!0);const n=this.getWorldTransformMatrix(new Phaser.GameObjects.Components.TransformMatrix),a=this.textOverlay.x,o=this.textOverlay.y,l=n.a*a+n.c*o+n.tx,d=n.b*a+n.d*o+n.ty;r.emitter.emit(r.BOMB_FLOAT_TEXT,{x:l,y:d,valueText:this.textOverlay.text})}catch(n){}})),e=Math.max(e,t+500)}}catch(n){try{this.bombSprite.animationState.timeScale=1;const e=this.bombSprite.animationState.setAnimation(0,t,!1);try{this.scene.tweens.add({targets:this.bombSprite,scaleX:.5*this.bombSprite.scaleX,scaleY:.5*this.bombSprite.scaleY,duration:400,ease:"Power2"})}catch(a){}if("number"==typeof i&&i>=0&&s>0){const t=i/s*1e3;this.scene.time.delayedCall(t,(()=>{var i,s;try{this.bombSprite.animationState.timeScale=0;const n=this.bombSprite.animationState.getCurrent(0)||e;n&&(n.trackTime=t/1e3),null==(s=null==(i=this.bombSprite.skeleton)?void 0:i.updateWorldTransform)||s.call(i),this.bombSprite.setAlpha(1)}catch(a){}}))}}catch(a){}}}setOtherSymbolsDepth(t){try{const e=this.parentContainer;if(!e||!e.list)return;e.list.forEach((e=>{if(e&&e!==this){if("function"==typeof e.setDepth)try{e.setDepth(t)}catch(i){}Array.isArray(null==e?void 0:e.list)&&e.list.forEach((e=>{if(e&&e!==this&&"function"==typeof e.setDepth)try{e.setDepth(t)}catch(i){}}))}}))}catch(e){}}destroy(){if(this.orbitTimer){try{this.orbitTimer.remove(!1)}catch(t){}this.orbitTimer=void 0}if(this.floatingText){try{this.floatingText.destroy()}catch(t){}this.floatingText=void 0}this.bombSprite&&(this.bombSprite.animationState.timeScale=1,this.bombSprite.animationState.addListener({complete:()=>{console.error("destroying bomb sprite complete"),this.bombSprite.destroy()}})),this.textOverlay&&this.textOverlay.destroy(),super.destroy()}getBombWorldPosition(){try{const t=this.getWorldTransformMatrix(new Phaser.GameObjects.Components.TransformMatrix),e=this.bombSprite.x,i=this.bombSprite.y;return{x:t.a*e+t.c*i+t.tx,y:t.b*e+t.d*i+t.ty}}catch(t){return{x:this.x,y:this.y}}}updateFloatingTextPosition(){if(!this.floatingText)return;const t=this.getBombWorldPosition();this.floatingText.setPosition(t.x,t.y)}startFloatingTextRise(){if(!this.floatingText)return;if(this.orbitTimer){try{this.orbitTimer.remove(!1)}catch(n){}this.orbitTimer=void 0}const t=this.getBombWorldPosition();this.floatingText.setPosition(t.x,t.y);try{this.scene.children.bringToTop(this.floatingText)}catch(n){}const e=this.scene.cameras.main.worldView;let i=this.isMobile?e.x+.5*e.width:e.x+.55*e.width,s=this.isMobile?e.y+.1875*e.height:e.y+.9*e.height;this.textOverlay.setText(""),this.scene.tweens.add({targets:this.floatingText,x:i,y:s,scale:1.5,duration:900,ease:"Sine.easeOut",onUpdate:()=>{this.floatingText},onComplete:()=>{try{this.scene.children.bringToTop(this.floatingText),setTimeout((()=>{var t;null==(t=this.floatingText)||t.destroy(),this.scene.gameData.totalBombWin+=this.getMultiplier(),r.emitter.emit(r.SHOW_BOMB_WIN),r.emitter.emit(r.UPDATE_TOTAL_WIN,0,!0)}),15)}catch(n){}}})}}class Cs{constructor(){s(this,"stateMachine")}start(t){}update(t,e,i){}end(t){}}class Bs extends Cs{constructor(){super(...arguments),s(this,"spinEventListener"),s(this,"changeLineListener")}start(t){const e=t;e.gameData.currentRow=0,e.gameData.isSpinning=!1,r.emitter.emit(r.START,{symbols:[[1,1,3,3,2,2],[1,0,3,5,0,2],[0,6,6,5,5,0],[8,0,6,7,0,4],[8,8,7,7,4,4]],currentRow:e.gameData.currentRow}),this.initEventListeners(e)}update(t,e,i){}end(t){this.spinEventListener&&(r.emitter.off(r.SPIN,this.spinEventListener),this.spinEventListener=void 0),this.changeLineListener&&(r.emitter.off(r.CHANGE_LINE,this.changeLineListener),this.changeLineListener=void 0)}spin(t,e){if(t.gameData.isSpinning)return;if(t.gameData.isSpinning=!0,console.log(`[STATE] spin start: isBonusRound=${t.gameData.isBonusRound}, freeSpins=${t.gameData.freeSpins}, useApiFreeSpins=${t.gameData.useApiFreeSpins}`),(null==e?void 0:e.isBuyFeature)&&(t.gameData.balance-=t.gameData.getBuyFeaturePrice(),t.gameData.minScatter=4),t.gameData.freeSpins>0){if(t.gameData.useApiFreeSpins||(t.gameData.freeSpins--,console.log(`[STATE] decremented freeSpins â†’ ${t.gameData.freeSpins} (isBonusRound=${t.gameData.isBonusRound})`)),t.gameData.useApiFreeSpins||(t.gameData.currentFreeSpinIndex=t.gameData.totalFreeSpins-t.gameData.freeSpins,console.log(`[STATE] currentFreeSpinIndex=${t.gameData.currentFreeSpinIndex}/${t.gameData.totalFreeSpins}`)),0===t.gameData.freeSpins&&!t.gameData.useApiFreeSpins){console.log("[STATE] freeSpins ended, toggling back to base game"),t.background.toggleBackground(t),t.audioManager.changeBackgroundMusic(t);const e=t.gameData.totalBonusWin;r.emitter.once(r.SPIN_ANIMATION_END,(()=>{t.slotMachine.showBonusWin(t,e),t.gameData.isSpinning=!1}))}}else!function(t){t.gameData.buyFeatureEnabled?t.gameData.balance-=t.gameData.getBuyFeaturePrice():t.gameData.doubleChanceEnabled?t.gameData.balance-=t.gameData.getDoubleFeaturePrice():t.gameData.balance-=t.gameData.bet}(t);const i=t.gameData.slot,s=[];for(let n=0;n<_.ROWS;n++){const t=Ps();s.push(t),i.setRows(t,n)}i.placeScatters(t.gameData.minScatter,t.gameData.maxScatter,t.gameData.scatterChance),t.gameData.minScatter=0,i.placeBombs(t.gameData.minBomb,t.gameData.maxBomb,t.gameData.bombChance,t.gameData.isBonusRound),t.gameData.minBomb=0,r.emitter.emit(r.SPIN_ANIMATION_START,{symbols:i.values,currentRow:t.gameData.currentRow,newRandomValues:s})}initEventListeners(t){this.spinEventListener=e=>{this.spin(t,e)},r.emitter.on(r.SPIN,this.spinEventListener),this.changeLineListener=()=>{this.initSpin()},r.emitter.on(r.CHANGE_LINE,this.changeLineListener)}initSpin(){}}function Ps(){const t=Array(_.SYMBOLS).fill(null),e=_.TOGGLE_DIFFICULTY?_.DIFFICULTY_SYMBOLS:_.SYMBOLS;let i=0;for(;i<e;){const e=Math.floor(Math.random()*_.SYMBOLS)+1;t.includes(e)||(t[i]=e,i++)}const s=Array(_.COLUMNS).fill(null);for(let n=0;n<_.COLUMNS;n++){const i=Math.floor(Math.random()*e);s[n]=t[i]}return s}class Is{constructor(){s(this,"container",null),s(this,"content",null),s(this,"claimCb")}create(t){if(this.container)return;this.container=t.add.container(0,0),this.container.setDepth(1e4),this.container.alpha=0;const e=t.add.graphics();e.fillStyle(0,.7),e.fillRect(0,0,2*t.scale.width,2*t.scale.height),this.container.add(e),this.content=t.add.container(.5*t.scale.width,.5*t.scale.height),this.container.add(this.content);const i=Math.min(560,.9*t.scale.width),s=t.add.graphics();s.fillStyle(1184274,1),s.fillRoundedRect(-i/2,-130,i,260,14),this.content.add(s);const n=t.add.text(-i/2+20,-106,"You Win!",{fontSize:"20px",color:"#37A557",fontFamily:"Poppins",fontStyle:"bold"});this.content.add(n);const a=t.add.text(0,-20,"Max Win:",{fontSize:"28px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold",align:"center"});a.setOrigin(.5,.5),this.content.title=a,this.content.add(a);const o=Math.min(340,i-80),r=t.add.graphics();r.fillStyle(4970857,1),r.fillRoundedRect(-o/2,37,o,56,28),r.lineStyle(2,3050327,1),r.strokeRoundedRect(-o/2,37,o,56,28),this.content.add(r);const l=t.add.zone(0,65,o,56);l.setOrigin(.5,.5),l.setInteractive({useHandCursor:!0});try{l.input.cursor="pointer"}catch(c){}this.content.add(l);const h=t.add.text(0,65,"CLAIM",{fontSize:"22px",color:"#000000",fontFamily:"Poppins",fontStyle:"bold"});h.setOrigin(.5,.5),this.content.add(h),l.on("pointerover",(()=>{try{t.tweens.add({targets:[r,h],scaleX:1.03,scaleY:1.03,duration:80,ease:"Cubic.easeOut"})}catch(c){}})),l.on("pointerout",(()=>{try{t.tweens.add({targets:[r,h],scaleX:1,scaleY:1,duration:80,ease:"Cubic.easeOut"})}catch(c){}})),l.on("pointerdown",(e=>{if(e&&(void 0===e.button||0===e.button))try{l.disableInteractive(),t.tweens.add({targets:[r,h],scaleX:.95,scaleY:.95,duration:80,ease:"Cubic.Out",yoyo:!0,onComplete:()=>{try{l.setInteractive({useHandCursor:!0})}catch(c){}this.hide(t),this.claimCb&&this.claimCb()}})}catch(c){this.hide(t),this.claimCb&&this.claimCb()}}))}show(t,e,i){if(this.create(t),!this.container||!this.content)return;this.claimCb=i;const s=this.content.title,n=e*t.gameData.bet;s&&s.setText(`Max Win: x${e.toLocaleString("en-US")}\nYou Won: ${t.gameData.currency} ${n.toLocaleString("en-US")}`),this.container.alpha=1,r.emitter.emit(r.WIN_OVERLAY_SHOW)}hide(t){this.container&&t.tweens.add({targets:this.container,alpha:0,duration:150,ease:"Cubic.easeIn",onComplete:()=>{var t;try{null==(t=this.container)||t.destroy()}catch(e){}this.container=null,this.content=null,r.emitter.emit(r.WIN_OVERLAY_HIDE)}})}}function Es(t){return t[0].map(((e,i)=>t.map((t=>t[i]))))}class Ds{constructor(){s(this,"container"),s(this,"symbolGrid"),s(this,"symbolDisplayWidth"),s(this,"symbolDisplayHeight"),s(this,"horizontalSpacing"),s(this,"verticalSpacing"),s(this,"width"),s(this,"centerX"),s(this,"totalGridWidth"),s(this,"totalGridHeight"),s(this,"slotX"),s(this,"slotY"),s(this,"activeWinOverlay",!1),s(this,"tweensToComplete",0),s(this,"bombAnimationActive",!1),s(this,"lastSpinTimestamp",0),s(this,"MIN_SPIN_INTERVAL",200),s(this,"winOverlayContainers",[]),s(this,"bombPopupContainer",null),s(this,"winOverlayQueue",[]),s(this,"onOverlayHide"),s(this,"animation"),s(this,"winAnimation"),s(this,"isMobile",!1),s(this,"symbolCountWinContainer",null),s(this,"symbolCountWinTexts",[]),s(this,"hadMatchThisSpin",!1),s(this,"deferredScatterCount",0),s(this,"bonusTriggeredThisSpin",!1),s(this,"maxWinClaim"),s(this,"currentIndex",0),this.symbolDisplayWidth=153.17,this.symbolDisplayHeight=147.2,this.horizontalSpacing=10,this.verticalSpacing=10,this.symbolGrid={length:0,map:()=>[],forEach:()=>{}}}preload(t){t.load.image("slotBackground","assets/Reels/Property 1=Default.png"),this.animation=new W(t),this.animation.preload(),this.winAnimation=new L(t),this.winAnimation.preload(),this.initVariables(t),this.isMobile=this.isMobileDevice()}initVariables(t){this.width=t.scale.width,this.centerX=.5*this.width,this.totalGridWidth=1e3,this.totalGridHeight=775,this.slotX=this.centerX-.475*this.totalGridWidth,this.slotY=85}create(t){this.createContainer(t),this.createBackground(t),this.createSlot(t),this.eventListeners(t),this.maxWinClaim=new Is,this.animation.create(),this.winAnimation.create(),this.onOverlayHide=()=>this.tryShowNextOverlay(t),r.emitter.on(r.WIN_OVERLAY_HIDE,this.onOverlayHide)}isMobileDevice(){const t=new URLSearchParams(window.location.search);return"mobile"==t.get("device")||"desktop"!=t.get("device")&&(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768)}createContainer(t){this.container=t.add.container(this.isMobile?.01*t.scale.width:this.slotX,this.isMobile?.23*t.scale.height:this.slotY),this.container.setScale(this.isMobile?.43:1),this.totalGridWidth=this.isMobile?.43*this.totalGridWidth:this.totalGridWidth,this.totalGridHeight=this.isMobile?.43*this.totalGridHeight:this.totalGridHeight,this.container.setDepth(4),this.createSymbolCountWinDisplay(t)}createSymbolCountWinDisplay(t){const e=.5*t.scale.width,i=this.isMobile?.65*t.scale.height:this.slotY+this.totalGridHeight;this.symbolCountWinContainer=t.add.container(e,i),this.symbolCountWinContainer.setDepth(5),this.symbolCountWinContainer.setVisible(!1)}showSymbolCountWinDisplay(t,e){if(!this.symbolCountWinContainer||0===e.length)return;this.clearSymbolCountWinTexts();const i=e.filter((t=>t.count>=8));if(0===i.length)return void console.log("No valid symbols with count >= 8");const s=[];i.slice(0,3).forEach((e=>{const i=t.add.container(0,0),n=t.add.text(0,0,`${e.count}`,{fontSize:"20px",color:"#FFFFFF",fontFamily:"Poppins"});n.setOrigin(.5,.5);let a=null;if(e.symbol>=1&&e.symbol<=9){const i=`Symbol${e.symbol}_SW`,s=`Symbol${e.symbol}_SW-00000.png`;a=t.add.sprite(0,0,i,s),a.setDisplaySize(40,40),t.gameData.debugLog(`Created symbol sprite for symbol ${e.symbol}`)}const o=e.win.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2}),r=t.add.text(0,0,`= ${t.gameData.currency}${o}`,{fontSize:"20px",color:"#FFFFFF",fontFamily:"Poppins"});r.setOrigin(.5,.5),i.add(n),a&&i.add(a),i.add(r);const l=n.getBounds().width,h=a?a.getBounds().width:0,c=r.getBounds().width;let d=-(l+(a?4+h:0)+4+c)/2;n.setPosition(d+l/2,0),d+=l,a&&(d+=4,a.setPosition(d+h/2,0),d+=h),d+=4,r.setPosition(d+c/2,0),this.symbolCountWinContainer.add(i),s.push(i),this.symbolCountWinTexts.push(n,r),a&&this.symbolCountWinTexts.push(a)}));const n=this.isMobile?.9*t.scale.width:this.totalGridWidth;!function(t,e,i){const s=i.gap,n=e.slice(0,3).filter(Boolean);if(e.forEach((t=>{t.setVisible(n.includes(t))})),0===n.length)return;const a=n.map((t=>t.getBounds().width)).reduce(((t,e)=>t+e),0)+s*(n.length-1),o=Math.min(1,i.maxWidth/Math.max(1,a));n.forEach((t=>t.setScale(t.scaleX*o,t.scaleY*o)));const r=n.map((t=>t.getBounds().width)),l=r.reduce(((t,e)=>t+e),0)+s*(n.length-1);let h=i.x;h=i.x-l/2;let c=h;n.forEach(((t,e)=>{const n=r[e],a=n/2;t.setPosition(c+a,i.y),c+=n+s}))}(0,s,{x:0,y:0,maxWidth:n,gap:18}),this.isMobile?this.symbolCountWinContainer.setVisible(!0):this.symbolCountWinContainer.setVisible(!1)}hideSymbolCountWinDisplay(){this.symbolCountWinContainer&&(this.symbolCountWinContainer.setVisible(!1),this.clearSymbolCountWinTexts())}clearSymbolCountWinTexts(){this.symbolCountWinTexts.forEach((t=>{t&&t.active&&t.destroy()})),this.symbolCountWinTexts=[],this.symbolCountWinContainer&&this.symbolCountWinContainer.removeAll()}createBackground(t){if(this.isMobile)return;const e=t.add.image(0,0,"slotBackground").setOrigin(0,0);e.setDepth(3),e.x=this.slotX-45,e.y=this.slotY-37.5,e.displayWidth=this.totalGridWidth+90,e.displayHeight=this.totalGridHeight+75}createSlot(t){const e=this.isMobile?0*t.scale.width:this.slotX-45,i=this.isMobile?.21*t.scale.height:this.slotY-15,s=this.isMobile?this.totalGridWidth:this.totalGridWidth+90,n=this.isMobile?1.5*this.totalGridHeight:this.totalGridHeight+60,a=t.add.graphics();a.fillRect(e,i,s,n);const o=a.createGeometryMask();this.container.setMask(o),a.setVisible(!1)}async createReel(t,e){var i,s,n,a,o,l,h,c,d,u,m,g,p,b,f;if(t.gameData.isBonusRound&&t.gameData.useApiFreeSpins)return void console.log(`[BONUS] createReel: Already in API-driven bonus. isBonusRound=${t.gameData.isBonusRound}, freeSpins=${t.gameData.freeSpins}`);r.emitter.emit(r.GET_BALANCE),this.cleanupAloneSymbols();let y=[];const w=null!=(i=e.isBuyFeature)?i:t.gameData.buyFeatureEnabled,S=t.gameData.bet,x=null!=(s=e.isEnhancedBet)?s:t.gameData.doubleChanceEnabled;(w||x)&&console.log("[BUY FEATURE] isBuyFeature:",w,"betAmount sent:",S,"isEnhancedBet:",x);const F=await t.gameAPI.doSpin(S,w,x);if(t.buttons.bonusMultiplier=1,"error"==F)return void console.log("[BUY FEATURE] doSpin error",F);console.log("result",F.slot);let v=parseFloat(F.bet);w?v*=100:x&&(v*=1.25),setTimeout((()=>{r.emitter.emit(r.UPDATE_FAKE_BALANCE,v,0)}),100),t.gameData.apiBet=F.bet,t.gameData.bet=F.bet;const T=(null==(n=null==F?void 0:F.slot)?void 0:n.freeSpin.items)||(null==(a=null==F?void 0:F.slot)?void 0:a.freeSpins.items)||[];if(t.gameData.totalBonusWin=F.slot.totalWin,Array.isArray(T)&&T.length>0){this.bonusTriggeredThisSpin=!0;try{t.buttons.freeSpinTriggered=!0,t.buttons.updateButtonStates(t)}catch(M){}try{t.buttons.autoplayIndicator.visible=!!(null==(l=null==(o=t.buttons)?void 0:o.autoplay)?void 0:l.isAutoPlaying),(null==(c=null==(h=t.buttons)?void 0:h.autoplay)?void 0:c.isAutoPlaying)||(t.buttons.freeSpinBtn.visible=!1),t.buttons.updateButtonStates(t)}catch(M){}t.gameData.apiFreeSpins=[],t.gameData.apiFreeSpins=T,t.gameData.apiFreeSpinsIndex=0,t.gameData.useApiFreeSpins=!0,t.gameData.totalWinFreeSpin=[];const e=null==(d=T[0])?void 0:d.spinsLeft;t.gameData.freeSpins=e,t.gameData.totalFreeSpins=T.length,t.gameData.totalWinFreeSpinPerTumble=[],T.forEach((e=>{var i;t.gameData.totalWinFreeSpin.push(e.totalWin);let s=0;null==(i=e.tumbles)||i.forEach((t=>{s+=null==t?void 0:t.win})),t.gameData.totalWinFreeSpinPerTumble.push(s)}));try{(null==(m=null==(u=t.buttons)?void 0:u.autoplay)?void 0:m.isAutoPlaying)&&(t.buttons.autoplay.pauseForBonus(),(null==(g=t.buttons)?void 0:g.updateButtonStates)&&t.buttons.updateButtonStates(t))}catch(M){}try{t.gameData.freeSpinLockUntilMs=Date.now()+5e3,null==(b=null==(p=t.time)?void 0:p.delayedCall)||b.call(p,5e3,(()=>{var e,i;try{null==(i=null==(e=t.buttons)?void 0:e.updateButtonStates)||i.call(e,t)}catch(M){}}))}catch(M){}r.emitter.once(r.TUMBLE_SEQUENCE_DONE,(async()=>{var i,s,n,a;try{const e=[];for(let t=0;t<((null==(i=this.symbolGrid)?void 0:i.length)||0);t++){const i=this.symbolGrid[t];if(i)for(let t=0;t<i.length;t++){const n=i[t];n instanceof Phaser.GameObjects.Sprite&&"Symbol0_SW"===(null==(s=n.texture)?void 0:s.key)&&e.push(n)}}e.length>=3&&await this.animateScatterSymbolsForApi(t,e)}catch(M){}t.gameData.isBonusRound=!0,t.background.toggleBackground(t),t.audioManager.changeBackgroundMusic(t),(null==(n=t.buttons)?void 0:n.showRemainingFreeSpinsLabel)&&t.buttons.showRemainingFreeSpinsLabel(t),(null==(a=t.buttons)?void 0:a.hideBottomControlsForBonus)&&t.buttons.hideBottomControlsForBonus(t,!0);try{t.buttons.freeSpinTriggered=!0,t.buttons.updateButtonStates(t)}catch(M){}this.showFreeSpinsPopup(t,e)}))}y=Es(F.slot.area),t.gameData.debugLog("newValues",y);let A=Math.floor(9*Math.random())+1;for(let r=0;r<y.length;r++)for(let e=0;e<y[r].length;e++)t.gameData.debugged>0&&(y[r][e]=A),y[r][e];t.gameData.totalWin=F.slot.totalWin;try{t.gameData.lastTotalWin=F.slot.totalWin}catch(M){}try{t.lastSpinHadMaxWin=!!(null==(f=null==F?void 0:F.slot)?void 0:f.maxWin)}catch(M){}if(this.currentIndex=0,await this.playSpinAnimations(t,y,e),Array.isArray(F.slot.tumbles)&&F.slot.tumbles.length>0){try{t.gameData.lastTumbles=F.slot.tumbles}catch(M){}await this.processMatchesSequentially(t,y,F.slot.tumbles)}else r.emitter.emit(r.WIN,{}),r.emitter.emit(r.SPIN_ANIMATION_END,{symbols:y,currentRow:0}),r.emitter.emit(r.MATCHES_DONE,{symbolGrid:y}),r.emitter.emit(r.TUMBLE_SEQUENCE_DONE,{symbolGrid:y}),t.gameData.isSpinning=!1,t.buttons&&t.buttons.enableButtonsVisually&&t.buttons.enableButtonsVisually(t),this.cleanupAloneSymbols();t.gameData.buyFeatureEnabled=!1}async startApiFreeSpins(t){await this.playApiFreeSpin(t)}async playApiFreeSpin(t){var e,i;const s=t.gameData.apiFreeSpinsIndex||0,n=t.gameData.apiFreeSpins||[],a=n[s];if(!a)return void(await this.endApiBonus(t));if(t.gameData.isSpinning)return;t.gameData.isSpinning=!0,this.bonusTriggeredThisSpin=!1,this.currentIndex=0,t.buttons.bonusMultiplier=0;const o=Es(a.area),l=a.tumbles||[],h=Array.isArray(l)?l.reduce(((t,e)=>t+((null==e?void 0:e.win)||0)),0):0,c=Array.isArray(null==a?void 0:a.multipliers)?a.multipliers:[];if(0===c.length)t.buttons.bonusMultiplier=1;else{const e=c.reduce(((e,i)=>{const s="number"==typeof i?i-10:-1;return e+(s>=0&&s<t.gameData.bombMultiplier.length?t.gameData.bombMultiplier[s]:0)}),0);t.buttons.bonusMultiplier=e>0?e:1}await this.playSpinAnimations(t,o,{symbols:o,currentRow:0,isBuyFeature:!1,isEnhancedBet:!1,betAmount:t.gameData.bet}),l.length>0?await this.processMatchesSequentially(t,o,l):(r.emitter.emit(r.WIN,{}),r.emitter.emit(r.SPIN_ANIMATION_END,{symbols:o,currentRow:0}),r.emitter.emit(r.MATCHES_DONE,{symbolGrid:o}),r.emitter.emit(r.TUMBLE_SEQUENCE_DONE,{symbolGrid:o}),t.gameData.isSpinning=!1,t.buttons&&t.buttons.enableButtonsVisually&&t.buttons.enableButtonsVisually(t),this.cleanupAloneSymbols());try{const e=o.flat().filter((t=>0===t)).length;if(e>=(t.gameData.isBonusRound?3:4)){const i=[];for(let t=0;t<o.length;t++)for(let e=0;e<o[t].length;e++)if(0===o[t][e]&&this.symbolGrid[t][e]){const s=this.symbolGrid[t][e];s instanceof Phaser.GameObjects.Sprite&&i.push(s)}i.length>0&&(await this.animateScatterSymbolsForApi(t,i),t.gameData.isBonusRound&&e>=3&&this.showRetriggerPopup(t,5))}}catch(f){t.gameData.debugError("Scatter animation (API) failed",f)}const d=t.gameData.bet||1,u=null==a?void 0:a.totalWin,m="number"==typeof u?u:h;(d>0?m/d:0)>=t.gameData.winRank[1]&&this.showWinOverlay(t,m,d),t.gameData.apiFreeSpinsIndex=s+1,r.emitter.emit(r.HIDE_BOMB_WIN);const g=n[s+1],p=Math.max(0,null!=(e=null==g?void 0:g.spinsLeft)?e:n.length-(s+1));t.gameData.freeSpins=p,(null==(i=t.buttons)?void 0:i.updateRemainingFreeSpinsCount)&&t.buttons.updateRemainingFreeSpinsCount(t),t.gameData.currentFreeSpinIndex=s+1;const b=async()=>{p>0?t.time.delayedCall(300,(()=>this.playApiFreeSpin(t))):(r.emitter.emit(r.FINAL_WIN_SHOW,{}),await this.endApiBonus(t))};this.activeWinOverlay?r.emitter.once(r.WIN_OVERLAY_HIDE,(()=>{b()})):await b()}async animateScatterSymbolsForApi(t,e){if(0===e.length)return;if(e.length<3)return;t.audioManager.ScatterSFX.play();const i=[];e.forEach(((e,s)=>{const n=new Promise((i=>{this.createWinParticles(t,e.x,e.y,16711680),this.animation.playSymbolAnimation(e,0),e.once("animationcomplete",(()=>{i()}))}));i.push(n)})),await Promise.all(i)}async endApiBonus(t){var e,i,s,n,a,o,l,h,c,d;t.gameData.isBonusRound=!1;try{const e=Array.isArray(t.gameData.apiFreeSpins)?t.gameData.apiFreeSpins:[];if(e.length>0){const i=e.reduce(((t,e)=>t+(Number(null==e?void 0:e.totalWin)||0)),0);if(i>0)t.gameData.totalBonusWin=i;else if(Array.isArray(t.gameData.totalWinFreeSpin)&&t.gameData.totalWinFreeSpin.length>0){const e=t.gameData.totalWinFreeSpin.reduce(((t,e)=>t+(Number(e)||0)),0);e>0&&(t.gameData.totalBonusWin=e)}}}catch(m){}const u=t.gameData.totalWin;this.showBonusWin(t,u),t.gameData.useApiFreeSpins=!1,t.gameData.apiFreeSpins=[],t.gameData.apiFreeSpinsIndex=0,t.gameData.totalWinFreeSpin=[];try{(null==(i=null==(e=t.buttons)?void 0:e.autoplayIndicator)?void 0:i.visible)||(t.buttons.freeSpinBtn.visible=!0)}catch(m){}(null==(s=t.buttons)?void 0:s.hideBottomControlsForBonus)&&t.buttons.hideBottomControlsForBonus(t,!1),(null==(n=t.buttons)?void 0:n.hideRemainingFreeSpinsLabel)&&t.buttons.hideRemainingFreeSpinsLabel();try{!(null==(o=null==(a=t.buttons)?void 0:a.autoplay)?void 0:o.isMobile)&&(null==(h=null==(l=t.buttons)?void 0:l.autoplay)?void 0:h.hideRemainingSpinsDisplay)&&t.buttons.autoplay.hideRemainingSpinsDisplay()}catch(m){}try{t.buttons.freeSpinTriggered=!1,t.buttons.updateButtonStates(t),null==(d=null==(c=t.buttons.autoplayIndicator)?void 0:c.setAlpha)||d.call(c,0)}catch(m){}r.emitter.emit(r.WIN_OVERLAY_HIDE),r.emitter.emit(r.UPDATE_BALANCE,u)}async playSpinAnimations(t,e,i){const s=_.ROWS,n=_.COLUMNS,a=this.symbolDisplayWidth,o=this.symbolDisplayHeight,l=this.horizontalSpacing,h=this.verticalSpacing;let c=Array(s).fill(null).map((()=>Array(n).fill(null)));Object.assign(c,{length:s,map:t=>Array(s).fill(null).map(((e,i)=>t(c[i],i))),forEach:t=>Array(s).fill(null).forEach(((e,i)=>t(c[i],i)))});let d=t.gameData.turbo?.2:1;t.gameData.turbo&&t.audioManager.TurboDrop.play();const u=[];for(let r=0;r<n;r++)for(let i=s-1;i>=0;i--){const n=this.symbolGrid[i][r],m=.5*a+r*(a+l),g=.5*o+i*(o+h),p=(250*r+150*(s-1-i))*d,b=e[i][r];let f=null,y="Symbol0_SW",w="Symbol0_SW-00000.png";const S=g-o*(s+1);b>=1&&b<=9?(y=`Symbol${b}_SW`,w=`Symbol${b}_SW-00000.png`,f=t.add.sprite(m,S,y,w)):b>=10&&b<=22?(f=new Ms(t,m,S,b,t.gameData),f.setBombDisplaySize(a*_.SYMBOL_SIZE,o*_.SYMBOL_SIZE)):f=t.add.sprite(m,S,y,w),0===b?null==f||f.setDisplaySize(a*_.SCATTER_SIZE,o*_.SCATTER_SIZE):b>=10&&b<=22?f instanceof Ms?f.setBombDisplaySize(a*_.SYMBOL_SIZE*_.BOMB_SCALE,o*_.SYMBOL_SIZE*_.BOMB_SCALE):f&&f.setDisplaySize(a*_.SYMBOL_SIZE,o*_.SYMBOL_SIZE):null==f||f.setDisplaySize(a*_.SYMBOL_SIZE,o*_.SYMBOL_SIZE),f&&b>=10&&b<=22&&f.setDepth(10);let x=(g-S)/2*d;t.gameData.turbo&&(x=Math.min(x,1250*d));let F=(p+1100)*d;if(t.gameData.turbo&&(F+=x/d),n){const e=n.y+o*(s+1),i=(e-n.y)/2*d,a=[],r=10,l=-100;for(let s=0;s<r;s++)if(0==t.gameData.turbo&&"texture"in n){const e=t.add.sprite(n.x,n.y,n.texture.key,n.frame.name);e.setDisplaySize(n.displayWidth,n.displayHeight),e.setAlpha(.7-.15*s),e.setPipeline("BlurPostFX"),e.blurStrength=.8+.1*s,e.setDepth(n.depth-(s+1)),this.container.add(e),a.push(e)}t.tweens.add({targets:n,y:e,alpha:.1,scale:.5,duration:i,delay:p,ease:"Quart.easeInOut",onUpdate:()=>{0==t.gameData.turbo&&setTimeout((()=>{a.forEach(((t,e)=>{t.y=n.y-l*(e+1),t.alpha=n.alpha*(.7-.15*e)}))}),100)},onComplete:()=>{a.forEach((t=>t.destroy())),n.destroy()}})}if(f){const e=new Promise((e=>{t.tweens.add({targets:f,y:g,duration:x,ease:"Quart.easeInOut",delay:F,onComplete:()=>{4===i&&(t.gameData.turbo||t.audioManager.ReelDrop.play()),e()}})}));u.push(e),this.container.add(f),c[i][r]=f}}this.symbolGrid=c,await Promise.all(u),r.emitter.emit(r.SPIN_ANIMATION_END,{symbols:e,currentRow:i.currentRow})}async processMatchesSequentially(t,e,i){var s;let n,a=!0;try{for(;a;){const s=await this.checkMatchAsync(e,t,i[this.currentIndex]);n=s,"No more matches"===s||"free spins"===s?a=!1:"continue match"===s&&(this.hadMatchThisSpin=!0,this.currentIndex<i.length?this.currentIndex++:(console.log("No more tumbles, stopping match"),a=!1))}}catch(o){console.error("Error in match processing: "+o)}finally{if(this.hadMatchThisSpin){let e=!1;for(let t=0;t<((null==(s=this.symbolGrid)?void 0:s.length)||0);t++){const i=this.symbolGrid[t];if(i){for(let t=0;t<i.length;t++)if(i[t]instanceof Ms){e=!0;break}if(e)break}}await this.explodeAndRemoveAllBombs(t);try{r.emitter.emit(r.WIN,{applyMultiplier:!0})}catch(l){}this.hadMatchThisSpin=!1,e&&await new Promise((e=>{t.time.delayedCall(1e3,(()=>e()))}))}if(!t.gameData.useApiFreeSpins&&this.deferredScatterCount>0){const i=this.deferredScatterCount;this.deferredScatterCount=0;const s=e.length,n=e[0].length,a=[];for(let t=0;t<s;t++)for(let i=0;i<n;i++)if(0===e[t][i]&&this.symbolGrid[t][i]){const e=this.symbolGrid[t][i];e instanceof Phaser.GameObjects.Sprite&&a.push(e)}await this.animateScatterSymbols(t,a,i)}r.emitter.emit(r.TUMBLE_SEQUENCE_DONE,{symbolGrid:e}),t.gameData.isSpinning=!1;let n=0;i.forEach((t=>{n+=t.win})),t.gameData.isBonusRound||r.emitter.emit(r.UPDATE_BALANCE,n),t.gameData.useApiFreeSpins&&r.emitter.emit(r.FREE_SPIN_TOTAL_WIN),t.buttons&&t.buttons.enableButtonsVisually&&t.buttons.enableButtonsVisually(t)}}eventListeners(t){r.emitter.on(r.SPIN,(async e=>{const i=Date.now();if(i<(t.gameData.freeSpinLockUntilMs||0))console.log(`Spin blocked: free spin lockout active for ${t.gameData.freeSpinLockUntilMs-i}ms`);else if(t.gameData.isSpinning)console.log("Spin already in progress, ignoring new spin request");else if(this.hadMatchThisSpin=!1,this.bonusTriggeredThisSpin=!1,this.currentIndex=0,i-this.lastSpinTimestamp<this.MIN_SPIN_INTERVAL)console.log(`Spin rate limited, ${this.MIN_SPIN_INTERVAL}ms cooldown active`);else{t.gameData.isSpinning=!0,this.lastSpinTimestamp=i,this.hideSymbolCountWinDisplay(),this.cleanupAloneSymbols();try{t.gameData.useApiFreeSpins&&r.emitter.emit(r.FREE_SPIN_TOTAL_WIN)}catch(s){}t.buttons&&t.buttons.updateButtonStates&&t.buttons.updateButtonStates(t);try{t.gameData.debugged>0&&(t.gameData.demoMode=!0),t.audioManager.ReelStart.play();try{r.emitter.emit(r.SPIN_ANIMATION_START,{currentRow:t.gameData.currentRow})}catch(s){}if(t.gameData.demoMode){_.TOGGLE_DIFFICULTY=!0,_.DIFFICULTY_SYMBOLS=t.gameData.debugged;const e=Array(_.ROWS).fill(null).map((()=>Ps()));await this.playSpinAnimations(t,e,{symbols:e,currentRow:0,isBuyFeature:!1,isEnhancedBet:!1,betAmount:t.gameData.bet});const i={symbols:{in:e,out:[]},win:0};await this.processMatchesSequentially(t,e,[i])}else _.TOGGLE_DIFFICULTY=!1,_.DIFFICULTY_SYMBOLS=4,await this.createReel(t,e)}catch(n){console.error("Error during spin: "+n),t.gameData.isSpinning=!1,t.buttons&&t.buttons.enableButtonsVisually&&t.buttons.enableButtonsVisually(t)}}})),r.emitter.on(r.START,(e=>{this.createSampleSymbols(t,e.symbols)}))}createSampleSymbols(t,e){const i=_.ROWS,s=_.COLUMNS,n=this.symbolDisplayWidth,a=this.symbolDisplayHeight,o=this.horizontalSpacing,r=this.verticalSpacing;this.symbolGrid=Array(i).fill(null).map((()=>Array(s).fill(null))),Object.assign(this.symbolGrid,{map:t=>Array(i).fill(null).map(((e,i)=>t(this.symbolGrid[i],i))),forEach:t=>Array(i).fill(null).forEach(((e,i)=>t(this.symbolGrid[i],i)))});for(let l=0;l<i;l++){let i=0;for(let h=0;h<s;h++){const s=e[l][h];let c="Symbol0_SW",d="Symbol0_SW-00000.png";s>=1&&s<=9&&(c=`Symbol${s}_SW`,d=`Symbol${s}_SW-00000.png`);const u=.5*n+h*(n+o),m=.5*a+l*(a+r),g=t.add.sprite(u,m,c,d);0===s&&i<3?(i++,g.setDisplaySize(n*_.SCATTER_SIZE,a*_.SCATTER_SIZE)):g.setDisplaySize(n*_.SYMBOL_SIZE,a*_.SYMBOL_SIZE),this.container.add(g),this.symbolGrid[l][h]=g}}}async spin(t,e){const i=t,s={symbols:e.symbols,currentRow:0,isBuyFeature:t.gameData.buyFeatureEnabled,isEnhancedBet:t.gameData.doubleChanceEnabled,betAmount:t.gameData.bet};if(i.gameData.scatterCount>0&&i.gameData.slot.placeScatters(i.gameData.minScatter,i.gameData.maxScatter,i.gameData.scatterChance),i.gameData.isBonusRound){const t=e.symbols.map((t=>[...t]));for(let e=0;e<_.ROWS;e++)for(let s=0;s<_.COLUMNS;s++)if(t[e][s]>=1&&t[e][s]<=9&&Math.random()<i.gameData.bombChance/100){const n=Math.random();let a;a=n<.6?Math.floor(7*Math.random())+10:n<.9?Math.floor(4*Math.random())+17:Math.floor(2*Math.random())+21,t[e][s]=a,i.gameData.slot.bombCount++}s.symbols=t}this.createReel(i,s)}showBonusWin(t,e){var i,s,n,a,o;try{const a=t.gameData.bet||1,o=(null==(i=t.gameData.winRank)?void 0:i[5])||21e3;if(a>0&&e/a>=o&&this.maxWinClaim){this.maxWinClaim.show(t,o,(()=>{this.enqueueWinOverlay(t,e,"Congrats")}));try{(null==(n=null==(s=t.buttons)?void 0:s.autoplayIndicator)?void 0:n.visible)||(t.buttons.freeSpinBtn.visible=!1)}catch(r){}return}}catch(r){}this.enqueueWinOverlay(t,e,"Congrats");try{(null==(o=null==(a=t.buttons)?void 0:a.autoplayIndicator)?void 0:o.visible)||(t.buttons.freeSpinBtn.visible=!1)}catch(r){}}update(){}showFreeSpinsPopup(t,e){this.activeWinOverlay?(r.emitter.once(r.WIN_OVERLAY_HIDE,(()=>{t.time.delayedCall(200,(()=>{this.showWinOverlay(t,e,-1)}))})),console.log(`[BONUS] Overlay active, waiting to show congrats popup (FS=${e})`)):t.time.delayedCall(100,(()=>{this.showWinOverlay(t,e,-1)}))}showWinOverlay(t,e,i){let s;if(-1===i?s="FreeSpin":-2===i&&(s="Congrats"),!s){let t=1;if(t=i>0?e/i:i,0===t)return;s=t.toString()}this.enqueueWinOverlay(t,e,s)}destroyWinOverlay(t){[...this.winOverlayContainers].forEach((t=>t.destroy())),this.winOverlayContainers=[],this.activeWinOverlay=!1,t.audioManager.stopWinSFX(t),r.emitter.emit(r.WIN_OVERLAY_HIDE)}enqueueWinOverlay(t,e,i){this.winOverlayQueue.push({totalWin:e,overlayType:i}),this.tryShowNextOverlay(t)}tryShowNextOverlay(t){if(this.activeWinOverlay)return;if(0===this.winOverlayQueue.length)return;const e=this.winOverlayQueue.shift();if(!e)return;const i=new Ts(t,this.winAnimation);this.winOverlayContainers.push(i),this.activeWinOverlay=!0,console.error("next",e),i.show(e.totalWin,e.overlayType)}createWinParticles(t,e,i,s=16766720){const n=t.add.particles(e,i,"star",{speed:{min:200,max:400},angle:{min:0,max:360},scale:{start:.4,end:0},blendMode:"ADD",lifespan:1e3,gravityY:300,quantity:1,frequency:50,tint:s,emitting:!1}),a=t.add.particles(e,i,"star",{speed:{min:50,max:100},angle:{min:0,max:360},scale:{start:.2,end:.4,ease:"Quad.easeOut"},alpha:{start:.5,end:0},blendMode:"ADD",lifespan:1500,quantity:1,frequency:50,tint:s,emitting:!1});n.explode(15),a.explode(10);const o=t.add.graphics();o.lineStyle(2,s,1),o.strokeCircle(0,0,10),o.setPosition(e,i),t.tweens.add({targets:o,scaleX:2,scaleY:2,alpha:0,duration:1e3,ease:"Quad.easeOut",onComplete:()=>{o.destroy()}}),t.time.delayedCall(1500,(()=>{n.destroy(),a.destroy()}))}async checkMatchAsync(t,e,i){const s=t.length,n=t[0].length,a={},o={};for(let r=0;r<s;r++)for(let e=0;e<n;e++){const i=t[r][e];a[i]=(a[i]||0)+1,o[i]||(o[i]=[]),o[i].push({row:r,col:e})}const l=[];for(const r in a)a[r]>=8&&l.push(parseInt(r));if(0===l.length){if(!e.gameData.useApiFreeSpins){const t=a[0]||0;(t>=4||e.gameData.isBonusRound&&t>=3)&&(this.deferredScatterCount=t)}return r.emitter.emit(r.WIN,{}),r.emitter.emit(r.SPIN_ANIMATION_END,{symbols:t,newRandomValues:t}),0===this.deferredScatterCount&&r.emitter.emit(r.MATCHES_DONE,{symbolGrid:t}),this.cleanupAloneSymbols(),"No more matches"}const h=[];l.forEach((t=>{o[t].forEach((e=>{h.push({...e,symbol:t})}))})),e.gameData.bet;let c=0;const d=[];l.forEach((t=>{var e,s;const n=o[t];c+=(null==(e=i.symbols.out.find((e=>e.symbol===t)))?void 0:e.win)||0,r.emitter.emit(r.WIN,{win:c}),d.push({symbol:t,count:n.length,win:(null==(s=i.symbols.out.find((e=>e.symbol===t)))?void 0:s.win)||0})})),e.gameData.isBonusRound&&e.gameData.useApiFreeSpins,r.emitter.emit(r.WIN,{}),this.showSymbolCountWinDisplay(e,d),r.emitter.emit(r.UPDATE_TOTAL_WIN,c),this.isMobile||l.forEach((t=>{this.showWinPopup(e,o[t],function(){var e;let s=0;return s=(null==(e=i.symbols.out.find((e=>e.symbol===t)))?void 0:e.win)||0,s}())}));const u=Array.from({length:s},(()=>Array(n).fill(!1)));return h.forEach((({row:t,col:e})=>{u[t][e]=!0})),await this.animateMatchedSymbols(e,h.map((({row:t,col:e,symbol:i})=>({row:t,col:e,symbol:i})))),await this.dropAndRefillAsync(t,u,e,i),"continue match"}async handleScatterMatch(t,e,i){var s,n;t.gameData.isSpinning=!0;try{null==(n=null==(s=t.buttons)?void 0:s.disableButtonsVisually)||n.call(s,t)}catch(h){}console.log(`[SCATTER] handleScatterMatch start, scatterCount=${i}`);let a=[];const o=e.length,l=e[0].length;for(let r=0;r<o;r++)for(let t=0;t<l;t++)0===e[r][t]&&this.symbolGrid[r][t]&&a.push(this.symbolGrid[r][t]);return console.log(`[SCATTER] Found ${a.length} scatter sprites to animate`),await this.animateScatterSymbols(t,a,i),console.log("[SCATTER] Scatter animations complete, emitting MATCHES_DONE"),r.emitter.emit(r.MATCHES_DONE,{symbolGrid:e}),"free spins"}async animateScatterSymbols(t,e,i){if(0===e.length)return console.log("[SCATTER] No scatter sprites found, proceeding to handleScatterRewards"),void this.handleScatterRewards(t,i);console.log(`[SCATTER] Animating ${e.length} scatter sprites`),t.audioManager.ScatterSFX.play();const s=[];e.forEach(((e,i)=>{const n=new Promise((i=>{this.createWinParticles(t,e.x,e.y,16711680);try{this.animation.playSymbolAnimation(e,0)}catch(s){}e.once("animationcomplete",(()=>{e.alpha=0,i()}))}));s.push(n)})),await Promise.all(s),this.handleScatterRewards(t,i)}handleScatterRewards(t,e){var i,s,n,a;let o=t.gameData.freeSpins||0;if(t.gameData.isBonusRound){let i=0;(3===e||4===e||5===e||6===e)&&(i=5),t.gameData.freeSpins+=i,t.buttons.autoplay.isAutoPlaying&&t.buttons.autoplay.updateRemainingSpinsDisplay(),console.log("[BONUS] Showing retrigger popup"),this.showRetriggerPopup(t,i)}else{this.bonusTriggeredThisSpin=!0;try{t.buttons.autoplayIndicator.visible=!!(null==(s=null==(i=t.buttons)?void 0:i.autoplay)?void 0:s.isAutoPlaying),t.buttons.freeSpinBtn.visible=!0,t.buttons.updateButtonStates(t)}catch(l){}(4===e||5===e||6===e)&&(o+=10),t.gameData.freeSpins=o,t.gameData.totalBonusWin=0,t.buttons.autoplay.isAutoPlaying&&t.buttons.autoplay.pauseForBonus();try{t.gameData.freeSpinLockUntilMs=Date.now()+5e3,null==(a=null==(n=t.time)?void 0:n.delayedCall)||a.call(n,5e3,(()=>{var e,i;try{null==(i=null==(e=t.buttons)?void 0:e.updateButtonStates)||i.call(e,t)}catch(l){}}))}catch(l){}r.emitter.once(r.MATCHES_DONE,(()=>{try{t.buttons.freeSpinTriggered=!0,t.buttons.updateButtonStates(t)}catch(l){}t.gameData.isBonusRound=!0,console.log(`[BONUS] Initial trigger: animations done â†’ set isBonusRound=true; showing Congrats overlay for FS=${o}`),this.showFreeSpinsPopup(t,o)}))}}showRetriggerPopup(t,e){new As(t).show(e,(()=>{t.gameData.useApiFreeSpins||r.emitter.emit(r.SPIN,{currentRow:t.gameData.currentRow,symbols:t.gameData.slot.values})}))}showWinPopup(t,e,i){const s=_.ROWS,n=_.COLUMNS,a=(s-1)/2,o=(n-1)/2;let r=1/0,l={x:t.scale.width/2,y:t.scale.height/2};e.forEach((({row:t,col:e})=>{const i=Math.abs(t-a)+Math.abs(e-o);if(i<r&&this.symbolGrid[t][e]){r=i;const s=this.symbolGrid[t][e];l={x:s.x,y:s.y}}}));const h=t.add.text(l.x,l.y,`+$${i.toFixed(2)}`,{fontSize:"64px",color:"#FFD700",fontStyle:"bold",stroke:"#000",strokeThickness:6,fontFamily:"Poppins"});h.setOrigin(.5,.5),h.setDepth(100),t.tweens.add({targets:h,y:l.y-80,alpha:0,scale:1.5,duration:2e3,ease:"Back.easeOut",onComplete:()=>{h.destroy()}})}async animateMatchedSymbols(t,e){t.audioManager.playRandomQuickWin(t);const i=[];e.forEach((({row:e,col:s,symbol:n})=>{const a=this.symbolGrid[e][s];if(a)if(a instanceof Ms){const e=new Promise((e=>{t.tweens.add({targets:a,alpha:0,scale:.5,duration:1e3,ease:"Circ.easeInOut",onComplete:()=>{a.destroy(),e()}})}));i.push(e)}else{const t=n,e=new Promise((e=>{this.animation.playSymbolAnimation(a,t),a.once("animationcomplete",(()=>{a.destroy(),e()}))}));i.push(e)}})),t.gameData.currentMatchingSymbols=e.map((({symbol:t})=>t)),await Promise.all(i)}async dropAndRefillAsync(t,e,i,s){i.gameData.debugLog("processing drop and refill");const n=t.length,a=t[0].length,o=this.symbolDisplayWidth,l=this.symbolDisplayHeight,h=this.horizontalSpacing,c=this.verticalSpacing;this.cleanupAloneSymbols();const d=[];for(let r=0;r<a;r++){const a=[];let u=[];for(let i=0;i<n;i++)e[i][r]||(a.push(t[i][r]),u.push(i));const m=n-a.length;for(let t=0;t<m;t++){const e=s.symbols.in[r][t];a.unshift(e)}const g=[];let p=n-1;for(let e=u.length-1;e>=0;e--){const s=u[e],n=this.symbolGrid[s][r];if(n&&n.active){const e=.5*l+p*(l+c),a=new Promise((t=>{i.tweens.add({targets:n,y:e,duration:300,ease:"Cubic.easeIn",onComplete:()=>t()})}));d.push(a),g[p]=n,t[p][r]=t[s][r]}p--}for(let e=0;e<m;e++){const s=a[e];let n="Symbol0_SW",u="Symbol0_SW-00000.png";s>=1&&s<=9&&(n=`Symbol${s}_SW`,u=`Symbol${s}_SW-00000.png`);const p=.5*l,b=.5*o+r*(o+h),f=p+(e-m)*(l+c),y=p+e*(l+c);let w;s>=10&&s<=22?(w=new Ms(i,b,f,s,i.gameData),w.setBombDisplaySize(o*_.SYMBOL_SIZE*_.BOMB_SCALE,l*_.SYMBOL_SIZE*_.BOMB_SCALE),i.gameData.debugLog("Created BombContainer for dropAndRefill",{symbolValue:s,position:{x:b,y:f}})):(w=i.add.sprite(b,f,n,u),0===s?w.setDisplaySize(o*_.SCATTER_SIZE,l*_.SCATTER_SIZE):w.setDisplaySize(o*_.SYMBOL_SIZE,l*_.SYMBOL_SIZE)),w&&s>=10&&s<=22&&w.setDepth(1e3),this.container.add(w),g[e]=w,t[e][r]=s;const S=new Promise((t=>{i.tweens.add({targets:w,y:y,duration:300,ease:"Cubic.easeIn",onComplete:()=>t()})}));d.push(S)}for(let t=0;t<n;t++)g[t]&&(this.symbolGrid[t][r]=g[t])}await Promise.all(d),i.gameData.bet,i.gameData.totalWin,await new Promise((t=>{i.time.delayedCall(1,(()=>{i.audioManager.playWinSFX("tumble"),t()}))})),this.hideSymbolCountWinDisplay(),r.emitter.emit(r.MATCHES_DONE,{symbolGrid:t})}async explodeAndRemoveAllBombs(t){const e=[];for(let s=0;s<this.symbolGrid.length;s++)for(let t=0;t<this.symbolGrid[s].length;t++){const i=this.symbolGrid[s][t];i instanceof Ms&&e.push({bomb:i,row:s,col:t})}e.sort(((t,e)=>t.col-e.col||t.row-e.row));for(const{bomb:s,row:n,col:a}of e){try{s.showExplosion()}catch(i){}await new Promise((e=>{t.time.delayedCall(600,(()=>{s&&s.active,this.symbolGrid[n][a]=null,e()}))})),await new Promise((e=>{t.time.delayedCall(200,(()=>e()))}))}}cleanupAloneSymbols(){this.container.each((t=>{if((t instanceof Phaser.GameObjects.Sprite||t instanceof vs||t instanceof Ms)&&t.active){let e=!1;for(let i=0;i<this.symbolGrid.length;i++){for(let s=0;s<this.symbolGrid[i].length;s++)if(this.symbolGrid[i][s]===t){e=!0;break}if(e)break}e||t.parentContainer!==this.container||t.destroy()}}))}destroy(){[...this.winOverlayContainers].forEach((t=>t.destroy())),this.winOverlayContainers=[],this.bombPopupContainer&&(this.bombPopupContainer.destroy(),this.bombPopupContainer=null),this.clearSymbolCountWinTexts(),this.symbolCountWinContainer&&(this.symbolCountWinContainer.destroy(),this.symbolCountWinContainer=null),this.container&&this.container.destroy(),this.activeWinOverlay=!1,this.tweensToComplete=0,this.onOverlayHide&&(r.emitter.off(r.WIN_OVERLAY_HIDE,this.onOverlayHide),this.onOverlayHide=void 0)}async getBalance(t){const e=t;try{await e.gameAPI.getBalance()}catch(i){console.error("Failed to fetch balance:",i)}}hasActiveBombAnimations(){if(this.bombAnimationActive)return!0;for(let t=0;t<this.symbolGrid.length;t++)for(let e=0;e<this.symbolGrid[t].length;e++){const i=this.symbolGrid[t][e];if(i instanceof Ms&&i.isPlayingAnimation())return!0}return!1}setBombAnimationActive(t){this.bombAnimationActive=t,t&&setTimeout((()=>{this.bombAnimationActive=!1}),5e3)}async checkMatchForSymbolAsync(t,e,i,s){const n=t.length,a=t[0].length,o=[];for(let l=0;l<n;l++)for(let e=0;e<a;e++)t[l][e]===i&&o.push({row:l,col:e,symbol:i});if(0===o.length)return"No matches for symbol";await this.animateMatchedSymbols(e,o);const r=t.map((t=>t.map((t=>t===i))));return await this.dropAndRefillAsync(t,r,e,s),"continue match"}SymbolCountWin(t){0!==t.length&&t.forEach((t=>{t.count>1&&(t.win=t.count*t.symbol)}))}}class Rs extends Cs{start(t){setTimeout((()=>{this.stateMachine&&this.stateMachine.setState(new Bs,t)}),100)}update(t,e,i){}end(t){}}class _s{constructor(){s(this,"spineObject")}preload(t){const e="assets/Assets/Character";t.load.spineAtlas("character-atlas",`${e}/char.atlas`),t.load.spineJson("character",`${e}/char.json`)}isMobileDevice(){const t=new URLSearchParams(window.location.search);return"mobile"==t.get("device")||"desktop"!=t.get("device")&&(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768)}create(t){let e=t.scale.width,i=t.scale.height,s=this.isMobileDevice()?.8*e:.14*e,n=this.isMobileDevice()?.13*i:.5*i;this.spineObject=t.add.spine(s,n,"character","character-atlas"),this.spineObject.setScale(this.isMobileDevice()?.12:.25),this.spineObject.animationState.setAnimation(0,"Idle",!0),this.spineObject.setDepth(10),r.emitter.on(r.WIN_OVERLAY_SHOW,(()=>{this.spineObject&&this.spineObject.animationState&&(this.spineObject.animationState.timeScale=0)})),r.emitter.on(r.WIN_OVERLAY_HIDE,(()=>{this.spineObject&&this.spineObject.animationState&&(this.spineObject.animationState.timeScale=1)})),r.emitter.on(r.SESSION_TIMEOUT,(()=>{this.spineObject&&this.spineObject.animationState&&(this.spineObject.animationState.timeScale=0)}))}}class Ws{constructor(){s(this,"container"),s(this,"scrollView"),s(this,"contentContainer"),s(this,"mask"),s(this,"isVisible",!1),s(this,"scene"),s(this,"viewWidth",1329),s(this,"isMobile",!1),s(this,"padding",20),s(this,"contentWidth",1200),s(this,"titleStyle",{fontSize:"24px",color:"#379557",fontFamily:"Poppins",fontStyle:"bold"}),s(this,"textStyle",{fontSize:"24px",color:"#FFFFFF",fontFamily:"Poppins",align:"left",wordWrap:{width:this.contentWidth}}),s(this,"yPosition",0),this.isVisible=!1}isMobileDevice(){const t=new URLSearchParams(window.location.search);return"mobile"==t.get("device")||"desktop"!=t.get("device")&&(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768)}preload(t){const e="assets/Symbols/HelpScreen/";t.load.image("ScatterLabel",`${e}ScatterSymbol.png`),t.load.image("BuyFeatHelp",`${e}BuyFeatHelp.png`),t.load.image("DoubleHelp",`${e}DoubleHelp.png`),t.load.image("BuyFeatMobile",`${e}BuyFeatMobile.png`),t.load.image("DoubleHelpMobile",`${e}DoubleHelpMobile.png`),t.load.image("tumbleSymbol",`${e}tumbleIcon.png`),t.load.image("tumbleGame",`${e}tumbleGame.png`),t.load.image("tumbleWin",`${e}tumbleWin.png`),t.load.image("scatterIcon",`${e}scatterIcon.png`),t.load.image("scatterGame",`${e}scatterGame.png`),t.load.image("scatterWin",`${e}scatterWin.png`),t.load.image("multiplierIcon",`${e}multiplierIcon.png`),t.load.image("multiplierGame",`${e}multiplierGame.png`),t.load.image("paylineWin1",`${e}paylineWin1.png`),t.load.image("paylineWin2",`${e}paylineWin2.png`),t.load.image("paylineNoWin1",`${e}paylineNoWin1.png`),t.load.image("paylineNoWin2",`${e}paylineNoWin2.png`),t.load.image("paylineMobileWin",`${e}paylineMobileWin.png`),t.load.image("paylineMobileNoWin",`${e}paylineMobileNoWin.png`),t.load.image("howToPlay1",`${e}HowToPlay1.png`),t.load.image("howToPlay2",`${e}HowToPlay2.png`),t.load.image("howToPlay3",`${e}HowToPlay3.png`),t.load.image("howToPlay4",`${e}HowToPlay4.png`),t.load.image("howToPlay5",`${e}HowToPlay5.png`),t.load.image("howToPlay6",`${e}HowToPlay6.png`),t.load.image("howToPlay7",`${e}HowToPlay7.png`),t.load.image("howToPlay8",`${e}HowToPlay8.png`),t.load.image("howToPlay9",`${e}HowToPlay9.png`),t.load.image("howToPlay10",`${e}HowToPlay10.png`),t.load.image("howToPlay1Mobile",`${e}HowToPlay1Mobile.png`),t.load.image("howToPlay2Mobile",`${e}HowToPlay2Mobile.png`),t.load.image("howToPlay3Mobile",`${e}HowToPlay3Mobile.png`),t.load.image("howToPlay4Mobile",`${e}HowToPlay4Mobile.png`),t.load.image("howToPlay8Mobile",`${e}HowToPlay8Mobile.png`),t.load.image("howToPlay9Mobile",`${e}HowToPlay9Mobile.png`),t.load.image("howToPlay10Mobile",`${e}HowToPlay10Mobile.png`),t.load.image("howToPlay11Mobile",`${e}HowToPlay11Mobile.png`),t.load.image("howToPlay12Mobile",`${e}HowToPlay12Mobile.png`),t.load.image("greenRectBtn","assets/Buttons/greenRectBtn.png"),t.load.image("ekis","assets/Buttons/ekis.png")}create(t){this.isMobile=this.isMobileDevice();const e=t.scale.height,i=this.isMobile?16:64;this.viewWidth=this.isMobile?t.scale.width:1329,this.container=t.add.container(-this.viewWidth,0),this.container.setDepth(1e3),this.container.setVisible(!1);const s=t.add.graphics();s.fillStyle(0,.8),s.fillRoundedRect(0,0,.975*this.viewWidth,e,1),s.strokeRoundedRect(0,0,.975*this.viewWidth,e,1),this.container.add(s),this.scrollView=t.add.container(i,i),this.container.add(this.scrollView),this.contentContainer=t.add.container(0,0),this.scrollView.add(this.contentContainer);const n=t.add.graphics();n.fillStyle(16777215),n.fillRect(this.container.x+i,this.container.y+i,this.viewWidth-2*i,.8*e-2*i);const a=t.add.container(this.isMobile?this.viewWidth-6*i:this.viewWidth-1.5*i,this.isMobile?2*i:i),o=t.add.image(0,0,"greenRectBtn");o.setScale(this.isMobile?.125:.25,this.isMobile?.25:.5);const l=t.add.image(0,0,"ekis");l.setOrigin(.5,.5),l.setScale(this.isMobile?.5:1),o.setPosition(o.x+o.width/4,o.y),l.setPosition(l.x+o.width/4,l.y),a.add(o),a.add(l);const h=o.displayWidth*(this.isMobile?2.2:3),c=o.displayHeight*(this.isMobile?2.2:3),d=new Phaser.Geom.Rectangle(o.x-h/2,o.y-c/2,h,c);a.setInteractive(d,Phaser.Geom.Rectangle.Contains).on("pointerover",(()=>o.setTint(4194061))).on("pointerout",(()=>o.clearTint())).on("pointerdown",(()=>{t.audioManager.UtilityButtonSFX.play(),this.hide(t),t.gameData.isHelpScreenVisible=!1,r.emitter.emit(r.HELP_SCREEN_TOGGLE)}));const u=t.add.graphics();u.fillStyle(1118481,.01);const m=this.viewWidth,g=Math.max(0,t.scale.width-this.viewWidth);u.fillRect(0,0,g,t.scale.height),u.setInteractive(new Phaser.Geom.Rectangle(0,0,g,t.scale.height),Phaser.Geom.Rectangle.Contains),u.on("pointerdown",(()=>{t.audioManager.UtilityButtonSFX.play(),this.hide(t),t.gameData.isHelpScreenVisible=!1,r.emitter.emit(r.HELP_SCREEN_TOGGLE)})),this.container.add(a),this.container.add(u),u.setPosition(m,0),this.isMobile||this.createContent(t),this.enableScrolling(t),this.contentContainer.setSize(this.isMobile?-this.viewWidth:-this.contentWidth,this.yPosition),this.contentContainer.setInteractive(),this.contentContainer.setPosition(this.isMobile?0:2*-this.padding,0)}createContent(t){this.padding=32,this.contentWidth=1200,this.yPosition=0,this.addContent(t,"Game Rules","title"),this.yPosition-=this.padding/2,this.addContent(t,"Win by landing 8 or more matching symbols anywhere on the screen.","text",!0,this.contentWidth-2*this.padding),this.yPosition-=this.padding/2,this.addContent(t,"The more matching symbols you get, the higher your payout.","text",!0,this.contentWidth-4*this.padding),this.addContent(t,"RTP","title"),this.yPosition-=this.padding/2,this.addContent(t,"96.49% - 96.6%","text"),this.yPosition+=this.padding,this.addContent(t,"Payout","title"),this.yPosition+=1.5*this.padding;const e=76.5,i=(this.contentWidth-374.5)/10;for(let D=0;D<3;D++){for(let e=0;e<3;e++){const s=3*D+e+1,n=i+399.5*e,a=this.yPosition+10,o=t.add.container(n,a);this.createBorder(t,o,-this.padding,-76.5,393.3,150.999984);const r=t.add.sprite(0,0,`Symbol${s}_SW`);r.setFrame(`Symbol${s}_SW-00000.png`),6===s?(r.setScale(.8),r.setOrigin(.2,.45)):(r.setScale(.7),r.setOrigin(.2,.5)),o.add(r),this.createPayoutTable(t,107.1,-this.padding,o,s),this.contentContainer.add(o)}this.yPosition+=e+2.5*this.padding}const s=t.add.text(2.5*this.padding,this.yPosition-1.5*this.padding,"Scatter",{...this.textStyle});this.contentContainer.add(s);const n=t.add.container(i-this.padding/2,this.yPosition+this.padding);this.createBorder(t,n,-this.padding/2,-95.625,1193.9175,246.999987);const a=t.add.sprite(this.padding,2*this.padding,"ScatterLabel");a.setScale(.28),a.setOrigin(-.66,.65),n.add(a),this.createPayoutTable(t,306.9,this.padding,n,0),this.contentContainer.add(n),this.contentContainer.sendToBack(n),this.yPosition+=e+4*this.padding,this.addDivider(t),this.addContent(t,"Tumble Win","title"),this.yPosition-=this.padding/2;const o=t.add.container(this.padding,this.yPosition),r=t.add.image(0,0,"tumbleGame");r.setScale(1),r.setOrigin(.5,.5),r.setPosition(564.5+2*this.padding,r.height/2+this.padding),o.add(r);const l=t.add.image(0,0,"tumbleSymbol");l.setScale(1),l.setOrigin(.5,.5),l.setPosition(r.x-r.displayWidth/2,.75*l.height),o.add(l);const h=t.add.image(0,0,"tumbleWin");h.setScale(1),h.setOrigin(.5,.5),h.setPosition(l.x-l.displayWidth/2+this.padding,l.y-h.height/2),o.add(h);const c=t.add.text(0,0,"After each spin, winning symbols are paid and then removed from the screen. Remaining symbols drop down, and new ones fall from above to fill the empty spaces.\n\nTumbles continue as long as new winning combinations appear â€” there's no limit to the number of tumbles per spin.\n\nAll wins are credited to the player's balance after all tumbles from a base spin are completed.",{...this.textStyle,wordWrap:{width:1200.9997170000001-2*this.padding}});c.setPosition(this.padding,h.displayHeight/2+r.displayHeight+this.padding),o.add(c),this.yPosition+=this.createBorder(t,o,0,0,1200.9997170000001,688.5),this.contentContainer.add(o),this.yPosition+=2*this.padding,this.addDivider(t),this.yPosition-=this.padding/2,this.addContent(t,"Free Spins Rules","title"),this.yPosition-=this.padding/2;const d=t.add.container(this.padding,this.yPosition),u=t.add.image(0,0,"scatterGame");u.setScale(1),u.setOrigin(.5,.5),u.setPosition(564.5+2*this.padding,u.height/2+this.padding),d.add(u);const m=t.add.image(0,0,"scatterIcon");m.setScale(1),m.setOrigin(.5,.5),m.setPosition(u.x-u.displayWidth/2-2*this.padding,m.height+this.padding),d.add(m);const g=t.add.image(0,0,"scatterIcon");g.setScale(.65),g.setOrigin(.5,.5),g.setRotation(.3),g.setPosition(m.x-1.5*this.padding,m.y-2.5*this.padding),d.add(g);const p=t.add.image(0,0,"scatterIcon");p.setScale(.7),p.setOrigin(.5,.5),p.setRotation(-.3),p.setPosition(m.x-1.5*this.padding,m.y+2.5*this.padding),d.add(p);const b=t.add.image(0,0,"scatterIcon");b.setScale(.55),b.setOrigin(.5,.5),b.setRotation(.3),b.setPosition(m.x+1.5*this.padding,m.y+1.5*this.padding),d.add(b),d.bringToTop(m);const f=t.add.image(0,0,"scatterWin");f.setScale(1),f.setOrigin(.5,.5),f.setPosition(m.x+m.displayWidth/3,3*m.y/4-f.height/2+this.padding),d.add(f);const y=t.add.image(0,0,"scatterIcon");y.setScale(.25),y.setOrigin(.5,.5),y.setPosition(u.x-u.displayWidth/2-2.5*this.padding,m.y+m.displayHeight+2.75*this.padding),d.add(y);const w=t.add.text(0,0,"Bonus Trigger\n\nLand 4 or more          SCATTER   symbols anywhere on the screen to trigger the FREE SPINS feature.\n\nYou'll start with 10 free spins.\n\nDuring the bonus round, hitting 3 or more SCATTER symbols awards 5 extra free spins",{...this.textStyle,wordWrap:{width:1200.9997170000001}});w.setPosition(this.padding,f.displayHeight/2+u.displayHeight+this.padding),d.add(w),this.yPosition+=this.createBorder(t,d,0,0,1200.9997170000001,688.5),this.contentContainer.add(d),this.yPosition+=this.padding;const S=t.add.container(this.padding,this.yPosition),x=t.add.image(0,0,"multiplierGame");x.setScale(1),x.setOrigin(.5,.5),x.setPosition(564.5+2*this.padding,x.height/2+this.padding),S.add(x);const F=t.add.image(0,0,"multiplierIcon");F.setScale(.75),F.setOrigin(.5,.5),F.setPosition(x.x-x.displayWidth/2-this.padding,F.height-2*this.padding),S.add(F);const v=t.add.text(0,0,"Multiplier\n\nThe         Multiplier symbol appears only during the FREE SPINS round and remains on the screen until the tumbling sequence ends\n\nEach time a          lands, it randomly takes a multiplier value:\n2x, 3x, 4x, 5x, 6x, 8x, 10x, 12x, 15x, 20x, 25x, 50x, or even 100x!\n\nOnce all tumbles are finished , the total of all         multipliers are added and applied to the total win of that sequence\n\nSpecial reels are used during the FREE SPINS round",{...this.textStyle,wordWrap:{width:1200.9997170000001-1.88*this.padding}}),T=t.add.image(0,0,"multiplierIcon");T.setScale(.15),T.setOrigin(.5,.5),T.setPosition(x.x-3*x.displayWidth/4-2.25*this.padding,1.95*F.height),S.add(T);const A=t.add.image(0,0,"multiplierIcon");A.setScale(.15),A.setOrigin(.5,.5),A.setPosition(x.x-3*x.displayWidth/5+this.padding/2-2.5*this.padding,7*F.height/3+.1*this.padding),S.add(A);const M=t.add.image(0,0,"multiplierIcon");M.setScale(.175),M.setOrigin(.5,.5),M.setPosition(x.x+.06*x.displayWidth-2.25*this.padding,8*F.height/3+.1*this.padding),S.add(M),v.setPosition(this.padding,F.displayHeight/2+3*x.displayHeight/4+this.padding),S.add(v),this.yPosition+=this.createBorder(t,S,0,0,1200.9997170000001,726.75),this.contentContainer.add(S),this.yPosition+=this.padding,this.addContent(t,"Game Settings","title"),this.yPosition-=this.padding/2;const C=t.add.container(this.padding,this.yPosition),B=t.add.text(0,0,"Paylines\n\nSymbols can land anywhere on the screen.\n\n",{...this.textStyle,wordWrap:{width:1200.9997170000001}});B.setPosition(this.padding,this.padding),C.add(B);const P=t.add.image(0,3*this.padding,"paylineMobileWin");P.setScale(1),P.setOrigin(.5,.5),P.setPosition(564.5,P.height/2+4*this.padding),C.add(P);const I=t.add.image(P.x,P.y,"paylineMobileNoWin");I.setScale(1),I.setOrigin(.5,.5),I.setPosition(P.x,P.y+P.displayHeight+2*this.padding),C.add(I);const E=t.add.text(0,0,"All wins are multiplied by the base bet.\n\nWhen multiple symbol wins occur, all values are combined into the total win.\n\nFree spins rewards are granted after the round ends.",{...this.textStyle,wordWrap:{width:1200.9997170000001}});E.setPosition(this.padding,I.height/2+I.y+this.padding),C.add(E),this.yPosition+=this.createBorder(t,C,0,0,1200.9997170000001,726.75),this.contentContainer.add(C),this.yPosition+=this.padding,this.commonRules(t,1129,e),this.yPosition+=382.5}commonRules(t,e,i){this.addContent(t,"How to Play","title"),this.yPosition-=this.padding/2;const s=t.add.container(0,this.yPosition);this.yPosition+=this.createBorder(t,s,this.padding,0,1.063773*e,25*i),this.contentContainer.add(s),this.createHeader(t,60,this.isMobile?20:30,s,"Bet Controls","#379557"),this.createHowToPlayEntry(t,60,this.isMobile?100:120,s,this.isMobile?"howToPlay1Mobile":"howToPlay1",this.isMobile?"":"Adjust your total bet."),this.createHeader(t,60,this.isMobile?200:180,s,"Game Actions","#379557"),this.createHowToPlayEntry(t,60,this.isMobile?300:280,s,this.isMobile?"howToPlay2Mobile":"howToPlay2",this.isMobile?"":"Start the game round."),this.createHowToPlayEntry(t,60,this.isMobile?900:420,s,this.isMobile?"howToPlay3Mobile":"howToPlay3",this.isMobile?"":"Open the autoplay menu. Tap again to stop autoplay."),this.createHowToPlayEntry(t,60,this.isMobile?1100:560,s,this.isMobile?"howToPlay4Mobile":"howToPlay4",this.isMobile?"":"Speeds up the game."),this.createHeader(t,60,this.isMobile?1040:660,s,"Display & Stats","#379557"),this.createHowToPlayEntry(t,60,this.isMobile?1140:760,s,"howToPlay5","Shows your current available credits."),this.createHowToPlayEntry(t,60,this.isMobile?1360:900,s,"howToPlay6","Display your total winnings from the current round."),this.createHowToPlayEntry(t,60,this.isMobile?1580:1040,s,"howToPlay7","Adjust your wager using the - and + buttons."),this.createHeader(t,60,this.isMobile?1740:1140,s,"General Controls","#379557"),this.createHowToPlayEntry(t,60,this.isMobile?1800:1200,s,this.isMobile?"howToPlay8Mobile":"howToPlay8",this.isMobile?"":"Toggle game sounds on and off."),this.createHowToPlayEntry(t,60,this.isMobile?1960:1280,s,this.isMobile?"howToPlay9Mobile":"howToPlay9",this.isMobile?"":"Access gameplay preferences and system options."),this.createHowToPlayEntry(t,60,this.isMobile?2160:1380,s,this.isMobile?"howToPlay10Mobile":"howToPlay10",this.isMobile?"":"View game rules, features, and paytable.")}addContent(t,e,i,s=!1,n=0){if("title"==i){const i=t.add.text(1.5*this.padding,this.yPosition,e,this.titleStyle);this.contentContainer.add(i),"Bonus Trigger"==e&&i.setPosition(i.x+2*this.padding,i.y),this.yPosition+=i.height+this.padding}else if("text"==i){const i=t.add.text(1.5*this.padding,this.yPosition,e,{...this.textStyle,wordWrap:s?{width:n}:void 0});this.contentContainer.add(i),this.yPosition+=i.height+this.padding}}createHeader(t,e,i,s,n,a){const o=t.add.text(0,0,n,{...this.textStyle,wordWrap:{width:1129-6*this.padding},fontSize:"20px",color:a,fontFamily:"Poppins",fontStyle:"bold"});o.setPosition(e,i),s.add(o)}createHowToPlayEntry(t,e,i,s,n,a){const o=this.isMobile?this.viewWidth-2*this.padding:1129;let r=null;""!=n&&(r=t.add.image(e,i,n)),null!=r&&("tumbleGame"!=n&&"scatterGame"!=n&&"multiplierGame"!=n||r.setScale(.5),r.setOrigin(0,.5)),"BuyFeatMobile"==n&&(null==r||r.setPosition(e-r.displayWidth/5,i)),null!=r&&s.add(r);const l=t.add.text(0,0,a,{...this.textStyle,wordWrap:{width:o-6*this.padding}});l.setPosition(this.isMobile?e:e+(null!=r?r.displayWidth+this.padding:0),this.isMobile?null!=r?r.y+r.displayHeight/2+2*this.padding:i:null!=r?r.y-r.displayHeight/10:i),l.setOrigin(0,0),"BuyFeatMobile"==n&&l.setPosition(e,i+5*this.padding),"scatterGame"==n&&l.setPosition(e,l.y+6*this.padding),s.add(l),this.isMobile&&(this.yPosition+=(null!=r?2*r.displayHeight:0)+l.displayHeight+2*this.padding)}createBorder(t,e,i,s,n,a){const o=t.add.graphics();return o.fillStyle(3355443),o.fillRoundedRect(i,s,n,a,8),o.lineStyle(2,3355443),o.strokeRoundedRect(i,s,n,a,8),o.setAlpha(.7),e.add(o),e.sendToBack(o),a}addDivider(t,e=16777215){const i=t.add.graphics();i.lineStyle(2,e);const s=this.isMobile?this.viewWidth-4*this.padding:this.contentWidth+2*this.padding;i.lineBetween(this.padding,this.yPosition,s,this.yPosition),this.contentContainer.add(i),this.yPosition+=this.padding}createPayoutTable(t,e,i,s,n){const a=this.isMobile?60:45,o=this.isMobile?120:80,r=["12+","10","8"],l=["6","5","4"],h=["This is the SCATTER symbol.","SCATTER symbol is present on all reels.","SCATTER pays on any position."],c=i-55,d=t.add.graphics();let u=[0,0,0];for(let m=0;m<3;m++)for(let i=0;i<3;i++){let g=0;g=0==i?a:1==i?o:2*o;const p=e+(2==i?a+o+10:i*(g+5)),b=c+37.5*m;if(d.strokeRect(p,b,g,22.5),0!=n){if(i<2){const e=(t.gameData.winamounts[m][n]*t.gameData.bet).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});let a;u[m]=e.length;const o=u[0]-e.length;let l;a=o>0?0==i?r[m]:" ".repeat(o)+t.gameData.currency+e:0==i?r[m]:t.gameData.currency+e,l=0==i?t.add.text(p+g,b+45,a,{fontSize:"24px",color:"#FFFFFF",fontFamily:"Poppins",align:"left",fontStyle:"bold"}):t.add.text(p+g,b+45,a,{fontSize:"24px",color:"#FFFFFF",fontFamily:"Poppins",align:"right"}),l.setOrigin(0==i?0:.5,.5),s.add(l)}}else{const e=(t.gameData.winamounts[m][n]*t.gameData.bet).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});let a;u[m]=e.length;const o=u[0]-e.length;if(a=o>0?0==i?l[m]:" ".repeat(o)+t.gameData.currency+e:0==i?l[m]:t.gameData.currency+e,0==i){const e=t.add.text(p+g+this.padding,b+11.25,a,{fontSize:"24px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold"});e.setOrigin(0==i?0:.5,.5),s.add(e)}else if(1==i){const e=t.add.text(p+1.5*g,b+11.25,a,{fontSize:"24px",color:"#FFFFFF",fontFamily:"Poppins"});e.setOrigin(.5,.5),s.add(e)}else{const e=t.add.text(p+g+this.padding,b+11.25-.4*this.padding,h[m],{fontSize:"24px",color:"#FFFFFF",fontFamily:"Poppins"});e.setOrigin(0,0),s.add(e),this.isMobile&&(e.setPosition(0,e.y+e.displayHeight+10*this.padding),e.setWordWrapWidth(2*this.contentWidth))}}}s.add(d)}enableScrolling(t){let e=!1,i=0,s=0,n=0;const a=this.isMobile?16:64;this.scrollView.setInteractive(new Phaser.Geom.Rectangle(0,0,Math.max(0,this.viewWidth-2*a),Math.max(0,t.scale.height-2*a)),Phaser.Geom.Rectangle.Contains),this.scrollView.on("pointerdown",(i=>{e=!0,i.y,s=i.y,t.tweens.isTweening(this.contentContainer)&&t.tweens.killTweensOf(this.contentContainer)})),t.input.on("pointermove",(a=>{if(!e||!this.isVisible)return;const o=a.y-s;s=a.y,n=o,i=this.contentContainer.y+o;const r=Math.min(0,t.scale.height-this.yPosition);i>0?i=0+.5*(i-0):i<r&&(i=r+.5*(i-r)),this.contentContainer.y=i})),t.input.on("pointerup",(()=>{if(e)if(e=!1,Math.abs(n)>.1){let e=this.contentContainer.y+20*n;const i=0,s=Math.min(0,t.scale.height-this.yPosition);e=Phaser.Math.Clamp(e,s,i),t.tweens.add({targets:this.contentContainer,y:e,duration:500,ease:"Cubic.out"})}else{const e=0,i=Math.min(0,t.scale.height-this.yPosition),s=Phaser.Math.Clamp(this.contentContainer.y,i,e);s!==this.contentContainer.y&&t.tweens.add({targets:this.contentContainer,y:s,duration:200,ease:"Cubic.out"})}})),t.input.on("wheel",((e,s,n,a)=>{if(!this.isVisible)return;i=this.contentContainer.y-a;const o=Math.min(0,t.scale.height-this.yPosition);i=Phaser.Math.Clamp(i,o,0),t.tweens.add({targets:this.contentContainer,y:i,duration:100,ease:"Cubic.out"})}))}show(t){this.isVisible||(this.container.setVisible(!0),this.isVisible=!0,this.container.x=-this.viewWidth,t.tweens.add({targets:this.container,x:0,duration:500,ease:"Power2"}))}hide(t){this.isVisible&&t.tweens.add({targets:this.container,x:1.5*-this.viewWidth,duration:500,ease:"Power2",onComplete:()=>{this.container.setVisible(!1),this.isVisible=!1,r.emitter.emit(r.HELP_SCREEN_TOGGLE),this.destroy()}})}destroy(){this.mask&&this.mask.destroy(),this.container&&this.container.destroy(),this.isVisible=!1}}class Ls{constructor(t=!1){s(this,"menuContainer"),s(this,"contentArea"),s(this,"isMobile",!1),s(this,"width",0),s(this,"height",0),s(this,"menuEventHandlers",[]),s(this,"isDraggingMusic",!1),s(this,"isDraggingSFX",!1),s(this,"scene"),s(this,"settingsOnly",!1),s(this,"padding",20),s(this,"contentWidth",1200),s(this,"viewWidth",1329),s(this,"yPosition",0),s(this,"scrollView"),s(this,"contentContainer"),s(this,"mask"),s(this,"isVisible",!1),s(this,"panel"),s(this,"rulesContent"),s(this,"historyContent"),s(this,"settingsContent"),s(this,"activeTabIndex",0),s(this,"historyCurrentPage",1),s(this,"historyTotalPages",1),s(this,"historyPageLimit",11),s(this,"historyIsLoading",!1),s(this,"historyHeaderContainer"),s(this,"historyRowsContainer"),s(this,"historyPaginationContainer"),s(this,"titleStyle",{fontSize:"24px",color:"#379557",fontFamily:"Poppins",fontStyle:"bold"}),s(this,"textStyle",{fontSize:"20px",color:"#FFFFFF",fontFamily:"Poppins",align:"left",wordWrap:{width:this.contentWidth}}),this.isMobile=this.isMobileDevice(),this.settingsOnly=t}preload(t){t.load.image("menu_info","assets/Mobile/Menu/Info.png"),t.load.image("menu_history","assets/Mobile/Menu/History.png"),t.load.image("menu_settings","assets/Mobile/Menu/Settings.png"),t.load.image("menu_close","assets/Buttons/ekis.png"),t.load.image("icon_left","assets/Mobile/Menu/icon_left.png"),t.load.image("icon_most_left","assets/Mobile/Menu/icon_most_left.png"),t.load.image("icon_right","assets/Mobile/Menu/icon_right.png"),t.load.image("icon_most_right","assets/Mobile/Menu/icon_most_right.png"),t.load.image("loading_icon","assets/Mobile/Menu/loading.png")}create(t){this.contentContainer=t.add.container(0,0)}isMobileDevice(){const t=new URLSearchParams(window.location.search);return"mobile"==t.get("device")||"desktop"!=t.get("device")&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}createMenu(t){this.scene=t,this.width=t.scale.width,this.height=t.scale.height;const e=t.add.container(0,0);e.setDepth(2e3),e.setVisible(!1),e.setAlpha(0);const i=t.add.graphics();i.fillStyle(0,.8),i.fillRect(0,0,this.width,this.height),i.setInteractive(new a.Geom.Rectangle(0,0,this.width,this.height),a.Geom.Rectangle.Contains),i.on("pointerdown",(()=>{})),i.on("pointerup",(()=>{})),e.add(i);const s=this.width,n=this.height;this.panel=t.add.container(0,0),e.add(this.panel);const o=t.add.graphics();o.fillStyle(1579032,.95),o.fillRect(0,0,s,n),o.setInteractive(new a.Geom.Rectangle(0,0,s,n),a.Geom.Rectangle.Contains),o.on("pointerdown",(()=>{})),o.on("pointerup",(()=>{})),this.panel.add(o);const r=this.settingsOnly?["settings"]:["info","history","settings"],l=t=>{switch(t){case"info":return"Rules";case"history":return"History";case"settings":return"Settings";case"close":return"X";default:return""}},h=r.length,c=s/(h+.5),d=s-c*h,u=[...r.map(((t,e)=>({text:l(t),width:c,x:c*e,icon:t}))),{text:l("close"),width:d,x:c*h,icon:"close"}],m=[];u.forEach(((e,i)=>{const s=t.add.container(e.x,0),n=t.add.graphics(),o="close"===e.icon;n.fillStyle(o?2039583:0,1),n.fillRect(0,0,e.width,61),s.add(n);const r=t.add.graphics();r.fillStyle(65280,1),r.fillRect(0,58,e.width,3),r.setVisible(0===i),s.add(r);let l="";switch(e.icon){case"info":l="menu_info";break;case"history":l="menu_history";break;case"settings":l="menu_settings";break;case"close":l="menu_close"}if(l){const i=t.add.image(0,30.5,l);i.setOrigin(-.5,.5);const n=(this.isMobile?18:22)/i.height;i.setScale(n),"close"===e.icon?(i.setOrigin(0,.5),i.setPosition(e.width/3,30.5),i.clearTint()):(i.setPosition(12,30.5),i.setTint(3642711)),s.add(i)}const c=i<h?45:e.width/2,d=i<h?"left":"center",g=t.add.text(c,30.5,e.text,{fontSize:this.isMobile?"16px":"20px",color:"#FFFFFF",fontFamily:"Poppins",align:d});"close"===e.icon&&g.setVisible(!1),g.setOrigin(i<h?0:.5,.5),s.add(g),s.setInteractive(new a.Geom.Rectangle(0,0,e.width,61),a.Geom.Rectangle.Contains).isButton=!0,s.on("pointerup",(()=>{t.audioManager.UtilityButtonSFX.play(),this.switchTab(t,m,i,u)})),m.push(s),this.panel.add(s)})),this.switchTab(t,m,0,u);const g=t.add.container(20,81);g.setSize(s-40,n-61-40);const p=t.add.graphics();p.fillStyle(16777215),p.fillRect(0,60,s,n);const b=p.createGeometryMask();return g.setMask(b),p.setVisible(!1),this.panel.add(g),this.contentArea=g,this.initializeTabContentContainers(t),this.showTabContent(t,u[0].icon),this.menuContainer=e,e}initializeTabContentContainers(t){this.rulesContent=t.add.container(0,0),this.historyContent=t.add.container(0,0),this.settingsContent=t.add.container(0,0),this.contentArea.add(this.rulesContent),this.contentArea.add(this.historyContent),this.contentArea.add(this.settingsContent),this.setupScrollableRulesContent(t),this.historyCurrentPage=1,this.historyPageLimit=11,this.showHistoryContent(t,this.historyContent,this.historyCurrentPage,this.historyPageLimit),this.createVolumeSettingsContent(t,this.settingsContent),this.hideAllTabContent(),this.rulesContent.setVisible(!0)}hideAllTabContent(){this.rulesContent.setVisible(!1),this.historyContent.setVisible(!1),this.settingsContent.setVisible(!1)}setupScrollableRulesContent(t){this.scrollView=t.add.container(0,0),this.contentContainer=t.add.container(0,0),this.scrollView.add(this.contentContainer);const e=t.add.graphics();e.fillStyle(16777215),e.fillRect(0,0,this.contentArea.width,this.contentArea.height),this.mask=e.createGeometryMask(),this.scrollView.setMask(this.mask),e.setVisible(!1),this.createHelpScreenContent(t,this.rulesContent),this.rulesContent.add(this.scrollView),this.enableScrolling(t)}switchTab(t,e,i,s){e.forEach(((t,e)=>{const n=t.getAt(0),a=t.getAt(1),o=s[e];e===i?(n.fillStyle(2972221,1),n.fillRect(0,0,o.width,61),a.setVisible(!0)):(n.fillStyle("close"===o.icon?2039583:0),n.fillRect(0,0,o.width,61),a.setVisible(!1))}));const n=s[i].icon;this.showTabContent(t,n)}showTabContent(t,e){if(this.contentArea)switch(this.hideAllTabContent(),e){case"info":this.rulesContent.setVisible(!0);break;case"history":this.historyContent.setVisible(!0);break;case"settings":this.settingsContent.setVisible(!0);break;case"close":this.hideMenu(t)}}async showHistoryContent(t,e,i,s){var n,a,o,r,l;const h=["Spin","Currency","Bet","Win"];if(!this.historyHeaderContainer||!this.historyHeaderContainer.scene){this.historyHeaderContainer=t.add.container(0,0);const e=t.add.text(15,15,"History",this.titleStyle);e.setOrigin(0,0),this.historyHeaderContainer.add(e)}if(this.historyRowsContainer&&this.historyRowsContainer.scene||(this.historyRowsContainer=t.add.container(0,0)),this.historyPaginationContainer&&this.historyPaginationContainer.scene||(this.historyPaginationContainer=t.add.container(0,0)),this.historyHeaderContainer.parentContainer!==e&&e.add(this.historyHeaderContainer),this.historyRowsContainer.parentContainer!==e&&e.add(this.historyRowsContainer),this.historyPaginationContainer.parentContainer!==e&&e.add(this.historyPaginationContainer),this.historyIsLoading)return;this.historyIsLoading=!0;const c=.45*t.scale.width,d=.3*t.scale.height,u=t.add.image(c,d,"loading_icon");u.setOrigin(.5,.5),u.setScale(.25),e.add(u);const m=t.tweens.add({targets:u,angle:360,duration:800,repeat:-1,ease:"Linear"});let g;try{g=await t.gameAPI.getHistory(i,s)}finally{m.stop(),u.destroy(),this.historyIsLoading=!1}console.log(g),this.historyCurrentPage=null!=(a=null==(n=null==g?void 0:g.meta)?void 0:n.page)?a:i,this.historyTotalPages=null!=(r=null==(o=null==g?void 0:g.meta)?void 0:o.pageCount)?r:1,this.historyPageLimit=s;const p=this.getHistoryColumnCenters(t),b=this.historyHeaderContainer;if(b.length<=1){const e=60;h.forEach(((i,s)=>{const n=t.add.text(p[s],e,i,{fontSize:"14px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold"});n.setOrigin(.5,0),b.add(n)}))}let f="26/7/2025, 16:00",y="usd",w="250.00",S=25e7,x=100;const F=this.historyRowsContainer;F.removeAll(!0),null==(l=g.data)||l.forEach((e=>{f=this.formatISOToDMYHM(e.created_at),y=""==e.currency?"usd":e.currency,w=e.total_bet,S=e.total_win,x+=30,this.createHistoryEntry(x,t,F,f,y,w,S.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),p),this.addDividerHistory(t,F,x),x+=20}));const v=this.historyPaginationContainer;v.removeAll(!0),this.addHistoryPagination(t,v,this.historyCurrentPage,this.historyTotalPages,this.historyPageLimit)}formatISOToDMYHM(t,e="Asia/Manila"){const i=new Date(t),s=new Intl.DateTimeFormat("en-GB",{day:"numeric",month:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:e}).formatToParts(i),n=Object.fromEntries(s.map((t=>[t.type,t.value])));return`${n.day}/${n.month}/${n.year}, ${n.hour}:${n.minute}`}createHistoryEntry(t,e,i,s,n,a,o,r){[s,n,a,o].forEach(((s,n)=>{const a=e.add.text(r[n],t,s,{fontSize:"14px",color:"#FFFFFF",fontFamily:"Poppins"});a.setOrigin(.5,0),i.add(a)}))}getHistoryColumnCenters(t){const e=t.scale.width-20,i=this.contentArea?this.contentArea.x:0,s=20-i,n=e-i-s;return[.15,.4,.65,.88].map((t=>s+n*t))}addDividerHistory(t,e,i){const s=i+30,n=t.scale.width-20,a=20-(this.contentArea?this.contentArea.x:0),o=n-20,r=t.add.graphics();r.fillStyle(16777215,.1),r.fillRect(a,s,o,1),e.add(r)}addHistoryPagination(t,e,i,s,n){const a=["icon_most_left","icon_left","icon_right","icon_most_right"],o=this.contentArea?this.contentArea.width:t.scale.width,r=(this.contentArea?this.contentArea.height:t.scale.height)-80,l=a.map((e=>t.add.image(0,0,e))),h=l.reduce(((t,e,i)=>t+e.width+(i>0?18:0)),0);l.forEach((t=>t.destroy()));let c=(o-h)/2;a.forEach((o=>{const l=t.add.image(c,r,o);l.setOrigin(0,1);let h=i,d=!0;switch(o){case"icon_most_left":h=1,d=i>1;break;case"icon_left":h=Math.max(1,i-1),d=i>1;break;case"icon_right":h=Math.min(s,i+1),d=i<s;break;case"icon_most_right":h=Math.max(1,s),d=i<s}d?(l.setInteractive({useHandCursor:!0}),l.on("pointerup",(()=>{this.historyIsLoading||(t.audioManager.UtilityButtonSFX.play(),e.iterate((t=>{const e=t;e&&e.texture&&a.includes(e.texture.key)&&(e.disableInteractive(),e.setAlpha(.5))})),this.showHistoryContent(t,this.historyContent,h,n))}))):(l.setAlpha(.5),l.disableInteractive()),e.add(l),c+=l.width+18}));const d=t.add.text(o/2,r+40,`Page ${i} of ${s}`,{fontSize:"20px",color:"#FFFFFF",fontFamily:"Poppins",align:"center"});d.setOrigin(.5,0),e.add(d)}createVolumeSettingsContent(t,e){const i=t.add.text(15,15,"Settings",this.titleStyle);i.setOrigin(0,0),e.add(i);const s=15,n=130,o=t.add.text(15,85,"Background Music",{fontSize:"18px",color:"#FFFFFF",fontFamily:"Poppins"});e.add(o);const r=t.add.text(15,185,"Sound FX",{fontSize:"18px",color:"#FFFFFF",fontFamily:"Poppins"});e.add(r);const l=t.add.text(15,285,"Skip Intro",{fontSize:"18px",color:"#FFFFFF",fontFamily:"Poppins"});e.add(l);const h=64,c=36,d=18,u=t.scale.width-40,m=Math.max(215,u-h-20),g=(t,e,i,s,n)=>{const a=s-18;t.clear(),e.clear(),n?(t.fillStyle(3642711,1),t.lineStyle(3,3108169,1),t.strokeRoundedRect(i,a,h,c,d),t.fillRoundedRect(i,a,h,c,d),e.fillStyle(16777215,1),e.fillCircle(i+h-d,a+18,14)):(t.fillStyle(2042167,1),t.lineStyle(3,10265519,1),t.strokeRoundedRect(i,a,h,c,d),t.fillRoundedRect(i,a,h,c,d),e.fillStyle(16777215,1),e.fillCircle(i+d,a+18,14))},p=t.add.graphics(),b=t.add.graphics();e.add(p),e.add(b),p.setDepth(10),b.setDepth(11);let f=t.audioManager.getMusicVolume()>0;f||(f=!0,t.audioManager.setMusicVolume(1)),g(p,b,m,85,f);const y=t.add.zone(m,67,h,c).setOrigin(0,0);y.setInteractive(),y.on("pointerdown",(()=>{f=!f,t.audioManager.setMusicVolume(f?1:0),g(p,b,m,85,f),W()})),e.add(y),y.setDepth(12);const w=t.add.graphics(),S=t.add.graphics();e.add(w),e.add(S),w.setDepth(10),S.setDepth(11);let x=t.audioManager.getSFXVolume()>0;x||(x=!0,t.audioManager.setSFXVolume(1)),g(w,S,m,185,x);const F=t.add.zone(m,167,h,c).setOrigin(0,0);F.setInteractive(),F.on("pointerdown",(()=>{x=!x,t.audioManager.setSFXVolume(x?1:0),g(w,S,m,185,x),W()})),e.add(F),F.setDepth(12);const v=t.add.graphics(),T=t.add.graphics();e.add(v),e.add(T),v.setDepth(10),T.setDepth(11);let A=!1;g(v,T,m,287,A);const M=t.add.zone(m,269,h,c).setOrigin(0,0);M.setInteractive(),M.on("pointerdown",(()=>{A=!A,g(v,T,m,287,A)})),e.add(M),M.setDepth(12);const C=t.add.graphics();C.fillStyle(3642711,1),C.fillRoundedRect(s,n,340,8,4);const B=t.add.graphics();B.fillStyle(3355443,1),B.lineStyle(1,6710886),B.fillRoundedRect(s,n,340,8,4),B.strokeRoundedRect(s,n,340,8,4),e.add(B),e.add(C);const P=t.add.graphics();P.fillStyle(16777215,1),P.fillCircle(0,0,12),P.setPosition(270,134),P.setInteractive(new a.Geom.Circle(0,0,22),a.Geom.Circle.Contains),e.add(P);const I=t.add.text(s,155,"75%",{fontSize:"16px",color:"#FFFFFF",fontFamily:"Poppins"});e.add(I);const E=t.add.graphics(),D=t.add.graphics(),R=t.add.graphics(),_=t.add.text(s,270,"75%",{fontSize:"16px",color:"#FFFFFF",fontFamily:"Poppins"});E.setVisible(!1),D.setVisible(!1),R.setVisible(!1),_.setVisible(!1);const W=(e=null,i=null)=>{const o=340,r=null!==e?Math.max(0,Math.min(1,e/o)):t.audioManager.getMusicVolume(),l=null!==i?Math.max(0,Math.min(1,i/o)):t.audioManager.getSFXVolume();P.clear(),P.fillStyle(16777215,1);const h=s+r*o;P.fillCircle(0,0,12),P.setPosition(h,134),C.clear(),C.fillStyle(3642711,1),C.fillRoundedRect(s,n,o*r,8,4),I.setText(Math.round(100*r)+"%"),0===r?f&&(f=!1,g(p,b,m,85,f)):f||(f=!0,g(p,b,m,85,f));const c=s+l*o;R.clear(),R.fillStyle(16777215,1),R.fillCircle(0,0,12),R.setPosition(c,249),E.clear(),E.fillStyle(3642711,1),E.fillRoundedRect(s,245,o*l,8,4),_.setText(Math.round(100*l)+"%"),null!==e&&t.audioManager.setMusicVolume(r),null!==i&&t.audioManager.setSFXVolume(l),P.setInteractive(new a.Geom.Circle(0,0,22),a.Geom.Circle.Contains),R.disableInteractive()};W(),this.isDraggingMusic=!1,this.isDraggingSFX=!1;const L=t=>{if(this.isDraggingMusic){const e=340,i=k.getLocalPoint(t.x,t.y),s=Math.max(0,Math.min(e,i&&"number"==typeof i.x?i.x:0));W(s,null)}else if(this.isDraggingSFX){const e=340,i=N.getLocalPoint(t.x,t.y),s=Math.max(0,Math.min(e,i&&"number"==typeof i.x?i.x:0));W(null,s)}},O=()=>{this.isDraggingMusic=!1,this.isDraggingSFX=!1};this.menuEventHandlers.push(L,O),this.scene.input.on("pointermove",L),this.scene.input.on("pointerup",O);const k=t.add.graphics();k.setPosition(s,n),k.fillStyle(0,0),k.fillRect(0,-10,340,28),k.setInteractive(new a.Geom.Rectangle(0,-10,340,28),a.Geom.Rectangle.Contains),e.add(k);const N=t.add.graphics();N.setPosition(s,245),N.fillStyle(0,0),N.setVisible(!1),e.add(N),k.on("pointerdown",((e,i)=>{const s=(i=Math.max(0,Math.min(340,i)))/340;t.audioManager.setMusicVolume(s),this.isDraggingMusic=!0,W()})),P.on("pointerdown",(()=>{this.isDraggingMusic=!0})),R.on("pointerdown",(()=>{this.isDraggingSFX=!0}))}showMenu(t){this.isMobile?this.settingsOnly=!1:this.settingsOnly=!0,this.menuContainer&&this.destroyMenu(t);const e=this.createMenu(t);e.setVisible(!0),e.setAlpha(0),this.isVisible=!0,t.tweens.add({targets:e,alpha:1,duration:300,ease:"Power2"})}hideMenu(t){this.menuContainer&&(this.menuContainer.setVisible(!1),this.menuContainer.setActive(!1),this.isVisible=!1,t.gameData.isHelpScreenVisible=!1,this.menuEventHandlers&&(this.menuEventHandlers.forEach((e=>{t.input.off("pointermove",e),t.input.off("pointerup",e)})),this.menuEventHandlers=[]),this.isDraggingMusic=!1,this.isDraggingSFX=!1)}destroyMenu(t){this.hideMenu(t),this.menuContainer&&(this.menuContainer.destroy(!0),this.menuContainer=void 0),this.panel=void 0}addContent(t,e,i,s=!1,n=0){if("title"===i){const i=t.add.text(this.padding/2,this.yPosition,e,this.titleStyle);this.contentContainer.add(i),"Bonus Trigger"===e&&i.setPosition(0,i.y),this.yPosition+=i.height+this.padding}else if("text"===i){const i={...this.textStyle};s&&(i.wordWrap={width:n});const a=t.add.text(this.padding/2,this.yPosition,e,i);this.contentContainer.add(a),this.yPosition+=a.height+this.padding}}createHelpScreenContent(t,e){this.padding=10,this.contentWidth=this.isMobile?t.scale.width-6*this.padding:this.viewWidth-12*this.padding,this.yPosition=this.padding,this.addContent(t,"Game Rules","title"),this.addContent(t,"Win by landing 8 or more matching symbols anywhere on the screen. The more matching symbols you get, the higher your payout.","text",!0,this.contentWidth),this.addContent(t,"RTP","title"),this.addContent(t,"96.49% - 96.6%","text"),this.yPosition+=2*this.padding,this.addContent(t,"Payout","title"),this.yPosition+=7*this.padding;for(let p=0;p<9;p++){const e=this.padding,i=this.yPosition,s=t.add.container(e,i);this.createBorder(t,s,-this.padding/2,-76.5,this.contentWidth+3*this.padding,114.75);const n=t.add.sprite(0,0,`Symbol${p+1}_SW`);n.setFrame(`Symbol${p+1}_SW-00000.png`),n.setScale(.5),n.setOrigin(0,.7),s.add(n),5==p&&n.setPosition(n.x,n.y+this.padding),this.createPayoutTable(t,107.1,0,s,p+1),this.contentContainer.add(s),s.setPosition(0,s.y),this.yPosition+=76.5+5*this.padding}this.yPosition-=76.5,this.yPosition+=3*this.padding,this.addContent(t,"Scatter","text"),this.yPosition+=3*this.padding;{const e=-this.padding/2,i=this.yPosition,s=t.add.container(e,i);this.createBorder(t,s,0,-76.5,this.contentWidth+3*this.padding,420.75);const n=t.add.sprite(0,0,"ScatterLabel");n.setScale(.2),n.setOrigin(.3,.4),s.add(n),n.setPosition(.4*t.scale.width,this.padding),this.createPayoutTable(t,n.x/3,3*n.height/10,s,0),this.contentContainer.add(s),this.contentContainer.sendToBack(s),this.yPosition+=382.5}this.addContent(t,"Tumble Win","title");const i=t.add.container(1.5*-this.padding,this.yPosition);this.yPosition+=this.createBorder(t,i,this.padding,0,this.contentWidth+3*this.padding,669.375),this.contentContainer.add(i),this.createHowToPlayEntry(t,20,170,i,"tumbleGame","After each spin, winning symbols are paid and then removed from the screen. Remaining symbols drop down, and new ones fall from above to fill the empty spaces.\n\nTumbles continue as long as new winning combinations appear â€” there's no limit to the number of tumbles per spin.\n\nAll wins are credited to the player's balance after all tumbles from a base spin are completed.",!0,this.contentWidth-2*this.padding);const s=t.add.image(0,0,"tumbleSymbol");s.setScale(.5),s.setOrigin(.5,.5),s.setPosition(90,65),i.add(s);const n=t.add.image(0,0,"tumbleWin");n.setScale(.5),n.setOrigin(.5,.5),n.setPosition(s.x-s.displayWidth/2+2*this.padding,s.y-n.height/3),i.add(n),this.yPosition-=765,this.addContent(t,"Free Spins Rules","title"),this.yPosition+=267.75,this.addContent(t,"Bonus Trigger","title"),this.yPosition-=267.75;const a=t.add.container(1.5*-this.padding,this.yPosition-38.25);this.yPosition+=this.createBorder(t,a,this.padding,0,this.contentWidth+3*this.padding,535.5),this.contentContainer.add(a),this.contentContainer.sendToBack(a),this.yPosition-=19.125,this.createHowToPlayEntry(t,20,120,a,"scatterGame","Land 4 or more         SCATTER \nsymbols anywhere on the screen to trigger the free spins feature.\n\nYou'll start with 10 free spins.\n\nDuring the bonus round, hitting 3 or more scatter symbols awards 5 extra free spins",!0,this.contentWidth+3*this.padding);const o=t.add.image(0,0,"scatterIcon");o.setScale(.25),o.setOrigin(.5,.5),o.setPosition(195,320),a.add(o);const r=t.add.image(0,0,"scatterIcon");r.setScale(.5),r.setOrigin(.5,.5),r.setPosition(100,75),a.add(r);const l=t.add.image(0,0,"scatterWin");l.setScale(.5),l.setOrigin(.5,.5),l.setPosition(r.x-r.displayWidth/2+2*this.padding,3*r.y/4-l.height/4),a.add(l),this.yPosition-=363.375,this.addContent(t,"Multiplier","title"),this.yPosition-=325.125;const h=t.add.container(1.5*-this.padding,this.yPosition);this.yPosition+=this.createBorder(t,h,this.padding,0,this.contentWidth+3*this.padding,765),this.yPosition+=497.25,this.contentContainer.add(h),this.contentContainer.sendToBack(h),this.createHowToPlayEntry(t,20,170,h,"multiplierGame","\nThe         Multiplier symbol only appears during the FREE SPINS round and remains on the screen until the tumbling sequence ends.\n\nEach time a         symbol lands, it randomly takes a multiplier value: 2x, 3x, 4x, 5x, 6x, 8x, 10x, 12x, 15x, 20x, 25x, 50x, or even 100x!\n\nOnce all tumbles are finished, the total of all           multipliers is added and applied to the total win of the that sequence.\n\nSpecial reels are used during the FREE SPINS round.",!0,this.contentWidth+3*this.padding);const c=t.add.image(0,0,"multiplierIcon");c.setScale(.15),c.setOrigin(.5,.5),c.setPosition(80,330),h.add(c);const d=t.add.image(0,0,"multiplierIcon");d.setScale(.15),d.setOrigin(.5,.5),d.setPosition(163,440),h.add(d);const u=t.add.image(0,0,"multiplierIcon");u.setScale(.15),u.setOrigin(.5,.5),u.setPosition(100,575),h.add(u);const m=t.add.image(0,0,"multiplierIcon");m.setScale(.33),m.setOrigin(.5,.5),m.setPosition(100,50),h.add(m),this.contentContainer.bringToTop(m),this.yPosition-=1315.8,this.addContent(t,"Game Settings","title");const g=t.add.container(1.5*-this.padding,this.yPosition);this.yPosition+=this.createBorder(t,g,this.padding,0,this.contentWidth+3*this.padding,765),this.contentContainer.add(g),this.yPosition-=765,this.yPosition+=this.padding,this.addContent(t,"Paylines","title"),this.createHowToPlayEntry(t,20,57.375,g,"","Symbols can land anywhere on the screen.",!0,this.contentWidth+3*this.padding),this.createHowToPlayEntry(t,20,210.375,g,"paylineMobileWin",""),this.createHowToPlayEntry(t,20,401.625,g,"paylineMobileNoWin",""),this.createHowToPlayEntry(t,20,497.25,g,"","All wins are multiplied by the base bet.",!0,this.contentWidth+3*this.padding),this.createHowToPlayEntry(t,20,573.75,g,"","When multiple symbol wins occur, all values are combined into the total win.",!0,this.contentWidth+3*this.padding),this.createHowToPlayEntry(t,20,669.375,g,"","Free spins rewards are granted after the round ends.",!0,this.contentWidth+3*this.padding),this.yPosition-=248.625,this.commonRules(t,this.contentWidth,153),this.yPosition-=3366,e.add(this.contentContainer)}commonRules(t,e,i){this.addContent(t,"How to Play","title");const s=20,n=t.add.container(0,this.yPosition);this.yPosition+=this.createBorder(t,n,this.padding,0,e,25*i),this.contentContainer.add(n),this.createHeader(t,s,this.isMobile?10:30,n,"Bet Controls","#379557"),this.createHowToPlayEntry(t,s,this.isMobile?100:120,n,this.isMobile?"howToPlay1Mobile":"howToPlay1",this.isMobile?"":"Adjust your total bet."),this.createHeader(t,s,this.isMobile?190:180,n,"Game Actions","#379557"),this.createHowToPlayEntry(t,s,this.isMobile?300:280,n,this.isMobile?"howToPlay2Mobile":"howToPlay2",this.isMobile?"":"Start the game round."),this.createHowToPlayEntry(t,s/3,this.isMobile?500:420,n,this.isMobile?"howToPlay11Mobile":"BuyFeatHelp",this.isMobile?"":"Lets you buy the free spins round for 100x your total bet."),this.createHowToPlayEntry(t,s,this.isMobile?760:560,n,this.isMobile?"howToPlay12Mobile":"DoubleHelp",this.isMobile?"":"You're wagering 25% more per spin, but you also have better chances at hitting big features."),this.createHowToPlayEntry(t,s,this.isMobile?1e3:700,n,this.isMobile?"howToPlay3Mobile":"howToPlay3",this.isMobile?"":"Open the autoplay menu. Tap again to stop autoplay."),this.createHowToPlayEntry(t,s,this.isMobile?1200:840,n,this.isMobile?"howToPlay4Mobile":"howToPlay4",this.isMobile?"":"Speeds up the game."),this.createHeader(t,s,this.isMobile?1320:1040,n,"Display & Stats","#379557"),this.createHowToPlayEntry(t,s,this.isMobile?1440:1040,n,"howToPlay5","Shows your current available credits.",!0,this.contentWidth-2*this.padding),this.createHowToPlayEntry(t,s,this.isMobile?1640:1180,n,"howToPlay6","Display your total winnings from the current round.",!0,this.contentWidth-2*this.padding),this.createHowToPlayEntry(t,s,this.isMobile?1860:1320,n,"howToPlay7","Adjust your wager using the - and + buttons.",!0,this.contentWidth-2*this.padding),this.createHeader(t,s,this.isMobile?2020:1420,n,"General Controls","#379557"),this.createHowToPlayEntry(t,s,this.isMobile?2140:1480,n,this.isMobile?"howToPlay8Mobile":"howToPlay8",this.isMobile?"":"Toggle game sounds on and off."),this.createHowToPlayEntry(t,s,this.isMobile?2290:1560,n,this.isMobile?"howToPlay9Mobile":"howToPlay9",this.isMobile?"":"Access gameplay preferences and system options."),this.createHowToPlayEntry(t,s,this.isMobile?2480:1660,n,this.isMobile?"howToPlay10Mobile":"howToPlay10",this.isMobile?"":"View game rules, features, and paytable."),this.yPosition-=15*i}createHeader(t,e,i,s,n,a){const o=this.isMobile?this.viewWidth-2*this.padding:1129,r=t.add.text(0,0,n,{...this.textStyle,wordWrap:{width:o-6*this.padding},fontSize:"20px",color:a,fontFamily:"Poppins",fontStyle:"bold"});r.setPosition(e,i),s.add(r)}enableScrolling(t){let e=!1,i=0,s=0,n=0;this.scrollView.setInteractive(new Phaser.Geom.Rectangle(0,0,this.contentArea.width,this.contentArea.height),Phaser.Geom.Rectangle.Contains),this.scrollView.on("pointerdown",(i=>{e=!0,i.y,s=i.y,t.tweens.isTweening(this.contentContainer)&&t.tweens.killTweensOf(this.contentContainer)})),t.input.on("pointermove",(t=>{if(!e||!this.isVisible)return;const a=t.y-s;s=t.y,n=a,i=this.contentContainer.y+a;const o=this.yPosition,r=this.contentArea.height,l=Math.min(0,r-o);i>0?i=0+.5*(i-0):i<l&&(i=l+.5*(i-l)),this.contentContainer.y=i})),t.input.on("pointerup",(()=>{if(e)if(e=!1,Math.abs(n)>.1){let e=this.contentContainer.y+20*n;const i=0,s=this.yPosition,a=this.contentArea.height,o=Math.min(0,a-s);e=Phaser.Math.Clamp(e,o,i),t.tweens.add({targets:this.contentContainer,y:e,duration:500,ease:"Cubic.out"})}else{const e=0,i=Math.min(0,t.scale.height-this.yPosition),s=Phaser.Math.Clamp(this.contentContainer.y,i,e);s!==this.contentContainer.y&&t.tweens.add({targets:this.contentContainer,y:s,duration:200,ease:"Cubic.out"})}})),t.input.on("wheel",((e,s,n,a)=>{if(!this.isVisible)return;i=this.contentContainer.y-a;const o=this.yPosition,r=this.contentArea.height,l=Math.min(0,r-o);i=Phaser.Math.Clamp(i,l,0),t.tweens.add({targets:this.contentContainer,y:i,duration:100,ease:"Cubic.out"})}))}createHowToPlayEntry(t,e,i,s,n,a,o=!1,r=0){let l=null;""!=n&&(l=t.add.image(e,i,n)),null!=l&&("tumbleGame"!=n&&"scatterGame"!=n&&"multiplierGame"!=n||l.setScale(.63),l.setOrigin(0,.5),"scatterGame"==n&&l.setOrigin(0,.33)),"BuyFeatMobile"==n&&(null==l||l.setPosition(e-l.displayWidth/5,i)),null!=l&&s.add(l);const h=t.add.text(0,0,a,{...this.textStyle,wordWrap:o?{width:r}:void 0});h.setPosition(this.isMobile?e:e+(null!=l?l.displayWidth+this.padding:0),this.isMobile?null!=l?l.y+l.displayHeight/2+2*this.padding:i:null!=l?l.y-l.displayHeight/10:i),h.setOrigin(0,0),"BuyFeatMobile"==n&&h.setPosition(e,i+5*this.padding),"scatterGame"==n&&h.setPosition(e,h.y+6*this.padding),s.add(h),this.isMobile&&(this.yPosition+=(null!=l?2*l.displayHeight:0)+h.displayHeight+2*this.padding)}createBorder(t,e,i,s,n,a){const o=t.add.graphics();return o.fillStyle(3355443),o.fillRoundedRect(i,s,n,a,8),o.lineStyle(2,3355443),o.strokeRoundedRect(i,s,n,a,8),o.setAlpha(.7),e.add(o),e.sendToBack(o),a}addDivider(t,e=16777215){const i=t.add.graphics();i.lineStyle(2,e);const s=this.isMobile?this.viewWidth-4*this.padding:this.contentWidth+2*this.padding;i.lineBetween(this.padding,this.yPosition,s,this.yPosition),this.contentContainer.add(i),this.yPosition+=this.padding}createPayoutTable(t,e,i,s,n){const a=this.isMobile?60:45,o=this.isMobile?100:80,r=["12+","10","8"],l=["6","5","4"],h=["This is the SCATTER symbol.","SCATTER symbol is present on all reels.","SCATTER pays on any position."],c=i-55,d=t.add.graphics();let u=[0,0,0];for(let m=0;m<3;m++)for(let i=0;i<3;i++){let g=0;g=0==i?a:1==i?o:2*o;const p=e+(2==i?a+o+10:i*(g+5)),b=c+27.5*m;if(d.strokeRect(p,b,g,22.5),0!=n){if(i<2){const e=(t.gameData.winamounts[m][n]*t.gameData.bet).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});let a;u[m]=e.length;const o=u[0]-e.length;let l;a=o>0?0==i?r[m]:" ".repeat(o)+t.gameData.currency+e:0==i?r[m]:t.gameData.currency+e,l=0==i?t.add.text(p+g,b+11.25,a,{fontSize:"20px",color:"#FFFFFF",fontFamily:"Poppins",align:"left",fontStyle:"bold"}):t.add.text(p+g,b+11.25,a,{fontSize:"20px",color:"#FFFFFF",fontFamily:"Poppins",align:"right"}),l.setOrigin(0==i?0:.5,.5),s.add(l)}}else{const e=(t.gameData.winamounts[m][n]*t.gameData.bet).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});let a;u[m]=e.length;const o=u[0]-e.length;if(a=o>0?0==i?l[m]:" ".repeat(o)+t.gameData.currency+e:0==i?l[m]:t.gameData.currency+e,0==i){const e=t.add.text(p+g+this.padding,b+11.25,a,{fontSize:"20px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold"});e.setOrigin(0==i?0:.5,.5),s.add(e)}else if(1==i){const e=t.add.text(p+g,b+11.25,a,{fontSize:"20px",color:"#FFFFFF",fontFamily:"Poppins"});e.setOrigin(.5,.5),s.add(e)}else{const e=t.add.text(p+g/2+this.padding,b+11.25-.7*this.padding,h[m],{fontSize:"20px",color:"#FFFFFF",fontFamily:"Poppins",padding:{left:this.padding,right:this.padding}});e.setOrigin(0,0),s.add(e),this.isMobile&&(e.setPosition(0,e.y+e.displayHeight+10*this.padding),e.setWordWrapWidth(2*this.contentWidth))}}}s.add(d)}toggleMenu(t){this.showMenu(t)}}const Os=class t{constructor(){s(this,"popupContainer",null),s(this,"isMobile",!1),s(this,"betOptions",[.2,.4,.6,.8,1,1.2,1.6,2,2.4,2.8,3.2,3.6,4,5,6,8,10,14,18,24,32,40,60,80,100,110,120,130,140,150]),s(this,"currentBetIndex",17),s(this,"popupY",0),s(this,"minusBtnRef",null),s(this,"plusBtnRef",null),this.isMobile=this.isMobileDevice()}updateBetButtonsState(){var t,e,i,s,n,a,o,r,l,h,c,d,u,m;try{const g=this.isAtMinValue(null!=(i=null==(e=null==(t=null==window?void 0:window.currentScene)?void 0:t.gameData)?void 0:e.bet)?i:this.betOptions[this.currentBetIndex]),p=this.isAtMaxValue(null!=(a=null==(n=null==(s=null==window?void 0:window.currentScene)?void 0:s.gameData)?void 0:n.bet)?a:this.betOptions[this.currentBetIndex]);this.minusBtnRef&&(this.minusBtnRef.setAlpha(g?.3:.8),g?null==(r=(o=this.minusBtnRef).disableInteractive)||r.call(o):null==(h=(l=this.minusBtnRef).setInteractive)||h.call(l)),this.plusBtnRef&&(this.plusBtnRef.setAlpha(p?.3:.8),p?null==(d=(c=this.plusBtnRef).disableInteractive)||d.call(c):null==(m=(u=this.plusBtnRef).setInteractive)||m.call(u))}catch(g){}}findBetIndexByValue(e){return this.betOptions.findIndex((i=>Math.abs(i-e)<t.EPS))}isAtMinValue(e){return e<=this.betOptions[0]+t.EPS}isAtMaxValue(e){return e>=this.betOptions[this.betOptions.length-1]-t.EPS}isMobileDevice(){const t=new URLSearchParams(window.location.search);return"mobile"==t.get("device")||"desktop"!=t.get("device")&&(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768)}preload(t){t.load.image("buyFeatBG","assets/Reels/BuyFeatureBG.png"),t.load.image("freeSpinDisplay","assets/Controllers/FreeSpinDisplay.png"),t.load.image("greenBtn","assets/Buttons/greenBtn.png"),t.load.image("greenLongBtn","assets/Buttons/greenLongBtn.png"),t.load.image("ekis","assets/Buttons/ekis.png"),t.load.image("ScatterLogo","assets/Logo/Scatter.png"),t.load.image("ScatterBackground","assets/Mobile/Bonus-Setting.png"),t.load.image("plus","assets/Controllers/Plus.png"),t.load.image("minus","assets/Controllers/Minus.png")}create(t){const e=this.isMobile?t.scale.width:573,i=this.isMobile?736:369,s=(this.isMobile,t.scale.width/2-e/2),n=this.isMobile?t.scale.height-i:t.scale.height/2-i/2;if(this.popupY=n,this.popupContainer=t.add.container(s,n),this.popupContainer.setDepth(1e3),this.popupContainer.setVisible(!1),!this.isMobile){const e=573,i=369,s=t.add.image(e/2,i/2,"buyFeatBG");s.setOrigin(.5,.5),this.popupContainer.add(s);const n=t.add.image(e/2,46,"freeSpinDisplay");n.displayWidth=200,n.displayHeight=107,n.setOrigin(.5,.25),n.alpha=1,this.popupContainer.add(n);const a=t.add.text(e/2,144,"",{color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold",align:"center"});a.setOrigin(.5,.25),this.popupContainer.add(a);const o=127,l=63,h=t.add.image(e/2-o/2-20,i-48-l/2,"greenBtn");h.displayWidth=o,h.displayHeight=l,h.setOrigin(.5,.5),h.alpha=1,this.popupContainer.add(h);const c=t.add.text(e/2-o/2-20,i-48-l/2,"Buy",{fontSize:"36px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold",align:"center"});c.setOrigin(.5,.5),this.popupContainer.add(c);const d=t.add.image(e/2+o/2+20,i-48-l/2,"greenBtn");d.displayWidth=o,d.displayHeight=l,d.setOrigin(.5,.5),d.alpha=0,d.setInteractive().isButton=!0,d.on("pointerdown",(()=>{this.hide(t)})),this.popupContainer.add(d);const u=t.add.text(e/2+o/2+20,i-48-l/2,"Close",{fontSize:"32px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold"});return u.setOrigin(.5,.5),this.popupContainer.add(u),h.setInteractive().isButton=!0,h.on("pointerdown",(()=>{const e=t.gameData.getBuyFeaturePrice(),i=t.gameData.balance,s=i>=e;if(console.log(`[BUY FEATURE] Clicked. balance=${i}, cost=${e}, ok=${s}`),!s)return console.log("[BUY FEATURE] Blocked: insufficient balance, showing popup"),void r.emitter.emit(r.SHOW_INSUFFICIENT_BALANCE);this.handleBuyFeature(t)})),u.setInteractive().isButton=!0,u.on("pointerdown",(()=>{this.hide(t)})),this.popupContainer.buyText=a,void(this.popupContainer.closeBtnBg=d)}const a=t.add.image(0,0,"ScatterBackground");a.setOrigin(0,0),this.popupContainer.add(a);let o=Math.min(e,i)/16;const l=t.add.text(o,2*o,"Buy Feature",{fontSize:this.isMobile?"24px":"32px",color:"#379557",fontFamily:"Poppins",fontStyle:"bold"});l.setOrigin(0,0),this.popupContainer.add(l);const h=t.add.text(e/2,4*o,"Sugar Bomb Bonus",{fontSize:this.isMobile?"24px":"32px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold",align:"center"});h.setOrigin(.5,0),this.popupContainer.add(h);const c=t.add.image(e/2,.35*i,"ScatterLogo");c.setOrigin(.5,.5),this.popupContainer.add(c);const d=t.add.text(e/2,.55*i,"",{color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold",align:"center"});d.setOrigin(.5,.5),this.popupContainer.add(d);const u=t.add.container(e/2,.7*i);this.popupContainer.add(u);const m=Math.max(9.5*o,240),g=(this.isMobile,56),p=t.add.graphics();p.fillStyle(16777215,.2),p.lineStyle(1,6739017,0),p.fillRoundedRect(.5*-m,.5*-g,m,g,10),p.strokeRoundedRect(.5*-m,.5*-g,m,g,10),u.add(p);const b=t.add.text(.5*-m,.5*-g-8,"Bet",{fontSize:this.isMobile?"20px":"24px",color:"#FFFFFF",fontFamily:"Poppins",align:"left"});b.setOrigin(0,1),u.add(b);const f=t.add.text(0,0,"",{fontSize:"24px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold",align:"center"});f.setOrigin(.5,.5),u.add(f);const y=t.add.image(.5*-m+30,0,"minus");y.setInteractive().isButton=!0,u.add(y),this.minusBtnRef=y;const w=t.add.image(.5*m-30,0,"plus");w.setInteractive().isButton=!0,u.add(w),this.plusBtnRef=w;const S=t.add.image(2*o,.8*i,"greenLongBtn");S.setDisplaySize(12*o,2.5*o),S.setOrigin(0,0),this.popupContainer.add(S);const x=t.add.text(e/2,S.y+S.height/2,"BUY FEATURE",{fontSize:(this.isMobile,"24px"),color:"#000000",fontFamily:"Poppins",fontStyle:"bold",align:"center"});x.setOrigin(.5,.5),this.popupContainer.add(x);const F=t.add.image(14*o,3*o,"ekis");F.setDisplaySize(o/1.5,o/1.5),F.setOrigin(.5,.5),this.popupContainer.add(F),S.setInteractive().isButton=!0,S.on("pointerdown",(()=>{const e=t.gameData.getBuyFeaturePrice(),i=t.gameData.balance,s=i>=e;if(console.log(`[BUY FEATURE] Clicked. balance=${i}, cost=${e}, ok=${s}`),!s)return console.log("[BUY FEATURE] Blocked: insufficient balance, showing popup"),void r.emitter.emit(r.SHOW_INSUFFICIENT_BALANCE);this.handleBuyFeature(t)})),F.setInteractive().isButton=!0,F.on("pointerdown",(()=>{this.hide(t)})),y.on("pointerdown",(()=>{if(t.gameData.isSpinning)return;const e=this.findBetIndexByValue(t.gameData.bet);e>0&&(t.audioManager.UtilityButtonSFX.play(),this.currentBetIndex=e-1,t.gameData.bet=this.betOptions[this.currentBetIndex],this.updateBetDisplay(t,f,d),this.updateBetButtonsState(),r.emitter.emit(r.CHANGE_BET,{}))})),w.on("pointerdown",(()=>{if(t.gameData.isSpinning)return;const e=this.findBetIndexByValue(t.gameData.bet);e>=0&&e<this.betOptions.length-1&&(t.audioManager.UtilityButtonSFX.play(),this.currentBetIndex=e+1,t.gameData.bet=this.betOptions[this.currentBetIndex],this.updateBetDisplay(t,f,d),this.updateBetButtonsState(),r.emitter.emit(r.CHANGE_BET,{}))})),this.popupContainer.buyText=d,this.popupContainer.buyBtnBg=S,this.popupContainer.closeBtnBg=F,this.popupContainer.betValueText=f,this.popupContainer.minusBtnRef=y,this.popupContainer.plusBtnRef=w,this.updateBetButtonsState(),r.emitter.on(r.CHANGE_BET,(()=>{if(!this.popupContainer)return;this.currentBetIndex=this.findBetIndexByValue(t.gameData.bet),this.currentBetIndex<0&&(this.currentBetIndex=0),this.updateBetButtonsState();const e=this.popupContainer.buyText,i=this.popupContainer.betValueText;if(this.isMobile)this.updateBetDisplay(t,i,e);else{const i=t.gameData.getBuyFeaturePrice();e.setText(`Buy 10 Free Spins\nAt the cost of $${i}?`)}}))}updateBetDisplay(t,e,i){const s=t.gameData.currency+" "+t.gameData.bet.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});e.setText(s);const n=t.gameData.getBuyFeaturePrice();i.setText(`${t.gameData.currency}${n.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),i.setStyle({color:"#FFFFFF",fontFamily:"Poppins",fontSize:"42px",fontStyle:"bold",fontWeight:"700",align:"center",lineHeight:"normal"})}show(t){if(!this.popupContainer)return;if(t.gameData.isSpinning||t.autoplay.isAutoPlaying||t.gameData.isBonusRound)return;this.currentBetIndex=this.findBetIndexByValue(t.gameData.bet),-1===this.currentBetIndex&&(this.currentBetIndex=17);const e=this.popupContainer.buyText,i=this.popupContainer.betValueText;if(this.isMobile)this.updateBetDisplay(t,i,e),this.updateBetButtonsState();else{const i=t.gameData.getBuyFeaturePrice();e.setText(`Buy 10 Free Spins\nAt the cost of $${i}?`),e.setStyle({color:"#FFFFFF",fontFamily:"Poppins",fontSize:"48px",fontStyle:"bold",fontWeight:"700",align:"center",lineHeight:"normal"})}const s=t.add.graphics();s.name="buyFeatureMask",s.fillStyle(0,.7),s.fillRect(0,0,t.scale.width,t.scale.height),s.setInteractive(new a.Geom.Rectangle(0,0,t.scale.width,t.scale.height),a.Geom.Rectangle.Contains),s.on("pointerdown",(()=>{this.hide(t)})),t.add.existing(s),s.setDepth(999),this.popupContainer.setVisible(!0),this.popupContainer.alpha=0,t.tweens.add({targets:this.popupContainer,alpha:1,y:{from:this.popupY+t.scale.height,to:this.popupY},duration:200,ease:"Cubic.easeOut"})}hide(t){this.popupContainer&&(t.children.list.forEach((t=>{t instanceof a.GameObjects.Graphics&&"buyFeatureMask"===t.name&&t.destroy()})),t.tweens.add({targets:this.popupContainer,alpha:1,y:{from:this.popupY,to:this.popupY+t.scale.height},duration:200,ease:"Cubic.easeIn",onComplete:()=>{this.popupContainer.setVisible(!1)}}))}handleBuyFeature(t){var e,i,s;t.gameData.isSpinning=!1,t.gameData.totalWin=0,r.emitter.emit(r.RESET_WIN,{});try{null==(s=null==(i=null==(e=null==t?void 0:t.buttons)?void 0:e.autoplayIndicator)?void 0:i.setAlpha)||s.call(i,0)}catch(n){}this.hide(t),r.emitter.emit(r.SPIN,{currentRow:t.gameData.currentRow,symbols:t.gameData.slot.values,isBuyFeature:!0})}isVisible(){return!!this.popupContainer&&this.popupContainer.visible}};s(Os,"EPS",1e-6);let ks=Os;class Ns{constructor(){s(this,"container",null)}preload(t){t.load.image("settings_close","assets/Buttons/ekis.png")}create(t){this.container&&(this.container.destroy(!0),this.container=null);const e=t.scale.height-171.6-64,i=t.add.container(48,e);i.setDepth(1200),i.setVisible(!1),i.setScale(.66),this.container=i;const s=t.add.graphics();s.fillStyle(0,1),s.fillRoundedRect(0,0,573,260,12),s.lineStyle(2,6739017,1),s.strokeRoundedRect(0,0,573,260,12),i.add(s);const n=t.add.text(52,60,"SYSTEM SETTINGS",{fontFamily:"Poppins",fontStyle:"bold",color:"#379557",fontSize:"32px"});n.setOrigin(0,.5),i.add(n);const a=n.context.createLinearGradient(0,0,0,n.height);a.addColorStop(0,"#66D449"),a.addColorStop(.75,"#379557"),n.setFill(a);const o=t.add.image(525,58,"settings_close");o.setOrigin(.5,.5),o.setScale(.45),i.add(o),o.setInteractive().isButton=!0,o.on("pointerdown",(()=>this.hide(t)));const r=(e,s,n,a)=>{const o=t.add.image(52,s,"volume");o.setOrigin(0,.5),o.setScale(.5),i.add(o);const r=52+o.displayWidth+12,l=t.add.text(r,s,e,{fontFamily:"Poppins",color:"#FFFFFF",fontSize:"25px"});l.setOrigin(0,.5),i.add(l);const h=r+100,c=t.add.text(h,s,`${Math.round(100*n())}%`,{fontFamily:"Poppins",color:"#FFFFFF",fontSize:"25px"});c.setOrigin(0,.5),i.add(c);const d=h+70,u=s,m=225,g=t.add.graphics();i.add(g);const p=t.add.graphics();i.add(p);const b=()=>{const t=n();g.clear(),g.fillStyle(2829099,1),g.fillRoundedRect(d,u-6,m,12,6),g.fillStyle(3642711,1),g.fillRoundedRect(d,u-6,m*t,12,6),p.clear(),p.fillStyle(16777215,1),p.fillCircle(d+m*t,u,10),c.setText(`${Math.round(100*t)}%`),o.setTint(0===t?10265519:16777215)};b();const f=t.add.zone(d,u-12,m,24).setOrigin(0,0);f.setInteractive(),i.add(f);let y=!1;const w=(t,e,i)=>Math.max(e,Math.min(i,t));f.on("pointerdown",((t,e)=>{y=!0;const i=w(e/m,0,1);a(i),b()})),t.input.on("pointerup",(()=>y=!1)),t.input.on("pointermove",(t=>{if(!y)return;const e=f.getLocalPoint(t.x,t.y),i=w(e.x/m,0,1);a(i),b()})),o.setInteractive({useHandCursor:!0}).isButton=!0,o.on("pointerdown",(()=>{const t=n();a(0===t?1:0),b()}))};r("Music",110,(()=>t.audioManager.getMusicVolume()),(e=>t.audioManager.setMusicVolume(e))),r("SFX",170,(()=>t.audioManager.getSFXVolume()),(e=>t.audioManager.setSFXVolume(e)))}show(t){this.container&&(this.container.setVisible(!0),this.container.alpha=0,t.tweens.add({targets:this.container,alpha:1,duration:150,ease:"Power2"}))}hide(t){this.container&&t.tweens.add({targets:this.container,alpha:0,duration:120,ease:"Power2",onComplete:()=>{this.container.setVisible(!1)}})}}const Vs=class t{constructor(){s(this,"spinButton"),s(this,"freeSpinBtn"),s(this,"autoplayIndicator"),s(this,"turboButton"),s(this,"turboOnButton"),s(this,"buttonContainer"),s(this,"bombWinContainer"),s(this,"bombMarqueeContainer"),s(this,"bombWin"),s(this,"width"),s(this,"height"),s(this,"isVisuallyDisabled",!1),s(this,"buyFeaturePriceText"),s(this,"doubleFeaturePriceText"),s(this,"buyFeatureButton",null),s(this,"buyFeatureButtonText",null),s(this,"buyFeatureStarLeft",null),s(this,"buyFeatureStarRight",null),s(this,"autoplayPopup",null),s(this,"buyFeaturePopup",null),s(this,"balance"),s(this,"totalWin"),s(this,"totalBet"),s(this,"balanceContainer"),s(this,"totalWinContainer"),s(this,"betContainer"),s(this,"betContainer_Y",0),s(this,"autoplay"),s(this,"menu"),s(this,"idleTween",null),s(this,"autoplayButton"),s(this,"autoplayOnButton"),s(this,"isMobile",!1),s(this,"mobile_buttons_y",0),s(this,"spinInProgress",!1),s(this,"wasSpinEnabled",!1),s(this,"wasBuyFeatureEnabled",!1),s(this,"remainingFsLabel",null),s(this,"remainingFsLabel_Count",null),s(this,"forceSpinsLeftOverlay",!1),s(this,"freeSpinTriggered",!1),s(this,"baseYPositions",{}),s(this,"spinAnimation"),s(this,"autoPlay_Y",0),s(this,"amplifyBet"),s(this,"bonusMultiplier",1),this.autoplay=null,this.isMobile=this.isMobileDevice()}hasSufficientBalance(t){if(t.gameData.freeSpins>0)return!0;const e=t.gameData.doubleChanceEnabled?t.gameData.getDoubleFeaturePrice():t.gameData.bet;return t.gameData.balance>=e}isMobileDevice(){const t=new URLSearchParams(window.location.search);return"mobile"==t.get("device")||"desktop"!=t.get("device")&&(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768)}preload(t){this.width=t.scale.width,this.height=t.scale.height;const e="assets/Controllers";t.load.image("spinButton",`${e}/Spin.png`),t.load.image("turboButton",`${e}/Turbo.png`),t.load.image("turboOn",`${e}/Turbo_ON.png`),t.load.image("autoplayButton",`${e}/Autoplay.png`),t.load.image("autoplayOn",`${e}/Autoplay_ON.png`),t.load.image("info",`${e}/Info.png`),t.load.image("infoOn",`${e}/Info_ON.png`),t.load.image("plus",`${e}/Plus.png`),t.load.image("minus",`${e}/Minus.png`),t.load.image("logo","assets/Logo/Logo.png"),t.load.image("volume",`${e}/Volume.png`),t.load.image("settings",`${e}/Settings.png`),t.load.image("star",`${e}/star.png`),t.load.image("buyFeatBG","assets/Reels/BuyFeatureBG.png"),t.load.image("freeSpinDisplay",`${e}/FreeSpinDisplay.png`),t.load.image("autoplayIndicator",`${e}/AutoplayIndicator.png`),t.load.image("amplifyBet",`${e}/AmplifyBet.png`),t.load.image("greenBtn","assets/Buttons/greenBtn.png"),t.load.image("greenLongBtn","assets/Buttons/greenLongBtn.png"),t.load.image("greenRectBtn","assets/Buttons/greenRectBtn.png"),t.load.image("greenCircBtn","assets/Buttons/greenCircBtn.png"),t.load.image("hamburger","assets/Mobile/Hamburger.png"),t.load.image("buyFeature","assets/Mobile/BuyFeature.png"),t.load.image("doubleFeature","assets/Mobile/DoubleFeature.png"),t.load.image("marquee","assets/Mobile/Marquee.png"),t.load.spineAtlas("button_animation_idle","assets/Controllers/Animation/Spin/button_animation_idle.atlas"),t.load.spineJson("button_animation_idle","assets/Controllers/Animation/Spin/button_animation_idle.json"),t.load.spineAtlas("Amplify_Bet","assets/Controllers/Animation/AmplifyBet/Amplify Bet.atlas"),t.load.spineJson("Amplify_Bet","assets/Controllers/Animation/AmplifyBet/Amplify Bet.json"),(new Ws).preload(t),new Ls(!1).preload(t),(new ks).preload(t),(new Ns).preload(t)}create(t){this.autoplay&&this.autoplay.create||(this.autoplay=t.autoplay),this.isMobile&&(this.mobile_buttons_y=.86*t.scale.height),this.createContainer(t),this.createTurboButton(t),this.createSpinButton(t),this.createAutoplay(t),this.createInfo(t),this.createBalance(t),this.createTotalWin(t),this.createBombWin(t),this.createBet(t),this.createBuyFeature(t),this.createDoubleFeature(t),this.createLogo(t),this.createMarquee(t),this.createMarqueeBonus(t),this.createSettings(t),r.emitter.emit(r.HIDE_BOMB_WIN),t.buyFeaturePopup||(t.buyFeaturePopup=new ks,t.buyFeaturePopup.create(t)),this.setupKeyboardInput(t),this.createRemainingFreeSpinsLabel(t),r.emitter.on(r.BOMB_FLOAT_TEXT,(e=>{var i,s,n,a,o,r,l,h;try{const d=null!=(i=null==e?void 0:e.x)?i:.5*t.scale.width,u=null!=(s=null==e?void 0:e.y)?s:.5*t.scale.height,m=this.isMobile;let g=.5*t.scale.width,p=this.isMobile?.175*this.height:.83*this.height;if(m){const e=null==(r=null==(o=null==(a=this.buttonContainer)?void 0:a.list)?void 0:o.find)?void 0:r.call(o,(t=>{var e,i;return null==(i=null==(e=null==t?void 0:t.list)?void 0:e.some)?void 0:i.call(e,(t=>{var e;return"marquee"===(null==(e=null==t?void 0:t.texture)?void 0:e.key)}))}));let i=null;e&&e.list&&(i=e.list.find((t=>{var e;return"marquee"===(null==(e=null==t?void 0:t.texture)?void 0:e.key)})));const s=(null==i?void 0:i.getBounds)?i.getBounds():null;s?(g=s.centerX,p=s.centerY):(g=.5*t.scale.width,p=.175*t.scale.height)}else{const t=(null==(n=this.totalWinContainer)?void 0:n.getBounds)?this.totalWinContainer.getBounds():null;t&&(g=t.centerX,p=t.centerY)}const b=t.add.text(d,u,null!=(l=null==e?void 0:e.valueText)?l:"",{fontSize:"32px",color:"#FFD700",fontFamily:"Poppins",fontStyle:"bold",align:"center",stroke:"#FF0000",strokeThickness:4});b.setOrigin(.5,.5),b.setDepth(1e4);try{const t=null==(h=b.context)?void 0:h.createLinearGradient(0,0,0,b.height);t&&(t.addColorStop(0,"#FFF15A"),t.addColorStop(.5,"#FFD000"),t.addColorStop(1,"#FFB400"),b.setFill(t))}catch(c){}t.tweens.add({targets:b,x:g,y:p,duration:900,ease:"Cubic.easeInOut",onComplete:()=>{try{b.destroy()}catch(c){}}})}catch(c){}}))}createContainer(t){this.buttonContainer=t.add.container(0,0),this.buttonContainer.setDepth(10),this.isMobile||this.buttonContainer.setDepth(6)}createRemainingFreeSpinsLabel(t){const e=this.isMobile?.2*t.scale.width:.88*t.scale.width,i=this.isMobile?.815*t.scale.height:.39*t.scale.height,s={fontSize:this.isMobile?"32px":"28px",color:this.isMobile?"#09FF5C":"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold",align:"left",wordWrap:{width:.5*t.scale.width,useAdvancedWrap:!0}};this.remainingFsLabel=t.add.text(e,i,"Remaining Free Spins:",s),this.remainingFsLabel.setOrigin(this.isMobile?0:.5,this.isMobile?0:.225),this.remainingFsLabel.setDepth(1e3),this.remainingFsLabel.setVisible(!1);const n=this.isMobile?.65*t.scale.width:.88*t.scale.width,a=this.isMobile?.81*t.scale.height:.39*t.scale.height,o={fontSize:this.isMobile?"84px":"128px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold",align:"left"};this.remainingFsLabel_Count=t.add.text(n,a,"0",o),this.remainingFsLabel_Count.setOrigin(this.isMobile?0:.5,(this.isMobile,0)),this.remainingFsLabel_Count.setDepth(1e3),this.remainingFsLabel_Count.setVisible(!1);const l=()=>{var e,i,s,n,a,o;if(!this.remainingFsLabel||!this.remainingFsLabel_Count)return;this.remainingFsLabel.setFontSize(this.isMobile?"32px":"20px");const r=!!t.gameData.isBonusRound&&(null!=(e=t.gameData.freeSpins)?e:0)>0,l=this.forceSpinsLeftOverlay?10:null!=(i=t.gameData.freeSpins)?i:0;this.isMobile?(this.remainingFsLabel.setText("Remaining Free Spins:"),this.remainingFsLabel_Count.setText(`${l}`)):(this.remainingFsLabel.setText("Spins Left:"),this.remainingFsLabel_Count.setText(`${this.forceSpinsLeftOverlay?l:l-1}`)),this.remainingFsLabel.setVisible(r),this.remainingFsLabel_Count.setVisible(r);try{this.freeSpinBtn.visible=r||!!(null==(s=this.autoplay)?void 0:s.isAutoPlaying)||!!t.gameData.autoplayWasPaused}catch(h){}try{this.autoplayIndicator.visible=!(r||!(null==(n=this.autoplay)?void 0:n.isAutoPlaying)&&!t.gameData.autoplayWasPaused)}catch(h){}try{t.gameData.isBonusRound&&(null==(a=this.autoplayIndicator)?void 0:a.visible)&&(this.freeSpinBtn.visible=!0)}catch(h){}try{this.updateButtonStates(t)}catch(h){}this.isMobile?(this.hideBottomControlsForBonus(t,r),this.remainingFsLabel.setText("Remaining Free Spins:"),this.remainingFsLabel_Count.setText(""+(l-1))):r&&(null==(o=this.autoplay)?void 0:o.ensureRemainingSpinsDisplay)&&this.autoplay.ensureRemainingSpinsDisplay(t)};r.emitter.on(r.SPIN_ANIMATION_START,l),r.emitter.on(r.SPIN_ANIMATION_END,l),r.emitter.on(r.MATCHES_DONE,l),r.emitter.on(r.UPDATE_TOTAL_WIN,l),r.emitter.on(r.AUTOPLAY_START,l),r.emitter.on(r.AUTOPLAY_STOP,l),r.emitter.on(r.FREE_SPIN_OVERLAY_SHOW,(()=>{if(this.forceSpinsLeftOverlay=!0,this.remainingFsLabel&&this.remainingFsLabel_Count){this.remainingFsLabel.setText(this.isMobile?"Remaining Free Spins:":"Spins Left:"),this.remainingFsLabel_Count.setText("10"),this.remainingFsLabel.setVisible(!0),this.remainingFsLabel_Count.setVisible(!0);try{this.freeSpinBtn.visible=!0,this.freeSpinBtn.setAlpha(1)}catch(e){}try{this.spinButton.setAlpha(0)}catch(e){}try{this.autoplayIndicator.visible=!1}catch(e){}try{this.updateButtonStates(t)}catch(e){}}})),r.emitter.on(r.WIN_OVERLAY_HIDE,(()=>{this.forceSpinsLeftOverlay=!1;try{l()}catch(t){}})),l()}showRemainingFreeSpinsLabel(t){var e,i;if(!this.remainingFsLabel||!this.remainingFsLabel_Count)return;const s=null!=(e=t.gameData.freeSpins)?e:0;this.isMobile?(this.remainingFsLabel.setText("Remaining Free Spins:"),this.remainingFsLabel_Count.setText(""+(s-1))):(this.remainingFsLabel.setText("Spins Left:"),this.remainingFsLabel_Count.setText(`${s}`)),!this.isMobile&&(null==(i=this.autoplay)?void 0:i.ensureRemainingSpinsDisplay)&&this.autoplay.ensureRemainingSpinsDisplay(t);try{this.freeSpinBtn.visible=!0}catch(n){}try{this.autoplayIndicator.visible=!1}catch(n){}}updateRemainingFreeSpinsCount(t){var e,i;if(!this.remainingFsLabel||!this.remainingFsLabel_Count)return;const s=null!=(e=t.gameData.freeSpins)?e:0;this.isMobile?(this.remainingFsLabel.setText("Remaining Free Spins:"),this.remainingFsLabel_Count.setText(`${s}`)):(this.remainingFsLabel.setText("Spins Left:"),this.remainingFsLabel_Count.setText(`${s}`)),!this.isMobile&&(null==(i=this.autoplay)?void 0:i.ensureRemainingSpinsDisplay)&&this.autoplay.ensureRemainingSpinsDisplay(t)}hideRemainingFreeSpinsLabel(t){var e,i,s;if(this.remainingFsLabel&&this.remainingFsLabel_Count){this.remainingFsLabel.setVisible(!1),this.remainingFsLabel_Count.setVisible(!1),this.remainingFsLabel_Count.setText(""),this.remainingFsLabel_Count.setVisible(!1);try{const n=!!t&&!!(null==(e=t.gameData)?void 0:e.autoplayWasPaused);(null==(i=this.autoplayIndicator)?void 0:i.visible)||(null==(s=this.autoplay)?void 0:s.isAutoPlaying)||n||(this.freeSpinBtn.visible=!1)}catch(n){}}}hideBottomControlsForBonus(t,e){if(!this.buttonContainer)return;this.isMobile||(e=!1);const i=(t,e)=>{const i=this.buttonContainer.list.find((e=>e.name===t));i&&i.setVisible(e)};i("spinContainer",!e),i("turboContainer",!e),i("doubleFeatureContainer",!e),i("autoplayContainer",!e),i("settingsContainer",!this.isMobile||!e||!e),this.isMobile||i("infoContainer",!e),r.emitter.emit(r.CREATE_TURBO_BUTTON,e),r.emitter.emit(r.CREATE_AUTOPLAY,e),r.emitter.emit(r.CREATE_SPIN_BUTTON,e),r.emitter.emit(r.CREATE_DOUBLE_FEATURE,e),r.emitter.emit(r.CREATE_INFO,e)}toggleTurbo(t){if(t.audioManager.UtilityButtonSFX.play(),t.gameData.isSpinning){const e=()=>{this.turboButton.visible=!this.turboButton.visible,this.turboOnButton.visible=!this.turboOnButton.visible,t.gameData.turbo=!t.gameData.turbo,r.emitter.off(r.MATCHES_DONE,e)};r.emitter.once(r.MATCHES_DONE,e)}else this.turboButton.visible=!this.turboButton.visible,this.turboOnButton.visible=!this.turboOnButton.visible,t.gameData.turbo=!t.gameData.turbo}createTurboButton(t){const e=this.isMobile?.915*this.width:.88*this.width,i=this.isMobile?this.mobile_buttons_y:.29*this.height,s=t.add.container(e,i);this.turboButton=t.add.image(0,0,"turboButton"),this.turboOnButton=t.add.image(0,0,"turboOn"),this.turboOnButton.visible=!1;const n=.75*this.turboButton.width,o=.75*this.turboButton.height,l=t.add.graphics();l.fillStyle(0,.5),l.fillCircle(0,0,1.25*n),s.add(l);const h=t.add.graphics();if(h.fillStyle(0,.15),h.fillCircle(0,0,1.55*n),h.setVisible(!this.isMobile),s.add(h),this.turboButton.displayWidth=n,this.turboButton.displayHeight=o,this.turboOnButton.displayWidth=3*n,this.turboOnButton.displayHeight=2.25*o,this.turboButton.setInteractive().isButton=!0,this.turboOnButton.setInteractive().isButton=!0,s.add(this.turboButton),s.add(this.turboOnButton),s.name="turboContainer",s.setScale(this.isMobile?.3:1),this.turboOnButton.setScale(this.isMobile?.9:1),this.isMobile){const e=t.add.text(0,50,"Turbo",{fontSize:"12px",color:"#FFFFFF",fontFamily:"Poppins",align:"center"});e.setOrigin(.5,0),e.setScale(2),s.add(e)}s.setScale(this.isMobile?.475:1),this.buttonContainer.add(s),this.baseYPositions[s.name]=s.y,r.emitter.on(r.CREATE_TURBO_BUTTON,(e=>{var i;if(!s)return;const n=null!=(i=this.baseYPositions.turboContainer)?i:s.y,a=e?t.scale.height+200:n;try{t.tweens.add({targets:s,y:a,duration:200,ease:"Cubic.easeInOut"})}catch(o){s.y=a}})),s.setInteractive(new a.Geom.Circle(0,0,1.25*n),a.Geom.Circle.Contains).isButton=!0,s.on("pointerdown",(()=>{this.toggleTurbo(t)})),this.turboButton.on("pointerdown",(()=>{this.toggleTurbo(t)})),this.turboOnButton.on("pointerdown",(()=>{this.toggleTurbo(t)}))}setupKeyboardInput(t){var e;null==(e=t.input.keyboard)||e.on("keydown-SPACE",(()=>{if(!t.gameData.isBonusRound&&!(t.gameData.isSpinning||t.slotMachine.activeWinOverlay||t.gameData.isHelpScreenVisible||this.isVisuallyDisabled)){if(!this.hasSufficientBalance(t))return console.log("[INPUT] Spacebar blocked: insufficient balance"),void r.emitter.emit(r.SHOW_INSUFFICIENT_BALANCE);this.disableButtonsVisually(t),t.gameData.isHelpScreenVisible?t.helpScreen.hide(t):(t.buttons.autoplay.isAutoPlaying&&(t.buttons.autoplay.stop(),t.buttons.resetAutoplayButtons(),r.emitter.emit(r.AUTOPLAY_STOP)),t.audioManager.SpinSFX.play(),t.gameData.totalWin=0,r.emitter.emit(r.WIN,{}),r.emitter.emit(r.SPIN,{currentRow:t.gameData.currentRow,symbols:t.gameData.slot.values}))}}))}spinAnimationOnce(){this.spinAnimation.setAlpha(1),this.spinAnimation.animationState.setAnimation(0,"animation",!1),this.spinAnimation.animationState.addListener({complete:()=>{this.spinAnimation.setAlpha(0)}})}createSpinButton(t){const e=this.isMobile?.5*this.width:.88*this.width,i=this.isMobile?this.mobile_buttons_y:.443*this.height,s=t.add.container(e,i);this.spinButton=t.add.image(0,0,"spinButton");const n=this.isMobile?this.spinButton.width/3.25:.75*this.spinButton.width,a=this.isMobile?this.spinButton.height/3.25:.75*this.spinButton.height;this.freeSpinBtn=t.add.image(0,0,"greenCircBtn"),this.autoplayIndicator=t.add.image(0,0,"autoplayIndicator");const o=this.isMobile?this.freeSpinBtn.width/2.5:.9*this.freeSpinBtn.width,l=this.isMobile?this.freeSpinBtn.height/2.5:.9*this.freeSpinBtn.height,h=t.add.graphics();h.fillStyle(0,.15),h.setVisible(!this.isMobile);const c=.57*n;h.fillCircle(0,0,c),s.add(h),this.spinButton.displayWidth=n,this.spinButton.displayHeight=a,this.spinButton.setInteractive().isButton=!0,s.add(this.spinButton),this.freeSpinBtn.displayWidth=o,this.freeSpinBtn.displayHeight=l,this.freeSpinBtn.setInteractive().isButton=!0,this.autoplayIndicator.displayWidth=o,this.autoplayIndicator.displayHeight=l,this.autoplayIndicator.setInteractive().isButton=!0,this.autoplayIndicator.setScale(.95,.95),this.isMobile&&this.autoplayIndicator.setScale(.4,.4),s.add(this.freeSpinBtn),s.add(this.autoplayIndicator),s.name="spinContainer",setTimeout((()=>{const e=t.add.spine(0,0,"button_animation_idle","button_animation_idle");e.setPosition(0,0),e.setOrigin(.4,1.2),e.setAlpha(0),e.setScale(this.isMobile?1.4:3.3),s.add(e),s.bringToTop(e),this.spinAnimation=e}),10),this.buttonContainer.add(s),this.baseYPositions[s.name]=s.y,r.emitter.on(r.CREATE_SPIN_BUTTON,(e=>{var i;if(!s)return;const n=null!=(i=this.baseYPositions.spinContainer)?i:s.y,a=e?t.scale.height+200:n;try{t.tweens.add({targets:s,y:a,duration:200,ease:"Cubic.easeInOut"})}catch(o){s.y=a}})),this.baseYPositions[s.name]=s.y,r.emitter.on(r.CREATE_SPIN_BUTTON,(e=>{const i=this.baseYPositions.spinContainer,n=e?t.scale.height+200:i;t.tweens.add({targets:s,y:n,duration:200,ease:"Cubic.easeInOut"})}));const d=()=>{this.startIdleAnimation(t)};d();const u=()=>{this.stopIdleAnimation()},m=()=>!t.gameData.isSpinning&&!this.autoplay.isAutoPlaying,g=()=>{this.updateButtonStates(t)};r.emitter.on(r.WIN_OVERLAY_SHOW,(()=>{u()})),r.emitter.on(r.WIN_OVERLAY_HIDE,(()=>{m()&&d()}));const p=()=>{var e;const i=Date.now()<((null==(e=t.gameData)?void 0:e.freeSpinLockUntilMs)||0);if(i)try{this.spinButton.setAlpha(.5),this.spinButton.disableInteractive()}catch(s){}if(!(i||this.spinInProgress||t.gameData.isSpinning||t.slotMachine.activeWinOverlay||this.isVisuallyDisabled)){if(!this.hasSufficientBalance(t))return console.log("[SPIN] Blocked in spinAction: insufficient balance"),void r.emitter.emit(r.SHOW_INSUFFICIENT_BALANCE);this.spinInProgress=!0,this.disableButtonsVisually(t),t.gameData.isHelpScreenVisible&&t.helpScreen.hide(t),this.autoplay.isAutoPlaying&&(this.autoplay.stop(),this.resetAutoplayButtons(),r.emitter.emit(r.AUTOPLAY_STOP)),t.gameData.totalWin=0,r.emitter.emit(r.RESET_WIN,{}),r.emitter.emit(r.SPIN,{currentRow:t.gameData.currentRow,symbols:t.gameData.slot.values})}};this.spinButton.on("pointerdown",(()=>{if(!this.spinInProgress&&!t.gameData.isSpinning){if(!this.hasSufficientBalance(t))return console.log("[INPUT] Spin click blocked: insufficient balance"),void r.emitter.emit(r.SHOW_INSUFFICIENT_BALANCE);t.audioManager.SpinSFX.play(),this.spinAnimationOnce(),p()}})),this.freeSpinBtn.on("pointerdown",(()=>{})),this.freeSpinBtn.visible=!1,this.autoplayIndicator.visible=!1,this.autoplayIndicator.on("pointerdown",(()=>{this.autoplay&&this.autoplay.isAutoPlaying&&(t.audioManager.UtilityButtonSFX.play(),r.emitter.emit(r.AUTOPLAY_STOP))})),r.emitter.on(r.SPIN_ANIMATION_START,(()=>{u(),g()})),r.emitter.on(r.MATCHES_DONE,(()=>{g(),m()&&d()})),r.emitter.on(r.SPIN_ANIMATION_END,(()=>{g()})),r.emitter.on(r.WIN_OVERLAY_SHOW,(()=>{g()})),r.emitter.on(r.WIN_OVERLAY_HIDE,(()=>{g()})),g();try{this.spinButton.setAlpha(1)}catch(b){}try{this.freeSpinBtn.setAlpha(0)}catch(b){}m()&&d(),r.emitter.on(r.MATCHES_DONE,(()=>{var e;this.spinInProgress=!1;const i=!!(null==(e=null==t?void 0:t.slotMachine)?void 0:e.bonusTriggeredThisSpin)&&!t.gameData.isBonusRound;if(this.enableButtonsVisually(t),i)try{this.spinButton.setAlpha(.5),this.spinButton.disableInteractive()}catch(b){}}))}createAutoplay(t){var e;const i=this.isMobile?.28*this.width:.88*this.width,s=this.isMobile?this.mobile_buttons_y:.598*this.height,n=32,o=t.add.container(i,s);this.autoplayButton=t.add.image(0,0,"autoplayButton"),this.autoplayOnButton=t.add.image(0,0,"autoplayOn"),this.autoplayButton.setScale(this.isMobile?.7:1),this.autoplayOnButton.setScale(this.isMobile?.4:1);const l=t.add.graphics();l.fillStyle(0,.5),l.fillCircle(0,0,60*(this.isMobile?.514:.78)),o.add(l);const h=t.add.graphics();h.fillStyle(0,.15),h.fillCircle(0,0,60*(this.isMobile?.675:.95)),h.setVisible(!this.isMobile),o.add(h),this.autoplayButton.setInteractive().isButton=!0,this.autoplayOnButton.setInteractive().isButton=!0,this.autoplayOnButton.setScale(this.isMobile?.7:1.1),o.add(this.autoplayButton),o.add(this.autoplayOnButton),this.autoplayOnButton.visible=!1,this.buttonContainer.add(o),o.name="autoplayContainer",this.baseYPositions[o.name]=o.y,r.emitter.on(r.CREATE_AUTOPLAY,(e=>{var i;if(!o)return;const s=null!=(i=this.baseYPositions.autoplayContainer)?i:o.y,n=e?t.scale.height+200:s;try{t.tweens.add({targets:o,y:n,duration:200,ease:"Cubic.easeInOut"})}catch(a){o.y=n}}));const c=this.isMobile?t.scale.width:466,d=722,u=t.add.container(this.isMobile?0:t.scale.width/2-c/2,this.isMobile?t.scale.height/2-d*(1-d/t.scale.height*.75):t.scale.height/2-361);u.setDepth(1e3),u.setVisible(!1),u.setScale((this.isMobile,1)),this.autoplayPopup=u,this.autoPlay_Y=u.y;const m=t.add.graphics();m.fillStyle(0,.8),m.lineStyle(0,6739017,1),m.strokeRoundedRect(0,0,c,this.isMobile?1444:d,16),m.fillRoundedRect(0,0,c,this.isMobile?1444:d,16),u.add(m),t.sys.game.renderer.pipelines&&m.setPipeline("BlurPostFX");const g=t.add.text(n,n,"AUTOPLAY SETTINGS",{fontSize:"24px",color:"#66D449",fontStyle:"bold",fontFamily:"Poppins"});u.add(g);const p=t.add.text(c-64,n,"Ã—",{fontSize:"32px",color:"#FFFFFF",fontFamily:"Poppins"});p.setInteractive().isButton=!0,u.add(p);const b=c-64,f=t.add.graphics();f.fillStyle(0,.5),f.lineStyle(1,6739017,0),f.fillRoundedRect(n,74,b,60,10),f.strokeRoundedRect(n,74,b,60,10),u.add(f);const y=t.add.text(48,104,"Balance",{fontSize:"24px",color:"#FFFFFF",fontFamily:"Poppins"});y.setOrigin(0,.5),u.add(y);const w=t.add.text(n+b-16,104,t.gameData.currency+t.gameData.balance.toLocaleString(),{fontSize:"24px",color:"#66D449",fontFamily:"Poppins",align:"center"});null==(e=w.setOrigin)||e.call(w,1,.5),u.add(w);const S=t.add.text(n,164,"Number of autospins",{fontSize:"24px",color:"#FFFFFF",fontFamily:"Poppins"});u.add(S);const x=[10,30,50,75,100,150,500,1e3],F=79.65,v=this.isMobile?16:28;let T=x[0],A=null;const M=x.map(((e,i)=>{const s=Math.floor(i/4),o=n+i%4*(F+v),r=S.y+S.height+n+s*(60+v),l=t.add.container(o,r),h=t.add.graphics();h.fillStyle(0===i?6739017:1579032,1),h.fillRoundedRect(0,0,F,60,8),l.add(h);const c=t.add.text(39.825,30,e.toString(),{fontSize:"24px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold"});c.setOrigin(.5),l.add(c);const d=new a.Geom.Rectangle(0,0,F,60);return l.setInteractive(d,a.Geom.Rectangle.Contains),l.isButton=!0,l.on("pointerdown",(()=>{if(t.audioManager.UtilityButtonSFX.play(),A){const t=A.list[0];t.clear(),t.fillStyle(1579032,1),t.fillRoundedRect(0,0,F,60,8)}h.clear(),h.fillStyle(6739017,1),h.fillRoundedRect(0,0,F,60,8),A=l,T=e,Y()})),u.add(l),l}));A=M[0];const C=t.add.text(n,393,"BET",{fontSize:"24px",color:"#FFFFFF",fontFamily:"Poppins"});u.add(C);const B=C.y+C.height+n/3,P=c-64,I=t.add.graphics();I.fillStyle(3355443,.8),I.lineStyle(1,6739017,1),I.fillRoundedRect(n,B,P,74,10),I.strokeRoundedRect(n,B,P,74,10),u.add(I);const E=B+37,D=t.add.image(68,E,"minus");D.setInteractive().isButton=!0,u.add(D);let R=t.gameData.bet;const _=t.add.text(c/2,E,t.gameData.currency+R.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),{fontSize:"32px",color:"#FFFFFF",fontFamily:"Poppins",align:"center"});_.setOrigin(.5,.5),u.add(_);const W=t.add.image(n+P-36,E,"plus");W.setInteractive().isButton=!0,u.add(W);const L=[.2,.4,.6,.8,1,1.2,1.6,2,2.4,2.8,3.2,3.6,4,5,6,8,10,14,18,24,32,40,60,80,100,110,120,130,140,150];let O=L.indexOf(t.gameData.bet);-1===O&&(O=0);const k=1e-6,N=t=>L.findIndex((e=>Math.abs(e-t)<k)),V=()=>{var e,i,s,n,a,o,r,l;const h=t.gameData.bet<=L[0]+k,c=t.gameData.bet>=L[L.length-1]-k;h?(null==(e=D.setAlpha)||e.call(D,.3),null==(i=D.disableInteractive)||i.call(D)):(null==(s=D.setAlpha)||s.call(D,.8),null==(n=D.setInteractive)||n.call(D)),c?(null==(a=W.setAlpha)||a.call(W,.3),null==(o=W.disableInteractive)||o.call(W)):(null==(r=W.setAlpha)||r.call(W,.8),null==(l=W.setInteractive)||l.call(W))};function Y(){const e=t.gameData.bet;_.setText(t.gameData.currency+" "+e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}))}W.on("pointerdown",(()=>{const e=N(t.gameData.bet);e>=0&&e<L.length-1&&(t.audioManager.UtilityButtonSFX.play(),O=e+1,t.gameData.bet=L[O],Y(),V(),r.emitter.emit(r.CHANGE_BET,{}),r.emitter.emit(r.ENHANCE_BET_TOGGLE,{}))})),D.on("pointerdown",(()=>{const e=N(t.gameData.bet);e>0&&(t.audioManager.UtilityButtonSFX.play(),O=e-1,t.gameData.bet=L[O],Y(),V(),r.emitter.emit(r.CHANGE_BET,{}),r.emitter.emit(r.ENHANCE_BET_TOGGLE,{}))})),Y(),V();const X=t.add.image(c/2,0,"greenLongBtn");X.displayWidth=402,X.displayHeight=62,X.setPosition(c/2,626-X.displayHeight/2-24),X.setOrigin(.5,.5),u.add(X);const G=t.add.text(c/2,X.y,"START AUTOPLAY",{fontSize:"28px",color:"#000000",fontStyle:"bold",fontFamily:"Poppins"});if(G.setOrigin(.5,.5),u.add(G),X.setInteractive().isButton=!0,X.on("pointerdown",(()=>{T>0&&(this.autoplayIndicator.setAlpha(1),t.audioManager.UtilityButtonSFX.play(),this.autoplayButton.visible=!1,this.autoplayOnButton.visible=!0,t.tweens.add({targets:u,y:{from:u.y,to:u.y+1500},duration:1e3,ease:"Cubic.easeIn",onComplete:()=>{u.setVisible(!1),u.list.forEach((t=>{t instanceof a.GameObjects.Graphics&&"betMask"===t.name&&t.destroy()}))}}),t.gameData.debugLog("autoplay.isAutoPlaying",this.autoplay.isAutoPlaying),r.emitter.emit(r.AUTOPLAY_START,T))})),p.on("pointerdown",(()=>{t.audioManager.UtilityButtonSFX.play(),t.tweens.add({targets:u,alpha:0,y:{from:this.autoPlay_Y,to:this.autoPlay_Y+1e3},duration:500,ease:"Cubic.easeIn",onComplete:()=>{u.setVisible(!1),u.list.forEach((t=>{t instanceof a.GameObjects.Graphics&&t.destroy()}))}})})),this.autoplayButton.on("pointerdown",(()=>{if(t.gameData.isSpinning)return;t.audioManager.UtilityButtonSFX.play(),t.buyFeaturePopup&&t.buyFeaturePopup.isVisible()&&t.buyFeaturePopup.hide(t),this.hideBetPopup(t),(()=>{const e=t.gameData.balance;w.setText(t.gameData.currency+e.toLocaleString())})(),R=t.gameData.bet*T,Y();try{V()}catch(i){}const e=t.add.graphics();e.name="betMask",e.fillStyle(0,.7),e.fillRect(0,0,t.scale.width,t.scale.height),e.setInteractive(new a.Geom.Rectangle(0,0,t.scale.width,t.scale.height),a.Geom.Rectangle.Contains),e.on("pointerdown",(()=>{t.tweens.add({targets:u,y:{from:this.autoPlay_Y,to:this.autoPlay_Y+1e3},duration:500,ease:"Expo.easeOut",onComplete:()=>{u.setVisible(!1)}}),u.list.forEach((t=>{t instanceof a.GameObjects.Graphics&&"betMask"===t.name&&t.destroy()}))})),e.setScale(this.isMobile?2.5:1),e.setPosition(this.isMobile?-c/2:-u.x,this.isMobile?-902.5:-u.y),u.add(e),u.sendToBack(e),t.tweens.add({targets:e,alpha:{from:0,to:.01}}),u.setVisible(!0),u.alpha=0,t.tweens.add({targets:u,alpha:{from:0,to:1},y:{from:this.autoPlay_Y+1e3,to:this.autoPlay_Y},duration:500,ease:"Expo.easeOut"})})),this.autoplayOnButton.on("pointerdown",(()=>{var e;(null==(e=t.gameData)?void 0:e.autoplayWasPaused)||(t.audioManager.UtilityButtonSFX.play(),r.emitter.emit(r.AUTOPLAY_STOP))})),r.emitter.on(r.AUTOPLAY_COMPLETE,(()=>{this.autoplayButton.visible=!0,this.autoplayOnButton.visible=!1})),this.isMobile){const e=t.add.text(0,30,"Autoplay",{fontSize:"12px",color:"#FFFFFF",fontFamily:"Poppins",align:"center"});e.setOrigin(.5,0),o.add(e)}}resetAutoplayButtons(){this.autoplayButton.visible=!0,this.autoplayOnButton.visible=!1,this.freeSpinBtn.visible=!1,this.autoplayIndicator.visible=!1,this.spinButton&&this.spinButton.setAlpha(1)}updateButtonStates(t){var e,i,s,n,a,o,r,l,h,c,d,u;const m=Date.now()<((null==(e=t.gameData)?void 0:e.freeSpinLockUntilMs)||0),g=t.gameData.isSpinning||t.slotMachine.activeWinOverlay||m,p=this.isVisuallyDisabled||g,b=p||t.gameData.isBonusRound,f=p||this.autoplay.isAutoPlaying||t.gameData.isBonusRound,y=!p,w=!f;b?(this.spinButton.setAlpha(.5),this.spinButton.disableInteractive()):(this.spinButton.setAlpha(1),this.spinButton.setInteractive()),this.autoplayButton&&(this.freeSpinTriggered?(this.autoplayButton.setAlpha(.5),this.autoplayButton.disableInteractive()):(this.autoplayButton.setAlpha(1),this.autoplayButton.setInteractive())),this.autoplayOnButton&&(this.freeSpinTriggered?(this.autoplayOnButton.setAlpha(.5),null==(s=(i=this.autoplayOnButton).disableInteractive)||s.call(i)):(this.autoplayOnButton.setAlpha(1),null==(a=(n=this.autoplayOnButton).setInteractive)||a.call(n))),this.buyFeatureButton&&(this.buyFeatureButton.setAlpha(f?.5:1),f?null==(r=(o=this.buyFeatureButton).disableInteractive)||r.call(o):null==(h=(l=this.buyFeatureButton).setInteractive)||h.call(l)),this.buyFeaturePriceText&&this.buyFeaturePriceText.setAlpha(f?.5:1),this.buyFeatureButtonText&&this.buyFeatureButtonText.setAlpha(f?.5:1),this.buyFeatureStarLeft&&this.buyFeatureStarLeft.setAlpha(f?.5:1),this.buyFeatureStarRight&&this.buyFeatureStarRight.setAlpha(f?.5:1),y&&!this.wasSpinEnabled&&this.playReadyCue(t,this.spinButton),w&&!this.wasBuyFeatureEnabled&&this.buyFeatureButton&&this.playReadyCue(t,this.buyFeatureButton),this.wasSpinEnabled=y,this.wasBuyFeatureEnabled=w;try{(null==(c=this.autoplay)?void 0:c.isAutoPlaying)?(this.spinButton.setAlpha(0),this.freeSpinBtn.visible=!0,this.freeSpinBtn.setAlpha(1)):t.gameData.isBonusRound&&(null==(d=this.autoplayIndicator)?void 0:d.visible)&&(null==(u=this.spinButton)?void 0:u.visible)&&this.spinButton.setAlpha(0)}catch(S){}}disableButtonsVisually(t){this.isVisuallyDisabled=!0,this.updateButtonStates(t)}enableButtonsVisually(t){this.isVisuallyDisabled=!1,this.updateButtonStates(t)}playReadyCue(t,e){var i,s,n,a;try{const o=null!=(s=null!=(i=e.scaleX)?i:e.scale)?s:1,r=null!=(a=null!=(n=e.scaleY)?n:e.scale)?a:1;t.tweens.add({targets:e,scaleX:1*o,scaleY:1*r,duration:120,yoyo:!0,repeat:1,ease:"Sine.easeOut"})}catch(o){}}createInfo(t){const e=this.isMobile?.12*this.width:.88*this.width,i=this.isMobile?this.mobile_buttons_y:.7*this.height,s=t.add.container(e,i),n=t.add.image(0,0,"info"),o=t.add.image(0,0,"infoOn");o.visible=!1;const l=.6*n.width,h=.6*n.height,c=t.add.graphics();c.fillStyle(0,.5),c.fillCircle(0,0,this.isMobile?1.75*l:1.875*l),s.add(c);const d=t.add.graphics();d.fillStyle(0,.15),d.fillCircle(0,0,2.25*l),d.setVisible(!this.isMobile),s.add(d),n.displayWidth=.8*l,n.displayHeight=.8*h,o.displayWidth=4.5*l*.8,o.displayHeight=2.25*h*.8,n.setInteractive().isButton=!0,o.setInteractive().isButton=!0,s.add(n),s.add(o),s.setScale(this.isMobile?0:1),s.name="infoContainer",this.buttonContainer.add(s),this.baseYPositions[s.name]=s.y,r.emitter.on(r.CREATE_INFO,(e=>{var i;if(!s)return;const n=null!=(i=this.baseYPositions.infoContainer)?i:s.y,a=e?t.scale.height+200:n;try{t.tweens.add({targets:s,y:a,duration:200,ease:"Cubic.easeInOut"})}catch(o){s.y=a}})),s.setInteractive(new a.Geom.Circle(0,0,1.25*l/.8),a.Geom.Circle.Contains).isButton=!0;const u=()=>{this.hideBetPopup(t),t.gameData.isHelpScreenVisible?(t.helpScreen.hide(t),n.visible=!0,o.visible=!1):(t.helpScreen||(t.helpScreen=new Ws),t.helpScreen.create(t),t.helpScreen.show(t),n.visible=!1,o.visible=!0,t.audioManager.UtilityButtonSFX.play()),t.gameData.isHelpScreenVisible=!t.gameData.isHelpScreenVisible};s.on("pointerdown",u),n.on("pointerdown",u),o.on("pointerdown",u),r.emitter.on(r.HELP_SCREEN_TOGGLE,(()=>{u()}))}createBalance(e){var i;const s=1.5*t.PANEL_WIDTH,n=this.isMobile?.05*this.width:.24*this.width,a=this.isMobile?.715*this.height:.83*this.height,o=e.add.container(n,a),l=e.textures.createCanvas("balanceGradient",this.isMobile?s/1.5:s,t.PANEL_HEIGHT);if(l){const e=l.getContext(),i=e.createLinearGradient(0,0,0,t.PANEL_HEIGHT);i.addColorStop(0,"rgba(0, 0, 0, 0.24)"),i.addColorStop(1,"rgba(0, 0, 0, 0.24)"),e.fillStyle=i,e.fillRect(0,0,this.isMobile?s/1.5:s,t.PANEL_HEIGHT),l.refresh()}this.balance=e.add.graphics(),this.balance.fillStyle(0,.5),this.balance.fillRoundedRect(0,0,this.isMobile?s/1.5:s,t.PANEL_HEIGHT,10),this.balance.lineStyle(1,6739017),this.balance.strokeRoundedRect(0,0,this.isMobile?s/1.5:s,t.PANEL_HEIGHT,10),o.add(this.balance);const h=e.add.text(this.isMobile?.5*s/1.5:.5*s,.3*t.PANEL_HEIGHT,"BALANCE",{fontSize:"25px",color:"#3FFF0D",align:"center",fontStyle:"bold",fontFamily:"Poppins"});h.setScale(this.isMobile?1.1:1),o.add(h),h.setOrigin(.5,.5);const c=e.gameData.balance.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),d=e.add.text(this.isMobile?.5*s/1.5:.5*s,.65*t.PANEL_HEIGHT,`$ ${c}`,{fontSize:"35px",color:"#FFFFFF",align:"center",fontStyle:"bold",fontFamily:"Poppins"});d.setScale(this.isMobile?.9:1),o.add(d),d.setOrigin(.5,.5);const u=e.add.text(this.isMobile?.5*s/1.5:.5*s,.9*t.PANEL_HEIGHT,"demo credits only",{fontSize:"16px",color:"#FFFFFF",align:"center",fontFamily:"Poppins"});u.setOrigin(.5,.5),u.setAlpha(.8);const m="undefined"!=typeof window&&!!(null==(i=null==window?void 0:window.APP_CONFIG)?void 0:i.demo);u.setVisible(m),o.add(u),r.emitter.on(r.SPIN_ANIMATION_START,(()=>{})),r.emitter.on(r.WIN,(()=>{r.emitter.emit(r.UPDATE_BALANCE),r.emitter.emit(r.GET_BALANCE)})),r.emitter.on(r.FINAL_WIN_SHOW,(()=>{r.emitter.emit(r.GET_BALANCE)})),r.emitter.on(r.UPDATE_BALANCE,(t=>{let i=e.gameData.balance;t&&(i+=t),d.setText(e.gameData.currency+" "+i.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),e.gameData.balance=i})),r.emitter.on(r.UPDATE_FAKE_BALANCE,((t,i)=>{e.gameData.balance-=t,e.gameData.balance+=i,d.setText(e.gameData.currency+" "+e.gameData.balance.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}))})),r.emitter.on(r.GET_BALANCE,(()=>{try{e.gameAPI.getBalance().then((t=>{const i=t.data.balance;d.setText(e.gameData.currency+" "+i.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),e.gameData.balance=i,console.log("balance",i)}))}catch(t){e.gameData.debugLog("error updating balance "+t),d.setText(e.gameData.currency+" "+e.gameData.balance.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}))}})),o.setScale(this.isMobile?.5:1),this.balanceContainer=o,this.buttonContainer.add(o),r.emitter.emit(r.GET_BALANCE),r.emitter.emit(r.UPDATE_BALANCE)}createBombWin(e){var i;const s=1.5*t.PANEL_WIDTH,n=this.isMobile?this.balanceContainer.x+.525*s:this.balanceContainer.x+s+.01*this.width,a=(this.isMobile,this.balanceContainer.y),o=e.add.container(n,a);o.name="bombWinContainer",o.setDepth(7);const l=e.textures.createCanvas("totalWinGradient2",s,t.PANEL_HEIGHT);if(l){const e=l.getContext(),i=e.createLinearGradient(0,0,0,t.PANEL_HEIGHT);i.addColorStop(0,"rgba(0, 0, 0, 0.24)"),i.addColorStop(1,"rgba(0, 0, 0, 0.24)"),e.fillStyle=i,e.fillRect(0,0,s,t.PANEL_HEIGHT),l.refresh()}this.bombWin=e.add.graphics(),this.bombWin.fillStyle(0,.5),this.bombWin.fillRoundedRect(0,0,s,t.PANEL_HEIGHT,10),this.bombWin.lineStyle(1,6739017),this.bombWin.strokeRoundedRect(0,0,s,t.PANEL_HEIGHT,10),o.add(this.bombWin);const h=e.add.text(.5*s,.3*t.PANEL_HEIGHT,"WIN",{fontSize:"25px",color:"#3FFF0D",align:"center",fontStyle:"bold",fontFamily:"Poppins"});o.add(h),h.setOrigin(.5,.5);const c=Math.max(0,Math.min(e.gameData.apiFreeSpinsIndex||0,((null==(i=e.gameData.totalWinFreeSpin)?void 0:i.length)||1)-1));let d=(e.gameData.totalWinFreeSpin||[]).slice(0,c+1).reduce(((t,e)=>t+(Number(e)||0)),0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});const u=e.add.text(.5*s,.65*t.PANEL_HEIGHT,`${e.gameData.currency} ${d}`,{fontSize:"35px",color:"#FFFFFF",align:"center",fontStyle:"bold",fontFamily:"Poppins"});u.setOrigin(.5,.5),o.add(u),this.bombWinContainer=o,this.bombWinContainer.setVisible(!this.isMobile),r.emitter.on(r.SHOW_BOMB_WIN,(()=>{this.bombWinContainer.setVisible(!this.isMobile);let t=e.gameData.totalBombWin,i=e.gameData.totalWinFreeSpinPerTumble[e.gameData.apiFreeSpinsIndex].toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2});const s=(e.gameData.totalWinFreeSpinPerTumble[e.gameData.apiFreeSpinsIndex]*e.gameData.totalBombWin).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2});t>1&&u.setText(`${e.gameData.currency} ${i} x ${t} = ${s}`)})),r.emitter.on(r.HIDE_BOMB_WIN,(()=>{var t;this.bombWinContainer.setVisible(!1);try{const i=(null==(t=e.gameData.totalWinFreeSpin)?void 0:t.length)||0;if(e.gameData.useApiFreeSpins&&i>0&&e.gameData.apiFreeSpinsIndex>=i){const t=(e.gameData.totalWinFreeSpin||[]).reduce(((t,e)=>t+(Number(e)||0)),0);h.setText("TOTAL WIN"),u.setText(`${e.gameData.currency} ${t.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2})}`)}}catch(i){}}))}createTotalWin(e){const i=1.5*t.PANEL_WIDTH,s=this.isMobile?this.balanceContainer.x+.525*i:this.balanceContainer.x+i+.01*this.width,n=(this.isMobile,this.balanceContainer.y),a=e.add.container(s,n);a.setDepth(6);const o=e.textures.createCanvas("totalWinGradient",i,t.PANEL_HEIGHT);if(o){const e=o.getContext(),s=e.createLinearGradient(0,0,0,t.PANEL_HEIGHT);s.addColorStop(0,"rgba(0, 0, 0, 0.24)"),s.addColorStop(1,"rgba(0, 0, 0, 0.24)"),e.fillStyle=s,e.fillRect(0,0,i,t.PANEL_HEIGHT),o.refresh()}this.totalWin=e.add.graphics(),this.totalWin.fillStyle(0,.5),this.totalWin.fillRoundedRect(0,0,i,t.PANEL_HEIGHT,10),this.totalWin.lineStyle(1,6739017),this.totalWin.strokeRoundedRect(0,0,i,t.PANEL_HEIGHT,10),a.add(this.totalWin);const l=e.add.text(.5*i,.3*t.PANEL_HEIGHT,"TOTAL WIN",{fontSize:"25px",color:"#3FFF0D",align:"center",fontStyle:"bold",fontFamily:"Poppins"});a.add(l),l.setOrigin(.5,.5);const h=e.add.text(.5*i,.65*t.PANEL_HEIGHT,`${e.gameData.currency} 0`,{fontSize:"35px",color:"#FFFFFF",align:"center",fontStyle:"bold",fontFamily:"Poppins"});a.add(h),h.setOrigin(.5,.5);let c=0,d=[],u=!1,m=null;const g=t=>t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});r.emitter.on(r.UPDATE_TOTAL_WIN,((t,i)=>{if("number"!=typeof t||isNaN(t)){const t=(e.gameData.totalWin||0)-c;t>0&&d.push(t)}else d.push(t);(t=>{if(u)return;u=!0,m&&(m.remove(!1),m=null);const i=()=>{var s;if(0===d.length){if(u=!1,t){const t=Math.max(0,Math.min(e.gameData.apiFreeSpinsIndex||0,((null==(s=e.gameData.totalWinFreeSpin)?void 0:s.length)||1)-1)),i=e.gameData.totalWinFreeSpin||[];c=i.slice(0,t+1).reduce(((t,e)=>t+(e||0)),0),l.setText("TOTAL WIN");const n=c>=e.gameData.totalWin?e.gameData.totalWin:c;return void h.setText(`${e.gameData.currency} ${g(n)}`)}if(e.gameData.isBonusRound)return l.setText("WIN"),void h.setText(`${e.gameData.currency} ${g(c)}`);const i=e.gameData.totalWin||0,n=i>0&&c>=i?i:c;return void(m=e.time.delayedCall(250,(()=>{e.gameData.isBonusRound?l.setText("TOTAL WIN"):l.setText("WIN"),h.setText(`${e.gameData.currency} ${g(n)}`),m=null})))}const n=d.shift();c+=n||0,l.setText(e.gameData.isBonusRound?"WIN":"TOTAL WIN"),e.gameData.isBonusRound||l.setText("WIN"),h.setText(`${e.gameData.currency} ${g(c)}`),e.time.delayedCall(1e3,i)};i()})(i)})),r.emitter.on(r.SPIN_ANIMATION_START,(()=>{this.isMobile||(c=0,d=[],u=!1,m&&(e.time.removeEvent(m),m=null),h.setText(`${e.gameData.currency} `+(0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})))})),r.emitter.on(r.TUMBLE_SEQUENCE_DONE,(()=>{this.isMobile||(c=0,d=[],u=!1)})),r.emitter.on(r.UPDATE_CURRENCY,(()=>{this.isMobile})),a.setScale(this.isMobile?.5:1),this.totalWinContainer=a,this.totalWinContainer.setVisible(!this.isMobile),r.emitter.on(r.SHOW_BOMB_WIN,(()=>{this.totalWinContainer.setVisible((this.isMobile,!1))})),r.emitter.on(r.HIDE_BOMB_WIN,(()=>{var t;this.totalWinContainer.setVisible(!this.isMobile);try{const i=(null==(t=e.gameData.totalWinFreeSpin)?void 0:t.length)||0;if(e.gameData.useApiFreeSpins&&i>0&&e.gameData.apiFreeSpinsIndex>=i){const t=(e.gameData.totalWinFreeSpin||[]).reduce(((t,e)=>t+(Number(e)||0)),0);l.setText("TOTAL WIN"),h.setText(`${e.gameData.currency} ${g(t)}`)}}catch(i){}})),r.emitter.on(r.FINAL_WIN_SHOW,(()=>{l.setText("TOTAL WIN"),h.setText(`${e.gameData.currency} ${g(e.gameData.totalWin)}`),r.emitter.emit(r.GET_BALANCE),this.totalWinContainer.setVisible(!this.isMobile)})),r.emitter.on(r.FREE_SPIN_TOTAL_WIN,(()=>{var t;const i=Math.max(0,Math.min(e.gameData.currentFreeSpinIndex||0,((null==(t=e.gameData.totalWinFreeSpin)?void 0:t.length)||1)-1)),s=(e.gameData.totalWinFreeSpin||[]).slice(0,i+1).reduce(((t,e)=>t+(Number(e)||0)),0);l.setText("TOTAL WIN"),h.setText(`${e.gameData.currency} ${s.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`)})),this.buttonContainer.add(a)}amplifyBetAnimation(){this.amplifyBet.setAlpha(1),this.amplifyBet.animationState.setAnimation(0,"animation",!1),this.amplifyBet.animationState.addListener({complete:()=>{this.amplifyBet.setAlpha(0)}})}createBet(e){var i,s;const n=(this.isMobile,t.PANEL_WIDTH),o=this.isMobile?1.3*this.totalWinContainer.x:this.totalWinContainer.x+1.5*n+.01*this.width,l=this.isMobile?this.totalWinContainer.y:.83*this.height,h=e.add.container(o,l);h.setDepth(6);const c=[.2,.4,.6,.8,1,1.2,1.6,2,2.4,2.8,3.2,3.6,4,5,6,8,10,14,18,24,32,40,60,80,100,110,120,130,140,150];let d=localStorage.getItem("bet")?c.indexOf(parseFloat(localStorage.getItem("bet")||"1")):5;const u=1e-6,m=t=>c.findIndex((e=>Math.abs(e-t)<u));this.totalBet=e.add.graphics(),this.totalBet.fillStyle(0,.5),this.totalBet.fillRoundedRect(0,0,n,t.PANEL_HEIGHT,10),this.totalBet.lineStyle(1,6739017),this.totalBet.strokeRoundedRect(0,0,n,t.PANEL_HEIGHT,10),h.add(this.totalBet);const g=e.add.text(.5*n,.3*t.PANEL_HEIGHT,"BET",{fontSize:"25px",color:"#3FFF0D",align:"center",fontStyle:"bold",fontFamily:"Poppins"});g.setScale(this.isMobile?1.1:1),h.add(g),g.setOrigin(.5,.5);const p=e.add.text(.5*n,.65*t.PANEL_HEIGHT,e.gameData.currency+" "+e.gameData.bet.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2}),{fontSize:"32px",color:"#FFFFFF",align:"center",fontStyle:"bold",fontFamily:"Poppins"});p.setScale(this.isMobile?1.1:1),h.add(p),p.setOrigin(.5,.5);try{const i=e.add.spine(.5*n,.5*t.PANEL_HEIGHT,"Amplify_Bet","Amplify_Bet");i.setScale(this.isMobile?1.75:2.5),h.addAt(i,0),i.setAlpha(0),this.amplifyBet=i,h.sendToBack(i)}catch(X){}const b=e.add.image(0,0,"plus");b.setPosition(this.isMobile?p.x+80:n-50,this.isMobile?p.y-5:.65*t.PANEL_HEIGHT),b.setInteractive().isButton=!0,h.add(b);const f=e.add.image(0,0,"minus");f.setPosition(this.isMobile?p.x-80:50,this.isMobile?b.y:.65*t.PANEL_HEIGHT),f.setInteractive().isButton=!0,h.add(f);const y=()=>{var t,i,s,n;const a=e.gameData.bet<=c[0]+u,o=e.gameData.bet>=c[c.length-1]-u;a?(f.setAlpha(.25),null==(t=f.disableInteractive)||t.call(f)):(f.setAlpha(1),null==(i=f.setInteractive)||i.call(f)),o?(b.setAlpha(.25),null==(s=b.disableInteractive)||s.call(b)):(b.setAlpha(1),null==(n=b.setInteractive)||n.call(b))},w=e.add.zone(.5*n,.5*t.PANEL_HEIGHT,.5*n,.6*t.PANEL_HEIGHT);w.setInteractive().isButton=!0,w.on("pointerdown",(()=>{e.gameData.isSpinning||e.gameData.isBonusRound||(e.audioManager.UtilityButtonSFX.play(),d=c.indexOf(e.gameData.bet),-1===d&&(d=0),this.showBetPopup(e,d))})),h.addAt(w,0),y(),h.setScale(this.isMobile?.5:1),b.on("pointerdown",(()=>{if(e.gameData.isSpinning)return;if(e.gameData.isBonusRound)return;const t=m(e.gameData.bet);if(t>=0&&t<c.length-1){e.audioManager.UtilityButtonSFX.play();const i=t+1;e.gameData.bet=c[i],d=i,y(),r.emitter.emit(r.CHANGE_BET,{}),r.emitter.emit(r.ENHANCE_BET_TOGGLE,{})}})),f.on("pointerdown",(()=>{if(e.gameData.isSpinning)return;if(e.gameData.isBonusRound)return;const t=m(e.gameData.bet);if(t>0){e.audioManager.UtilityButtonSFX.play();const i=t-1;e.gameData.bet=c[i],d=i,y(),r.emitter.emit(r.CHANGE_BET,{}),r.emitter.emit(r.ENHANCE_BET_TOGGLE,{})}})),r.emitter.on(r.CHANGE_BET,(()=>{const t=e.gameData.bet.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2});p.setText(t),localStorage.setItem("bet",e.gameData.bet.toString()),y()})),r.emitter.on(r.ENHANCE_BET_TOGGLE,(t=>{e.gameData.doubleChanceEnabled?p.setText(e.gameData.currency+(1.25*e.gameData.bet).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2})):p.setText(e.gameData.currency+e.gameData.bet.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2}))})),e.gameData.bet=localStorage.getItem("bet")?parseFloat(localStorage.getItem("bet")||"1"):1,localStorage.setItem("bet",e.gameData.bet.toString());try{y()}catch(X){}h.name="betContainer";const S=e.add.container(0,0);S.setScale((this.isMobile,1)),S.setDepth(30);const x=32,F=e.add.graphics();F.fillStyle(0,.8),F.fillRoundedRect(0,0,451,912,16),F.lineStyle(0,6739017),F.strokeRoundedRect(0,0,451,912,16),S.add(F);const v=e.add.text(x,x,"BET",{fontSize:"32px",color:"#3FFF0D",fontFamily:"Poppins",fontStyle:"bold",align:"left"});S.add(v);const T=e.add.text(434,x,"Ã—",{fontSize:"32px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold"});T.setOrigin(1,0),T.setInteractive().isButton=!0,S.add(T),T.on("pointerdown",(()=>{e.audioManager.UtilityButtonSFX.play(),c[d]=e.gameData.bet,this.hideBetPopup(e)}));const A=e.add.text(x,128,"Select Bet Amount",{fontSize:"24px",color:"#FFFFFF",fontFamily:"Poppins"});S.add(A);const M=67.6,C=60;let B=null;const P=c.map(((t,i)=>{const s=Math.floor(i/5),n=x+i%5*83.6,o=176+76*s,r=e.add.container(n,o),l=e.add.graphics();l.fillStyle(0===i?6739017:1579032,1),l.fillRoundedRect(0,0,M,C,8),r.add(l);const h=e.add.text(33.8,30,t.toString(),{fontSize:"24px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold"});h.setOrigin(.5),r.add(h);const c=new a.Geom.Rectangle(0,0,M,C);return r.setInteractive(c,a.Geom.Rectangle.Contains),r.isButton=!0,r.on("pointerdown",(()=>{if(e.audioManager.UtilityButtonSFX.play(),B){const t=B.list[0];t.clear(),t.fillStyle(1579032,1),t.fillRoundedRect(0,0,M,C,8)}l.clear(),l.fillStyle(6739017,1),l.fillRoundedRect(0,0,M,C,8),B=r,d=i;try{null==k||k()}catch(X){}})),S.add(r),r})),I=P[P.length-1].y+C,E=e.add.text(x,I+24,"BET",{fontSize:"24px",color:"#FFFFFF",fontFamily:"Poppins"});S.add(E);const D=E.y+E.height+8,R=e.add.graphics();R.fillStyle(3355443,.95),R.lineStyle(1,6739017,1),R.fillRoundedRect(x,D,402,60,10),R.strokeRoundedRect(x,D,402,60,10),S.add(R);const _=D+30,W=e.add.image(62,_,"minus");null==(i=W.setInteractive)||i.call(W),W.isButton=!0,S.add(W);const L=e.add.text(233,_,e.gameData.currency+" "+c[d].toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),{fontSize:"28px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold",align:"center"});L.setOrigin(.5,.5),S.add(L);const O=e.add.image(404,_,"plus");null==(s=O.setInteractive)||s.call(O),O.isButton=!0,S.add(O);const k=()=>{var t,i,s,n,a,o,r,l;if(L.setText(e.gameData.currency+" "+c[d].toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),B){const t=B.list[0];t.clear(),t.fillStyle(1579032,1),t.fillRoundedRect(0,0,M,C,8)}if(B=P[d],B){const t=B.list[0];t.clear(),t.fillStyle(6739017,1),t.fillRoundedRect(0,0,M,C,8)}const h=d<=0,u=d>=c.length-1;h?(null==(t=W.setAlpha)||t.call(W,.3),null==(i=W.disableInteractive)||i.call(W)):(null==(s=W.setAlpha)||s.call(W,.8),null==(n=W.setInteractive)||n.call(W)),u?(null==(a=O.setAlpha)||a.call(O,.3),null==(o=O.disableInteractive)||o.call(O)):(null==(r=O.setAlpha)||r.call(O,.8),null==(l=O.setInteractive)||l.call(O))};k(),r.emitter.on(r.CHANGE_BET,(()=>{d=c.indexOf(e.gameData.bet),-1===d&&(d=0);try{k()}catch(X){}})),W.on("pointerdown",(()=>{d>0&&(e.audioManager.UtilityButtonSFX.play(),d-=1,k())})),O.on("pointerdown",(()=>{d<c.length-1&&(e.audioManager.UtilityButtonSFX.play(),d+=1,k())}));const N=e.add.image(233,784,"greenLongBtn");N.displayWidth=402,N.displayHeight=62,S.add(N);const V=e.add.text(233,784,"CONFIRM",{fontSize:"28px",color:"#000000",fontStyle:"bold",fontFamily:"Poppins"});V.setOrigin(.5,.5),S.add(V),N.setInteractive().isButton=!0,N.on("pointerdown",(()=>{e.gameData.isSpinning?(e.gameData.bet=e.gameData.apiBet,r.emitter.emit(r.CHANGE_BET,{}),r.emitter.emit(r.ENHANCE_BET_TOGGLE,{})):(e.gameData.bet=c[d],r.emitter.emit(r.CHANGE_BET,{}),r.emitter.emit(r.ENHANCE_BET_TOGGLE,{})),e.audioManager.UtilityButtonSFX.play(),e.tweens.add({targets:S,alpha:0,duration:200,ease:"Cubic.easeIn",onComplete:()=>{S.setVisible(!1),S.list.forEach((t=>{t instanceof a.GameObjects.Graphics&&"betMask"===t.name&&t.destroy()})),r.emitter.emit(r.ENHANCE_BET_TOGGLE,{})}})}));const Y=c.indexOf(e.gameData.bet);if(B=P[-1!==Y?Y:0],P.forEach(((t,e)=>{const i=t.list[0];i.clear(),i.fillStyle(1579032,1),i.fillRoundedRect(0,0,M,C,8)})),B){const t=B.list[0];t.clear(),t.fillStyle(6739017,1),t.fillRoundedRect(0,0,M,C,8)}r.emitter.on(r.CHANGE_BET,(()=>{this.betContainer&&this.betContainer.visible&&(()=>{const t=c.indexOf(e.gameData.bet);if(-1===t)return;d=t,P.forEach((t=>{const e=t.list[0];e.clear(),e.fillStyle(1579032,1),e.fillRoundedRect(0,0,M,C,8)}));const i=P[d];if(i){const t=i.list[0];t.clear(),t.fillStyle(6739017,1),t.fillRoundedRect(0,0,M,C,8)}})()})),S.setPosition(this.isMobile?0:.5*e.scale.width-240,this.isMobile?e.scale.height-912:.5*e.scale.height-420),S.setScale(.95,1),S.setVisible(!1),this.betContainer=S,this.betContainer_Y=this.betContainer.y}showBetPopup(t,e){if(this.betContainer){!1===this.betContainer.visible&&(this.betContainer.setVisible(!0),this.betContainer.alpha=0,t.tweens.add({targets:this.betContainer,alpha:{from:0,to:1},y:{from:this.betContainer_Y+1e3,to:this.betContainer_Y},duration:1e3,ease:"Expo.easeOut"}));const i=void 0!==e?e:[.2,.4,.6,.8,1,1.2,1.6,2,2.4,2.8,3.2,3.6,4,5,6,8,10,14,18,24,32,40,60,80,100,110,120,130,140,150].indexOf(t.gameData.bet);if(-1!==i&&this.betContainer.list.length>0){const t=this.betContainer.list.filter((t=>t instanceof a.GameObjects.Container&&t!==this.betContainer&&t.list&&t.list.length>0&&t.list[0]instanceof a.GameObjects.Graphics));if(i<t.length){const e=t[i];e&&e.emit&&e.emit("pointerdown")}}r.emitter.emit(r.ENHANCE_BET_TOGGLE,{})}}hideBetPopup(t){this.betContainer&&t.tweens.add({targets:this.betContainer,alpha:0,y:{from:this.betContainer_Y,to:this.betContainer_Y+t.scale.height},duration:1e3,ease:"Expo.easeInOut",onComplete:()=>{this.betContainer.setVisible(!1),this.betContainer.list.forEach((t=>{t instanceof a.GameObjects.Graphics&&"betMask"===t.name&&t.destroy()}))}})}createBuyFeature(t){const e=this.isMobile?.505*this.width:.15*this.width,i=this.isMobile?.75*this.height:.13*this.height,s=t.add.container(e,i);this.isMobile?(this.buyFeatureButton=t.add.image(0,0,"buyFeature"),this.buyFeatureButton.setInteractive(new a.Geom.Rectangle(this.buyFeatureButton.width/4,this.buyFeatureButton.height/4,.6*this.buyFeatureButton.width,this.buyFeatureButton.height/2),a.Geom.Rectangle.Contains),this.buyFeatureButton.isButton=!0,s.add(this.buyFeatureButton)):(this.buyFeatureButton=t.add.graphics(),this.buyFeatureButton.fillStyle(1579032,.95),this.buyFeatureButton.lineStyle(2,6739017,1),this.buyFeatureButton.setInteractive(new a.Geom.Rectangle(-138.5,-57,277,114),a.Geom.Rectangle.Contains),this.buyFeatureButton.strokeRoundedRect(-138.5,-57,277,114,57),this.buyFeatureButton.fillRoundedRect(-138.5,-57,277,114,57),this.buyFeatureButton.isButton=!0,s.add(this.buyFeatureButton)),this.isMobile||(this.buyFeatureStarLeft=t.add.image(-106.5,-24,"star"),s.add(this.buyFeatureStarLeft),this.buyFeatureStarRight=t.add.image(106.5,-24,"star"),s.add(this.buyFeatureStarRight)),this.buyFeatureButtonText=t.add.text(0,-24,"BUY FEATURE",{}),this.buyFeatureButtonText.setOrigin(.5,.5),this.isMobile?(this.buyFeatureButtonText.setScale(.5),this.buyFeatureButtonText.setPosition(0,-12),this.buyFeatureButtonText.setStyle({fontSize:"24px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold",align:"center"})):this.buyFeatureButtonText.setStyle({fontSize:"24px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold",align:"center",letterSpacing:1.5,stroke:"#181818",strokeThickness:2,shadow:{offsetX:0,offsetY:2,color:"#000000",blur:4,fill:!0}}),s.add(this.buyFeatureButtonText);const n=t.gameData.getBuyFeaturePrice(),o=t.gameData.currency+" "+n.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2});this.buyFeaturePriceText=t.add.text(0,24,o,{fontSize:"42px",color:"#3FFF0D",fontFamily:"Poppins",align:"center",fontStyle:"bold"}),this.buyFeaturePriceText.setOrigin(.5,.5),this.isMobile&&(this.buyFeaturePriceText.setScale(.4),this.buyFeaturePriceText.setPosition(0,8),this.buyFeaturePriceText.setColor("#FFFFFF")),s.add(this.buyFeaturePriceText),s.name="buyFeatureContainer",this.buttonContainer.add(s),this.buttonContainer.sendToBack(s);const l=()=>{t.gameData.isSpinning||t.autoplay.isAutoPlaying||t.gameData.isBonusRound?this.buyFeaturePriceText.setAlpha(.5):this.buyFeaturePriceText.setAlpha(1)};this.buyFeatureButton.on("pointerdown",(()=>{t.audioManager.UtilityButtonSFX.play(),r.emitter.emit(r.REMOVE_ENHANCE_BET,{}),this.autoplayPopup&&this.autoplayPopup.visible&&this.autoplayPopup.setVisible(!1),t.buyFeaturePopup&&t.buyFeaturePopup.show(t)})),r.emitter.on(r.SPIN_ANIMATION_START,l),r.emitter.on(r.SPIN_ANIMATION_END,l),r.emitter.on(r.MATCHES_DONE,l),r.emitter.on(r.CHANGE_BET,(()=>{this.updateBuyFeaturePrice(t,t.gameData.getBuyFeaturePrice())}))}updateBuyFeaturePrice(t,e){this.buyFeaturePriceText&&this.buyFeaturePriceText.setText(t.gameData.currency+" "+e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2}))}createDoubleFeature(t){const e=this.isMobile?.73*this.width:.8*this.width,i=this.isMobile?this.mobile_buttons_y:.82*this.height,s=this.isMobile?240:254,n=this.isMobile?108:131,a=t.add.container(e,i);if(this.isMobile){const e=t.add.image(0,0,"amplifyBet");e.setOrigin(.5,.5),e.setScale(.7),e.setInteractive().isButton=!0,e.on("pointerdown",(()=>{this.amplifyBetAnimation(),t.gameData.doubleChanceEnabled=!t.gameData.doubleChanceEnabled,r.emitter.emit(r.ENHANCE_BET_TOGGLE,{}),t.audioManager.UtilityButtonSFX.play()})),a.add(e)}else{const e=t.add.image(s/2,n/2,"greenRectBtn");e.displayWidth=s,e.displayHeight=n,e.setOrigin(.5,.5),a.add(e)}const o=t.add.graphics();o.fillStyle(1579032,1),o.fillRoundedRect(15,20,90,90,16),o.setVisible(!this.isMobile),a.add(o);const l=t.add.text(60,45,"BET",{fontSize:"24px",color:"#DDDDDD",fontFamily:"Poppins",fontStyle:"bold",align:"center"});l.setOrigin(.5,.5),l.setVisible(!this.isMobile),a.add(l),this.doubleFeaturePriceText=t.add.text(this.isMobile?.7*s:60,this.isMobile?.725*n:90,t.gameData.getDoubleFeaturePrice().toString(),{fontSize:"36px",fontFamily:"Poppins",fontStyle:"bold",align:"center"}),this.doubleFeaturePriceText.setOrigin(.5,.75),this.doubleFeaturePriceText.setColor(this.isMobile?"#FFFFFF":"#3FFF0D"),this.isMobile||this.doubleFeaturePriceText.setWordWrapWidth(80),a.add(this.doubleFeaturePriceText);const h=()=>{this.doubleFeaturePriceText.setStyle({fontSize:this.isMobile?"0px":"28px"})};h(),r.emitter.on(r.CHANGE_BET,(()=>{this.doubleFeaturePriceText&&(this.doubleFeaturePriceText.setText(t.gameData.getDoubleFeaturePrice().toString()),h())}));const c=t.add.text(this.isMobile?.15*s:s-140,this.isMobile?.15*n:10,"ENHANCED BET",{fontSize:"12px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold"});c.setFontSize(this.isMobile?"22px":"14px"),c.setVisible(!this.isMobile),a.add(c);const d=64,u=36,m=18,g=this.isMobile?48:s-120,p=49.5,b=t.add.graphics();b.fillStyle(1579032,1),b.lineStyle(3,16777215,.5),b.strokeRoundedRect(g,p,d,u,m),b.fillRoundedRect(g,p,d,u,m),b.setVisible(!this.isMobile),a.add(b);const f=t.add.graphics();let y=!!t.gameData.doubleChanceEnabled;const w=()=>{f.clear(),y?(b.clear(),b.fillStyle(3642711,1),b.lineStyle(5,16777215,1),b.strokeRoundedRect(g,p,d,u,m),b.fillRoundedRect(g,p,d,u,m),f.fillStyle(4194061,1),f.fillCircle(g+m,67.5,14),o.clear(),o.fillStyle(0,.8),o.fillRoundedRect(15,20,90,90,16),l.setColor("#FFFFFF"),this.doubleFeaturePriceText.setColor(this.isMobile?"#FFFFFF":"#3FFF0D"),t.gameData.doubleChanceEnabled=!0,r.emitter.emit(r.ENHANCE_BET_TOGGLE,{})):(b.clear(),b.fillStyle(14540253,0),b.lineStyle(3,16777215,1),b.strokeRoundedRect(g,p,d,u,m),b.fillRoundedRect(g,p,d,u,m),f.fillStyle(16777215,1),f.fillCircle(g+d-m,67.5,14),o.clear(),o.fillStyle(1579032,.5),o.fillRoundedRect(15,20,90,90,16),l.setColor(this.isMobile?"#FFFFFF":"#888888"),this.doubleFeaturePriceText.setColor(this.isMobile?"#FFFFFF":"#888888"),t.gameData.doubleChanceEnabled=!1,r.emitter.emit(r.ENHANCE_BET_TOGGLE,{}))};w(),r.emitter.on(r.REMOVE_ENHANCE_BET,(()=>{t.gameData.doubleChanceEnabled=!1,y=!1,w()})),f.setVisible(!this.isMobile),a.add(f);const S=t.add.zone(g,p,d,u).setOrigin(0,0);S.setInteractive().isButton=!0,S.on("pointerdown",(()=>{t.gameData.isSpinning||(this.amplifyBetAnimation(),t.audioManager.UtilityButtonSFX.play(),y=!y,t.gameData.doubleChanceEnabled=y,w())})),a.add(S);const x=t.add.text(s-140,105,"Higher odds for\nFree Spins",{fontSize:"14px",color:"#FFFFFF",fontFamily:"Poppins",align:"center"});if(x.setOrigin(0,.5),x.setVisible(!this.isMobile),a.add(x),a.setDepth(5),a.name="doubleFeatureContainer",a.setScale((this.isMobile,1)),this.isMobile){const e=t.add.text(0,30,"Amplify Bet",{fontSize:"12px",color:"#FFFFFF",fontFamily:"Poppins",align:"center"});e.setOrigin(.5,0),a.add(e)}if(this.isMobile){const e=120,i=48,s=1,n=65280,o=0,r=t.add.container(0,-44),l=t.add.graphics();l.fillStyle(o,1),l.fillRect(-60,-24,e,i),l.lineStyle(s,n,1),l.strokeRect(-60,-24,e,i),l.lineStyle(s,n,1),l.strokeRect(-60+s,-24+s,e-2*s,i-2*s),l.setScale(.9,.8),r.add(l);const h=t.add.text(0,0,"Double Chance For Feature",{fontSize:"12px",color:"#FFFFFF",fontFamily:"Poppins",align:"center",wordWrap:{width:e-20}});h.setOrigin(.5,.5),r.add(h),a.add(r)}this.buttonContainer.add(a),this.baseYPositions[a.name]=a.y,r.emitter.on(r.CREATE_DOUBLE_FEATURE,(e=>{var i;if(!a)return;const s=null!=(i=this.baseYPositions.doubleFeatureContainer)?i:a.y,n=e?t.scale.height+200:s;try{t.tweens.add({targets:a,y:n,duration:200,ease:"Cubic.easeInOut"})}catch(o){a.y=n}}))}createLogo(t){const e=this.isMobile?.22*this.width:.88*this.width,i=this.isMobile?.1*this.height:.12*this.height,s=t.add.container(e,i),n=t.add.image(0,0,"logo");n.setScale(.25),s.add(n),s.name="logoContainer",s.setScale(this.isMobile?.5:1),this.buttonContainer.add(s)}createMarqueeBonus(t){if(!this.isMobile)return;const e=.5*this.width,i=.175*this.height,s=t.add.container(e,i);s.setDepth(20);const n=t.add.image(0,0,"marquee");s.add(n);const a=t.gameData.totalWin.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2}),o=t.add.text(0,0,"WIN",{fontSize:"14px",color:"#FFFFFF",fontFamily:"Poppins",align:"center"});o.setOrigin(.5,1);const l=t.add.text(0,0,t.gameData.currency+" "+a,{fontSize:"20px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold",align:"center"});l.setOrigin(.5,0);const h=t.add.container(0,0,[o,l]);s.add(h),this.bombMarqueeContainer=s,this.bombMarqueeContainer.setVisible(!1),r.emitter.on(r.SHOW_BOMB_WIN,(()=>{this.bombMarqueeContainer.setVisible(!0);let e=t.gameData.totalBombWin,i=t.gameData.totalWinFreeSpinPerTumble[t.gameData.apiFreeSpinsIndex].toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2});const s=(t.gameData.totalWinFreeSpinPerTumble[t.gameData.apiFreeSpinsIndex]*t.gameData.totalBombWin).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2});e>1&&l.setText(`${t.gameData.currency} ${i} x ${e} = ${s}`)})),r.emitter.on(r.HIDE_BOMB_WIN,(()=>{var e;this.bombMarqueeContainer.setVisible(!1);try{const i=(null==(e=t.gameData.totalWinFreeSpin)?void 0:e.length)||0;if(this.isMobile&&t.gameData.useApiFreeSpins&&i>0&&t.gameData.apiFreeSpinsIndex>=i){const e=(t.gameData.totalWinFreeSpin||[]).reduce(((t,e)=>t+(Number(e)||0)));o.setText("TOTAL WIN"),l.setText(`${t.gameData.currency} ${e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`)}}catch(i){}}))}createMarquee(t){if(!this.isMobile)return;const e=.5*this.width,i=.175*this.height,s=t.add.container(e,i);s.setDepth(20);const n=t.add.image(0,0,"marquee");s.add(n);const a=t.gameData.totalWin.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2}),o=t.add.text(0,0,"TOTAL WIN",{fontSize:"14px",color:"#FFFFFF",fontFamily:"Poppins",align:"center"});o.setOrigin(.5,1);const l=t.add.text(0,0,t.gameData.currency+" "+a,{fontSize:"20px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold",align:"center"});l.setOrigin(.5,0);const h=t.add.container(0,0,[o,l]);s.add(h);let c=0,d=[],u=!1,m=null;h.setVisible(!1),r.emitter.on(r.UPDATE_TOTAL_WIN,((e,i)=>{if(h.setVisible(!0),"number"!=typeof e||isNaN(e)){const e=(t.gameData.totalWin||0)-c;e>0&&d.push(e)}else d.push(e);(e=>{if(u)return;u=!0,m&&(m.remove(!1),m=null);const i=()=>{var s;if(0===d.length){if(u=!1,e){const e=Math.max(0,Math.min(t.gameData.apiFreeSpinsIndex||0,((null==(s=t.gameData.totalWinFreeSpin)?void 0:s.length)||1)-1)),i=t.gameData.totalWinFreeSpin||[];c=i.slice(0,e+1).reduce(((t,e)=>t+(e||0)),0),o.setText("TOTAL WIN");const n=c>=t.gameData.totalWin?t.gameData.totalWin:c;return void l.setText(`${t.gameData.currency} ${n.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`)}if(t.gameData.isBonusRound)return o.setText("WIN"),void l.setText(`${t.gameData.currency} ${c.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`);const i=t.gameData.totalWin||0,n=i>0&&c>=i?i:c;return void(m=t.time.delayedCall(250,(()=>{t.gameData.isBonusRound?o.setText("TOTAL WIN"):o.setText("WIN"),l.setText(`${t.gameData.currency} ${n.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),m=null})))}const n=d.shift();c+=n||0,o.setText(t.gameData.isBonusRound?"WIN":"TOTAL WIN"),t.gameData.isBonusRound||o.setText("WIN"),l.setText(`${t.gameData.currency} ${c.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),t.time.delayedCall(1e3,i)};i()})(i)})),r.emitter.on(r.SPIN_ANIMATION_START,(()=>{this.isMobile&&(c=0,d=[],u=!1,m&&(t.time.removeEvent(m),m=null),l.setText(t.gameData.currency+" "+(0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})))})),r.emitter.on(r.TUMBLE_SEQUENCE_DONE,(()=>{this.isMobile&&(c=0,d=[],u=!1)})),r.emitter.on(r.UPDATE_CURRENCY,(()=>{this.isMobile})),r.emitter.on(r.FINAL_WIN_SHOW,(()=>{o.setText("TOTAL WIN"),l.setText(`${t.gameData.currency} ${t.gameData.totalWin.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),r.emitter.emit(r.GET_BALANCE)})),r.emitter.on(r.FREE_SPIN_TOTAL_WIN,(()=>{var e;const i=Math.max(0,Math.min(t.gameData.currentFreeSpinIndex||0,((null==(e=t.gameData.totalWinFreeSpin)?void 0:e.length)||1)-1)),s=(t.gameData.totalWinFreeSpin||[]).slice(0,i+1).reduce(((t,e)=>t+(Number(e)||0)),0);o.setText("TOTAL WIN"),l.setText(`${t.gameData.currency} ${s.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`)})),this.buttonContainer.add(s)}createSettings(t){const e=this.isMobile?.11*t.scale.width:.05*this.width,i=this.isMobile?this.mobile_buttons_y:.9*this.height,s=t.add.container(e,i),n=t.add.image(0,0,this.isMobile?"hamburger":"volume");if(n.setOrigin(.5,.5),n.setScale(this.isMobile?1:.6),this.isMobile){const e=t.add.graphics();e.fillStyle(0,.5),e.fillCircle(0,0,n.width),s.add(e)}if(s.add(n),s.name="settingsContainer",this.buttonContainer.add(s),s.setInteractive(new a.Geom.Rectangle(-40,-40,80,80),a.Geom.Rectangle.Contains).isButton=!0,this.isMobile){const e=t.add.text(0,25,"Menu",{fontSize:"12px",color:"#FFFFFF",fontFamily:"Poppins",align:"center"});e.setOrigin(.5,0),s.add(e)}this.menu||(this.isMobile?this.menu=new Ls(!1):this.menu=new Ls),s.on("pointerdown",(()=>{var e;if(t.audioManager.UtilityButtonSFX.play(),this.isMobile)this.menu.toggleMenu(t);else{t.children.list.forEach((t=>{t&&"systemSettingsContainer"===t.name&&t.destroy(!0)}));const i=new Ns;i.create(t),null==(e=i.container)||e.setName("systemSettingsContainer"),i.show(t)}}))}update(){}startIdleAnimation(t){this.idleTween&&this.idleTween.stop(),this.idleTween=t.tweens.add({targets:this.spinButton,angle:"+=360",duration:8e3,repeat:-1,ease:"Linear"})}stopIdleAnimation(){this.idleTween&&(this.idleTween.stop(),this.idleTween=null)}};s(Vs,"PANEL_WIDTH",250),s(Vs,"PANEL_HEIGHT",120);let Ys=Vs;class Xs{constructor(){s(this,"musicVolume",1),s(this,"sfxVolume",1),s(this,"winIsPlaying",!1),s(this,"winSFXQueue",[]),s(this,"isPlayingQueue",!1),s(this,"MainBG"),s(this,"BonusBG"),s(this,"BGChecker"),s(this,"ClickSFX"),s(this,"ReelDrop"),s(this,"ReelStart"),s(this,"TurboDrop"),s(this,"SpinSFX"),s(this,"UtilityButtonSFX"),s(this,"ScatterSFX"),s(this,"TExplosion"),s(this,"TW1Wins"),s(this,"TW2Wins"),s(this,"TW3Wins"),s(this,"TW4Wins"),s(this,"EpicW"),s(this,"MegaW"),s(this,"BigW"),s(this,"SuperW"),s(this,"CongratsW"),s(this,"FreeSpinW"),s(this,"BonusW"),s(this,"FreeSpinWon")}preload(t){const e="assets/Audio",i=".ogg";t.load.audio("BonusBG",`${e}/bonusbg_sw${i}`),t.load.audio("MainBG",`${e}/mainbg_sw${i}`),t.load.audio("BGChecker",`${e}/mainbg_sw${i}`),t.load.audio("ClickSFX",`${e}/click_sw${i}`),t.load.audio("ReelDrop",`${e}/reeldrop_SW2${i}`),t.load.audio("ReelStart",`${e}/reelstarting_sw${i}`),t.load.audio("TurboDrop",`${e}/turbodrop_sw${i}`),t.load.audio("SpinSFX",`${e}/spin_sw${i}`),t.load.audio("UtilityButtonSFX",`${e}/ub${i}`),t.load.audio("ScatterSFX",`${e}/scatter_SW2${i}`),t.load.audio("TExplosion",`${e}/bomb_SW${i}`),t.load.audio("BigW",`${e}/big_win_SW${i}`),t.load.audio("BonusW",`${e}/bonusw_sw${i}`),t.load.audio("SuperW",`${e}/super_win_SW${i}`),t.load.audio("MegaW",`${e}/mega_win_SW${i}`),t.load.audio("EpicW",`${e}/epic_win_SW${i}`),t.load.audio("FreeSpinWon",`${e}/freespinwon${i}`),t.load.audio("CongratsW",`${e}/end_win_SW${i}`),t.load.audio("FreeSpin",`${e}/super_win_SW${i}`),t.load.audio("TW1Wins",`${e}/tumblewin_1_SW${i}`),t.load.audio("TW2Wins",`${e}/tumblewin_2_SW${i}`),t.load.audio("TW3Wins",`${e}/tumblewin_3_SW${i}`),t.load.audio("TW4Wins",`${e}/tumblewin_4_SW${i}`)}create(t){this.ClickSFX=t.sound.add("ClickSFX",{volume:this.sfxVolume}),this.TW1Wins=t.sound.add("TW1Wins",{volume:this.sfxVolume}),this.TW2Wins=t.sound.add("TW2Wins",{volume:this.sfxVolume}),this.TW3Wins=t.sound.add("TW3Wins",{volume:this.sfxVolume}),this.TW4Wins=t.sound.add("TW4Wins",{volume:this.sfxVolume}),this.ReelDrop=t.sound.add("ReelDrop",{volume:this.sfxVolume}),this.ReelStart=t.sound.add("ReelStart",{volume:this.sfxVolume}),this.TurboDrop=t.sound.add("TurboDrop",{volume:this.sfxVolume}),this.SpinSFX=t.sound.add("SpinSFX",{volume:this.sfxVolume}),this.UtilityButtonSFX=t.sound.add("UtilityButtonSFX",{volume:this.sfxVolume}),this.ScatterSFX=t.sound.add("ScatterSFX",{volume:this.sfxVolume}),this.TExplosion=t.sound.add("TExplosion",{volume:this.sfxVolume}),this.FreeSpinWon=t.sound.add("FreeSpinWon",{volume:this.sfxVolume}),this.EpicW=t.sound.add("EpicW",{volume:this.sfxVolume}),this.MegaW=t.sound.add("MegaW",{volume:this.sfxVolume}),this.BigW=t.sound.add("BigW",{volume:this.sfxVolume}),this.SuperW=t.sound.add("SuperW",{volume:this.sfxVolume}),this.BonusW=t.sound.add("BonusW",{volume:this.sfxVolume}),this.CongratsW=t.sound.add("CongratsW",{volume:this.sfxVolume}),this.FreeSpinW=t.sound.add("FreeSpin",{volume:0}),this.BonusBG=t.sound.add("BonusBG",{loop:!0,volume:this.musicVolume}),this.MainBG=t.sound.add("MainBG",{loop:!0,volume:this.musicVolume}),this.BGChecker=t.sound.add("BGChecker",{loop:!0,volume:0}),this.MainBG.play(),this.BGChecker.play(),t.input.on("pointerdown",((t,e)=>{e.find((t=>t.isButton))||this.ClickSFX.play({volume:this.sfxVolume})}))}changeBackgroundMusic(t){t.gameData.isBonusRound?(this.BonusBG.play(),this.MainBG.stop()):(this.MainBG.play(),this.BonusBG.stop())}playRandomQuickWin(t){switch(Math.floor(4*Math.random())){case 0:this.TW1Wins.play({volume:this.sfxVolume});break;case 1:this.TW2Wins.play({volume:this.sfxVolume});break;case 2:this.TW3Wins.play({volume:this.sfxVolume});break;case 3:this.TW4Wins.play({volume:this.sfxVolume})}t.gameData.isBonusRound?(this.BonusBG.resume(),this.BonusBG.isPlaying||this.BonusBG.play()):(this.MainBG.resume(),this.MainBG.isPlaying||this.MainBG.play())}queueWinSFX(t){t.forEach((t=>{this.winSFXQueue.push(t)})),this.isPlayingQueue||this.playNextInQueue()}playNextInQueue(){if(0===this.winSFXQueue.length)return this.isPlayingQueue=!1,void(this.winIsPlaying=!1);this.isPlayingQueue=!0,this.winIsPlaying=!0;const t=this.winSFXQueue.shift();this.playWinSFX(t)}clearWinSFXQueue(t){this.winSFXQueue=[],this.isPlayingQueue=!1,this.winIsPlaying=!1,t?this.stopWinSFX(t):(this.BigW.stop(),this.MegaW.stop(),this.EpicW.stop(),this.SuperW.stop(),this.CongratsW.stop(),this.BGChecker.resume(),this.getMusicVolume()>1&&this.setMusicVolume(1))}getQueueLength(){return this.winSFXQueue.length}getQueueContents(){return[...this.winSFXQueue]}playWinSFX(t){let e;if("FreeSpin"===t){let t;return this.BGChecker.stop(),t=this.FreeSpinWon,void(t&&(t.once("complete",(()=>{this.BGChecker.resume(),this.isPlayingQueue&&this.playNextInQueue()})),t.play({volume:this.sfxVolume})))}this.BGChecker.stop(),"tumble"==t||(this.BonusBG.pause(),this.MainBG.pause()),"BigWin"===t?e=this.BigW:"EpicWin"===t?e=this.EpicW:"MegaWin"===t?e=this.MegaW:"SuperWin"===t&&(e=this.SuperW),e&&(e.once("complete",(()=>{this.winIsPlaying=!1,this.BGChecker.play(),this.isPlayingQueue&&(console.log("playing next in queue"),this.playNextInQueue())})),e.play({volume:this.sfxVolume}))}stopWinSFX(t){this.BGChecker.play(),t.gameData.isBonusRound?(this.BonusBG.play(),this.BonusBG.resume()):(this.MainBG.play(),this.MainBG.resume()),this.getMusicVolume()>1&&this.setMusicVolume(1),this.EpicW.stop(),this.MegaW.stop(),this.SuperW.stop(),this.BigW.stop(),this.CongratsW.stop(),this.winSFXQueue=[],this.isPlayingQueue=!1,this.winIsPlaying=!1}isQueuePlaying(){return this.isPlayingQueue}update(t,e,i){}setMusicVolume(t){this.musicVolume=t,this.MainBG&&this.MainBG.setVolume(this.musicVolume),this.BonusBG&&this.BonusBG.setVolume(this.musicVolume)}getMusicVolume(){return this.musicVolume}setSFXVolume(t){this.sfxVolume=t,this.ClickSFX&&this.ClickSFX.setVolume(this.sfxVolume),this.TW1Wins&&this.TW1Wins.setVolume(this.sfxVolume),this.TW2Wins&&this.TW2Wins.setVolume(this.sfxVolume),this.TW3Wins&&this.TW3Wins.setVolume(this.sfxVolume),this.TW4Wins&&this.TW4Wins.setVolume(this.sfxVolume),this.ReelDrop&&this.ReelDrop.setVolume(this.sfxVolume),this.SpinSFX&&this.SpinSFX.setVolume(this.sfxVolume),this.UtilityButtonSFX&&this.UtilityButtonSFX.setVolume(this.sfxVolume),this.EpicW&&this.EpicW.setVolume(this.sfxVolume),this.MegaW&&this.MegaW.setVolume(this.sfxVolume),this.BigW&&this.BigW.setVolume(this.sfxVolume),this.SuperW&&this.SuperW.setVolume(this.sfxVolume),this.BonusW&&this.BonusW.setVolume(this.sfxVolume),this.FreeSpinWon&&this.FreeSpinWon.setVolume(this.sfxVolume),this.TExplosion&&this.TExplosion.setVolume(this.sfxVolume),this.CongratsW&&this.CongratsW.setVolume(this.sfxVolume),this.FreeSpinW&&this.FreeSpinW.setVolume(0)}getSFXVolume(){return this.sfxVolume}}class Gs{constructor(){s(this,"isAutoPlaying",!1),s(this,"remainingSpins",0),s(this,"scene"),s(this,"spinInterval"),s(this,"remainingSpinsText"),s(this,"remainingSpinsBg"),s(this,"isMobile",!1),s(this,"matchesDoneListener"),s(this,"pollInterval",null),s(this,"spinScheduled",!1),s(this,"awaitingSpinAnimationEnd",!1),s(this,"awaitingOverlayClose",!1),s(this,"onSpinAnimationEnd",null),s(this,"onWinOverlayShow",null),s(this,"onWinOverlayHide",null)}preload(t){this.scene=t,this.isMobile=this.isMobileDevice()}isMobileDevice(){const t=new URLSearchParams(window.location.search);return"mobile"==t.get("device")||"desktop"!=t.get("device")&&(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768)}create(t){this.scene=t,this.matchesDoneListener=()=>{t.gameData.debugLog("Autoplay MATCHES_DONE received (no direct scheduling)")},this.onSpinAnimationEnd=()=>{this.isAutoPlaying&&(t.gameData.debugLog("Autoplay detected SPIN_ANIMATION_END"),this.awaitingSpinAnimationEnd=!1,this.scheduleSpinIfReady())},this.onWinOverlayShow=()=>{this.isAutoPlaying&&(t.gameData.debugLog("Autoplay detected WIN_OVERLAY_SHOW"),this.awaitingOverlayClose=!0)},this.onWinOverlayHide=()=>{this.isAutoPlaying&&(t.gameData.debugLog("Autoplay detected WIN_OVERLAY_HIDE"),this.awaitingOverlayClose=!1,this.scheduleSpinIfReady())},r.emitter.on(r.AUTOPLAY_START,(e=>{this.start(t,e)})),r.emitter.on(r.AUTOPLAY_STOP,(()=>{this.stop()})),r.emitter.on(r.SPIN_ANIMATION_END,this.onSpinAnimationEnd),r.emitter.on(r.WIN_OVERLAY_SHOW,this.onWinOverlayShow),r.emitter.on(r.WIN_OVERLAY_HIDE,this.onWinOverlayHide)}destroy(){r.emitter.off(r.AUTOPLAY_START,this.start),r.emitter.off(r.AUTOPLAY_STOP,this.stop),this.matchesDoneListener&&r.emitter.off(r.MATCHES_DONE,this.matchesDoneListener),this.onSpinAnimationEnd&&r.emitter.off(r.SPIN_ANIMATION_END,this.onSpinAnimationEnd),this.onWinOverlayShow&&r.emitter.off(r.WIN_OVERLAY_SHOW,this.onWinOverlayShow),this.onWinOverlayHide&&r.emitter.off(r.WIN_OVERLAY_HIDE,this.onWinOverlayHide)}start(t,e){if(t.gameData.isSpinning)t.gameData.debugLog("Cannot start autoplay: already spinning");else{this.isAutoPlaying=!0,this.remainingSpins=e,this.scene=t,this.createRemainingSpinsDisplay(t);try{t.buttons.spinButton.setAlpha(0),t.buttons.freeSpinBtn.setAlpha(1),t.buttons.freeSpinBtn.visible=!0}catch(i){}r.emitter.on(r.MATCHES_DONE,this.matchesDoneListener),t.gameData.debugLog("Starting autoplay - scheduling first spin"),this.spinInterval=setTimeout((()=>{t.gameData.debugLog("Executing first autoplay spin"),this.spin()}),50),this.pollInterval&&clearInterval(this.pollInterval),this.pollInterval=setInterval((()=>{this.isAutoPlaying&&this.scene&&!this.scene.gameData.isSpinning&&!this.spinScheduled&&(this.scene.gameData.debugLog("[Autoplay Poll] Detected ready state, spinning..."),this.spinScheduled=!0,this.spin())}),500)}}createRemainingSpinsDisplay(t){var e,i,s;this.remainingSpinsText&&this.remainingSpinsText.destroy(),this.remainingSpinsBg&&this.remainingSpinsBg.destroy();let n=.88*t.scale.width,a=.443*t.scale.height,o=null;try{o=t.children.getByName("spinContainer"),!o&&this.isMobile?(n=.5*t.scale.width,a=.86*t.scale.height):o&&(n=o.x,a=o.y)}catch(h){}if(this.remainingSpinsText=t.add.text(o?0:n,o?0:a,"",{fontSize:"72px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold",align:"center",stroke:"#000000",strokeThickness:6}),this.remainingSpinsText.setOrigin(.5,.5),this.remainingSpinsText.setDepth(this.isMobile?10:1e3),this.remainingSpinsText.setScale(this.isMobile?.5:1),o){o.add(this.remainingSpinsText);try{o.bringToTop(this.remainingSpinsText)}catch(h){}}const r=!0===(null==(e=null==t?void 0:t.slotMachine)?void 0:e.activeWinOverlay),l=t.gameData.isBonusRound&&(null!=(i=t.gameData.freeSpins)?i:0)>0&&!r||!t.gameData.isBonusRound&&this.isAutoPlaying&&this.remainingSpins>0&&!r;if(t.gameData.isBonusRound&&!r){try{t.buttons.autoplayIndicator.visible=!1}catch(h){}try{t.buttons.freeSpinBtn.visible=l}catch(h){}}else{try{t.buttons.autoplayIndicator.visible=!!this.isAutoPlaying}catch(h){}try{this.isAutoPlaying?t.buttons.freeSpinBtn.visible=!0:t.buttons.freeSpinBtn.visible=l}catch(h){}try{(null==(s=t.buttons.autoplayIndicator)?void 0:s.visible)&&(t.buttons.freeSpinBtn.visible=!0)}catch(h){}}this.updateRemainingSpinsDisplay()}updateRemainingSpinsDisplay(){var t;if(!this.scene||!this.remainingSpinsText)return;let e="";if(this.isAutoPlaying){e=`${Math.max(0,this.remainingSpins)}`;try{const t=this.scene.children.getByName("spinContainer");t&&this.remainingSpinsText.parentContainer===t?this.remainingSpinsText.setPosition(0,0):t?(t.add(this.remainingSpinsText),this.remainingSpinsText.setPosition(0,0)):this.isMobile?this.remainingSpinsText.setPosition(.5*this.scene.scale.width,.86*this.scene.scale.height):this.remainingSpinsText.setPosition(.88*this.scene.scale.width,.443*this.scene.scale.height)}catch(i){}try{this.remainingSpinsText.setDepth(this.isMobile?10:1e3)}catch(i){}const t=e.length;t>=3?this.remainingSpinsText.setFontSize("48px"):2===t?this.remainingSpinsText.setFontSize("64px"):this.remainingSpinsText.setFontSize("72px")}else{if(!this.scene.gameData.isBonusRound)return void this.remainingSpinsText.setText("");{e="";try{const t=this.scene.children.getByName("spinContainer");t&&this.remainingSpinsText.parentContainer===t?this.remainingSpinsText.setPosition(0,0):t?this.remainingSpinsText.setPosition(t.x,t.y):this.isMobile?this.remainingSpinsText.setPosition(.5*this.scene.scale.width,.86*this.scene.scale.height):this.remainingSpinsText.setPosition(.88*this.scene.scale.width,.443*this.scene.scale.height)}catch(i){}const s=(null!=(t=this.scene.gameData.freeSpins)?t:0).toString().length;s>=3?this.remainingSpinsText.setFontSize("40px"):2===s?this.remainingSpinsText.setFontSize("56px"):this.remainingSpinsText.setFontSize("72px")}}this.remainingSpinsText.setText(e)}ensureRemainingSpinsDisplay(t){var e,i,s;this.scene=t,this.remainingSpinsText||this.createRemainingSpinsDisplay(t);const n=!0===(null==(e=null==t?void 0:t.slotMachine)?void 0:e.activeWinOverlay);if(t.gameData.isBonusRound&&(null!=(i=t.gameData.freeSpins)?i:0)>0&&!n||!t.gameData.isBonusRound&&this.isAutoPlaying&&this.remainingSpins>0&&!n){try{t.buttons.freeSpinBtn.visible=!0}catch(a){}try{t.buttons.autoplayIndicator.visible=!1}catch(a){}}try{(null==(s=t.buttons.autoplayIndicator)?void 0:s.visible)&&(t.buttons.freeSpinBtn.visible=!0)}catch(a){}}hideRemainingSpinsDisplay(){this.remainingSpinsText&&(this.remainingSpinsText.destroy(),this.remainingSpinsText=void 0),this.remainingSpinsBg&&(this.remainingSpinsBg.destroy(),this.remainingSpinsBg=void 0)}stop(){this.spinInterval&&(clearTimeout(this.spinInterval),this.spinInterval=0),this.pollInterval&&(clearInterval(this.pollInterval),this.pollInterval=null),this.spinScheduled=!1,this.scene.buttons.resetAutoplayButtons(),this.isAutoPlaying=!1,this.remainingSpins=0;try{this.scene.buttons.spinButton.setAlpha(1),this.scene.buttons.freeSpinBtn.setAlpha(0),this.scene.buttons.autoplayIndicator.visible=!1}catch(t){}this.matchesDoneListener&&r.emitter.off(r.MATCHES_DONE,this.matchesDoneListener),this.onSpinAnimationEnd&&r.emitter.off(r.SPIN_ANIMATION_END,this.onSpinAnimationEnd),this.onWinOverlayShow&&r.emitter.off(r.WIN_OVERLAY_SHOW,this.onWinOverlayShow);try{this.scene.gameData.freeSpinLockUntilMs=Math.min(this.scene.gameData.freeSpinLockUntilMs||0,Date.now())}catch(t){}this.onWinOverlayHide&&r.emitter.off(r.WIN_OVERLAY_HIDE,this.onWinOverlayHide),this.remainingSpinsText&&(this.remainingSpinsText.destroy(),this.remainingSpinsText=void 0),this.remainingSpinsBg&&(this.remainingSpinsBg.destroy(),this.remainingSpinsBg=void 0),this.scene&&this.scene.buttons&&this.scene.buttons.updateButtonStates(this.scene)}pauseForBonus(){if(this.scene){try{this.scene.gameData.autoplayRemainingSpins=Math.max(0,(this.scene.gameData.autoplayRemainingSpins||0)+(this.remainingSpins||0)),this.scene.gameData.autoplayWasPaused=this.scene.gameData.autoplayRemainingSpins>0}catch(t){}this.spinInterval&&(clearTimeout(this.spinInterval),this.spinInterval=0),this.pollInterval&&(clearInterval(this.pollInterval),this.pollInterval=null),this.spinScheduled=!1,this.isAutoPlaying=!1,this.scene&&this.scene.buttons&&this.scene.buttons.updateButtonStates&&this.scene.buttons.updateButtonStates(this.scene)}}spin(){var t,e,i,s;if(this.spinScheduled=!1,this.scene.gameData.debugLog("=== AUTOPLAY SPIN ATTEMPT ==="),this.scene.gameData.debugLog(`autoplay: ${this.isAutoPlaying}, bonus: ${this.scene.gameData.isBonusRound}, spins: ${this.remainingSpins}, free: ${this.scene.gameData.freeSpins}, isSpinning: ${this.scene.gameData.isSpinning}`),!this.isAutoPlaying||!this.scene.gameData.isBonusRound&&this.remainingSpins<=0||this.scene.gameData.isBonusRound&&this.scene.gameData.freeSpins<=0)return this.stop(),this.scene.gameData.debugLog("Autoplay stopped - no more spins"),void r.emitter.emit(r.AUTOPLAY_COMPLETE);if(this.scene.gameData.isSpinning||this.scene.slotMachine.activeWinOverlay)return this.scene.gameData.debugLog("Skipping autoplay spin - game busy"),void(this.spinInterval=setTimeout((()=>{this.spin()}),500));if(this.scene.gameData.isBonusRound)this.scene.gameData.debugLog("Free spin autoplay");else{if(this.scene.gameData.debugLog("Regular autoplay spin"),this.scene.gameData.balance<this.scene.gameData.bet)return this.stop(),this.scene.gameData.debugLog("Autoplay stopped - insufficient balance"),void r.emitter.emit(r.AUTOPLAY_COMPLETE);this.remainingSpins--,this.updateRemainingSpinsDisplay()}if(this.scene.gameData.totalWin=0,r.emitter.emit(r.WIN,{}),!(null==(e=null==(t=this.scene.gameData.slot)?void 0:t.values)?void 0:e.length))return this.scene.gameData.debugError("Invalid slot data in autoplay spin"),this.stop(),void r.emitter.emit(r.AUTOPLAY_COMPLETE);this.scene.gameData.debugLog("Triggering autoplay spin via Events.SPIN"),this.awaitingSpinAnimationEnd=!0,this.awaitingOverlayClose=!1,r.emitter.emit(r.SPIN,{currentRow:this.scene.gameData.currentRow,symbols:this.scene.gameData.slot.values}),this.scene.gameData.debugLog("Events.SPIN emitted successfully");try{this.scene.gameData.isBonusRound&&(this.scene.buttons.spinButton.setAlpha(0),this.scene.buttons.freeSpinBtn.setAlpha(1),this.scene.buttons.freeSpinBtn.visible=!0,this.scene.buttons.autoplayIndicator.visible=!0),this.isAutoPlaying&&(null==(s=null==(i=this.scene.buttons.autoplayIndicator)?void 0:i.setAlpha)||s.call(i,1))}catch(n){}}scheduleSpinIfReady(){this.isAutoPlaying&&this.scene&&(this.scene.gameData.isSpinning||this.scene.slotMachine.activeWinOverlay||this.awaitingSpinAnimationEnd||this.awaitingOverlayClose||(this.spinInterval&&clearTimeout(this.spinInterval),this.scene.gameData.debugLog("All conditions met. Scheduling next autoplay spin"),this.spinInterval=setTimeout((()=>this.spin()),50)))}update(t,e,i){}}function Hs(t){const e=new URLSearchParams(window.location.search);if(e.get("ebal"))return e.get("ebal")||"-1";let i="";return i=e.get("start_game")?"start_game":e.get(t)||"",i}const Us=()=>{var t;const e=null==(t=null==window?void 0:window.APP_CONFIG)?void 0:t["game-url"];return"string"==typeof e&&e.length>0?e.replace(/\/$/,""):"https://game-launcher.torrospins.com/"};class $s{constructor(t){s(this,"gameData"),s(this,"exitURL",""),s(this,"ebale",-1),this.gameData=t}async generateGameUrlToken(){const t=`${Us()}/api/v1/generate_url`,e={operator_id:"1",player_id:2,game_id:"00010525",device:"desktop",lang:"en",currency:"",quit_link:"www.quit.com",free_spin:"1",session:"83f78be3-8685-4142-aa4e-7b1a4d0a7415",player_name:"test"},i={"Content-Type":"application/json",Accept:"*/*",Connection:"keep-alive","Accept-Encoding":"gzip, deflate, br","x-access-token":"taVHVt4xD8NLwvlo3TgExmiSaGOiuiKAeGB9Qwla6XKpmSRMUwy2pZuuYJYNqFLr","x-brand":"6194bf3a-b863-4302-b691-9cc8fe9b56c8"};try{const s=await fetch(t,{method:"POST",headers:i,body:JSON.stringify(e)});if(!s.ok){const t=await s.text();throw new Error(`HTTP error! status: ${s.status}, message: ${t}`)}const n=await s.json();return{url:n.data.url,token:n.data.token}}catch(s){throw s}}async gameLauncher(){try{localStorage.removeItem("gameToken"),localStorage.removeItem("exit_url"),localStorage.removeItem("what_device"),sessionStorage.removeItem("gameToken"),sessionStorage.removeItem("exit_url"),sessionStorage.removeItem("what_device"),console.log(E.yellowBright.bold("Starting gameLauncher..."));let t="",e=Hs("token");e&&(t=e,localStorage.setItem("gameToken",t),sessionStorage.setItem("gameToken",t));let i=Hs("device");i&&(localStorage.setItem("what_device",i),sessionStorage.setItem("what_device",i));let s=Hs("api_exit");s&&(this.exitURL=s,localStorage.setItem("exit_url",s),sessionStorage.setItem("exit_url",s));let n=Hs("start_game");if(n){console.log("startGame");let{url:e,token:i}=await this.generateGameUrlToken();t=i,localStorage.setItem("gameToken",i),sessionStorage.setItem("gameToken",i)}if(!t&&!n)throw new Error}catch(t){throw new Error}}async getBalance(){if(Hs("ebal")&&Hs("start_game")&&parseInt(Hs("ebal"))>this.ebale)return{data:{balance:parseInt(Hs("ebal"))}};try{const t=await fetch(`${Us()}/api/v1/slots/balance`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("gameToken")}`}});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()}catch(t){throw this.gameData.debugError("Error in getBalance:",t),t}}async doSpin(t,e,i){let s=e?E.green("true"):E.red("false"),n=i?E.green("true"):E.red("false");if(console.log(E.grey("[API] doSpin called. bet: ")+E.blue(t)+E.grey(" | isBuyFs: ")+s+E.grey(" | isEnhancedBet: ")+n),!localStorage.getItem("gameToken"))return"error";try{const s=await fetch(`${Us()}/api/v1/slots/bet`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("gameToken")}`},body:JSON.stringify({action:"spin",bet:t.toString(),line:2,isBuyFs:e,isEnhancedBet:i})});if(this.gameData.debugged<-99){if(-100==this.gameData.debugged)return{playerId:"2",bet:"10",slot:{area:[[4,3,2,1,0],[5,7,0,6,8],[2,9,9,3,1],[1,2,3,9,4],[6,0,7,8,5],[3,2,0,1,9]],totalWin:361.5,tumbles:[],freeSpin:{multiplierValue:10,items:[{spinsLeft:10,area:[[9,9,1,1,5],[8,11,3,3,7],[7,7,9,9,5],[5,5,2,2,9],[8,7,7,3,3],[8,9,9,4,4]],totalWin:0,multipliers:[11],tumbles:[]},{spinsLeft:9,area:[[6,6,8,8,4],[5,5,7,7,4],[7,3,3,9,9],[1,9,9,6,6],[2,2,9,9,7],[9,7,7,6,6]],totalWin:0,multipliers:[],tumbles:[]},{spinsLeft:8,area:[[18,3,3,6,6],[8,6,6,7,7],[2,2,7,7,9],[5,5,8,8,6],[8,5,5,9,9],[5,9,9,8,8]],totalWin:0,multipliers:[18],tumbles:[]},{spinsLeft:7,area:[[4,6,6,9,9],[8,9,9,0,3],[9,5,5,8,8],[8,8,4,4,9],[8,8,7,7,9],[9,5,5,8,8]],totalWin:21.5,multipliers:[],tumbles:[{symbols:{in:[[7,2],[4,5,5],[5,5,1],[8,9,9],[4,7,7],[7,7,4]],out:[{symbol:9,count:8,win:2.5},{symbol:8,count:9,win:4}]},win:6.5},{symbols:{in:[[],[1,1],[6,8,8,5],[],[],[7,7]],out:[{symbol:5,count:8,win:10}]},win:10},{symbols:{in:[[4],[],[],[],[9,9,2,2],[9,7,7,8]],out:[{symbol:7,count:9,win:5}]},win:5}]},{spinsLeft:6,area:[[8,8,0,9,9],[9,9,5,5,7],[9,9,4,4,2],[0,8,8,9,9],[4,4,8,8,9],[6,9,9,5,5]],totalWin:7.5,multipliers:[],tumbles:[{symbols:{in:[[7,8],[1,6],[9,9],[9,9],[7],[7,0]],out:[{symbol:9,count:11,win:7.5}]},win:7.5}]},{spinsLeft:10,area:[[8,8,4,4,9],[9,6,6,1,1],[0,1,1,5,5],[9,1,1,9,9],[5,5,6,6,4],[8,2,2,9,9]],totalWin:0,multipliers:[],tumbles:[]},{spinsLeft:9,area:[[8,7,7,4,4],[9,8,8,14,3],[5,9,9,4,4],[9,9,8,8,7],[8,9,9,7,7],[9,7,7,9,9]],totalWin:192,multipliers:[10,14],tumbles:[{symbols:{in:[[],[8],[7,9],[8,8],[9,9],[9,9,7]],out:[{symbol:9,count:10,win:7.5}]},win:7.5},{symbols:{in:[[3,10,5],[9,4,4],[9],[8,5,5,9,9],[8,1,1],[9,9,2]],out:[{symbol:8,count:9,win:4},{symbol:7,count:9,win:5}]},win:9},{symbols:{in:[[],[6],[8,8],[1,1],[8,8],[9,5,5,8]],out:[{symbol:9,count:11,win:7.5}]},win:7.5}]},{spinsLeft:8,area:[[5,12,3,3,6],[6,1,1,8,8],[8,8,6,6,3],[8,8,5,5,9],[8,3,3,9,9],[7,7,5,5,9]],totalWin:0,multipliers:[12],tumbles:[]},{spinsLeft:7,area:[[4,6,6,9,9],[6,1,1,8,8],[0,1,1,5,5],[4,9,9,7,7],[9,7,7,5,5],[8,8,7,7,9]],totalWin:0,multipliers:[],tumbles:[]},{spinsLeft:6,area:[[5,11,3,3,6],[7,7,5,5,4],[1,1,5,5,9],[6,8,8,4,4],[1,8,8,5,5],[7,5,5,9,9]],totalWin:30,multipliers:[11],tumbles:[{symbols:{in:[[8],[2,2],[6,9],[],[5,7],[5,5]],out:[{symbol:5,count:9,win:10}]},win:10}]},{spinsLeft:5,area:[[5,16,3,3,6],[5,7,7,4,4],[9,5,5,8,8],[9,9,4,4,7],[5,5,6,6,4],[7,7,9,9,8]],totalWin:0,multipliers:[16],tumbles:[]},{spinsLeft:4,area:[[8,7,7,4,4],[6,6,1,1,8],[4,4,2,2,7],[9,9,3,3,8],[9,4,4,8,8],[8,8,6,6,8]],totalWin:4,multipliers:[],tumbles:[{symbols:{in:[[3],[7],[],[9],[9,9],[1,1,8]],out:[{symbol:8,count:8,win:4}]},win:4}]},{spinsLeft:3,area:[[9,9,1,1,5],[8,14,3,3,7],[6,6,3,3,9],[7,3,3,0,8],[6,6,8,8,7],[7,7,8,8,1]],totalWin:0,multipliers:[14],tumbles:[]},{spinsLeft:2,area:[[8,7,7,4,4],[9,9,6,6,1],[9,4,4,2,2],[9,9,4,4,7],[5,9,9,4,4],[9,7,7,5,5]],totalWin:39.5,multipliers:[],tumbles:[{symbols:{in:[[8,8],[2,7],[8,8,5],[9,2,2,5],[6,6,5,5],[5]],out:[{symbol:4,count:8,win:10},{symbol:9,count:8,win:2.5}]},win:12.5},{symbols:{in:[[],[],[9],[6],[8,4,4],[8,8,6]],out:[{symbol:5,count:8,win:10}]},win:10},{symbols:{in:[[7,7,8],[],[8,8],[],[9],[6,8]],out:[{symbol:8,count:8,win:4}]},win:4},{symbols:{in:[[8,5,5,1],[7],[],[7],[],[6,7]],out:[{symbol:7,count:8,win:5}]},win:5},{symbols:{in:[[],[0,9],[],[2],[6,5],[8,8,9]],out:[{symbol:6,count:8,win:8}]},win:8}]},{spinsLeft:1,area:[[8,9,9,7,7],[6,0,9,9,5],[5,5,8,8,9],[8,4,4,7,7],[9,9,0,8,8],[7,8,8,1,1]],totalWin:37,multipliers:[],tumbles:[{symbols:{in:[[5],[],[7,8],[6],[9,8],[6,8]],out:[{symbol:8,count:8,win:4}]},win:4},{symbols:{in:[[5,5],[8,5],[7],[],[7,9,9],[]],out:[{symbol:9,count:8,win:2.5}]},win:2.5},{symbols:{in:[[6,6],[],[5,9],[6,6],[3],[5]],out:[{symbol:7,count:8,win:5}]},win:5},{symbols:{in:[[6,6,3],[8,2],[9,9,3],[],[],[7]],out:[{symbol:5,count:9,win:10}]},win:10},{symbols:{in:[[1,1,9,9],[4],[],[9,9,6],[],[9]],out:[{symbol:6,count:9,win:8}]},win:8},{symbols:{in:[[2,9],[],[9,7,7],[7,7],[9,7],[9]],out:[{symbol:9,count:10,win:7.5}]},win:7.5}]}]}}};if(-101==this.gameData.debugged)return{playerId:"2",bet:"10",slot:{area:[[1,4,0,2,3],[8,6,5,7,0],[1,2,9,3,9],[1,3,9,4,2],[8,0,6,5,7],[2,1,3,9,0]],totalWin:397,tumbles:[],freeSpin:{multiplierValue:10,items:[{spinsLeft:10,area:[[5,7,6,8,8],[8,9,6,4,6],[7,8,8,9,3],[1,3,3,6,3],[7,9,9,3,3],[9,9,8,8,6]],totalWin:0,multipliers:[],tumbles:[]},{spinsLeft:9,area:[[9,6,6,7,7],[2,0,7,7,9],[9,6,9,7,5],[9,6,5,5,8],[9,7,7,9,9],[6,5,7,6,2]],totalWin:22.5,multipliers:[11],tumbles:[{symbols:{in:[[7,11,9],[4,4,9],[8,8,7],[7],[8,8,9,9,4],[4]],out:[{symbol:9,count:8,win:2.5},{symbol:7,count:8,win:5}]},win:7.5}]},{spinsLeft:8,area:[[7,7,7,8,8],[9,9,5,4,4],[6,2,8,8,5],[2,5,4,6,12],[6,1,9,7,9],[9,9,6,6,1]],totalWin:0,multipliers:[12],tumbles:[]},{spinsLeft:7,area:[[8,9,7,9,8],[9,9,5,4,4],[5,5,7,7,7],[4,6,12,9,2],[9,5,5,8,8],[4,4,4,3,3]],totalWin:0,multipliers:[12],tumbles:[]},{spinsLeft:6,area:[[5,7,7,6,6],[8,7,7,9,9],[8,9,9,6,9],[8,8,7,5,5],[6,6,7,6,8],[6,6,4,4,9]],totalWin:122.5,multipliers:[13],tumbles:[{symbols:{in:[[5,9],[],[5],[],[9,0,7],[8,8]],out:[{symbol:6,count:8,win:8}]},win:8},{symbols:{in:[[7],[4,5],[7,6,9],[],[3],[5]],out:[{symbol:9,count:8,win:2.5}]},win:2.5},{symbols:{in:[[4,8,8],[3,9],[8],[2],[0,7],[]],out:[{symbol:7,count:9,win:5}]},win:5},{symbols:{in:[[3,8],[9],[4,2],[6,6],[13],[7,7]],out:[{symbol:8,count:10,win:9}]},win:9}]},{spinsLeft:5,area:[[7,7,9,9,8],[4,6,9,9,8],[9,6,7,6,3],[9,8,8,7,5],[4,4,9,9,5],[4,3,3,9,9]],totalWin:7.5,multipliers:[],tumbles:[{symbols:{in:[[8,5],[9,9],[7],[6],[4,8],[5,9]],out:[{symbol:9,count:10,win:7.5}]},win:7.5}]},{spinsLeft:4,area:[[2,7,8,8,8],[0,7,7,9,9],[14,1,6,2,8],[6,3,3,6,6],[5,4,7,7,7],[8,8,9,15,7]],totalWin:0,multipliers:[14,15],tumbles:[]},{spinsLeft:3,area:[[9,5,7,6,8],[7,8,8,9,6],[7,7,5,5,8],[5,5,8,8,2],[7,9,9,5,5],[8,8,6,5,7]],totalWin:33.5,multipliers:[],tumbles:[{symbols:{in:[[9,8],[1,4],[6,6,9],[8,0,7,9],[8,7],[8,8,9]],out:[{symbol:5,count:8,win:10},{symbol:8,count:8,win:4}]},win:14},{symbols:{in:[[9,6,6],[5,7],[9,5,5],[5,5],[9,8,8,6],[6,9]],out:[{symbol:9,count:8,win:2.5},{symbol:7,count:8,win:5}]},win:7.5},{symbols:{in:[[8,2,6],[8],[4,4],[],[3],[6,9]],out:[{symbol:6,count:9,win:8}]},win:8},{symbols:{in:[[8,7],[8],[],[6],[5,6,6],[7,5]],out:[{symbol:8,count:9,win:4}]},win:4}]},{spinsLeft:2,area:[[1,3,3,9,5],[0,7,7,9,9],[5,5,8,8,9],[8,2,5,4,6],[4,9,9,5,5],[9,8,8,6,9]],totalWin:2.5,multipliers:[],tumbles:[{symbols:{in:[[2],[9,7],[0],[],[9,0],[6,7]],out:[{symbol:9,count:8,win:2.5}]},win:2.5}]},{spinsLeft:6,area:[[8,9,11,7,7],[2,0,7,7,9],[8,5,5,7,7],[9,9,1,3,3],[3,3,6,1,9],[7,8,8,9,15]],totalWin:0,multipliers:[11,15],tumbles:[]},{spinsLeft:5,area:[[3,3,9,5,5],[9,8,8,9,4],[9,6,7,6,3],[8,7,5,5,7],[8,4,4,9,9],[5,7,6,6,4]],totalWin:0,multipliers:[],tumbles:[]},{spinsLeft:4,area:[[5,8,8,9,11],[9,9,8,8,9],[8,8,5,5,7],[8,5,9,6,5],[6,7,6,8,8],[8,4,4,4,3]],totalWin:34.5,multipliers:[11],tumbles:[{symbols:{in:[[8,8],[9,9],[9,7],[6],[7,7],[6]],out:[{symbol:8,count:10,win:9}]},win:9},{symbols:{in:[[8],[4,9,9,6,6],[5],[8],[],[]],out:[{symbol:9,count:8,win:2.5}]},win:2.5}]},{spinsLeft:3,area:[[8,9,11,7,7],[7,9,5,5,6],[8,9,7,7,9],[9,8,5,5,6],[5,5,8,8,9],[9,6,6,1,9]],totalWin:7.5,multipliers:[11],tumbles:[{symbols:{in:[[8],[1],[6,9],[4],[9],[4,4]],out:[{symbol:9,count:8,win:2.5}]},win:2.5}]},{spinsLeft:2,area:[[11,7,7,9,9],[6,6,9,9,4],[7,7,9,9,0],[9,9,7,0,8],[8,8,6,6,13],[7,7,8,8,9]],totalWin:60,multipliers:[11,13],tumbles:[{symbols:{in:[[3,3],[0,2],[7,7],[5,8],[],[8]],out:[{symbol:9,count:9,win:2.5}]},win:2.5},{symbols:{in:[[5,9],[],[4,4,2,0],[3],[],[1,6]],out:[{symbol:7,count:9,win:5}]},win:5}]},{spinsLeft:6,area:[[8,7,4,7,7],[6,8,8,7,7],[4,9,9,7,8],[8,9,4,4,9],[3,7,0,9,4],[4,4,3,3,9]],totalWin:0,multipliers:[],tumbles:[]},{spinsLeft:5,area:[[7,6,8,8,9],[5,5,6,8,8],[7,5,5,9,6],[8,8,7,5,5],[6,8,8,6,6],[9,6,6,4,4]],totalWin:87,multipliers:[14],tumbles:[{symbols:{in:[[4,4,9],[6,6,6],[8],[9,7],[9,9,4,4,9],[8,8]],out:[{symbol:8,count:8,win:4},{symbol:6,count:8,win:8}]},win:12},{symbols:{in:[[8,8],[],[14],[4],[5,6,6],[7]],out:[{symbol:9,count:8,win:2.5}]},win:2.5}]},{spinsLeft:4,area:[[9,2,7,8,8],[6,6,6,9,9],[5,8,8,9,7],[6,12,9,2,4],[6,6,7,6,8],[5,7,7,8,8]],totalWin:0,multipliers:[12],tumbles:[]},{spinsLeft:3,area:[[8,8,9,11,7],[8,8,2,0,7],[3,3,3,14,1],[6,12,9,2,4],[3,7,0,9,4],[9,15,7,9,6]],totalWin:0,multipliers:[12,15,11,14],tumbles:[]},{spinsLeft:2,area:[[5,8,8,9,11],[8,8,9,4,7],[7,7,5,5,8],[3,3,6,3,3],[5,8,8,9,7],[7,7,8,8,9]],totalWin:19.5,multipliers:[11],tumbles:[{symbols:{in:[[9,4],[8,8],[9],[],[9,8],[9,7]],out:[{symbol:8,count:9,win:4}]},win:4},{symbols:{in:[[8,5],[4],[6],[],[2,1],[6,6]],out:[{symbol:9,count:8,win:2.5}]},win:2.5}]},{spinsLeft:1,area:[[9,5,7,6,8],[7,5,5,8,8],[2,4,4,9,6],[0,8,9,4,4],[7,9,9,5,5],[8,8,6,9,6]],totalWin:0,multipliers:[],tumbles:[]}]}}};if(-102==this.gameData.debugged)return{playerId:"2",bet:"10",slot:{area:[[4,1,0,3,2],[0,8,5,7,6],[9,1,2,9,3],[1,2,3,9,4],[5,6,7,0,8],[2,9,1,0,3]],totalWin:159.5,tumbles:[],freeSpin:{multiplierValue:10,items:[{spinsLeft:10,area:[[11,7,7,9,9],[1,3,10,3,9],[8,8,9,7,7],[6,6,9,9,8],[2,3,7,0,9],[7,9,9,8,8]],totalWin:97.5,multipliers:[10,11],tumbles:[{symbols:{in:[[7,7],[3],[6],[6,6],[6],[6,6]],out:[{symbol:9,count:9,win:2.5}]},win:2.5},{symbols:{in:[[8,8,6,7],[],[8,3,6],[4,5,2,8],[2,5],[2,6,4]],out:[{symbol:7,count:8,win:5},{symbol:6,count:8,win:8}]},win:13},{symbols:{in:[[7,9],[],[9,8,8],[8,9],[],[3,4]],out:[{symbol:8,count:9,win:4}]},win:4}]},{spinsLeft:9,area:[[7,6,8,8,9],[9,1,8,8,2],[6,7,6,3,8],[7,7,9,9,7],[8,8,6,6,13],[7,6,2,9,9]],totalWin:0,multipliers:[13],tumbles:[]},{spinsLeft:8,area:[[9,11,7,7,9],[9,4,4,1,3],[6,7,6,3,8],[3,3,6,3,3],[8,4,4,9,9],[6,2,8,8,3]],totalWin:0,multipliers:[11],tumbles:[]},{spinsLeft:7,area:[[5,7,6,8,8],[7,9,9,9,3],[9,6,9,7,5],[4,9,9,8,5],[8,9,5,2,9],[6,7,7,7,9]],totalWin:43,multipliers:[10],tumbles:[{symbols:{in:[[],[8,5,5],[8,8],[8,5],[4,8],[9]],out:[{symbol:9,count:10,win:7.5}]},win:7.5},{symbols:{in:[[8,8],[9],[9,5],[9,9],[8,6],[]],out:[{symbol:8,count:9,win:4}]},win:4},{symbols:{in:[[7],[3,10],[2,6],[6,6],[0],[]],out:[{symbol:5,count:8,win:10}]},win:10}]},{spinsLeft:6,area:[[8,9,11,7,7],[0,7,7,9,9],[9,0,2,4,4],[8,5,5,6,6],[9,9,5,5,4],[8,8,4,4,4]],totalWin:0,multipliers:[11],tumbles:[]},{spinsLeft:5,area:[[7,7,7,6,2],[8,2,6,6,6],[7,8,8,9,3],[8,2,5,4,6],[5,5,4,7,7],[7,6,2,9,9]],totalWin:0,multipliers:[],tumbles:[]},{spinsLeft:4,area:[[8,8,3,4,9],[8,8,9,4,7],[4,4,9,9,7],[4,7,6,6,6],[5,5,4,7,7],[8,9,15,7,9]],totalWin:0,multipliers:[15],tumbles:[]},{spinsLeft:3,area:[[4,1,3,3,9],[9,8,8,9,4],[9,9,0,2,4],[6,6,9,9,9],[7,7,7,8,8],[7,7,8,8,9]],totalWin:6.5,multipliers:[],tumbles:[{symbols:{in:[[2],[8,8],[9,5],[4,4,9],[],[4]],out:[{symbol:9,count:9,win:2.5}]},win:2.5},{symbols:{in:[[],[0,2,8,8],[],[],[7,9],[9,9]],out:[{symbol:8,count:8,win:4}]},win:4}]},{spinsLeft:2,area:[[5,7,6,8,8],[9,1,8,8,2],[5,7,7,7,9],[8,8,7,5,5],[3,3,6,1,9],[6,6,4,4,4]],totalWin:0,multipliers:[],tumbles:[]},{spinsLeft:1,area:[[3,4,9,4,4],[9,5,5,7,7],[6,4,4,9,9],[9,9,9,8,8],[8,6,6,13,6],[9,8,8,6,9]],totalWin:12.5,multipliers:[13],tumbles:[{symbols:{in:[[2],[6],[8,2],[6,4,5],[],[5,5]],out:[{symbol:9,count:9,win:2.5}]},win:2.5}]}]}}};if(-103==this.gameData.debugged)return{playerId:"2",bet:"10",slot:{area:[[2,4,1,3,0],[5,8,7,6,0],[2,1,9,3,9],[2,4,9,3,1],[8,7,5,6,0],[1,2,9,0,3]],totalWin:6600,tumbles:[],freeSpin:{multiplierValue:10,items:[{spinsLeft:10,area:[[8,8,3,10,4],[9,3,11,7,5],[6,4,7,7,7],[9,9,8,8,13],[7,6,8,8,6],[9,6,6,1,9]],totalWin:0,multipliers:[11,10,13],tumbles:[]},{spinsLeft:9,area:[[7,9,9,8,8],[8,9,6,4,6],[7,9,6,7,6],[5,8,8,2,5],[6,7,6,8,8],[4,4,9,9,6]],totalWin:0,multipliers:[],tumbles:[]},{spinsLeft:8,area:[[4,1,3,3,9],[8,2,6,6,9],[8,8,9,9,6],[5,5,7,7,9],[2,3,14,22,7],[4,6,2,8,8]],totalWin:0,multipliers:[14,22],tumbles:[]},{spinsLeft:7,area:[[8,8,3,10,4],[0,7,7,9,9],[6,6,4,4,9],[8,8,13,20,8],[9,6,6,7,6],[5,7,6,2,9]],totalWin:0,multipliers:[13,10,20],tumbles:[]},{spinsLeft:6,area:[[6,9,5,9,5],[2,0,7,7,9],[5,5,7,7,7],[9,4,4,9,9],[1,9,7,9,9],[9,9,8,8,4]],totalWin:6498,multipliers:[22,15,10,12],tumbles:[{symbols:{in:[[9,4],[4],[],[2,8,8],[8,8,7],[7,7]],out:[{symbol:9,count:11,win:7.5}]},win:7.5},{symbols:{in:[[],[9,8],[5,5,8],[],[9,7],[6,9]],out:[{symbol:7,count:9,win:5}]},win:5},{symbols:{in:[[],[9],[5],[4,4],[6,7],[5,9]],out:[{symbol:8,count:8,win:4}]},win:4},{symbols:{in:[[8,8],[],[6,7,6,9,7],[],[],[4]],out:[{symbol:5,count:8,win:10}]},win:10},{symbols:{in:[[8],[7],[],[6,6,7,4],[],[6,7]],out:[{symbol:4,count:8,win:10}]},win:10},{symbols:{in:[[7],[],[12,8],[3,6],[5],[4,4]],out:[{symbol:6,count:8,win:8}]},win:8},{symbols:{in:[[5],[7],[9,9],[9],[7,6],[7]],out:[{symbol:7,count:8,win:5}]},win:5},{symbols:{in:[[8],[7,4],[7,7,5],[9],[22],[15,10]],out:[{symbol:9,count:10,win:7.5}]},win:7.5}]},{spinsLeft:5,area:[[4,9,2,7,8],[5,7,7,8,8],[4,9,9,7,8],[1,3,3,6,3],[5,1,2,3,14],[10,15,0,9,9]],totalWin:0,multipliers:[10,15,14],tumbles:[]},{spinsLeft:4,area:[[8,4,4,1,3],[5,5,7,7,8],[8,8,12,5,5],[5,8,8,2,5],[3,6,1,9,7],[8,8,6,5,7]],totalWin:16,multipliers:[12],tumbles:[{symbols:{in:[[7],[9],[6,9],[6,9],[],[3,8]],out:[{symbol:8,count:8,win:4}]},win:4}]},{spinsLeft:3,area:[[3,3,9,5,5],[4,6,9,9,8],[7,7,5,5,8],[20,8,8,5,9],[7,7,9,9,3],[9,5,5,7,7]],totalWin:0,multipliers:[20],tumbles:[]},{spinsLeft:2,area:[[8,8,5,5,8],[7,8,8,9,6],[7,7,9,6,7],[8,5,5,6,6],[9,7,7,9,9],[9,9,8,8,6]],totalWin:56,multipliers:[],tumbles:[{symbols:{in:[[7,7,4],[2,8],[],[6],[],[7,7]],out:[{symbol:8,count:8,win:4}]},win:4},{symbols:{in:[[8,5],[5],[9,7,7],[],[7,9],[6,4]],out:[{symbol:7,count:10,win:10}]},win:10},{symbols:{in:[[],[6],[7,7],[],[9,9,4,4],[7,6]],out:[{symbol:9,count:9,win:2.5}]},win:2.5},{symbols:{in:[[],[7,7],[8],[8,5,5],[],[9,9,4]],out:[{symbol:6,count:9,win:8}]},win:8},{symbols:{in:[[9,7,9],[9,8,8],[2,6,1,3],[8,5,5,6],[9],[9]],out:[{symbol:7,count:8,win:5},{symbol:5,count:8,win:10}]},win:15},{symbols:{in:[[7,2],[5],[],[],[9,4,4],[8,8,9]],out:[{symbol:9,count:9,win:2.5}]},win:2.5},{symbols:{in:[[3],[6,4,6],[8],[9,9],[],[6,7]],out:[{symbol:8,count:9,win:4}]},win:4},{symbols:{in:[[8],[7],[],[],[6,8,8,6],[5,5]],out:[{symbol:4,count:8,win:10}]},win:10}]},{spinsLeft:1,area:[[8,8,3,10,4],[7,9,9,5,4],[5,5,7,7,7],[9,9,7,0,8],[6,6,6,8,8],[6,5,7,6,2]],totalWin:0,multipliers:[10],tumbles:[]}]}}};if(-104==this.gameData.debugged)return{playerId:"2",bet:"10",slot:{area:[[9,7,7,9,9],[9,9,1,8,8],[8,9,7,7,9],[6,3,3,6,6],[4,4,9,9,5],[7,7,9,9,8]],totalWin:226,tumbles:[{symbols:{in:[[8,5,5],[6,0],[8,7],[],[8,9],[0,8]],out:[{symbol:9,count:11,win:7.5}]},win:7.5},{symbols:{in:[[5],[8,7],[7,7],[],[5],[6,9]],out:[{symbol:8,count:8,win:4}]},win:4},{symbols:{in:[[7,5],[9],[5,5,8,8,2],[],[],[5,9]],out:[{symbol:7,count:10,win:10}]},win:10},{symbols:{in:[[7,7,6,6],[],[4,6],[],[0,7],[4]],out:[{symbol:5,count:9,win:10}]},win:10},{symbols:{in:[[4,4],[4],[9],[8,0,7],[],[7]],out:[{symbol:6,count:8,win:8}]},win:8}],freeSpin:{multiplierValue:10,items:[{spinsLeft:10,area:[[4,7,7,7,6],[8,8,2,0,7],[8,9,7,7,9],[3,6,3,3,6],[5,1,2,3,7],[8,4,4,4,3]],totalWin:0,multipliers:[],tumbles:[]},{spinsLeft:9,area:[[7,7,7,6,2],[9,9,8,8,9],[9,6,9,7,5],[7,0,8,9,4],[4,7,7,7,8],[9,9,8,8,6]],totalWin:16.5,multipliers:[],tumbles:[{symbols:{in:[[8,8,5],[4,5,9],[8,8,3],[7,5],[9,2,5],[9,9]],out:[{symbol:7,count:8,win:5},{symbol:9,count:8,win:2.5}]},win:7.5},{symbols:{in:[[8,8],[6,2],[8,2],[5],[2],[8,9]],out:[{symbol:8,count:10,win:9}]},win:9}]},{spinsLeft:8,area:[[5,7,7,6,6],[8,8,2,0,7],[9,0,2,4,4],[6,9,9,9,8],[3,7,0,9,4],[9,6,6,1,9]],totalWin:0,multipliers:[],tumbles:[]},{spinsLeft:12,area:[[9,11,7,7,9],[1,8,8,2,0],[9,7,8,8,9],[12,9,2,4,4],[7,9,9,5,5],[5,7,6,6,4]],totalWin:0,multipliers:[12,11],tumbles:[]},{spinsLeft:11,area:[[5,8,8,9,11],[9,5,5,6,8],[5,5,8,8,9],[6,6,6,9,9],[4,9,9,5,5],[4,4,9,9,6]],totalWin:37.5,multipliers:[11],tumbles:[{symbols:{in:[[1],[4],[2],[5,8],[5,9],[9,3]],out:[{symbol:9,count:9,win:2.5}]},win:2.5},{symbols:{in:[[5],[4,6],[7,7],[5],[5,9,8],[]],out:[{symbol:5,count:9,win:10}]},win:10}]},{spinsLeft:10,area:[[8,8,3,4,9],[7,7,8,8,9],[5,7,7,7,9],[9,8,8,7,5],[1,9,7,9,9],[8,6,5,7,6]],totalWin:16.5,multipliers:[],tumbles:[{symbols:{in:[[],[9,6],[2,0,9],[8],[9],[7]],out:[{symbol:7,count:8,win:5}]},win:5},{symbols:{in:[[4,7,8],[5,7,9,6],[0,9],[6,3,3,6],[8,9,9,4],[5]],out:[{symbol:8,count:8,win:4},{symbol:9,count:10,win:7.5}]},win:11.5}]},{spinsLeft:9,area:[[5,7,6,8,8],[9,9,4,4,1],[4,9,9,7,8],[8,8,5,9,6],[6,6,5,5,1],[5,5,7,6,6]],totalWin:0,multipliers:[],tumbles:[]},{spinsLeft:8,area:[[9,5,7,6,8],[9,8,8,9,4],[3,3,14,1,6],[5,7,7,9,9],[8,4,4,9,9],[6,9,6,7,7]],totalWin:15,multipliers:[14],tumbles:[{symbols:{in:[[7],[2,8],[],[5,5],[8,8],[5]],out:[{symbol:9,count:8,win:2.5}]},win:2.5}]},{spinsLeft:7,area:[[8,9,11,7,7],[5,5,8,8,2],[7,9,6,7,6],[5,5,6,6,9],[2,9,6,6,5],[2,9,9,8,8]],totalWin:0,multipliers:[11],tumbles:[]},{spinsLeft:6,area:[[8,3,4,9,4],[4,4,1,3,10],[2,8,8,5,5],[5,4,6,12,9],[7,6,8,8,6],[4,9,9,6,6]],totalWin:0,multipliers:[12,10],tumbles:[]},{spinsLeft:5,area:[[11,7,7,9,9],[5,7,7,8,8],[8,8,5,5,7],[9,2,4,4,7],[8,8,9,5,2],[6,4,4,9,9]],totalWin:0,multipliers:[11],tumbles:[]},{spinsLeft:4,area:[[8,4,4,1,3],[6,6,9,9,4],[9,7,5,5,9],[8,5,9,6,5],[9,7,7,9,9],[8,8,6,9,6]],totalWin:2.5,multipliers:[],tumbles:[{symbols:{in:[[],[8,8],[5,4],[6],[9,1,6],[9]],out:[{symbol:9,count:9,win:2.5}]},win:2.5}]},{spinsLeft:3,area:[[7,8,8,7,4],[5,7,7,8,8],[7,7,7,9,9],[9,9,8,5,5],[9,9,3,3,6],[9,8,8,6,9]],totalWin:11.5,multipliers:[],tumbles:[{symbols:{in:[[],[],[3,9],[9,6],[8,8],[3,8]],out:[{symbol:9,count:8,win:2.5}]},win:2.5},{symbols:{in:[[2,9],[4,9],[],[8],[8,6],[9,4,4]],out:[{symbol:8,count:10,win:9}]},win:9}]},{spinsLeft:2,area:[[6,6,7,7,7],[7,9,9,5,4],[4,9,9,7,8],[3,6,3,3,6],[7,9,9,3,3],[7,8,8,9,15]],totalWin:0,multipliers:[15],tumbles:[]},{spinsLeft:1,area:[[6,2,8,8,3],[2,6,6,6,9],[0,2,4,4,9],[6,3,3,6,6],[8,9,5,2,9],[8,8,6,9,6]],totalWin:8,multipliers:[],tumbles:[{symbols:{in:[[5],[5,9,7],[],[6,3,3],[],[6,4]],out:[{symbol:6,count:9,win:8}]},win:8}]}]}}};if(-105==this.gameData.debugged)return{playerId:"2",bet:"10",slot:{area:[[5,5,8,8,9],[8,9,6,4,6],[1,6,2,8,8],[7,6,6,6,9],[5,0,2,9,6],[9,8,8,6,5]],totalWin:10.5,tumbles:[{symbols:{in:[[],[4,6],[9],[6,3,3],[9],[9]],out:[{symbol:6,count:8,win:8}]},win:8},{symbols:{in:[[1],[5],[7],[9],[5,9],[2,6]],out:[{symbol:9,count:8,win:2.5}]},win:2.5}],freeSpin:[]}};if(-106==this.gameData.debugged)return{playerId:"2",bet:"0.2",slot:{area:[[2,3,4,0,1],[5,7,8,0,6],[9,2,9,1,3],[4,2,9,1,3],[0,8,7,5,6],[2,3,0,9,1]],totalWin:18.290000000000006,tumbles:[],freeSpin:[{spinsLeft:10,area:[[8,8,7,4,7],[11,7,5,5,8],[4,4,9,6,6],[7,5,5,7,7],[7,9,9,5,5],[6,6,4,4,9]],totalWin:0,multipliers:[11],tumbles:[]},{spinsLeft:9,area:[[9,5,7,6,8],[2,6,6,9,9],[7,7,9,6,7],[8,8,5,9,6],[9,9,3,3,6],[7,7,8,8,9]],totalWin:.05,multipliers:[],tumbles:[{symbols:{in:[[7],[9,6],[4],[9],[8,9],[9]],out:[{symbol:9,count:8,win:.05}]},win:.05}]},{spinsLeft:8,area:[[4,7,7,7,6],[5,5,6,8,8],[6,3,8,8,5],[9,9,7,0,8],[6,7,6,8,8],[1,9,5,5,7]],totalWin:0,multipliers:[],tumbles:[]},{spinsLeft:7,area:[[4,4,1,3,3],[7,7,9,9,9],[7,9,6,7,6],[8,8,5,9,6],[8,6,6,6,8],[7,6,6,4,4]],totalWin:16.000000000000004,multipliers:[22],tumbles:[{symbols:{in:[[],[],[7,5],[9],[9,7,22],[4,8]],out:[{symbol:6,count:8,win:.16000000000000003}]},win:.16000000000000003}]},{spinsLeft:6,area:[[7,7,6,6,9],[7,8,8,9,6],[5,9,6,6,4],[4,6,9,2,4],[9,3,3,6,1],[8,8,9,7,6]],totalWin:.21000000000000002,multipliers:[],tumbles:[{symbols:{in:[[7,8],[5],[9,6],[8],[9],[9]],out:[{symbol:6,count:8,win:.16000000000000003}]},win:.16000000000000003},{symbols:{in:[[4],[9],[9,7],[7],[5,9],[9,9]],out:[{symbol:9,count:9,win:.05}]},win:.05}]},{spinsLeft:5,area:[[6,2,8,8,3],[3,9,5,5,7],[9,9,7,8,8],[8,5,5,6,6],[9,3,3,6,1],[7,6,2,9,9]],totalWin:0,multipliers:[],tumbles:[]},{spinsLeft:4,area:[[7,8,8,7,4],[5,8,8,2,6],[9,6,7,6,3],[5,5,7,7,9],[4,7,7,7,8],[4,4,4,3,3]],totalWin:1.1800000000000002,multipliers:[10],tumbles:[{symbols:{in:[[8,8],[],[2],[8,8],[4,9,7],[]],out:[{symbol:7,count:8,win:.1}]},win:.1},{symbols:{in:[[9,4,4,9],[8,8],[],[6,6],[3],[]],out:[{symbol:8,count:9,win:.08000000000000002}]},win:.08000000000000002},{symbols:{in:[[9,4,4],[],[],[],[9,1],[8,8,9]],out:[{symbol:4,count:8,win:.2}]},win:.2},{symbols:{in:[[7,6,6],[],[5],[9],[6,9],[10]],out:[{symbol:9,count:8,win:.05}]},win:.05},{symbols:{in:[[8,8],[6],[7,7],[4,2],[4],[]],out:[{symbol:6,count:8,win:.16000000000000003}]},win:.16000000000000003}]},{spinsLeft:3,area:[[8,9,7,7,9],[9,4,7,9,5],[6,9,7,5,5],[3,6,3,3,6],[2,3,14,22,7],[15,0,9,9,8]],totalWin:0,multipliers:[15,14,22],tumbles:[]},{spinsLeft:2,area:[[4,9,2,7,8],[7,9,9,5,4],[7,7,8,8,9],[0,8,9,4,4],[5,4,7,7,7],[6,7,7,7,9]],totalWin:.25,multipliers:[],tumbles:[{symbols:{in:[[4],[4],[6,9],[],[9,1,6],[1,6,6]],out:[{symbol:7,count:10,win:.2}]},win:.2},{symbols:{in:[[9],[9,7],[9,9],[8],[9],[5]],out:[{symbol:9,count:8,win:.05}]},win:.05}]},{spinsLeft:1,area:[[8,8,7,4,7],[6,4,6,9,9],[5,8,8,9,7],[6,6,9,9,1],[3,6,1,9,7],[8,8,3,10,15]],totalWin:0,multipliers:[10,15],tumbles:[]}]}};if(-1e3==this.gameData.debugged)return{playerId:"2",bet:"10",slot:{area:[[1,2,3,4,6],[2,3,4,6,5],[3,4,6,5,7],[4,6,5,7,8],[5,7,8,9,0],[0,0,0,0,0]],totalWin:21e4,tumbles:[],freeSpin:[{spinsLeft:1,area:[[10,1,1,1,1],[1,2,19,2,1],[2,2,2,22,2],[4,4,20,4,4],[4,11,2,2,4],[4,1,1,21,4]],totalWin:21e4,multipliers:[10,19,20,21,22,23],tumbles:[{win:1050,symbols:{in:[[1,2,3,4,5],[2,3,4,5,6],[3,4,5,6,7],[4,5,6,7,8],[5,6,7,8,9],[6,7,8,9,1]],out:[{symbol:1,count:8,win:525},{symbol:2,count:8,win:525},{symbol:3,count:8,win:0}]}}]}],maxWin:21e4}};if(-107==this.gameData.debugged)return{playerId:"2",bet:"0.2",slot:{area:[[4,4,6,6,9],[2,8,8,9,9],[4,4,7,7,9],[8,8,9,9,4],[8,5,5,9,9],[9,9,7,7,9]],totalWin:30,tumbles:[{symbols:{in:[[5],[5,5],[9],[6,6],[5,7],[9,1,1]],out:[{symbol:9,count:11,win:30}]},win:30}],freeSpin:{multiplierValue:0,items:[]}}};if(-108==this.gameData.debugged)return{playerId:"2",bet:"40",slot:{area:[[2,3,4,0,1],[0,7,6,8,5],[9,9,3,1,2],[2,4,3,9,1],[6,7,0,5,8],[9,2,0,3,1]],totalWin:2206,tumbles:[],freeSpin:{multiplierValue:10,items:[{spinsLeft:10,area:[[4,9,9,6,6],[8,6,6,7,7],[5,8,8,6,6],[8,6,6,9,9],[9,0,8,8,7],[7,7,6,6,9]],totalWin:74,multipliers:[],tumbles:[{symbols:{in:[[8,8],[1,1],[6,9],[5,5],[],[6,3]],out:[{symbol:6,count:10,win:48}]},win:48},{symbols:{in:[[7,2],[9],[8,8],[5],[9,2],[]],out:[{symbol:8,count:8,win:16}]},win:16},{symbols:{in:[[9,8],[4],[9],[0,3],[8,9],[7]],out:[{symbol:9,count:9,win:10}]},win:10}]},{spinsLeft:9,area:[[8,7,7,4,4],[5,5,7,7,4],[4,4,8,8,9],[8,5,5,9,9],[9,0,8,8,7],[5,5,8,8,9]],totalWin:308,multipliers:[],tumbles:[{symbols:{in:[[9],[],[7,7],[7],[7,9],[8,8]],out:[{symbol:8,count:8,win:16}]},win:16},{symbols:{in:[[9,6],[7,7],[9,9],[2],[9,2],[]],out:[{symbol:7,count:9,win:20}]},win:20},{symbols:{in:[[9,9],[],[8,8,5],[5,8],[8,5,5],[8]],out:[{symbol:9,count:11,win:30}]},win:30},{symbols:{in:[[],[7,5],[3],[9,9,8],[7,8],[8,8]],out:[{symbol:5,count:10,win:60}]},win:60},{symbols:{in:[[],[],[9,9],[8,7],[9,9],[7,7,9,9,8]],out:[{symbol:8,count:11,win:36}]},win:36},{symbols:{in:[[7,7],[],[8,4],[8,8],[4,4],[5,7]],out:[{symbol:9,count:10,win:30}]},win:30},{symbols:{in:[[6,4,4,7],[9,8,8,5],[6,6,9],[6],[3,8,8],[1,8,8]],out:[{symbol:7,count:10,win:40},{symbol:4,count:8,win:40}]},win:80},{symbols:{in:[[],[2,2],[9],[4,4,8],[6,6],[8,8,5]],out:[{symbol:8,count:11,win:36}]},win:36}]},{spinsLeft:8,area:[[5,8,8,7,7],[9,0,3,3,7],[7,3,3,9,9],[8,4,4,7,7],[0,8,8,7,7],[8,0,7,7,5]],totalWin:840,multipliers:[18],tumbles:[{symbols:{in:[[6,6],[4],[4],[5,5],[8,5],[8,8]],out:[{symbol:7,count:10,win:40}]},win:40},{symbols:{in:[[3,18],[],[],[9],[7,7,9],[6,8,8]],out:[{symbol:8,count:9,win:16}]},win:16}]},{spinsLeft:12,area:[[6,6,8,8,9],[7,4,4,9,9],[4,4,2,2,7],[7,11,9,9,5],[5,9,9,8,8],[9,7,7,9,9]],totalWin:90,multipliers:[11],tumbles:[{symbols:{in:[[9],[5,9],[],[8,8],[4,9],[9,9,5]],out:[{symbol:9,count:10,win:30}]},win:30}]},{spinsLeft:11,area:[[6,9,9,2,2],[6,1,1,8,8],[5,9,9,4,4],[8,8,6,6,9],[8,5,5,9,9],[4,9,9,8,8]],totalWin:86,multipliers:[],tumbles:[{symbols:{in:[[8,5],[],[5,5],[9],[8,8],[7,9]],out:[{symbol:9,count:9,win:10}]},win:10},{symbols:{in:[[7],[7,5],[],[7,7],[5,5,7],[6,6]],out:[{symbol:8,count:10,win:36}]},win:36},{symbols:{in:[[3],[6],[7,2,2],[],[9,2,2,8],[]],out:[{symbol:5,count:9,win:40}]},win:40}]},{spinsLeft:10,area:[[5,5,8,8,7],[9,5,5,8,8],[8,6,6,3,3],[8,8,9,9,4],[9,9,7,7,4],[7,7,8,8,1]],totalWin:16,multipliers:[],tumbles:[{symbols:{in:[[8,4],[9,4],[8],[6,6],[],[6,6]],out:[{symbol:8,count:9,win:16}]},win:16}]},{spinsLeft:9,area:[[4,8,8,0,9],[6,6,1,1,8],[7,7,9,9,5],[5,9,9,6,6],[9,9,8,8,7],[7,5,5,9,9]],totalWin:10,multipliers:[],tumbles:[{symbols:{in:[[5],[],[7,8],[9,9],[9,9],[9,4]],out:[{symbol:9,count:9,win:10}]},win:10}]},{spinsLeft:8,area:[[9,9,3,3,7],[9,9,8,8,6],[8,9,9,7,7],[0,8,8,9,9],[8,7,7,3,3],[7,7,8,8,1]],totalWin:46,multipliers:[],tumbles:[{symbols:{in:[[7,7],[9,9,6,6],[0,2,4],[9,1,1,9],[5],[9,5]],out:[{symbol:9,count:8,win:10},{symbol:8,count:8,win:16}]},win:26},{symbols:{in:[[1,1,9],[],[8,6],[],[3,3],[8,9]],out:[{symbol:7,count:9,win:20}]},win:20}]},{spinsLeft:7,area:[[3,6,6,8,8],[10,3,3,7,7],[1,5,5,9,9],[5,5,8,8,6],[9,0,8,8,7],[8,8,9,9,4]],totalWin:32,multipliers:[10],tumbles:[{symbols:{in:[[9,6],[],[],[5,5],[7,7],[7,9]],out:[{symbol:8,count:8,win:16}]},win:16}]},{spinsLeft:6,area:[[8,7,7,4,4],[8,8,6,6,7],[9,9,7,7,6],[5,8,8,6,6],[9,4,4,8,8],[5,9,9,8,8]],totalWin:16,multipliers:[],tumbles:[{symbols:{in:[[7],[7,3],[],[4,8],[4,4],[8,8]],out:[{symbol:8,count:9,win:16}]},win:16}]},{spinsLeft:5,area:[[6,5,5,8,8],[6,6,1,1,8],[5,5,8,8,6],[9,6,6,8,8],[8,8,9,9,7],[9,4,4,8,8]],totalWin:36,multipliers:[],tumbles:[{symbols:{in:[[6,4],[1],[2,2],[9,1],[1,1],[9,9]],out:[{symbol:8,count:11,win:36}]},win:36}]},{spinsLeft:4,area:[[0,9,9,3,3],[7,2,2,8,8],[2,2,7,7,9],[9,6,6,8,8],[9,0,8,8,7],[5,5,6,6,8]],totalWin:0,multipliers:[],tumbles:[]},{spinsLeft:3,area:[[6,8,8,9,9],[4,4,9,9,6],[9,7,7,6,6],[5,5,2,2,9],[9,6,6,1,1],[9,8,8,0,7]],totalWin:42,multipliers:[],tumbles:[{symbols:{in:[[3,3],[6,8],[9],[6],[9],[7]],out:[{symbol:9,count:8,win:10}]},win:10},{symbols:{in:[[9],[7,6],[8,8],[5],[7,9],[]],out:[{symbol:6,count:8,win:32}]},win:32}]},{spinsLeft:2,area:[[9,1,1,5,5],[9,9,6,6,1],[5,5,9,9,11],[3,3,0,8,8],[5,8,8,7,7],[7,4,4,9,9]],totalWin:0,multipliers:[11],tumbles:[]},{spinsLeft:1,area:[[2,2,7,7,5],[6,6,7,7,2],[5,5,9,9,12],[9,7,7,11,9],[7,7,5,5,8],[5,9,9,7,7]],totalWin:490,multipliers:[12,11],tumbles:[{symbols:{in:[[8,8],[6,9],[],[8,9],[9,5],[9,9]],out:[{symbol:7,count:10,win:40}]},win:40},{symbols:{in:[[],[6],[4,0],[8,0,3],[7],[9,1,1,8]],out:[{symbol:9,count:11,win:30}]},win:30}]}]}}}}if(400===s.status){try{r.emitter.emit(r.SESSION_TIMEOUT,{})}catch(a){}throw new Error(`HTTP error! status: ${s.status}`)}if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const n=await s.json();if(n&&400===n.statusCode){try{r.emitter.emit(r.SESSION_TIMEOUT,{})}catch(a){}throw new Error("HTTP error! status: 400")}return console.log(E.gray("[API] doSpin response data:"),n),n}catch(o){throw console.error(o),o}}async getHistory(t,e){const i=`${Us()}/api/v1/games/me/histories`,s=await fetch(`${i}?limit=${e}&page=${t}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("gameToken")}`}});return await s.json()}}class zs{constructor(){s(this,"container",null),s(this,"isVisible",!1),s(this,"isMobile",!1)}isMobileDevice(){const t=new URLSearchParams(window.location.search);return"mobile"==t.get("device")||"desktop"!=t.get("device")&&(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768)}preload(t){}create(t){this.isMobile=this.isMobileDevice();const e=t.scale.width,i=t.scale.height;this.container=t.add.container(0,0),this.container.setDepth(1e4),this.container.setVisible(!1);const s=t.add.graphics();s.name="sessionTimeoutMask",s.fillStyle(0,.8),s.fillRect(0,0,e,i),s.setInteractive(new a.Geom.Rectangle(0,0,e,i),a.Geom.Rectangle.Contains),this.container.add(s);const n=Math.min(.9*e,this.isMobile?.9*e:720),o=Math.min(.6*i,this.isMobile?.5*i:360),l=(e-n)/2,h=(i-o)/2,c=t.add.graphics();c.fillStyle(2236962,.95),c.fillRoundedRect(l,h,n,o,12),c.lineStyle(2,3642711,1),c.strokeRoundedRect(l,h,n,o,12),this.container.add(c);const d=t.add.text(e/2,h+.3*o,"SESSION TIMEOUT",{fontSize:this.isMobile?"28px":"36px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold",align:"center"});d.setOrigin(.5,.5),this.container.add(d);const u=t.add.text(e/2,h+.5*o,"Please refresh the game to continue.",{fontSize:this.isMobile?"18px":"22px",color:"#FFFFFF",fontFamily:"Poppins",align:"center",wordWrap:{width:.9*n}});u.setOrigin(.5,.5),this.container.add(u);const m=this.isMobile?.6*n:260,g=this.isMobile?48:56,p=e/2-m/2,b=h+.7*o-g/2,f=t.add.graphics();f.fillStyle(4046438,1),f.fillRoundedRect(p,b,m,g,8),f.lineStyle(2,2849350,1),f.strokeRoundedRect(p,b,m,g,8),this.container.add(f);const y=t.add.text(e/2,b+g/2,"Refresh",{fontSize:this.isMobile?"20px":"24px",color:"#000000",fontFamily:"Poppins",fontStyle:"bold",align:"center"});y.setOrigin(.5,.5),this.container.add(y);const w=t.add.zone(p,b,m,g);w.setOrigin(0,0),w.setInteractive(new a.Geom.Rectangle(0,0,m,g),a.Geom.Rectangle.Contains),w.on("pointerdown",(()=>{try{window.location.reload()}catch(t){}})),this.container.add(w),r.emitter.on(r.SESSION_TIMEOUT,(()=>{this.show(t),this.freezeGame(t)}))}show(t){this.container&&!this.isVisible&&(this.isVisible=!0,this.container.setVisible(!0),this.container.alpha=1)}hide(t){this.container&&this.isVisible&&t.tweens.add({targets:this.container,alpha:0,duration:150,ease:"Cubic.easeIn",onComplete:()=>{this.container.setVisible(!1),this.isVisible=!1}})}destroy(){this.container&&(this.container.destroy(),this.container=null),this.isVisible=!1}freezeGame(t){try{t.tweens&&t.tweens.pauseAll(),t.time&&(t.time.timeScale=0),t.sound&&t.sound.pauseAll()}catch(e){}}}class qs{constructor(){s(this,"container",null),s(this,"isVisible",!1),s(this,"isMobile",!1)}preload(t){}isMobileDevice(){const t=new URLSearchParams(window.location.search);return"mobile"==t.get("device")||"desktop"!=t.get("device")&&(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768)}create(t){if(this.isMobile=this.isMobileDevice(),this.container)return;const e=t.scale.width,i=t.scale.height;this.container=t.add.container(0,0),this.container.setDepth(1e4),this.container.setVisible(!1);const s=t.add.graphics();s.name="insufficientBalanceMask",s.fillStyle(0,.8),s.fillRect(0,0,e,i),s.setInteractive(new a.Geom.Rectangle(0,0,e,i),a.Geom.Rectangle.Contains),this.container.add(s);const n=Math.min(.9*e,this.isMobile?.9*e:560),o=Math.min(.5*i,this.isMobile?.45*i:240),l=(e-n)/2,h=(i-o)/2,c=t.add.graphics();c.fillStyle(2236962,.95),c.fillRoundedRect(l,h,n,o,12),c.lineStyle(2,3642711,1),c.strokeRoundedRect(l,h,n,o,12),this.container.add(c);const d=t.add.text(e/2,h+.33*o,"Out of Balance",{fontSize:this.isMobile?"24px":"32px",color:"#FFFFFF",fontFamily:"Poppins",fontStyle:"bold",align:"center"});d.setOrigin(.5,.5),this.container.add(d);const u=t.add.text(e/2,h+.53*o,"Insufficient Funds",{fontSize:this.isMobile?"16px":"20px",color:"#FFFFFF",fontFamily:"Poppins",align:"center",wordWrap:{width:.9*n}});u.setOrigin(.5,.5),this.container.add(u);const m=this.isMobile?.55*n:220,g=this.isMobile?44:52,p=e/2-m/2,b=h+.75*o-g/2,f=t.add.graphics();f.fillStyle(4046438,1),f.fillRoundedRect(p,b,m,g,8),f.lineStyle(2,2849350,1),f.strokeRoundedRect(p,b,m,g,8),this.container.add(f);const y=t.add.text(e/2,b+g/2,"CLOSE",{fontSize:this.isMobile?"18px":"22px",color:"#000000",fontFamily:"Poppins",fontStyle:"bold",align:"center"});y.setOrigin(.5,.5),this.container.add(y);const w=t.add.zone(p,b,m,g);w.setOrigin(0,0),w.setInteractive(new a.Geom.Rectangle(0,0,m,g),a.Geom.Rectangle.Contains),w.on("pointerdown",(()=>{console.log("[UI] InsufficientBalancePopup OK clicked"),this.hide(t)})),this.container.add(w),r.emitter.on(r.SHOW_INSUFFICIENT_BALANCE,(()=>{this.show(t)}))}show(t){this.container&&!this.isVisible&&(this.isVisible=!0,this.container.setVisible(!0),this.container.alpha=1,console.log("[UI] Showing InsufficientBalancePopup"))}hide(t){this.container&&this.isVisible&&t.tweens.add({targets:this.container,alpha:0,duration:150,ease:"Cubic.easeIn",onComplete:()=>{this.container.setVisible(!1),this.isVisible=!1}})}destroy(){this.container&&(this.container.destroy(),this.container=null),this.isVisible=!1}}class js extends a.Scene{constructor(){super("Game"),s(this,"stateMachine"),s(this,"gameData"),s(this,"background"),s(this,"slotMachine"),s(this,"character"),s(this,"buttons"),s(this,"audioManager"),s(this,"autoplay"),s(this,"helpScreen"),s(this,"gameAPI"),s(this,"buyFeaturePopup"),s(this,"sessionTimeoutPopup"),s(this,"insufficientBalancePopup"),s(this,"components"),this.stateMachine=new o,this.gameAPI={},this.gameData=new R(this.gameAPI),this.gameAPI=new $s(this.gameData),this.background=new D,this.slotMachine=new Ds,this.character=new _s,this.buttons=new Ys,this.audioManager=new Xs,this.autoplay=new Gs,this.helpScreen=new Ws,this.buyFeaturePopup=new ks,this.sessionTimeoutPopup=new zs,this.insufficientBalancePopup=new qs,this.buttons.autoplay=this.autoplay,this.components=[this.background,this.slotMachine,this.character,this.buttons,this.audioManager,this.autoplay,this.helpScreen,this.buyFeaturePopup,this.sessionTimeoutPopup,this.insufficientBalancePopup]}preload(){try{for(const t of this.components)t.preload&&t.preload(this)}catch(t){console.error("Error during preload:",t)}}create(){try{this.gameData.debugLog("Game scene created"),this.gameData.debugLog("Current bet:",this.gameData.bet),this.gameData.debugLog("Current balance:",this.gameData.balance),this.stateMachine.setState(new Rs,this);for(const t of this.components)t.create&&t.create(this);this.initFadeIn()}catch(t){console.error("Error during create:",t)}}initFadeIn(){const t=this.add.rectangle(this.cameras.main.centerX,this.cameras.main.centerY,this.cameras.main.width,this.cameras.main.height,0);t.setDepth(9999),this.tweens.add({targets:t,alpha:0,duration:1e3,ease:"Circ.easeInOut",onComplete:()=>{t.destroy()}})}update(t,e){try{this.gameData.debugged>0&&t%1e3<16&&this.gameData.debugLog("Game update - isSpinning:",this.gameData.isSpinning),this.stateMachine.update(this,t,e);for(const i of this.components)i.update&&i.update(this,t,e)}catch(i){console.error("Error during update:",i)}}shutdown(){try{for(const t of this.components)t.destroy&&t.destroy();this.autoplay.isAutoPlaying&&this.autoplay.stop(),this.components=[]}catch(t){console.error("Error during shutdown:",t)}}showHelpScreen(){this.helpScreen.show(this)}hideHelpScreen(){this.helpScreen.hide(this)}}let Qs=null;document.addEventListener("visibilitychange",(()=>{"visible"!==document.visibilityState||Qs?"visible"!==document.visibilityState&&Qs&&async function(){var t;try{await(null==(t=null==Qs?void 0:Qs.release)?void 0:t.call(Qs))}catch(e){}Qs=null}():async function(){if("wakeLock"in navigator)try{Qs=await navigator.wakeLock.request("screen"),Qs.addEventListener("release",(()=>{Qs=null}))}catch(t){}}()}));class Zs extends a.Scene{constructor(){super("LandingPage"),s(this,"spinButton"),s(this,"notificationText"),s(this,"isRotating",!1),s(this,"pressed",!1),s(this,"isTransitioning",!1),s(this,"isMobile",!1),s(this,"fsButton",null),s(this,"onEnterFs"),s(this,"onLeaveFs"),s(this,"onDomFsChange"),s(this,"onResize")}preload(){this.load.image("logostart","assets/Logo/Logo.png"),this.load.image("background_desktop","assets/background/preloader_desktop.png"),this.load.image("background_mobile","assets/background/preloader_mobile.png"),this.load.image("spinButton","assets/Controllers/Spin.png"),this.load.image("gameTemplateBackground","assets/background/Main_Background.png"),this.load.image("fs_max","assets/Controllers/Maximize.png"),this.load.image("fs_min","assets/Controllers/Minimize.png")}create(){console.log(this.cameras.main.width,this.cameras.main.height),(()=>{const t=(()=>{if("undefined"==typeof document)return!1;const t=document.createElement("div");t.style.fontFamily="Poppins",t.style.position="absolute",t.style.left="-9999px",t.style.fontSize="16px",t.innerHTML="Test",document.body.appendChild(t);const e=t.offsetWidth;document.body.removeChild(t);const i=document.createElement("div");i.style.fontFamily="Arial",i.style.position="absolute",i.style.left="-9999px",i.style.fontSize="16px",i.innerHTML="Test",document.body.appendChild(i);const s=i.offsetWidth;return document.body.removeChild(i),e!==s})();console.log(`Poppins font ${t?"is":"is not"} loaded`)})(),this.isMobile=this.isMobileDevice();const t=this.isMobile?"background_mobile":"background_desktop";this.add.image(this.cameras.main.width/2,this.cameras.main.height/2,t).setOrigin(.5);const e=this.isMobile?10:12,i=this.isMobile?28:32,s=this.scale.isFullscreen?"fs_min":"fs_max",n=this.add.image(this.cameras.main.width-e,e,s);n.setOrigin(1,0),n.setDisplaySize(i,i),n.setDepth(1e3),n.setInteractive({useHandCursor:!0}),this.fsButton=n,n.on("pointerup",(()=>{var t,e,i,s;try{if(this.scale.isFullscreen){const i=null==(e=(t=this.scale).stopFullscreen)?void 0:e.call(t);i&&"function"==typeof i.catch&&i.catch((()=>{}))}else{const t=null==(s=(i=this.scale).startFullscreen)?void 0:s.call(i);t&&"function"==typeof t.catch&&t.catch((()=>{}))}}catch(n){}}));const a=()=>{const t=this.fsButton;if(!t||!t.scene||!t.scene.sys)return;const e=this.scale.isFullscreen?"fs_min":"fs_max";this.textures&&this.textures.exists(e)&&t.setTexture(e)};this.onEnterFs=a,this.onLeaveFs=a,this.scale.on("enterfullscreen",this.onEnterFs),this.scale.on("leavefullscreen",this.onLeaveFs),this.onDomFsChange=a,document.addEventListener("fullscreenchange",this.onDomFsChange),document.addEventListener("webkitfullscreenchange",this.onDomFsChange),this.onResize=()=>{const t=e;this.fsButton&&this.fsButton.setPosition(this.cameras.main.width-t,t)},this.scale.on("resize",this.onResize),this.events.once("shutdown",(()=>this.cleanupFullscreenHandlers())),this.events.once("destroy",(()=>this.cleanupFullscreenHandlers()));const o=this.isMobile?.25:.4,r=this.isMobile?this.cameras.main.width/2:600,l=this.isMobile?.2*this.cameras.main.height:150;this.add.image(r,l,"logostart").setScale(o);const h=this.isMobile?this.cameras.main.width/2:this.cameras.main.width/4,c=this.isMobile?.7*this.cameras.main.height:.8*this.cameras.main.height,d=this.isMobile?"32px":"48px";this.add.text(h,c,"Win up to 21,000x",{fontSize:d,color:"#ffffff",fontStyle:"bold",fontFamily:"'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif",stroke:"#379557",strokeThickness:this.isMobile?4:8,shadow:{offsetX:this.isMobile?1:2,offsetY:this.isMobile?4:8,color:"#000000",blur:0,fill:!0}}).setOrigin(.5);const u=this.isMobile?.25*this.cameras.main.width:.72*this.cameras.main.width,m=this.isMobile?.88*this.cameras.main.height:.6*this.cameras.main.height,g=this.isMobile?"18px":"24px";this.notificationText=this.add.text(u,m,"Press Play To Continue",{fontSize:g,color:"#ffffff",fontStyle:"bold",fontFamily:"'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif",stroke:"#379557"}).setAlpha(0);const p=this.isMobile?this.cameras.main.width/2:.8*this.cameras.main.width,b=this.isMobile?.8*this.cameras.main.height:.425*this.cameras.main.height,f=this.isMobile?.4:1;this.spinButton=this.add.image(p,b,"spinButton").setScale(f),this.spinButton.setAlpha(.5),this.startIdleRotation(),this.spinButton.setInteractive({useHandCursor:!0}),this.spinButton.on("pointerdown",(()=>{if(1==this.spinButton.alpha){if(this.scene.get("LoadingPage").hideLoadingBar(),this.isTransitioning)return;this.isTransitioning=!0,this.cameras.main.fadeOut(1e3,0,0,0),this.cameras.main.once("camerafadeoutcomplete",(()=>{this.scene.start("Game"),this.scene.remove("LoadingPage")}))}}));const y="undefined"!=typeof window&&window.APP_CONFIG?window.APP_CONFIG.version:void 0;let w=null!=y?y:"1.4.0";w&&!w.startsWith("v")&&(w=`v${w}`),this.add.text(this.cameras.main.width-10,this.cameras.main.height-10,w,{fontSize:this.isMobile?"12px":"14px",color:"#ffffff",fontFamily:"'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif",stroke:"#000000",strokeThickness:2}).setOrigin(1,1).setAlpha(.2),this.scene.launch("LoadingPage")}cleanupFullscreenHandlers(){this.onEnterFs&&this.scale.off("enterfullscreen",this.onEnterFs),this.onLeaveFs&&this.scale.off("leavefullscreen",this.onLeaveFs),this.onResize&&this.scale.off("resize",this.onResize),this.onDomFsChange&&(document.removeEventListener("fullscreenchange",this.onDomFsChange),document.removeEventListener("webkitfullscreenchange",this.onDomFsChange)),this.onEnterFs=void 0,this.onLeaveFs=void 0,this.onResize=void 0,this.onDomFsChange=void 0,this.fsButton&&(this.fsButton.destroy(),this.fsButton=null)}isMobileDevice(){const t=new URLSearchParams(window.location.search);return"mobile"==t.get("device")||"desktop"!=t.get("device")&&(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768)}startIdleRotation(){this.isRotating||(this.isRotating=!0,this.tweens.add({targets:this.spinButton,angle:360,duration:12e3,ease:"Linear",repeat:-1}))}doneLoading(){var t,e;this.spinButton.setAlpha(1),this.notificationText.setAlpha(1);try{null==(e=(t=this.scene.get("LoadingPage")).loadDeferredAudio)||e.call(t)}catch(a){}const i=new $s(this.gameData);let s=0;const n=async()=>{try{await i.gameLauncher(),this.spinButton.setAlpha(1)}catch(t){console.error(`Failed to launch game (attempt ${s+1}):`,t),s<50?(s++,await n()):(console.error("Max retries reached, game launch failed"),this.spinButton.setAlpha(.75))}};n()}}Phaser.Scene;class Ks extends a.Scene{constructor(){super("LoadingPage"),s(this,"loadingBar"),s(this,"progressText"),s(this,"width",310),s(this,"barX",0),s(this,"barY",0),s(this,"isMobile",!1),s(this,"stateMachine"),s(this,"gameData"),s(this,"background"),s(this,"slotMachine"),s(this,"character"),s(this,"buttons"),s(this,"audioManager"),s(this,"autoplay"),s(this,"helpScreen"),s(this,"components"),s(this,"deferAudio",!0),this.stateMachine=new o,this.background=new D,this.slotMachine=new Ds,this.character=new _s,this.buttons=new Ys,this.audioManager=new Xs,this.autoplay=new Gs,this.helpScreen=new Ws,this.components=[this.background,this.slotMachine,this.character,this.buttons,this.audioManager,this.autoplay,this.helpScreen]}preload(){this.isMobile=this.isMobileDevice();try{this.load.maxParallelDownloads=this.isMobile?4:8}catch(t){}this.createLoadingBar();try{for(const t of this.components)if(t.preload){if(this.deferAudio&&t instanceof Xs)continue;t.preload(this)}}catch(e){console.error("Error during preload:",e)}}create(){this.scene.get("LandingPage").doneLoading()}hideLoadingBar(){this.loadingBar.destroy(),this.progressText.destroy()}isMobileDevice(){const t=new URLSearchParams(window.location.search);return"mobile"==t.get("device")||"desktop"!=t.get("device")&&(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768)}createLoadingBar(){const t=this.isMobile?30:40,e=this.isMobile?22:30,i=this.isMobile?12:16,s=this.isMobile?200:310,n=this.isMobile?"18px":"24px";this.isMobile?(this.barX=this.cameras.main.centerX-s/2,this.barY=this.cameras.main.centerY+2*s):(this.barX=this.cameras.main.centerX+this.width+100,this.barY=this.cameras.main.centerY+160),this.loadingBar=this.add.graphics(),this.loadingBar.fillStyle(2236962,.8),this.loadingBar.fillRoundedRect(this.barX,this.barY,s,t,i),this.loadingBar.fillStyle(5025616,1),this.loadingBar.fillRoundedRect(this.barX,this.barY,0,e,i),this.loadingBar.setAlpha(0),this.progressText=this.add.text(this.barX+s/2,this.barY+t/2-3,"0%",{fontSize:n,color:"#ffffff",fontStyle:"bold",fontFamily:"'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif"}).setOrigin(.5),this.load.on("progress",(n=>{n>.1&&this.loadingBar.setAlpha(1),this.loadingBar.clear(),this.loadingBar.fillStyle(2236962,.8),this.loadingBar.fillRoundedRect(this.barX-5,this.barY-5,s+10,t,i),this.loadingBar.fillStyle(5025616,1),this.loadingBar.fillRoundedRect(this.barX,this.barY,s*n,e,i),this.progressText.setText(`${Math.floor(100*n)}%`)})),this.load.on("complete",(()=>{this.loadingBar.clear(),this.loadingBar.fillStyle(2236962,.8),this.loadingBar.fillRoundedRect(this.barX-5,this.barY-5,s+10,t,i),this.loadingBar.fillStyle(5025616,1),this.loadingBar.fillRoundedRect(this.barX,this.barY,s,e,i),this.progressText.setText("100%")}))}loadDeferredAudio(){var t,e;if(this.deferAudio)try{this.audioManager.preload(this),null==(e=(t=this.load).start)||e.call(t),this.deferAudio=!1}catch(i){console.error("Deferred audio load failed:",i)}}}if("undefined"!=typeof window&&window.Phaser){let t=window.require;window.require=e=>t?t(e):"Phaser"===e?window.Phaser:void 0}class Js{constructor(t,e={alpha:"true"}){if(s(this,"canvas"),s(this,"gl"),s(this,"restorables",new Array),t instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext)this.gl=t,this.canvas=this.gl.canvas;else{let i=t;this.gl=i.getContext("webgl2",e)||i.getContext("webgl",e),this.canvas=i,i.addEventListener("webglcontextlost",(t=>{t&&t.preventDefault()})),i.addEventListener("webglcontextrestored",(t=>{for(let e=0,i=this.restorables.length;e<i;e++)this.restorables[e].restore()}))}}addRestorable(t){this.restorables.push(t)}removeRestorable(t){let e=this.restorables.indexOf(t);e>-1&&this.restorables.splice(e,1)}}const tn=class t extends Ie{constructor(t,e,i=!1){super(e),s(this,"context"),s(this,"texture",null),s(this,"boundUnit",0),s(this,"useMipMaps",!1),this.context=t instanceof Js?t:new Js(t),this.useMipMaps=i,this.restore(),this.context.addRestorable(this)}setFilters(e,i){let s=this.context.gl;this.bind(),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,t.validateMagFilter(i)),this.useMipMaps=t.usesMipMaps(e),this.useMipMaps&&s.generateMipmap(s.TEXTURE_2D)}static validateMagFilter(t){switch(t){case Ee.MipMapLinearLinear:case Ee.MipMapLinearNearest:case Ee.MipMapNearestLinear:case Ee.MipMapNearestNearest:return Ee.Linear;default:return t}}static usesMipMaps(t){switch(t){case Ee.MipMapLinearLinear:case Ee.MipMapLinearNearest:case Ee.MipMapNearestLinear:case Ee.MipMapNearestNearest:return!0;default:return!1}}setWraps(t,e){let i=this.context.gl;this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,e)}update(t){let e=this.context.gl;this.texture||(this.texture=this.context.gl.createTexture()),this.bind(),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._image),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR_MIPMAP_LINEAR:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t&&e.generateMipmap(e.TEXTURE_2D)}restore(){this.texture=null,this.update(this.useMipMaps)}bind(t=0){let e=this.context.gl;this.boundUnit=t,e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this.texture)}unbind(){let t=this.context.gl;t.activeTexture(t.TEXTURE0+this.boundUnit),t.bindTexture(t.TEXTURE_2D,null)}dispose(){this.context.removeRestorable(this),this.context.gl.deleteTexture(this.texture)}};s(tn,"DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL",!1);let en=tn;class sn{constructor(t=0,e=0,i=0){s(this,"x",0),s(this,"y",0),s(this,"z",0),this.x=t,this.y=e,this.z=i}setFrom(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}set(t,e,i){return this.x=t,this.y=e,this.z=i,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}scale(t){return this.x*=t,this.y*=t,this.z*=t,this}normalize(){let t=this.length();return 0==t||(t=1/t,this.x*=t,this.y*=t,this.z*=t),this}cross(t){return this.set(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}multiply(t){let e=t.values;return this.set(this.x*e[nn]+this.y*e[an]+this.z*e[on]+e[rn],this.x*e[ln]+this.y*e[hn]+this.z*e[cn]+e[dn],this.x*e[un]+this.y*e[mn]+this.z*e[gn]+e[pn])}project(t){let e=t.values,i=1/(this.x*e[bn]+this.y*e[fn]+this.z*e[yn]+e[wn]);return this.set((this.x*e[nn]+this.y*e[an]+this.z*e[on]+e[rn])*i,(this.x*e[ln]+this.y*e[hn]+this.z*e[cn]+e[dn])*i,(this.x*e[un]+this.y*e[mn]+this.z*e[gn]+e[pn])*i)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}distance(t){let e=t.x-this.x,i=t.y-this.y,s=t.z-this.z;return Math.sqrt(e*e+i*i+s*s)}}const nn=0,an=4,on=8,rn=12,ln=1,hn=5,cn=9,dn=13,un=2,mn=6,gn=10,pn=14,bn=3,fn=7,yn=11,wn=15,Sn=class t{constructor(){s(this,"temp",new Float32Array(16)),s(this,"values",new Float32Array(16));let t=this.values;t[nn]=1,t[hn]=1,t[gn]=1,t[wn]=1}set(t){return this.values.set(t),this}transpose(){let t=this.temp,e=this.values;return t[nn]=e[nn],t[an]=e[ln],t[on]=e[un],t[rn]=e[bn],t[ln]=e[an],t[hn]=e[hn],t[cn]=e[mn],t[dn]=e[fn],t[un]=e[on],t[mn]=e[cn],t[gn]=e[gn],t[pn]=e[yn],t[bn]=e[rn],t[fn]=e[dn],t[yn]=e[pn],t[wn]=e[wn],this.set(t)}identity(){let t=this.values;return t[nn]=1,t[an]=0,t[on]=0,t[rn]=0,t[ln]=0,t[hn]=1,t[cn]=0,t[dn]=0,t[un]=0,t[mn]=0,t[gn]=1,t[pn]=0,t[bn]=0,t[fn]=0,t[yn]=0,t[wn]=1,this}invert(){let t=this.values,e=this.temp,i=t[bn]*t[mn]*t[cn]*t[rn]-t[un]*t[fn]*t[cn]*t[rn]-t[bn]*t[hn]*t[gn]*t[rn]+t[ln]*t[fn]*t[gn]*t[rn]+t[un]*t[hn]*t[yn]*t[rn]-t[ln]*t[mn]*t[yn]*t[rn]-t[bn]*t[mn]*t[on]*t[dn]+t[un]*t[fn]*t[on]*t[dn]+t[bn]*t[an]*t[gn]*t[dn]-t[nn]*t[fn]*t[gn]*t[dn]-t[un]*t[an]*t[yn]*t[dn]+t[nn]*t[mn]*t[yn]*t[dn]+t[bn]*t[hn]*t[on]*t[pn]-t[ln]*t[fn]*t[on]*t[pn]-t[bn]*t[an]*t[cn]*t[pn]+t[nn]*t[fn]*t[cn]*t[pn]+t[ln]*t[an]*t[yn]*t[pn]-t[nn]*t[hn]*t[yn]*t[pn]-t[un]*t[hn]*t[on]*t[wn]+t[ln]*t[mn]*t[on]*t[wn]+t[un]*t[an]*t[cn]*t[wn]-t[nn]*t[mn]*t[cn]*t[wn]-t[ln]*t[an]*t[gn]*t[wn]+t[nn]*t[hn]*t[gn]*t[wn];if(0==i)throw new Error("non-invertible matrix");let s=1/i;return e[nn]=t[cn]*t[pn]*t[fn]-t[dn]*t[gn]*t[fn]+t[dn]*t[mn]*t[yn]-t[hn]*t[pn]*t[yn]-t[cn]*t[mn]*t[wn]+t[hn]*t[gn]*t[wn],e[an]=t[rn]*t[gn]*t[fn]-t[on]*t[pn]*t[fn]-t[rn]*t[mn]*t[yn]+t[an]*t[pn]*t[yn]+t[on]*t[mn]*t[wn]-t[an]*t[gn]*t[wn],e[on]=t[on]*t[dn]*t[fn]-t[rn]*t[cn]*t[fn]+t[rn]*t[hn]*t[yn]-t[an]*t[dn]*t[yn]-t[on]*t[hn]*t[wn]+t[an]*t[cn]*t[wn],e[rn]=t[rn]*t[cn]*t[mn]-t[on]*t[dn]*t[mn]-t[rn]*t[hn]*t[gn]+t[an]*t[dn]*t[gn]+t[on]*t[hn]*t[pn]-t[an]*t[cn]*t[pn],e[ln]=t[dn]*t[gn]*t[bn]-t[cn]*t[pn]*t[bn]-t[dn]*t[un]*t[yn]+t[ln]*t[pn]*t[yn]+t[cn]*t[un]*t[wn]-t[ln]*t[gn]*t[wn],e[hn]=t[on]*t[pn]*t[bn]-t[rn]*t[gn]*t[bn]+t[rn]*t[un]*t[yn]-t[nn]*t[pn]*t[yn]-t[on]*t[un]*t[wn]+t[nn]*t[gn]*t[wn],e[cn]=t[rn]*t[cn]*t[bn]-t[on]*t[dn]*t[bn]-t[rn]*t[ln]*t[yn]+t[nn]*t[dn]*t[yn]+t[on]*t[ln]*t[wn]-t[nn]*t[cn]*t[wn],e[dn]=t[on]*t[dn]*t[un]-t[rn]*t[cn]*t[un]+t[rn]*t[ln]*t[gn]-t[nn]*t[dn]*t[gn]-t[on]*t[ln]*t[pn]+t[nn]*t[cn]*t[pn],e[un]=t[hn]*t[pn]*t[bn]-t[dn]*t[mn]*t[bn]+t[dn]*t[un]*t[fn]-t[ln]*t[pn]*t[fn]-t[hn]*t[un]*t[wn]+t[ln]*t[mn]*t[wn],e[mn]=t[rn]*t[mn]*t[bn]-t[an]*t[pn]*t[bn]-t[rn]*t[un]*t[fn]+t[nn]*t[pn]*t[fn]+t[an]*t[un]*t[wn]-t[nn]*t[mn]*t[wn],e[gn]=t[an]*t[dn]*t[bn]-t[rn]*t[hn]*t[bn]+t[rn]*t[ln]*t[fn]-t[nn]*t[dn]*t[fn]-t[an]*t[ln]*t[wn]+t[nn]*t[hn]*t[wn],e[pn]=t[rn]*t[hn]*t[un]-t[an]*t[dn]*t[un]-t[rn]*t[ln]*t[mn]+t[nn]*t[dn]*t[mn]+t[an]*t[ln]*t[pn]-t[nn]*t[hn]*t[pn],e[bn]=t[cn]*t[mn]*t[bn]-t[hn]*t[gn]*t[bn]-t[cn]*t[un]*t[fn]+t[ln]*t[gn]*t[fn]+t[hn]*t[un]*t[yn]-t[ln]*t[mn]*t[yn],e[fn]=t[an]*t[gn]*t[bn]-t[on]*t[mn]*t[bn]+t[on]*t[un]*t[fn]-t[nn]*t[gn]*t[fn]-t[an]*t[un]*t[yn]+t[nn]*t[mn]*t[yn],e[yn]=t[on]*t[hn]*t[bn]-t[an]*t[cn]*t[bn]-t[on]*t[ln]*t[fn]+t[nn]*t[cn]*t[fn]+t[an]*t[ln]*t[yn]-t[nn]*t[hn]*t[yn],e[wn]=t[an]*t[cn]*t[un]-t[on]*t[hn]*t[un]+t[on]*t[ln]*t[mn]-t[nn]*t[cn]*t[mn]-t[an]*t[ln]*t[gn]+t[nn]*t[hn]*t[gn],t[nn]=e[nn]*s,t[an]=e[an]*s,t[on]=e[on]*s,t[rn]=e[rn]*s,t[ln]=e[ln]*s,t[hn]=e[hn]*s,t[cn]=e[cn]*s,t[dn]=e[dn]*s,t[un]=e[un]*s,t[mn]=e[mn]*s,t[gn]=e[gn]*s,t[pn]=e[pn]*s,t[bn]=e[bn]*s,t[fn]=e[fn]*s,t[yn]=e[yn]*s,t[wn]=e[wn]*s,this}determinant(){let t=this.values;return t[bn]*t[mn]*t[cn]*t[rn]-t[un]*t[fn]*t[cn]*t[rn]-t[bn]*t[hn]*t[gn]*t[rn]+t[ln]*t[fn]*t[gn]*t[rn]+t[un]*t[hn]*t[yn]*t[rn]-t[ln]*t[mn]*t[yn]*t[rn]-t[bn]*t[mn]*t[on]*t[dn]+t[un]*t[fn]*t[on]*t[dn]+t[bn]*t[an]*t[gn]*t[dn]-t[nn]*t[fn]*t[gn]*t[dn]-t[un]*t[an]*t[yn]*t[dn]+t[nn]*t[mn]*t[yn]*t[dn]+t[bn]*t[hn]*t[on]*t[pn]-t[ln]*t[fn]*t[on]*t[pn]-t[bn]*t[an]*t[cn]*t[pn]+t[nn]*t[fn]*t[cn]*t[pn]+t[ln]*t[an]*t[yn]*t[pn]-t[nn]*t[hn]*t[yn]*t[pn]-t[un]*t[hn]*t[on]*t[wn]+t[ln]*t[mn]*t[on]*t[wn]+t[un]*t[an]*t[cn]*t[wn]-t[nn]*t[mn]*t[cn]*t[wn]-t[ln]*t[an]*t[gn]*t[wn]+t[nn]*t[hn]*t[gn]*t[wn]}translate(t,e,i){let s=this.values;return s[rn]+=t,s[dn]+=e,s[pn]+=i,this}copy(){return(new t).set(this.values)}projection(t,e,i,s){this.identity();let n=1/Math.tan(i*(Math.PI/180)/2),a=(e+t)/(t-e),o=2*e*t/(t-e),r=this.values;return r[nn]=n/s,r[ln]=0,r[un]=0,r[bn]=0,r[an]=0,r[hn]=n,r[mn]=0,r[fn]=0,r[on]=0,r[cn]=0,r[gn]=a,r[yn]=-1,r[rn]=0,r[dn]=0,r[pn]=o,r[wn]=0,this}ortho2d(t,e,i,s){return this.ortho(t,t+i,e,e+s,0,1)}ortho(t,e,i,s,n,a){this.identity();let o=2/(e-t),r=2/(s-i),l=-2/(a-n),h=-(e+t)/(e-t),c=-(s+i)/(s-i),d=-(a+n)/(a-n),u=this.values;return u[nn]=o,u[ln]=0,u[un]=0,u[bn]=0,u[an]=0,u[hn]=r,u[mn]=0,u[fn]=0,u[on]=0,u[cn]=0,u[gn]=l,u[yn]=0,u[rn]=h,u[dn]=c,u[pn]=d,u[wn]=1,this}multiply(t){let e=this.temp,i=this.values,s=t.values;return e[nn]=i[nn]*s[nn]+i[an]*s[ln]+i[on]*s[un]+i[rn]*s[bn],e[an]=i[nn]*s[an]+i[an]*s[hn]+i[on]*s[mn]+i[rn]*s[fn],e[on]=i[nn]*s[on]+i[an]*s[cn]+i[on]*s[gn]+i[rn]*s[yn],e[rn]=i[nn]*s[rn]+i[an]*s[dn]+i[on]*s[pn]+i[rn]*s[wn],e[ln]=i[ln]*s[nn]+i[hn]*s[ln]+i[cn]*s[un]+i[dn]*s[bn],e[hn]=i[ln]*s[an]+i[hn]*s[hn]+i[cn]*s[mn]+i[dn]*s[fn],e[cn]=i[ln]*s[on]+i[hn]*s[cn]+i[cn]*s[gn]+i[dn]*s[yn],e[dn]=i[ln]*s[rn]+i[hn]*s[dn]+i[cn]*s[pn]+i[dn]*s[wn],e[un]=i[un]*s[nn]+i[mn]*s[ln]+i[gn]*s[un]+i[pn]*s[bn],e[mn]=i[un]*s[an]+i[mn]*s[hn]+i[gn]*s[mn]+i[pn]*s[fn],e[gn]=i[un]*s[on]+i[mn]*s[cn]+i[gn]*s[gn]+i[pn]*s[yn],e[pn]=i[un]*s[rn]+i[mn]*s[dn]+i[gn]*s[pn]+i[pn]*s[wn],e[bn]=i[bn]*s[nn]+i[fn]*s[ln]+i[yn]*s[un]+i[wn]*s[bn],e[fn]=i[bn]*s[an]+i[fn]*s[hn]+i[yn]*s[mn]+i[wn]*s[fn],e[yn]=i[bn]*s[on]+i[fn]*s[cn]+i[yn]*s[gn]+i[wn]*s[yn],e[wn]=i[bn]*s[rn]+i[fn]*s[dn]+i[yn]*s[pn]+i[wn]*s[wn],this.set(this.temp)}multiplyLeft(t){let e=this.temp,i=this.values,s=t.values;return e[nn]=s[nn]*i[nn]+s[an]*i[ln]+s[on]*i[un]+s[rn]*i[bn],e[an]=s[nn]*i[an]+s[an]*i[hn]+s[on]*i[mn]+s[rn]*i[fn],e[on]=s[nn]*i[on]+s[an]*i[cn]+s[on]*i[gn]+s[rn]*i[yn],e[rn]=s[nn]*i[rn]+s[an]*i[dn]+s[on]*i[pn]+s[rn]*i[wn],e[ln]=s[ln]*i[nn]+s[hn]*i[ln]+s[cn]*i[un]+s[dn]*i[bn],e[hn]=s[ln]*i[an]+s[hn]*i[hn]+s[cn]*i[mn]+s[dn]*i[fn],e[cn]=s[ln]*i[on]+s[hn]*i[cn]+s[cn]*i[gn]+s[dn]*i[yn],e[dn]=s[ln]*i[rn]+s[hn]*i[dn]+s[cn]*i[pn]+s[dn]*i[wn],e[un]=s[un]*i[nn]+s[mn]*i[ln]+s[gn]*i[un]+s[pn]*i[bn],e[mn]=s[un]*i[an]+s[mn]*i[hn]+s[gn]*i[mn]+s[pn]*i[fn],e[gn]=s[un]*i[on]+s[mn]*i[cn]+s[gn]*i[gn]+s[pn]*i[yn],e[pn]=s[un]*i[rn]+s[mn]*i[dn]+s[gn]*i[pn]+s[pn]*i[wn],e[bn]=s[bn]*i[nn]+s[fn]*i[ln]+s[yn]*i[un]+s[wn]*i[bn],e[fn]=s[bn]*i[an]+s[fn]*i[hn]+s[yn]*i[mn]+s[wn]*i[fn],e[yn]=s[bn]*i[on]+s[fn]*i[cn]+s[yn]*i[gn]+s[wn]*i[yn],e[wn]=s[bn]*i[rn]+s[fn]*i[dn]+s[yn]*i[pn]+s[wn]*i[wn],this.set(this.temp)}lookAt(e,i,s){let n=t.xAxis,a=t.yAxis,o=t.zAxis;o.setFrom(i).normalize(),n.setFrom(i).normalize(),n.cross(s).normalize(),a.setFrom(n).cross(o).normalize(),this.identity();let r=this.values;return r[nn]=n.x,r[an]=n.y,r[on]=n.z,r[ln]=a.x,r[hn]=a.y,r[cn]=a.z,r[un]=-o.x,r[mn]=-o.y,r[gn]=-o.z,t.tmpMatrix.identity(),t.tmpMatrix.values[rn]=-e.x,t.tmpMatrix.values[dn]=-e.y,t.tmpMatrix.values[pn]=-e.z,this.multiply(t.tmpMatrix),this}};s(Sn,"xAxis",new sn),s(Sn,"yAxis",new sn),s(Sn,"zAxis",new sn),s(Sn,"tmpMatrix",new Sn);let xn=Sn;class Fn{constructor(t,e){s(this,"position",new sn(0,0,0)),s(this,"direction",new sn(0,0,-1)),s(this,"up",new sn(0,1,0)),s(this,"near",0),s(this,"far",100),s(this,"zoom",1),s(this,"viewportWidth",0),s(this,"viewportHeight",0),s(this,"projectionView",new xn),s(this,"inverseProjectionView",new xn),s(this,"projection",new xn),s(this,"view",new xn),this.viewportWidth=t,this.viewportHeight=e,this.update()}update(){let t=this.projection,e=this.view,i=this.projectionView,s=this.inverseProjectionView,n=this.zoom,a=this.viewportWidth,o=this.viewportHeight;t.ortho(n*(-a/2),n*(a/2),n*(-o/2),n*(o/2),this.near,this.far),e.lookAt(this.position,this.direction,this.up),i.set(t.values),i.multiply(e),s.set(i.values).invert()}screenToWorld(t,e,i){let s=t.x,n=i-t.y-1;return t.x=2*s/e-1,t.y=2*n/i-1,t.z=2*t.z-1,t.project(this.inverseProjectionView),t}worldToScreen(t,e,i){return t.project(this.projectionView),t.x=e*(t.x+1)/2,t.y=i*(t.y+1)/2,t.z=(t.z+1)/2,t}setViewport(t,e){this.viewportWidth=t,this.viewportHeight=e}}const vn=class t{constructor(t,e,i){s(this,"vertexShader"),s(this,"fragmentShader"),s(this,"context"),s(this,"vs",null),s(this,"vsSource"),s(this,"fs",null),s(this,"fsSource"),s(this,"program",null),s(this,"tmp2x2",new Float32Array(4)),s(this,"tmp3x3",new Float32Array(9)),s(this,"tmp4x4",new Float32Array(16)),this.vertexShader=e,this.fragmentShader=i,this.vsSource=e,this.fsSource=i,this.context=t instanceof Js?t:new Js(t),this.context.addRestorable(this),this.compile()}getProgram(){return this.program}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}getVertexShaderSource(){return this.vsSource}getFragmentSource(){return this.fsSource}compile(){let t=this.context.gl;try{if(this.vs=this.compileShader(t.VERTEX_SHADER,this.vertexShader),!this.vs)throw new Error("Couldn't compile vertex shader.");if(this.fs=this.compileShader(t.FRAGMENT_SHADER,this.fragmentShader),!this.fs)throw new Error("Couldn#t compile fragment shader.");this.program=this.compileProgram(this.vs,this.fs)}catch(e){throw this.dispose(),e}}compileShader(t,e){let i=this.context.gl,s=i.createShader(t);if(!s)throw new Error("Couldn't create shader.");if(i.shaderSource(s,e),i.compileShader(s),!i.getShaderParameter(s,i.COMPILE_STATUS)){let t="Couldn't compile shader: "+i.getShaderInfoLog(s);if(i.deleteShader(s),!i.isContextLost())throw new Error(t)}return s}compileProgram(t,e){let i=this.context.gl,s=i.createProgram();if(!s)throw new Error("Couldn't compile program.");if(i.attachShader(s,t),i.attachShader(s,e),i.linkProgram(s),!i.getProgramParameter(s,i.LINK_STATUS)){let t="Couldn't compile shader program: "+i.getProgramInfoLog(s);if(i.deleteProgram(s),!i.isContextLost())throw new Error(t)}return s}restore(){this.compile()}bind(){this.context.gl.useProgram(this.program)}unbind(){this.context.gl.useProgram(null)}setUniformi(t,e){this.context.gl.uniform1i(this.getUniformLocation(t),e)}setUniformf(t,e){this.context.gl.uniform1f(this.getUniformLocation(t),e)}setUniform2f(t,e,i){this.context.gl.uniform2f(this.getUniformLocation(t),e,i)}setUniform3f(t,e,i,s){this.context.gl.uniform3f(this.getUniformLocation(t),e,i,s)}setUniform4f(t,e,i,s,n){this.context.gl.uniform4f(this.getUniformLocation(t),e,i,s,n)}setUniform2x2f(t,e){let i=this.context.gl;this.tmp2x2.set(e),i.uniformMatrix2fv(this.getUniformLocation(t),!1,this.tmp2x2)}setUniform3x3f(t,e){let i=this.context.gl;this.tmp3x3.set(e),i.uniformMatrix3fv(this.getUniformLocation(t),!1,this.tmp3x3)}setUniform4x4f(t,e){let i=this.context.gl;this.tmp4x4.set(e),i.uniformMatrix4fv(this.getUniformLocation(t),!1,this.tmp4x4)}getUniformLocation(t){let e=this.context.gl;if(!this.program)throw new Error("Shader not compiled.");let i=e.getUniformLocation(this.program,t);if(!i&&!e.isContextLost())throw new Error(`Couldn't find location for uniform ${t}`);return i}getAttributeLocation(t){let e=this.context.gl;if(!this.program)throw new Error("Shader not compiled.");let i=e.getAttribLocation(this.program,t);if(-1==i&&!e.isContextLost())throw new Error(`Couldn't find location for attribute ${t}`);return i}dispose(){this.context.removeRestorable(this);let t=this.context.gl;this.vs&&(t.deleteShader(this.vs),this.vs=null),this.fs&&(t.deleteShader(this.fs),this.fs=null),this.program&&(t.deleteProgram(this.program),this.program=null)}static newColoredTextured(e){let i=`\nattribute vec4 ${t.POSITION};\nattribute vec4 ${t.COLOR};\nattribute vec2 ${t.TEXCOORDS};\nuniform mat4 ${t.MVP_MATRIX};\nvarying vec4 v_color;\nvarying vec2 v_texCoords;\n\nvoid main () {\n\tv_color = ${t.COLOR};\n\tv_texCoords = ${t.TEXCOORDS};\n\tgl_Position = ${t.MVP_MATRIX} * ${t.POSITION};\n}\n`;return new t(e,i,"\n#ifdef GL_ES\n\t#define LOWP lowp\n\tprecision mediump float;\n#else\n\t#define LOWP\n#endif\nvarying LOWP vec4 v_color;\nvarying vec2 v_texCoords;\nuniform sampler2D u_texture;\n\nvoid main () {\n\tgl_FragColor = v_color * texture2D(u_texture, v_texCoords);\n}\n")}static newTwoColoredTextured(e){let i=`\nattribute vec4 ${t.POSITION};\nattribute vec4 ${t.COLOR};\nattribute vec4 ${t.COLOR2};\nattribute vec2 ${t.TEXCOORDS};\nuniform mat4 ${t.MVP_MATRIX};\nvarying vec4 v_light;\nvarying vec4 v_dark;\nvarying vec2 v_texCoords;\n\nvoid main () {\n\tv_light = ${t.COLOR};\n\tv_dark = ${t.COLOR2};\n\tv_texCoords = ${t.TEXCOORDS};\n\tgl_Position = ${t.MVP_MATRIX} * ${t.POSITION};\n}\n`;return new t(e,i,"\n#ifdef GL_ES\n\t#define LOWP lowp\n\tprecision mediump float;\n#else\n\t#define LOWP\n#endif\nvarying LOWP vec4 v_light;\nvarying LOWP vec4 v_dark;\nvarying vec2 v_texCoords;\nuniform sampler2D u_texture;\n\nvoid main () {\n\tvec4 texColor = texture2D(u_texture, v_texCoords);\n\tgl_FragColor.a = texColor.a * v_light.a;\n\tgl_FragColor.rgb = ((texColor.a - 1.0) * v_dark.a + 1.0 - texColor.rgb) * v_dark.rgb + texColor.rgb * v_light.rgb;\n}\n")}static newColored(e){let i=`\nattribute vec4 ${t.POSITION};\nattribute vec4 ${t.COLOR};\nuniform mat4 ${t.MVP_MATRIX};\nvarying vec4 v_color;\n\nvoid main () {\n\tv_color = ${t.COLOR};\n\tgl_Position = ${t.MVP_MATRIX} * ${t.POSITION};\n}\n`;return new t(e,i,"\n#ifdef GL_ES\n\t#define LOWP lowp\n\tprecision mediump float;\n#else\n\t#define LOWP\n#endif\nvarying LOWP vec4 v_color;\n\nvoid main () {\n\tgl_FragColor = v_color;\n}\n")}};s(vn,"MVP_MATRIX","u_projTrans"),s(vn,"POSITION","a_position"),s(vn,"COLOR","a_color"),s(vn,"COLOR2","a_color2"),s(vn,"TEXCOORDS","a_texCoords"),s(vn,"SAMPLER","u_texture");let Tn=vn;class An{constructor(t,e,i,n){s(this,"attributes"),s(this,"context"),s(this,"vertices"),s(this,"verticesBuffer",null),s(this,"verticesLength",0),s(this,"dirtyVertices",!1),s(this,"indices"),s(this,"indicesBuffer",null),s(this,"indicesLength",0),s(this,"dirtyIndices",!1),s(this,"elementsPerVertex",0),this.attributes=e,this.context=t instanceof Js?t:new Js(t),this.elementsPerVertex=0;for(let s=0;s<e.length;s++)this.elementsPerVertex+=e[s].numElements;this.vertices=new Float32Array(i*this.elementsPerVertex),this.indices=new Uint16Array(n),this.context.addRestorable(this)}getAttributes(){return this.attributes}maxVertices(){return this.vertices.length/this.elementsPerVertex}numVertices(){return this.verticesLength/this.elementsPerVertex}setVerticesLength(t){this.dirtyVertices=!0,this.verticesLength=t}getVertices(){return this.vertices}maxIndices(){return this.indices.length}numIndices(){return this.indicesLength}setIndicesLength(t){this.dirtyIndices=!0,this.indicesLength=t}getIndices(){return this.indices}getVertexSizeInFloats(){let t=0;for(var e=0;e<this.attributes.length;e++)t+=this.attributes[e].numElements;return t}setVertices(t){if(this.dirtyVertices=!0,t.length>this.vertices.length)throw Error("Mesh can't store more than "+this.maxVertices()+" vertices");this.vertices.set(t,0),this.verticesLength=t.length}setIndices(t){if(this.dirtyIndices=!0,t.length>this.indices.length)throw Error("Mesh can't store more than "+this.maxIndices()+" indices");this.indices.set(t,0),this.indicesLength=t.length}draw(t,e){this.drawWithOffset(t,e,0,this.indicesLength>0?this.indicesLength:this.verticesLength/this.elementsPerVertex)}drawWithOffset(t,e,i,s){let n=this.context.gl;(this.dirtyVertices||this.dirtyIndices)&&this.update(),this.bind(t),this.indicesLength>0?n.drawElements(e,s,n.UNSIGNED_SHORT,2*i):n.drawArrays(e,i,s),this.unbind(t)}bind(t){let e=this.context.gl;e.bindBuffer(e.ARRAY_BUFFER,this.verticesBuffer);let i=0;for(let s=0;s<this.attributes.length;s++){let n=this.attributes[s],a=t.getAttributeLocation(n.name);e.enableVertexAttribArray(a),e.vertexAttribPointer(a,n.numElements,e.FLOAT,!1,4*this.elementsPerVertex,4*i),i+=n.numElements}this.indicesLength>0&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)}unbind(t){let e=this.context.gl;for(let i=0;i<this.attributes.length;i++){let s=this.attributes[i],n=t.getAttributeLocation(s.name);e.disableVertexAttribArray(n)}e.bindBuffer(e.ARRAY_BUFFER,null),this.indicesLength>0&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}update(){let t=this.context.gl;this.dirtyVertices&&(this.verticesBuffer||(this.verticesBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.verticesBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices.subarray(0,this.verticesLength),t.DYNAMIC_DRAW),this.dirtyVertices=!1),this.dirtyIndices&&(this.indicesBuffer||(this.indicesBuffer=t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices.subarray(0,this.indicesLength),t.DYNAMIC_DRAW),this.dirtyIndices=!1)}restore(){this.verticesBuffer=null,this.indicesBuffer=null,this.update()}dispose(){this.context.removeRestorable(this);let t=this.context.gl;t.deleteBuffer(this.verticesBuffer),t.deleteBuffer(this.indicesBuffer)}}class Mn{constructor(t,e,i){s(this,"name"),s(this,"type"),s(this,"numElements"),this.name=t,this.type=e,this.numElements=i}}class Cn extends Mn{constructor(){super(Tn.POSITION,En.Float,2)}}class Bn extends Mn{constructor(t=0){super(Tn.TEXCOORDS+(0==t?"":t),En.Float,2)}}class Pn extends Mn{constructor(){super(Tn.COLOR,En.Float,4)}}class In extends Mn{constructor(){super(Tn.COLOR2,En.Float,4)}}var En,Dn;(Dn=En||(En={}))[Dn.Float=0]="Float";const Rn=class t{constructor(t,e=!0,i=10920){if(s(this,"context"),s(this,"drawCalls",0),s(this,"isDrawing",!1),s(this,"mesh"),s(this,"shader",null),s(this,"lastTexture",null),s(this,"verticesLength",0),s(this,"indicesLength",0),s(this,"srcColorBlend"),s(this,"srcAlphaBlend"),s(this,"dstBlend"),s(this,"cullWasEnabled",!1),i>10920)throw new Error("Can't have more than 10920 triangles per batch: "+i);this.context=t instanceof Js?t:new Js(t);let n=e?[new Cn,new Pn,new Bn,new In]:[new Cn,new Pn,new Bn];this.mesh=new An(t,n,i,3*i);let a=this.context.gl;this.srcColorBlend=a.SRC_ALPHA,this.srcAlphaBlend=a.ONE,this.dstBlend=a.ONE_MINUS_SRC_ALPHA}begin(t){if(this.isDrawing)throw new Error("PolygonBatch is already drawing. Call PolygonBatch.end() before calling PolygonBatch.begin()");this.drawCalls=0,this.shader=t,this.lastTexture=null,this.isDrawing=!0;let e=this.context.gl;e.enable(e.BLEND),e.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)}setBlendMode(e,i){const s=t.blendModesGL[e],n=i?s.srcRgbPma:s.srcRgb,a=s.srcAlpha,o=s.dstRgb;this.srcColorBlend==n&&this.srcAlphaBlend==a&&this.dstBlend==o||(this.srcColorBlend=n,this.srcAlphaBlend=a,this.dstBlend=o,this.isDrawing&&this.flush(),this.context.gl.blendFuncSeparate(n,o,a,o))}draw(t,e,i){t!=this.lastTexture?(this.flush(),this.lastTexture=t):(this.verticesLength+e.length>this.mesh.getVertices().length||this.indicesLength+i.length>this.mesh.getIndices().length)&&this.flush();let s=this.mesh.numVertices();this.mesh.getVertices().set(e,this.verticesLength),this.verticesLength+=e.length,this.mesh.setVerticesLength(this.verticesLength);let n=this.mesh.getIndices();for(let a=this.indicesLength,o=0;o<i.length;a++,o++)n[a]=i[o]+s;this.indicesLength+=i.length,this.mesh.setIndicesLength(this.indicesLength)}flush(){if(0!=this.verticesLength){if(!this.lastTexture)throw new Error("No texture set.");if(!this.shader)throw new Error("No shader set.");this.lastTexture.bind(),this.mesh.draw(this.shader,this.context.gl.TRIANGLES),this.verticesLength=0,this.indicesLength=0,this.mesh.setVerticesLength(0),this.mesh.setIndicesLength(0),this.drawCalls++,t.globalDrawCalls++}}end(){if(!this.isDrawing)throw new Error("PolygonBatch is not drawing. Call PolygonBatch.begin() before calling PolygonBatch.end()");(this.verticesLength>0||this.indicesLength>0)&&this.flush(),this.shader=null,this.lastTexture=null,this.isDrawing=!1;let t=this.context.gl;t.disable(t.BLEND)}getDrawCalls(){return this.drawCalls}static getAndResetGlobalDrawCalls(){let e=t.globalDrawCalls;return t.globalDrawCalls=0,e}dispose(){this.mesh.dispose()}};s(Rn,"disableCulling",!1),s(Rn,"globalDrawCalls",0),s(Rn,"blendModesGL",[{srcRgb:770,srcRgbPma:1,dstRgb:771,srcAlpha:1},{srcRgb:770,srcRgbPma:1,dstRgb:1,srcAlpha:1},{srcRgb:774,srcRgbPma:774,dstRgb:771,srcAlpha:1},{srcRgb:1,srcRgbPma:1,dstRgb:769,srcAlpha:1}]);let _n=Rn;class Wn{constructor(t,e=10920){if(s(this,"context"),s(this,"isDrawing",!1),s(this,"mesh"),s(this,"shapeType",Ln.Filled),s(this,"color",new nt(1,1,1,1)),s(this,"shader",null),s(this,"vertexIndex",0),s(this,"tmp",new ct),s(this,"srcColorBlend"),s(this,"srcAlphaBlend"),s(this,"dstBlend"),e>10920)throw new Error("Can't have more than 10920 triangles per batch: "+e);this.context=t instanceof Js?t:new Js(t),this.mesh=new An(t,[new Cn,new Pn],e,0);let i=this.context.gl;this.srcColorBlend=i.SRC_ALPHA,this.srcAlphaBlend=i.ONE,this.dstBlend=i.ONE_MINUS_SRC_ALPHA}begin(t){if(this.isDrawing)throw new Error("ShapeRenderer.begin() has already been called");this.shader=t,this.vertexIndex=0,this.isDrawing=!0;let e=this.context.gl;e.enable(e.BLEND),e.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)}setBlendMode(t,e,i){this.srcColorBlend=t,this.srcAlphaBlend=e,this.dstBlend=i,this.isDrawing&&(this.flush(),this.context.gl.blendFuncSeparate(t,i,e,i))}setColor(t){this.color.setFromColor(t)}setColorWith(t,e,i,s){this.color.set(t,e,i,s)}point(t,e,i){this.check(Ln.Point,1),i||(i=this.color),this.vertex(t,e,i)}line(t,e,i,s,n){this.check(Ln.Line,2),this.mesh.getVertices(),this.vertexIndex,n||(n=this.color),this.vertex(t,e,n),this.vertex(i,s,n)}triangle(t,e,i,s,n,a,o,r,l,h){this.check(t?Ln.Filled:Ln.Line,3),this.mesh.getVertices(),this.vertexIndex,r||(r=this.color),l||(l=this.color),h||(h=this.color),t?(this.vertex(e,i,r),this.vertex(s,n,l),this.vertex(a,o,h)):(this.vertex(e,i,r),this.vertex(s,n,l),this.vertex(s,n,r),this.vertex(a,o,l),this.vertex(a,o,r),this.vertex(e,i,l))}quad(t,e,i,s,n,a,o,r,l,h,c,d,u){this.check(t?Ln.Filled:Ln.Line,3),this.mesh.getVertices(),this.vertexIndex,h||(h=this.color),c||(c=this.color),d||(d=this.color),u||(u=this.color),t?(this.vertex(e,i,h),this.vertex(s,n,c),this.vertex(a,o,d),this.vertex(a,o,d),this.vertex(r,l,u),this.vertex(e,i,h)):(this.vertex(e,i,h),this.vertex(s,n,c),this.vertex(s,n,c),this.vertex(a,o,d),this.vertex(a,o,d),this.vertex(r,l,u),this.vertex(r,l,u),this.vertex(e,i,h))}rect(t,e,i,s,n,a){this.quad(t,e,i,e+s,i,e+s,i+n,e,i+n,a,a,a,a)}rectLine(t,e,i,s,n,a,o){this.check(t?Ln.Filled:Ln.Line,8),o||(o=this.color);let r=this.tmp.set(n-i,e-s);r.normalize(),a*=.5;let l=r.x*a,h=r.y*a;t?(this.vertex(e+l,i+h,o),this.vertex(e-l,i-h,o),this.vertex(s+l,n+h,o),this.vertex(s-l,n-h,o),this.vertex(s+l,n+h,o),this.vertex(e-l,i-h,o)):(this.vertex(e+l,i+h,o),this.vertex(e-l,i-h,o),this.vertex(s+l,n+h,o),this.vertex(s-l,n-h,o),this.vertex(s+l,n+h,o),this.vertex(e+l,i+h,o),this.vertex(s-l,n-h,o),this.vertex(e-l,i-h,o))}x(t,e,i){this.line(t-i,e-i,t+i,e+i),this.line(t-i,e+i,t+i,e-i)}polygon(t,e,i,s){if(i<3)throw new Error("Polygon must contain at least 3 vertices");this.check(Ln.Line,2*i),s||(s=this.color),this.mesh.getVertices(),this.vertexIndex,i<<=1;let n=t[e<<=1],a=t[e+1],o=e+i;for(let r=e,l=e+i-2;r<l;r+=2){let e=t[r],i=t[r+1],l=0,h=0;r+2>=o?(l=n,h=a):(l=t[r+2],h=t[r+3]),this.vertex(e,i,s),this.vertex(l,h,s)}}circle(t,e,i,s,n,a=0){if(0==a&&(a=Math.max(1,6*ot.cbrt(s)|0)),a<=0)throw new Error("segments must be > 0.");n||(n=this.color);let o=2*ot.PI/a,r=Math.cos(o),l=Math.sin(o),h=s,c=0;if(t){this.check(Ln.Filled,3*a+3),a--;for(let t=0;t<a;t++){this.vertex(e,i,n),this.vertex(e+h,i+c,n);let t=h;h=r*h-l*c,c=l*t+r*c,this.vertex(e+h,i+c,n)}this.vertex(e,i,n),this.vertex(e+h,i+c,n)}else{this.check(Ln.Line,2*a+2);for(let t=0;t<a;t++){this.vertex(e+h,i+c,n);let t=h;h=r*h-l*c,c=l*t+r*c,this.vertex(e+h,i+c,n)}this.vertex(e+h,i+c,n)}h=s,c=0,this.vertex(e+h,i+c,n)}curve(t,e,i,s,n,a,o,r,l,h){this.check(Ln.Line,2*l+2),h||(h=this.color);let c=1/l,d=c*c,u=c*c*c,m=3*c,g=3*d,p=6*d,b=6*u,f=t-2*i+n,y=e-2*s+a,w=3*(i-n)-t+o,S=3*(s-a)-e+r,x=t,F=e,v=(i-t)*m+f*g+w*u,T=(s-e)*m+y*g+S*u,A=f*p+w*b,M=y*p+S*b,C=w*b,B=S*b;for(;l-- >0;)this.vertex(x,F,h),x+=v,F+=T,v+=A,T+=M,A+=C,M+=B,this.vertex(x,F,h);this.vertex(x,F,h),this.vertex(o,r,h)}vertex(t,e,i){let s=this.vertexIndex,n=this.mesh.getVertices();n[s++]=t,n[s++]=e,n[s++]=i.r,n[s++]=i.g,n[s++]=i.b,n[s++]=i.a,this.vertexIndex=s}end(){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");this.flush();let t=this.context.gl;t.disable(t.BLEND),this.isDrawing=!1}flush(){if(0!=this.vertexIndex){if(!this.shader)throw new Error("No shader set.");this.mesh.setVerticesLength(this.vertexIndex),this.mesh.draw(this.shader,this.shapeType),this.vertexIndex=0}}check(t,e){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");if(this.shapeType==t){if(!(this.mesh.maxVertices()-this.mesh.numVertices()<e))return;this.flush()}else this.flush(),this.shapeType=t}dispose(){this.mesh.dispose()}}var Ln,On;(On=Ln||(Ln={}))[On.Point=0]="Point",On[On.Line=1]="Line",On[On.Filled=4]="Filled";const kn=class t{constructor(t){s(this,"boneLineColor",new nt(1,0,0,1)),s(this,"boneOriginColor",new nt(0,1,0,1)),s(this,"attachmentLineColor",new nt(0,0,1,.5)),s(this,"triangleLineColor",new nt(1,.64,0,.5)),s(this,"pathColor",(new nt).setFromString("FF7F00")),s(this,"clipColor",new nt(.8,0,0,2)),s(this,"aabbColor",new nt(0,1,0,.5)),s(this,"drawBones",!0),s(this,"drawRegionAttachments",!0),s(this,"drawBoundingBoxes",!0),s(this,"drawMeshHull",!0),s(this,"drawMeshTriangles",!0),s(this,"drawPaths",!0),s(this,"drawSkeletonXY",!1),s(this,"drawClipping",!0),s(this,"premultipliedAlpha",!1),s(this,"scale",1),s(this,"boneWidth",2),s(this,"context"),s(this,"bounds",new us),s(this,"temp",new Array),s(this,"vertices",lt.newFloatArray(2048)),this.context=t instanceof Js?t:new Js(t)}draw(e,i,s){let n=i.x,a=i.y,o=this.context.gl,r=this.premultipliedAlpha?o.ONE:o.SRC_ALPHA;e.setBlendMode(r,o.ONE,o.ONE_MINUS_SRC_ALPHA);let l=i.bones;if(this.drawBones){e.setColor(this.boneLineColor);for(let t=0,i=l.length;t<i;t++){let i=l[t];if(s&&s.indexOf(i.data.name)>-1)continue;if(!i.parent)continue;let n=i.data.length*i.a+i.worldX,a=i.data.length*i.c+i.worldY;e.rectLine(!0,i.worldX,i.worldY,n,a,this.boneWidth*this.scale)}this.drawSkeletonXY&&e.x(n,a,4*this.scale)}if(this.drawRegionAttachments){e.setColor(this.attachmentLineColor);let t=i.slots;for(let i=0,s=t.length;i<s;i++){let s=t[i],n=s.getAttachment();if(n instanceof He){let t=n,i=this.vertices;t.computeWorldVertices(s,i,0,2),e.line(i[0],i[1],i[2],i[3]),e.line(i[2],i[3],i[4],i[5]),e.line(i[4],i[5],i[6],i[7]),e.line(i[6],i[7],i[0],i[1])}}}if(this.drawMeshHull||this.drawMeshTriangles){let t=i.slots;for(let i=0,s=t.length;i<s;i++){let s=t[i];if(!s.bone.active)continue;let n=s.getAttachment();if(!(n instanceof Ve))continue;let a=n,o=this.vertices;a.computeWorldVertices(s,0,a.worldVerticesLength,o,0,2);let r=a.triangles,l=a.hullLength;if(this.drawMeshTriangles){e.setColor(this.triangleLineColor);for(let t=0,i=r.length;t<i;t+=3){let i=2*r[t],s=2*r[t+1],n=2*r[t+2];e.triangle(!1,o[i],o[i+1],o[s],o[s+1],o[n],o[n+1])}}if(this.drawMeshHull&&l>0){e.setColor(this.attachmentLineColor),l=2*(l>>1);let t=o[l-2],i=o[l-1];for(let s=0,n=l;s<n;s+=2){let n=o[s],a=o[s+1];e.line(n,a,t,i),t=n,i=a}}}}if(this.drawBoundingBoxes){let t=this.bounds;t.update(i,!0),e.setColor(this.aabbColor),e.rect(!1,t.minX,t.minY,t.getWidth(),t.getHeight());let s=t.polygons,n=t.boundingBoxes;for(let i=0,a=s.length;i<a;i++){let t=s[i];e.setColor(n[i].color),e.polygon(t,0,t.length)}}if(this.drawPaths){let s=i.slots;for(let i=0,n=s.length;i<n;i++){let n=s[i];if(!n.bone.active)continue;let a=n.getAttachment();if(!(a instanceof Ye))continue;let o=a,r=o.worldVerticesLength,l=this.temp=lt.setArraySize(this.temp,r,0);o.computeWorldVertices(n,0,r,l,0,2);let h=this.pathColor,c=l[2],d=l[3],u=0,m=0;if(o.closed){e.setColor(h);let i=l[0],s=l[1],n=l[r-2],a=l[r-1];u=l[r-4],m=l[r-3],e.curve(c,d,i,s,n,a,u,m,32),e.setColor(t.LIGHT_GRAY),e.line(c,d,i,s),e.line(u,m,n,a)}r-=4;for(let i=4;i<r;i+=6){let s=l[i],n=l[i+1],a=l[i+2],o=l[i+3];u=l[i+4],m=l[i+5],e.setColor(h),e.curve(c,d,s,n,a,o,u,m,32),e.setColor(t.LIGHT_GRAY),e.line(c,d,s,n),e.line(u,m,a,o),c=u,d=m}}}if(this.drawBones){e.setColor(this.boneOriginColor);for(let t=0,i=l.length;t<i;t++){let i=l[t];s&&s.indexOf(i.data.name)>-1||e.circle(!0,i.worldX,i.worldY,3*this.scale,this.boneOriginColor,8)}}if(this.drawClipping){let t=i.slots;e.setColor(this.clipColor);for(let i=0,s=t.length;i<s;i++){let s=t[i];if(!s.bone.active)continue;let n=s.getAttachment();if(!(n instanceof Pe))continue;let a=n,o=a.worldVerticesLength,r=this.temp=lt.setArraySize(this.temp,o,0);a.computeWorldVertices(s,0,o,r,0,2);for(let t=0,i=r.length;t<i;t+=2){let i=r[t],s=r[t+1],n=r[(t+2)%r.length],a=r[(t+3)%r.length];e.line(i,s,n,a)}}}}dispose(){}};s(kn,"LIGHT_GRAY",new nt(192/255,192/255,192/255,1)),s(kn,"GREEN",new nt(0,1,0,1));let Nn=kn;class Vn{constructor(t,e,i){s(this,"vertices"),s(this,"numVertices"),s(this,"numFloats"),this.vertices=t,this.numVertices=e,this.numFloats=i}}let Yn=(e=class{constructor(t,e=!0){s(this,"premultipliedAlpha",!1),s(this,"tempColor",new nt),s(this,"tempColor2",new nt),s(this,"vertices"),s(this,"vertexSize",8),s(this,"twoColorTint",!1),s(this,"renderable",new Vn([],0,0)),s(this,"clipper",new gs),s(this,"temp",new ct),s(this,"temp2",new ct),s(this,"temp3",new nt),s(this,"temp4",new nt),this.twoColorTint=e,e&&(this.vertexSize+=4),this.vertices=lt.newFloatArray(1024*this.vertexSize)}draw(t,i,s=-1,n=-1,a=null){let o,r,l,h=this.clipper,c=this.premultipliedAlpha,d=this.twoColorTint,u=null,m=this.renderable,g=i.drawOrder,p=i.color,b=d?12:8,f=!1;-1==s&&(f=!0);for(let y=0,w=g.length;y<w;y++){let i=h.isClipping()?2:b,w=g[y];if(!w.bone.active){h.clipEndWithSlot(w);continue}if(s>=0&&s==w.data.index&&(f=!0),!f){h.clipEndWithSlot(w);continue}n>=0&&n==w.data.index&&(f=!1);let S,x=w.getAttachment();if(x instanceof He){let t=x;m.vertices=this.vertices,m.numVertices=4,m.numFloats=i<<2,t.computeWorldVertices(w,m.vertices,0,i),r=e.QUAD_TRIANGLES,o=t.uvs,S=t.region.texture,l=t.color}else{if(!(x instanceof Ve)){if(x instanceof Pe){let t=x;h.clipStart(w,t);continue}h.clipEndWithSlot(w);continue}{let t=x;m.vertices=this.vertices,m.numVertices=t.worldVerticesLength>>1,m.numFloats=m.numVertices*i,m.numFloats>m.vertices.length&&(m.vertices=this.vertices=lt.newFloatArray(m.numFloats)),t.computeWorldVertices(w,0,t.worldVerticesLength,m.vertices,0,i),r=t.triangles,S=t.region.texture,o=t.uvs,l=t.color}}if(S){let e=w.color,i=this.tempColor;i.r=p.r*e.r*l.r,i.g=p.g*e.g*l.g,i.b=p.b*e.b*l.b,i.a=p.a*e.a*l.a,c&&(i.r*=i.a,i.g*=i.a,i.b*=i.a);let s=this.tempColor2;w.darkColor?(c?(s.r=w.darkColor.r*i.a,s.g=w.darkColor.g*i.a,s.b=w.darkColor.b*i.a):s.setFromColor(w.darkColor),s.a=c?1:0):s.set(0,0,0,1);let n=w.data.blendMode;if(n!=u&&(u=n,t.setBlendMode(u,c)),h.isClipping()){h.clipTriangles(m.vertices,r,r.length,o,i,s,d);let e=new Float32Array(h.clippedVertices),n=h.clippedTriangles;a&&a(e,e.length,b),t.draw(S,e,n)}else{let e=m.vertices;if(d)for(let t=2,a=0,r=m.numFloats;t<r;t+=b,a+=2)e[t]=i.r,e[t+1]=i.g,e[t+2]=i.b,e[t+3]=i.a,e[t+4]=o[a],e[t+5]=o[a+1],e[t+6]=s.r,e[t+7]=s.g,e[t+8]=s.b,e[t+9]=s.a;else for(let t=2,s=0,a=m.numFloats;t<a;t+=b,s+=2)e[t]=i.r,e[t+1]=i.g,e[t+2]=i.b,e[t+3]=i.a,e[t+4]=o[s],e[t+5]=o[s+1];let n=m.vertices.subarray(0,m.numFloats);a&&a(m.vertices,m.numFloats,b),t.draw(S,n,r)}}h.clipEndWithSlot(w)}h.clipEnd()}getSkeletonClipping(){return this.clipper}},s(e,"QUAD_TRIANGLES",[0,1,2,2,3,0]),e);const Xn=[0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0],Gn=[0,1,2,2,3,0],Hn=new nt(1,1,1,1);class Un{constructor(t,e,i=!0){s(this,"context"),s(this,"canvas"),s(this,"camera"),s(this,"batcher"),s(this,"twoColorTint",!1),s(this,"batcherShader"),s(this,"shapes"),s(this,"shapesShader"),s(this,"activeRenderer",null),s(this,"skeletonRenderer"),s(this,"skeletonDebugRenderer"),this.canvas=t,this.context=e instanceof Js?e:new Js(e),this.twoColorTint=i,this.camera=new Fn(t.width,t.height),this.batcherShader=i?Tn.newTwoColoredTextured(this.context):Tn.newColoredTextured(this.context),this.batcher=new _n(this.context,i),this.shapesShader=Tn.newColored(this.context),this.shapes=new Wn(this.context),this.skeletonRenderer=new Yn(this.context,i),this.skeletonDebugRenderer=new Nn(this.context)}dispose(){this.batcher.dispose(),this.batcherShader.dispose(),this.shapes.dispose(),this.shapesShader.dispose(),this.skeletonDebugRenderer.dispose()}begin(){this.camera.update(),this.enableRenderer(this.batcher)}drawSkeleton(t,e=!1,i=-1,s=-1,n=null){this.enableRenderer(this.batcher),this.skeletonRenderer.premultipliedAlpha=e,this.skeletonRenderer.draw(this.batcher,t,i,s,n)}drawSkeletonDebug(t,e=!1,i){this.enableRenderer(this.shapes),this.skeletonDebugRenderer.premultipliedAlpha=e,this.skeletonDebugRenderer.draw(this.shapes,t,i)}drawTexture(t,e,i,s,n,a){this.enableRenderer(this.batcher),a||(a=Hn);var o=0;Xn[o++]=e,Xn[o++]=i,Xn[o++]=a.r,Xn[o++]=a.g,Xn[o++]=a.b,Xn[o++]=a.a,Xn[o++]=0,Xn[o++]=1,this.twoColorTint&&(Xn[o++]=0,Xn[o++]=0,Xn[o++]=0,Xn[o++]=0),Xn[o++]=e+s,Xn[o++]=i,Xn[o++]=a.r,Xn[o++]=a.g,Xn[o++]=a.b,Xn[o++]=a.a,Xn[o++]=1,Xn[o++]=1,this.twoColorTint&&(Xn[o++]=0,Xn[o++]=0,Xn[o++]=0,Xn[o++]=0),Xn[o++]=e+s,Xn[o++]=i+n,Xn[o++]=a.r,Xn[o++]=a.g,Xn[o++]=a.b,Xn[o++]=a.a,Xn[o++]=1,Xn[o++]=0,this.twoColorTint&&(Xn[o++]=0,Xn[o++]=0,Xn[o++]=0,Xn[o++]=0),Xn[o++]=e,Xn[o++]=i+n,Xn[o++]=a.r,Xn[o++]=a.g,Xn[o++]=a.b,Xn[o++]=a.a,Xn[o++]=0,Xn[o++]=0,this.twoColorTint&&(Xn[o++]=0,Xn[o++]=0,Xn[o++]=0,Xn[o]=0),this.batcher.draw(t,Xn,Gn)}drawTextureUV(t,e,i,s,n,a,o,r,l,h){this.enableRenderer(this.batcher),h||(h=Hn);var c=0;Xn[c++]=e,Xn[c++]=i,Xn[c++]=h.r,Xn[c++]=h.g,Xn[c++]=h.b,Xn[c++]=h.a,Xn[c++]=a,Xn[c++]=o,this.twoColorTint&&(Xn[c++]=0,Xn[c++]=0,Xn[c++]=0,Xn[c++]=0),Xn[c++]=e+s,Xn[c++]=i,Xn[c++]=h.r,Xn[c++]=h.g,Xn[c++]=h.b,Xn[c++]=h.a,Xn[c++]=r,Xn[c++]=o,this.twoColorTint&&(Xn[c++]=0,Xn[c++]=0,Xn[c++]=0,Xn[c++]=0),Xn[c++]=e+s,Xn[c++]=i+n,Xn[c++]=h.r,Xn[c++]=h.g,Xn[c++]=h.b,Xn[c++]=h.a,Xn[c++]=r,Xn[c++]=l,this.twoColorTint&&(Xn[c++]=0,Xn[c++]=0,Xn[c++]=0,Xn[c++]=0),Xn[c++]=e,Xn[c++]=i+n,Xn[c++]=h.r,Xn[c++]=h.g,Xn[c++]=h.b,Xn[c++]=h.a,Xn[c++]=a,Xn[c++]=l,this.twoColorTint&&(Xn[c++]=0,Xn[c++]=0,Xn[c++]=0,Xn[c]=0),this.batcher.draw(t,Xn,Gn)}drawTextureRotated(t,e,i,s,n,a,o,r,l){this.enableRenderer(this.batcher),l||(l=Hn);let h=e+a,c=i+o,d=-a,u=-o,m=s-a,g=n-o,p=d,b=u,f=d,y=g,w=m,S=g,x=m,F=u,v=0,T=0,A=0,M=0,C=0,B=0,P=0,I=0;if(0!=r){let t=ot.cosDeg(r),e=ot.sinDeg(r);v=t*p-e*b,T=e*p+t*b,P=t*f-e*y,I=e*f+t*y,C=t*w-e*S,B=e*w+t*S,A=C+(v-P),M=B+(T-I)}else v=p,T=b,P=f,I=y,C=w,B=S,A=x,M=F;v+=h,T+=c,A+=h,M+=c,C+=h,B+=c,P+=h,I+=c;var E=0;Xn[E++]=v,Xn[E++]=T,Xn[E++]=l.r,Xn[E++]=l.g,Xn[E++]=l.b,Xn[E++]=l.a,Xn[E++]=0,Xn[E++]=1,this.twoColorTint&&(Xn[E++]=0,Xn[E++]=0,Xn[E++]=0,Xn[E++]=0),Xn[E++]=A,Xn[E++]=M,Xn[E++]=l.r,Xn[E++]=l.g,Xn[E++]=l.b,Xn[E++]=l.a,Xn[E++]=1,Xn[E++]=1,this.twoColorTint&&(Xn[E++]=0,Xn[E++]=0,Xn[E++]=0,Xn[E++]=0),Xn[E++]=C,Xn[E++]=B,Xn[E++]=l.r,Xn[E++]=l.g,Xn[E++]=l.b,Xn[E++]=l.a,Xn[E++]=1,Xn[E++]=0,this.twoColorTint&&(Xn[E++]=0,Xn[E++]=0,Xn[E++]=0,Xn[E++]=0),Xn[E++]=P,Xn[E++]=I,Xn[E++]=l.r,Xn[E++]=l.g,Xn[E++]=l.b,Xn[E++]=l.a,Xn[E++]=0,Xn[E++]=0,this.twoColorTint&&(Xn[E++]=0,Xn[E++]=0,Xn[E++]=0,Xn[E]=0),this.batcher.draw(t,Xn,Gn)}drawRegion(t,e,i,s,n,a){this.enableRenderer(this.batcher),a||(a=Hn);var o=0;Xn[o++]=e,Xn[o++]=i,Xn[o++]=a.r,Xn[o++]=a.g,Xn[o++]=a.b,Xn[o++]=a.a,Xn[o++]=t.u,Xn[o++]=t.v2,this.twoColorTint&&(Xn[o++]=0,Xn[o++]=0,Xn[o++]=0,Xn[o++]=0),Xn[o++]=e+s,Xn[o++]=i,Xn[o++]=a.r,Xn[o++]=a.g,Xn[o++]=a.b,Xn[o++]=a.a,Xn[o++]=t.u2,Xn[o++]=t.v2,this.twoColorTint&&(Xn[o++]=0,Xn[o++]=0,Xn[o++]=0,Xn[o++]=0),Xn[o++]=e+s,Xn[o++]=i+n,Xn[o++]=a.r,Xn[o++]=a.g,Xn[o++]=a.b,Xn[o++]=a.a,Xn[o++]=t.u2,Xn[o++]=t.v,this.twoColorTint&&(Xn[o++]=0,Xn[o++]=0,Xn[o++]=0,Xn[o++]=0),Xn[o++]=e,Xn[o++]=i+n,Xn[o++]=a.r,Xn[o++]=a.g,Xn[o++]=a.b,Xn[o++]=a.a,Xn[o++]=t.u,Xn[o++]=t.v,this.twoColorTint&&(Xn[o++]=0,Xn[o++]=0,Xn[o++]=0,Xn[o]=0),this.batcher.draw(t.page.texture,Xn,Gn)}line(t,e,i,s,n,a){this.enableRenderer(this.shapes),this.shapes.line(t,e,i,s,n)}triangle(t,e,i,s,n,a,o,r,l,h){this.enableRenderer(this.shapes),this.shapes.triangle(t,e,i,s,n,a,o,r,l,h)}quad(t,e,i,s,n,a,o,r,l,h,c,d,u){this.enableRenderer(this.shapes),this.shapes.quad(t,e,i,s,n,a,o,r,l,h,c,d,u)}rect(t,e,i,s,n,a){this.enableRenderer(this.shapes),this.shapes.rect(t,e,i,s,n,a)}rectLine(t,e,i,s,n,a,o){this.enableRenderer(this.shapes),this.shapes.rectLine(t,e,i,s,n,a,o)}polygon(t,e,i,s){this.enableRenderer(this.shapes),this.shapes.polygon(t,e,i,s)}circle(t,e,i,s,n,a=0){this.enableRenderer(this.shapes),this.shapes.circle(t,e,i,s,n,a)}curve(t,e,i,s,n,a,o,r,l,h){this.enableRenderer(this.shapes),this.shapes.curve(t,e,i,s,n,a,o,r,l,h)}end(){this.activeRenderer===this.batcher?this.batcher.end():this.activeRenderer===this.shapes&&this.shapes.end(),this.activeRenderer=null}resize(t){let e=this.canvas;var i=window.devicePixelRatio||1,s=Math.round(e.clientWidth*i),n=Math.round(e.clientHeight*i);if(e.width==s&&e.height==n||(e.width=s,e.height=n),this.context.gl.viewport(0,0,e.width,e.height),t===$n.Expand)this.camera.setViewport(s,n);else if(t===$n.Fit){let t=e.width,i=e.height,s=this.camera.viewportWidth,n=this.camera.viewportHeight,a=n/s<i/t?s/t:n/i;this.camera.setViewport(t*a,i*a)}this.camera.update()}enableRenderer(t){this.activeRenderer!==t&&(this.end(),t instanceof _n?(this.batcherShader.bind(),this.batcherShader.setUniform4x4f(Tn.MVP_MATRIX,this.camera.projectionView.values),this.batcherShader.setUniformi("u_texture",0),this.batcher.begin(this.batcherShader),this.activeRenderer=this.batcher):t instanceof Wn?(this.shapesShader.bind(),this.shapesShader.setUniform4x4f(Tn.MVP_MATRIX,this.camera.projectionView.values),this.shapes.begin(this.shapesShader),this.activeRenderer=this.shapes):this.activeRenderer=this.skeletonDebugRenderer)}}var $n,zn;(zn=$n||($n={}))[zn.Stretch=0]="Stretch",zn[zn.Expand=1]="Expand",zn[zn.Fit=2]="Fit";class qn extends Ie{constructor(t){super(t)}setFilters(t,e){}setWraps(t,e){}dispose(){}}const jn=lt.newFloatArray(8),Qn=class t{constructor(t){s(this,"ctx"),s(this,"triangleRendering",!1),s(this,"debugRendering",!1),s(this,"vertices",lt.newFloatArray(8192)),s(this,"tempColor",new nt),this.ctx=t}draw(t){this.triangleRendering?this.drawTriangles(t):this.drawImages(t)}drawImages(t){let e=this.ctx,i=this.tempColor,s=t.color,n=t.drawOrder;this.debugRendering&&(e.strokeStyle="green");for(let a=0,o=n.length;a<o;a++){let t=n[a],o=t.bone;if(!o.active)continue;let r=t.getAttachment();if(!(r instanceof He))continue;r.computeWorldVertices(t,jn,0,2);let l=r.region,h=l.texture.getImage(),c=t.color,d=r.color;i.set(s.r*c.r*d.r,s.g*c.g*d.g,s.b*c.b*d.b,s.a*c.a*d.a),e.save(),e.transform(o.a,o.c,o.b,o.d,o.worldX,o.worldY),e.translate(r.offset[0],r.offset[1]),e.rotate(r.rotation*Math.PI/180);let u=r.width/l.originalWidth;e.scale(u*r.scaleX,u*r.scaleY);let m=l.width,g=l.height;if(e.translate(m/2,g/2),90==r.region.degrees){let t=m;m=g,g=t,e.rotate(-Math.PI/2)}e.scale(1,-1),e.translate(-m/2,-g/2),e.globalAlpha=i.a,e.drawImage(h,h.width*l.u,h.height*l.v,m,g,0,0,m,g),this.debugRendering&&e.strokeRect(0,0,m,g),e.restore()}}drawTriangles(e){let i=this.ctx,s=this.tempColor,n=e.color,a=e.drawOrder,o=null,r=this.vertices,l=null;for(let c=0,d=a.length;c<d;c++){let e,d=a[c],u=d.getAttachment();if(u instanceof He){let i=u;r=this.computeRegionVertices(d,i,!1),l=t.QUAD_TRIANGLES,e=i.region.texture.getImage()}else{if(!(u instanceof Ve))continue;{let t=u;r=this.computeMeshVertices(d,t,!1),l=t.triangles,e=t.region.texture.getImage()}}if(e){d.data.blendMode!=o&&(o=d.data.blendMode);let t=d.color,a=u.color;s.set(n.r*t.r*a.r,n.g*t.g*a.g,n.b*t.b*a.b,n.a*t.a*a.a),i.globalAlpha=s.a;for(var h=0;h<l.length;h+=3){let t=8*l[h],s=8*l[h+1],n=8*l[h+2],a=r[t],o=r[t+1],c=r[t+6],d=r[t+7],u=r[s],m=r[s+1],g=r[s+6],p=r[s+7],b=r[n],f=r[n+1],y=r[n+6],w=r[n+7];this.drawTriangle(e,a,o,c,d,u,m,g,p,b,f,y,w),this.debugRendering&&(i.strokeStyle="green",i.beginPath(),i.moveTo(a,o),i.lineTo(u,m),i.lineTo(b,f),i.lineTo(a,o),i.stroke())}}}this.ctx.globalAlpha=1}drawTriangle(t,e,i,s,n,a,o,r,l,h,c,d,u){let m=this.ctx;const g=t.width-1,p=t.height-1;s*=g,n*=p,r*=g,l*=p,d*=g,u*=p,m.beginPath(),m.moveTo(e,i),m.lineTo(a,o),m.lineTo(h,c),m.closePath();let b=(r-=s)*(u-=n)-(d-=s)*(l-=n);if(0==b)return;b=1/b;const f=(u*(a-=e)-l*(h-=e))*b,y=(u*(o-=i)-l*(c-=i))*b,w=(r*h-d*a)*b,S=(r*c-d*o)*b,x=e-f*s-w*n,F=i-y*s-S*n;m.save(),m.transform(f,y,w,S,x,F),m.clip(),m.drawImage(t,0,0),m.restore()}computeRegionVertices(e,i,s){let n=e.bone.skeleton.color,a=e.color,o=i.color,r=n.a*a.a*o.a,l=s?r:1,h=this.tempColor;h.set(n.r*a.r*o.r*l,n.g*a.g*o.g*l,n.b*a.b*o.b*l,r),i.computeWorldVertices(e,this.vertices,0,t.VERTEX_SIZE);let c=this.vertices,d=i.uvs;return c[He.C1R]=h.r,c[He.C1G]=h.g,c[He.C1B]=h.b,c[He.C1A]=h.a,c[He.U1]=d[0],c[He.V1]=d[1],c[He.C2R]=h.r,c[He.C2G]=h.g,c[He.C2B]=h.b,c[He.C2A]=h.a,c[He.U2]=d[2],c[He.V2]=d[3],c[He.C3R]=h.r,c[He.C3G]=h.g,c[He.C3B]=h.b,c[He.C3A]=h.a,c[He.U3]=d[4],c[He.V3]=d[5],c[He.C4R]=h.r,c[He.C4G]=h.g,c[He.C4B]=h.b,c[He.C4A]=h.a,c[He.U4]=d[6],c[He.V4]=d[7],c}computeMeshVertices(e,i,s){let n=e.bone.skeleton.color,a=e.color,o=i.color,r=n.a*a.a*o.a,l=s?r:1,h=this.tempColor;h.set(n.r*a.r*o.r*l,n.g*a.g*o.g*l,n.b*a.b*o.b*l,r);let c=i.worldVerticesLength/2,d=this.vertices;d.length<i.worldVerticesLength&&(this.vertices=d=lt.newFloatArray(i.worldVerticesLength)),i.computeWorldVertices(e,0,i.worldVerticesLength,d,0,t.VERTEX_SIZE);let u=i.uvs;for(let t=0,m=0,g=2;t<c;t++)d[g++]=h.r,d[g++]=h.g,d[g++]=h.b,d[g++]=h.a,d[g++]=u[m++],d[g++]=u[m++],g+=2;return d}};s(Qn,"QUAD_TRIANGLES",[0,1,2,2,3,0]),s(Qn,"VERTEX_SIZE",8);let Zn=Qn;const Kn=class t extends a.Plugins.ScenePlugin{constructor(t,e,i){super(t,e,i),s(this,"game"),s(this,"isWebGL"),s(this,"gl"),s(this,"canvasRenderer"),s(this,"phaserRenderer"),s(this,"skeletonDataCache"),s(this,"atlasCache"),this.game=e.game,this.isWebGL=2===this.game.config.renderType,this.gl=this.isWebGL?this.game.renderer.gl:null,this.phaserRenderer=this.game.renderer,this.canvasRenderer=null,this.skeletonDataCache=this.game.cache.addCustom("esotericsoftware.spine.skeletonFile.cache"),this.atlasCache=this.game.cache.addCustom("esotericsoftware.spine.atlas.cache"),e.registerFileType("spineJson",(function(t,e,i){let s=new ia(this,t,e,ta.json,i);return this.addFile(s.files),this}),t),e.registerFileType("spineBinary",(function(t,e,i){let s=new ia(this,t,e,ta.binary,i);return this.addFile(s.files),this}),t),e.registerFileType("spineAtlas",(function(t,e,i,s){let n=new sa(this,t,e,i,s);return this.addFile(n.files),this}),t),e.registerGameObject(window.SPINE_GAME_OBJECT_TYPE?window.SPINE_GAME_OBJECT_TYPE:O,(function(t,e,s,n,o){this.scene.sys.renderer instanceof a.Renderer.WebGL.WebGLRenderer&&this.scene.sys.renderer.pipelines.clear();const r=this.scene.sys[i];let l=new vs(this.scene,r,t,e,s,n,o);return this.displayList.add(l),this.updateList.add(l),this.scene.sys.renderer instanceof a.Renderer.WebGL.WebGLRenderer&&this.scene.sys.renderer.pipelines.rebind(),l}),(function(t,e=!1){this.scene.sys.renderer instanceof a.Renderer.WebGL.WebGLRenderer&&this.scene.sys.renderer.pipelines.clear();let s=t.x?t.x:0,n=t.y?t.y:0,o=t.boundsProvider?t.boundsProvider:void 0;const r=this.scene.sys[i];let l=new vs(this.scene,r,s,n,t.dataKey,t.atlasKey,o);return void 0!==e&&(t.add=e),this.scene.sys.renderer instanceof a.Renderer.WebGL.WebGLRenderer&&this.scene.sys.renderer.pipelines.rebind(),a.GameObjects.BuildGameObject(this.scene,l,t)}))}get webGLRenderer(){return t.gameWebGLRenderer}boot(){gi.yDown=!0,this.isWebGL?(t.gameWebGLRenderer||(t.gameWebGLRenderer=new Un(this.game.renderer.canvas,this.gl,!0)),this.onResize(),this.game.scale.on(a.Scale.Events.RESIZE,this.onResize,this)):this.canvasRenderer||(this.canvasRenderer=new Zn(this.scene.sys.context));var e=this.systems.events;e.once("shutdown",this.shutdown,this),e.once("destroy",this.destroy,this),this.game.events.once("destroy",this.gameDestroy,this)}onResize(){var t=this.game.renderer,e=this.webGLRenderer;if(t&&e){var i=t.width,s=t.height;e.camera.position.x=i/2,e.camera.position.y=s/2,e.camera.up.y=-1,e.camera.direction.z=1,e.camera.setViewport(i,s)}}shutdown(){this.systems.events.off("shutdown",this.shutdown,this),this.isWebGL&&this.game.scale.off(a.Scale.Events.RESIZE,this.onResize,this)}destroy(){this.shutdown()}gameDestroy(){this.pluginManager.removeGameObject(window.SPINE_GAME_OBJECT_TYPE?window.SPINE_GAME_OBJECT_TYPE:O,!0,!0),this.webGLRenderer&&this.webGLRenderer.dispose(),t.gameWebGLRenderer=null}getAtlas(t){let e;if(this.atlasCache.exists(t))e=this.atlasCache.get(t);else{let i=this.game.cache.text.get(t);if(e=new Le(i.data),this.isWebGL){let i=this.gl;const s=i.getParameter(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL);s&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);for(let n of e.pages)n.setTexture(new en(i,this.game.textures.get(t+"!"+n.name).getSourceImage(),!1));s&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0)}else for(let s of e.pages)s.setTexture(new qn(this.game.textures.get(t+"!"+s.name).getSourceImage()));this.atlasCache.add(t,e)}return e}isAtlasPremultiplied(t){let e=this.game.cache.text.get(t);return!!e&&e.premultipliedAlpha}getSkeletonData(t,e){const i=this.getAtlas(e),s=t+e;let n;if(this.skeletonDataCache.exists(s))n=this.skeletonDataCache.get(s);else{if(this.game.cache.json.exists(t)){let e=this.game.cache.json.get(t);n=new ps(new Ue(i)).readSkeletonData(e)}else{let e=this.game.cache.binary.get(t);n=new Ai(new Ue(i)).readSkeletonData(new Uint8Array(e))}this.skeletonDataCache.add(s,n)}return n}createSkeleton(t,e){return new gi(this.getSkeletonData(t,e))}};s(Kn,"gameWebGLRenderer",null),s(Kn,"rendererId",0);let Jn=Kn;var ta,ea;(ea=ta||(ta={}))[ea.json=0]="json",ea[ea.binary=1]="binary";class ia extends a.Loader.MultiFile{constructor(t,e,i,n,o){if("string"!=typeof e){const t=e;e=t.key,i=t.url,n="spineJson"===t.type?ta.json:ta.binary,o=t.xhrSettings}let r=null;r=n==ta.json?new a.Loader.FileTypes.JSONFile(t,{key:e,url:i,extension:"json",xhrSettings:o}):new a.Loader.FileTypes.BinaryFile(t,{key:e,url:i,extension:"skel",xhrSettings:o}),super(t,"spineSkeletonData",e,[r]),s(this,"fileType"),this.fileType=n}onFileComplete(t){this.pending--}addToCache(){this.isReadyToProcess()&&this.files[0].addToCache()}}class sa extends a.Loader.MultiFile{constructor(t,e,i,n,o){if("string"!=typeof e){const t=e;e=t.key,i=t.url,n=t.premultipliedAlpha,o=t.xhrSettings}super(t,"spineAtlasData",e,[new a.Loader.FileTypes.TextFile(t,{key:e,url:i,xhrSettings:o,extension:"atlas"})]),s(this,"premultipliedAlpha"),this.premultipliedAlpha=n}onFileComplete(t){var e;if(-1!=this.files.indexOf(t)&&(this.pending--,"text"==t.type)){var i=t.data.split(/\r\n|\r|\n/);let c=[];c.push(i[0]);for(var s=1;s<i.length;s++){var n=i[s];""===n.trim()&&s<i.length-1&&(n=i[s+1],c.push(n))}let d=(null!=(e=t.src.match(/^.*\//))?e:"").toString();this.loader.path&&this.loader.path.length>0&&d.startsWith(this.loader.path)&&(d=d.slice(this.loader.path.length));for(var o=0;o<c.length;o++){var r=d+c[o],l=t.key+"!"+c[o],h=new a.Loader.FileTypes.ImageFile(this.loader,l,r);this.loader.keyExists(h)||(this.addToMultiFile(h),this.loader.addFile(h))}}}addToCache(){var t;if(this.isReadyToProcess()){let e=this.loader.textureManager;for(let i of this.files)"image"==i.type?e.exists(i.key)||e.addImage(i.key,i.data):(this.premultipliedAlpha=null!=(t=this.premultipliedAlpha)?t:i.data.indexOf("pma: true")>=0||i.data.indexOf("pma:true")>=0,i.data={data:i.data,premultipliedAlpha:this.premultipliedAlpha},i.addToCache())}}}window.spine={SpinePlugin:Jn},window["spine.SpinePlugin"]=Jn;const na={type:a.AUTO,width:1920,height:1080,parent:"game-container",backgroundColor:"#000000",scale:{mode:a.Scale.FIT,autoCenter:a.Scale.CENTER_BOTH},scene:[Zs,Ks,js],plugins:{scene:[{key:"spine.SpinePlugin",plugin:Jn,mapping:"spine"}]},dom:{createContainer:!0},input:{activePointers:3}},aa={type:a.AUTO,width:428,height:926,parent:"game-container",backgroundColor:"#000000",scale:{mode:a.Scale.FIT,autoCenter:a.Scale.CENTER_BOTH},scene:[Zs,Ks,js],plugins:{scene:[{key:"spine.SpinePlugin",plugin:Jn,mapping:"spine"}]},dom:{createContainer:!0},input:{activePointers:3}},oa=()=>{const t=new URLSearchParams(window.location.search).get("device");return"desktop"!==t&&("mobile"===t||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768)};let ra=!1;const la=()=>{ra||(ra=!0,console.log(E.yellow.bold("Starting game...")),(t=>{const e=oa()?aa:na,i=new a.Game({...e,parent:t});if(oa()){try{const e=document.getElementById("app"),s=document.getElementById(t)||e,n=()=>{const t=window.visualViewport;return{width:t&&t.width?Math.round(t.width):window.innerWidth,height:t&&t.height?Math.round(t.height):window.innerHeight}},a=()=>{const{height:t}=n();e&&(e.style.width="100vw",e.style.height=`${t}px`),s&&(s.style.width="100vw",s.style.height=`${t}px`)},o=()=>{try{i.scale.refresh()}catch(t){}[60,180,360,720].forEach((e=>{window.setTimeout((()=>{a();try{i.scale.refresh()}catch(t){}}),e)}))};a(),e&&(e.style.display=e.style.display||"flex",e.style.justifyContent=e.style.justifyContent||"center",e.style.alignItems=e.style.alignItems||"center"),s&&(s.style.aspectRatio="",s.style.maxWidth="100vw",s.style.maxHeight="100vh");const r=()=>{a(),o()};r(),window.addEventListener("resize",r),window.addEventListener("orientationchange",r);const l=window.visualViewport;l&&l.addEventListener&&l.addEventListener("resize",r);const h=async()=>{try{screen&&screen.orientation&&screen.orientation.lock&&await screen.orientation.lock("portrait")}catch(t){}};i.scale.on("enterfullscreen",h),i.scale.on("resize",(()=>{a()}))}catch(o){}try{const e=document.getElementById("app"),s=document.getElementById(t)||e,n=i.canvas;if(n){const t=t=>{t.preventDefault()};n.addEventListener("touchstart",t,{passive:!1}),n.addEventListener("touchmove",t,{passive:!1}),n.addEventListener("touchend",t,{passive:!1}),n.addEventListener("touchcancel",t,{passive:!1})}const a=t=>{t&&(t.style.touchAction="none",t.style.msTouchAction="none",t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.webkitTapHighlightColor="transparent",t.style.overscrollBehavior="contain")};a(e),a(s),a(n)}catch(r){}i.canvas&&!i.canvas.hasAttribute("tabindex")&&i.canvas.setAttribute("tabindex","0")}window.phaserGame=i;const s=document.getElementById("app");s&&(i.scale.fullscreenTarget=s),i.scale.on("leavefullscreen",(()=>{var t;null==(t=i.canvas)||t.focus()}));const n=()=>{var t;i.scale.isFullscreen||null==(t=i.canvas)||t.focus()};document.addEventListener("fullscreenchange",n),document.addEventListener("webkitfullscreenchange",n)})("game-container"))};window.startGameWhenReady=la,document.addEventListener("DOMContentLoaded",(()=>{setTimeout((()=>{ra||(console.warn("Font loading timeout, starting game with fallback fonts"),la())}),1e3)}));
